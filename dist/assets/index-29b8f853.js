function xC(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();function vC(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var j_={exports:{}},Hf={},O_={exports:{}},lt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Z0=Symbol.for("react.element"),yC=Symbol.for("react.portal"),wC=Symbol.for("react.fragment"),_C=Symbol.for("react.strict_mode"),EC=Symbol.for("react.profiler"),kC=Symbol.for("react.provider"),TC=Symbol.for("react.context"),SC=Symbol.for("react.forward_ref"),bC=Symbol.for("react.suspense"),CC=Symbol.for("react.memo"),NC=Symbol.for("react.lazy"),$v=Symbol.iterator;function AC(t){return t===null||typeof t!="object"?null:(t=$v&&t[$v]||t["@@iterator"],typeof t=="function"?t:null)}var M_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},B_=Object.assign,V_={};function Ql(t,e,r){this.props=t,this.context=e,this.refs=V_,this.updater=r||M_}Ql.prototype.isReactComponent={};Ql.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ql.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function U_(){}U_.prototype=Ql.prototype;function Ag(t,e,r){this.props=t,this.context=e,this.refs=V_,this.updater=r||M_}var Ig=Ag.prototype=new U_;Ig.constructor=Ag;B_(Ig,Ql.prototype);Ig.isPureReactComponent=!0;var Wv=Array.isArray,$_=Object.prototype.hasOwnProperty,Rg={current:null},W_={key:!0,ref:!0,__self:!0,__source:!0};function z_(t,e,r){var n,s={},i=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)$_.call(e,n)&&!W_.hasOwnProperty(n)&&(s[n]=e[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];s.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:Z0,type:t,key:i,ref:a,props:s,_owner:Rg.current}}function IC(t,e){return{$$typeof:Z0,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Pg(t){return typeof t=="object"&&t!==null&&t.$$typeof===Z0}function RC(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var zv=/\/+/g;function Xd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?RC(""+t.key):e.toString(36)}function vh(t,e,r,n,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Z0:case yC:a=!0}}if(a)return a=t,s=s(a),t=n===""?"."+Xd(a,0):n,Wv(s)?(r="",t!=null&&(r=t.replace(zv,"$&/")+"/"),vh(s,e,r,"",function(u){return u})):s!=null&&(Pg(s)&&(s=IC(s,r+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(zv,"$&/")+"/")+t)),e.push(s)),1;if(a=0,n=n===""?".":n+":",Wv(t))for(var o=0;o<t.length;o++){i=t[o];var l=n+Xd(i,o);a+=vh(i,e,r,l,s)}else if(l=AC(t),typeof l=="function")for(t=l.call(t),o=0;!(i=t.next()).done;)i=i.value,l=n+Xd(i,o++),a+=vh(i,e,r,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Mu(t,e,r){if(t==null)return t;var n=[],s=0;return vh(t,n,"","",function(i){return e.call(r,i,s++)}),n}function PC(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Cn={current:null},yh={transition:null},FC={ReactCurrentDispatcher:Cn,ReactCurrentBatchConfig:yh,ReactCurrentOwner:Rg};function H_(){throw Error("act(...) is not supported in production builds of React.")}lt.Children={map:Mu,forEach:function(t,e,r){Mu(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Mu(t,function(){e++}),e},toArray:function(t){return Mu(t,function(e){return e})||[]},only:function(t){if(!Pg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};lt.Component=Ql;lt.Fragment=wC;lt.Profiler=EC;lt.PureComponent=Ag;lt.StrictMode=_C;lt.Suspense=bC;lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FC;lt.act=H_;lt.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=B_({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=Rg.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)$_.call(e,l)&&!W_.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Z0,type:t.type,key:s,ref:i,props:n,_owner:a}};lt.createContext=function(t){return t={$$typeof:TC,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:kC,_context:t},t.Consumer=t};lt.createElement=z_;lt.createFactory=function(t){var e=z_.bind(null,t);return e.type=t,e};lt.createRef=function(){return{current:null}};lt.forwardRef=function(t){return{$$typeof:SC,render:t}};lt.isValidElement=Pg;lt.lazy=function(t){return{$$typeof:NC,_payload:{_status:-1,_result:t},_init:PC}};lt.memo=function(t,e){return{$$typeof:CC,type:t,compare:e===void 0?null:e}};lt.startTransition=function(t){var e=yh.transition;yh.transition={};try{t()}finally{yh.transition=e}};lt.unstable_act=H_;lt.useCallback=function(t,e){return Cn.current.useCallback(t,e)};lt.useContext=function(t){return Cn.current.useContext(t)};lt.useDebugValue=function(){};lt.useDeferredValue=function(t){return Cn.current.useDeferredValue(t)};lt.useEffect=function(t,e){return Cn.current.useEffect(t,e)};lt.useId=function(){return Cn.current.useId()};lt.useImperativeHandle=function(t,e,r){return Cn.current.useImperativeHandle(t,e,r)};lt.useInsertionEffect=function(t,e){return Cn.current.useInsertionEffect(t,e)};lt.useLayoutEffect=function(t,e){return Cn.current.useLayoutEffect(t,e)};lt.useMemo=function(t,e){return Cn.current.useMemo(t,e)};lt.useReducer=function(t,e,r){return Cn.current.useReducer(t,e,r)};lt.useRef=function(t){return Cn.current.useRef(t)};lt.useState=function(t){return Cn.current.useState(t)};lt.useSyncExternalStore=function(t,e,r){return Cn.current.useSyncExternalStore(t,e,r)};lt.useTransition=function(){return Cn.current.useTransition()};lt.version="18.3.1";O_.exports=lt;var F=O_.exports;const G_=vC(F),LC=xC({__proto__:null,default:G_},[F]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DC=F,jC=Symbol.for("react.element"),OC=Symbol.for("react.fragment"),MC=Object.prototype.hasOwnProperty,BC=DC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,VC={key:!0,ref:!0,__self:!0,__source:!0};function K_(t,e,r){var n,s={},i=null,a=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)MC.call(e,n)&&!VC.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:jC,type:t,key:i,ref:a,props:s,_owner:BC.current}}Hf.Fragment=OC;Hf.jsx=K_;Hf.jsxs=K_;j_.exports=Hf;var c=j_.exports,Qm={},q_={exports:{}},Xn={},X_={exports:{}},Q_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ne,K){var fe=ne.length;ne.push(K);e:for(;0<fe;){var _e=fe-1>>>1,B=ne[_e];if(0<s(B,K))ne[_e]=K,ne[fe]=B,fe=_e;else break e}}function r(ne){return ne.length===0?null:ne[0]}function n(ne){if(ne.length===0)return null;var K=ne[0],fe=ne.pop();if(fe!==K){ne[0]=fe;e:for(var _e=0,B=ne.length,q=B>>>1;_e<q;){var H=2*(_e+1)-1,G=ne[H],J=H+1,ae=ne[J];if(0>s(G,fe))J<B&&0>s(ae,G)?(ne[_e]=ae,ne[J]=fe,_e=J):(ne[_e]=G,ne[H]=fe,_e=H);else if(J<B&&0>s(ae,fe))ne[_e]=ae,ne[J]=fe,_e=J;else break e}}return K}function s(ne,K){var fe=ne.sortIndex-K.sortIndex;return fe!==0?fe:ne.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],u=[],h=1,d=null,m=3,p=!1,x=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(ne){for(var K=r(u);K!==null;){if(K.callback===null)n(u);else if(K.startTime<=ne)n(u),K.sortIndex=K.expirationTime,e(l,K);else break;K=r(u)}}function N(ne){if(g=!1,_(ne),!x)if(r(l)!==null)x=!0,ie(j);else{var K=r(u);K!==null&&ge(N,K.startTime-ne)}}function j(ne,K){x=!1,g&&(g=!1,w(S),S=-1),p=!0;var fe=m;try{for(_(K),d=r(l);d!==null&&(!(d.expirationTime>K)||ne&&!A());){var _e=d.callback;if(typeof _e=="function"){d.callback=null,m=d.priorityLevel;var B=_e(d.expirationTime<=K);K=t.unstable_now(),typeof B=="function"?d.callback=B:d===r(l)&&n(l),_(K)}else n(l);d=r(l)}if(d!==null)var q=!0;else{var H=r(u);H!==null&&ge(N,H.startTime-K),q=!1}return q}finally{d=null,m=fe,p=!1}}var D=!1,k=null,S=-1,b=5,C=-1;function A(){return!(t.unstable_now()-C<b)}function I(){if(k!==null){var ne=t.unstable_now();C=ne;var K=!0;try{K=k(!0,ne)}finally{K?P():(D=!1,k=null)}}else D=!1}var P;if(typeof E=="function")P=function(){E(I)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,de=ue.port2;ue.port1.onmessage=I,P=function(){de.postMessage(null)}}else P=function(){y(I,0)};function ie(ne){k=ne,D||(D=!0,P())}function ge(ne,K){S=y(function(){ne(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ne){ne.callback=null},t.unstable_continueExecution=function(){x||p||(x=!0,ie(j))},t.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<ne?Math.floor(1e3/ne):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(ne){switch(m){case 1:case 2:case 3:var K=3;break;default:K=m}var fe=m;m=K;try{return ne()}finally{m=fe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ne,K){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var fe=m;m=ne;try{return K()}finally{m=fe}},t.unstable_scheduleCallback=function(ne,K,fe){var _e=t.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?_e+fe:_e):fe=_e,ne){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=fe+B,ne={id:h++,callback:K,priorityLevel:ne,startTime:fe,expirationTime:B,sortIndex:-1},fe>_e?(ne.sortIndex=fe,e(u,ne),r(l)===null&&ne===r(u)&&(g?(w(S),S=-1):g=!0,ge(N,fe-_e))):(ne.sortIndex=B,e(l,ne),x||p||(x=!0,ie(j))),ne},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(ne){var K=m;return function(){var fe=m;m=K;try{return ne.apply(this,arguments)}finally{m=fe}}}})(Q_);X_.exports=Q_;var UC=X_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $C=F,Kn=UC;function Ee(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Y_=new Set,f0={};function Ao(t,e){Rl(t,e),Rl(t+"Capture",e)}function Rl(t,e){for(f0[t]=e,t=0;t<e.length;t++)Y_.add(e[t])}var Ci=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ym=Object.prototype.hasOwnProperty,WC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Hv={},Gv={};function zC(t){return Ym.call(Gv,t)?!0:Ym.call(Hv,t)?!1:WC.test(t)?Gv[t]=!0:(Hv[t]=!0,!1)}function HC(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function GC(t,e,r,n){if(e===null||typeof e>"u"||HC(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Nn(t,e,r,n,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var Qr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Qr[t]=new Nn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Qr[e]=new Nn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Qr[t]=new Nn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Qr[t]=new Nn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Qr[t]=new Nn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Qr[t]=new Nn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Qr[t]=new Nn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Qr[t]=new Nn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Qr[t]=new Nn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Fg=/[\-:]([a-z])/g;function Lg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Fg,Lg);Qr[e]=new Nn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Fg,Lg);Qr[e]=new Nn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Fg,Lg);Qr[e]=new Nn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Qr[t]=new Nn(t,1,!1,t.toLowerCase(),null,!1,!1)});Qr.xlinkHref=new Nn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Qr[t]=new Nn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Dg(t,e,r,n){var s=Qr.hasOwnProperty(e)?Qr[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(GC(e,r,s,n)&&(r=null),n||s===null?zC(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var ji=$C.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Bu=Symbol.for("react.element"),nl=Symbol.for("react.portal"),sl=Symbol.for("react.fragment"),jg=Symbol.for("react.strict_mode"),Jm=Symbol.for("react.profiler"),J_=Symbol.for("react.provider"),Z_=Symbol.for("react.context"),Og=Symbol.for("react.forward_ref"),Zm=Symbol.for("react.suspense"),ep=Symbol.for("react.suspense_list"),Mg=Symbol.for("react.memo"),qi=Symbol.for("react.lazy"),e4=Symbol.for("react.offscreen"),Kv=Symbol.iterator;function yc(t){return t===null||typeof t!="object"?null:(t=Kv&&t[Kv]||t["@@iterator"],typeof t=="function"?t:null)}var Jt=Object.assign,Qd;function Ic(t){if(Qd===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Qd=e&&e[1]||""}return`
`+Qd+t}var Yd=!1;function Jd(t,e){if(!t||Yd)return"";Yd=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=n.stack.split(`
`),a=s.length-1,o=i.length-1;1<=a&&0<=o&&s[a]!==i[o];)o--;for(;1<=a&&0<=o;a--,o--)if(s[a]!==i[o]){if(a!==1||o!==1)do if(a--,o--,0>o||s[a]!==i[o]){var l=`
`+s[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{Yd=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Ic(t):""}function KC(t){switch(t.tag){case 5:return Ic(t.type);case 16:return Ic("Lazy");case 13:return Ic("Suspense");case 19:return Ic("SuspenseList");case 0:case 2:case 15:return t=Jd(t.type,!1),t;case 11:return t=Jd(t.type.render,!1),t;case 1:return t=Jd(t.type,!0),t;default:return""}}function tp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case sl:return"Fragment";case nl:return"Portal";case Jm:return"Profiler";case jg:return"StrictMode";case Zm:return"Suspense";case ep:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Z_:return(t.displayName||"Context")+".Consumer";case J_:return(t._context.displayName||"Context")+".Provider";case Og:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Mg:return e=t.displayName||null,e!==null?e:tp(t.type)||"Memo";case qi:e=t._payload,t=t._init;try{return tp(t(e))}catch{}}return null}function qC(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return tp(e);case 8:return e===jg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function wa(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function t4(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function XC(t){var e=t4(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){n=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Vu(t){t._valueTracker||(t._valueTracker=XC(t))}function r4(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=t4(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Vh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function rp(t,e){var r=e.checked;return Jt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function qv(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=wa(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function n4(t,e){e=e.checked,e!=null&&Dg(t,"checked",e,!1)}function np(t,e){n4(t,e);var r=wa(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?sp(t,e.type,r):e.hasOwnProperty("defaultValue")&&sp(t,e.type,wa(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Xv(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function sp(t,e,r){(e!=="number"||Vh(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Rc=Array.isArray;function xl(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+wa(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function ip(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Ee(91));return Jt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Qv(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Ee(92));if(Rc(r)){if(1<r.length)throw Error(Ee(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:wa(r)}}function s4(t,e){var r=wa(e.value),n=wa(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function Yv(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function i4(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ap(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?i4(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Uu,a4=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Uu=Uu||document.createElement("div"),Uu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Uu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function d0(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var zc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},QC=["Webkit","ms","Moz","O"];Object.keys(zc).forEach(function(t){QC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),zc[e]=zc[t]})});function o4(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||zc.hasOwnProperty(t)&&zc[t]?(""+e).trim():e+"px"}function l4(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=o4(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var YC=Jt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function op(t,e){if(e){if(YC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Ee(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Ee(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Ee(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Ee(62))}}function lp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cp=null;function Bg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var up=null,vl=null,yl=null;function Jv(t){if(t=ru(t)){if(typeof up!="function")throw Error(Ee(280));var e=t.stateNode;e&&(e=Qf(e),up(t.stateNode,t.type,e))}}function c4(t){vl?yl?yl.push(t):yl=[t]:vl=t}function u4(){if(vl){var t=vl,e=yl;if(yl=vl=null,Jv(t),e)for(t=0;t<e.length;t++)Jv(e[t])}}function h4(t,e){return t(e)}function f4(){}var Zd=!1;function d4(t,e,r){if(Zd)return t(e,r);Zd=!0;try{return h4(t,e,r)}finally{Zd=!1,(vl!==null||yl!==null)&&(f4(),u4())}}function m0(t,e){var r=t.stateNode;if(r===null)return null;var n=Qf(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Ee(231,e,typeof r));return r}var hp=!1;if(Ci)try{var wc={};Object.defineProperty(wc,"passive",{get:function(){hp=!0}}),window.addEventListener("test",wc,wc),window.removeEventListener("test",wc,wc)}catch{hp=!1}function JC(t,e,r,n,s,i,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(h){this.onError(h)}}var Hc=!1,Uh=null,$h=!1,fp=null,ZC={onError:function(t){Hc=!0,Uh=t}};function eN(t,e,r,n,s,i,a,o,l){Hc=!1,Uh=null,JC.apply(ZC,arguments)}function tN(t,e,r,n,s,i,a,o,l){if(eN.apply(this,arguments),Hc){if(Hc){var u=Uh;Hc=!1,Uh=null}else throw Error(Ee(198));$h||($h=!0,fp=u)}}function Io(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function m4(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Zv(t){if(Io(t)!==t)throw Error(Ee(188))}function rN(t){var e=t.alternate;if(!e){if(e=Io(t),e===null)throw Error(Ee(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return Zv(s),t;if(i===n)return Zv(s),e;i=i.sibling}throw Error(Ee(188))}if(r.return!==n.return)r=s,n=i;else{for(var a=!1,o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a){for(o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a)throw Error(Ee(189))}}if(r.alternate!==n)throw Error(Ee(190))}if(r.tag!==3)throw Error(Ee(188));return r.stateNode.current===r?t:e}function p4(t){return t=rN(t),t!==null?g4(t):null}function g4(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=g4(t);if(e!==null)return e;t=t.sibling}return null}var x4=Kn.unstable_scheduleCallback,e2=Kn.unstable_cancelCallback,nN=Kn.unstable_shouldYield,sN=Kn.unstable_requestPaint,cr=Kn.unstable_now,iN=Kn.unstable_getCurrentPriorityLevel,Vg=Kn.unstable_ImmediatePriority,v4=Kn.unstable_UserBlockingPriority,Wh=Kn.unstable_NormalPriority,aN=Kn.unstable_LowPriority,y4=Kn.unstable_IdlePriority,Gf=null,qs=null;function oN(t){if(qs&&typeof qs.onCommitFiberRoot=="function")try{qs.onCommitFiberRoot(Gf,t,void 0,(t.current.flags&128)===128)}catch{}}var As=Math.clz32?Math.clz32:uN,lN=Math.log,cN=Math.LN2;function uN(t){return t>>>=0,t===0?32:31-(lN(t)/cN|0)|0}var $u=64,Wu=4194304;function Pc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function zh(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,i=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~s;o!==0?n=Pc(o):(i&=a,i!==0&&(n=Pc(i)))}else a=r&~s,a!==0?n=Pc(a):i!==0&&(n=Pc(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-As(e),s=1<<r,n|=t[r],e&=~s;return n}function hN(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fN(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-As(i),o=1<<a,l=s[a];l===-1?(!(o&r)||o&n)&&(s[a]=hN(o,e)):l<=e&&(t.expiredLanes|=o),i&=~o}}function dp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function w4(){var t=$u;return $u<<=1,!($u&4194240)&&($u=64),t}function em(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function eu(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-As(e),t[e]=r}function dN(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-As(r),i=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~i}}function Ug(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-As(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var Ft=0;function _4(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var E4,$g,k4,T4,S4,mp=!1,zu=[],la=null,ca=null,ua=null,p0=new Map,g0=new Map,Qi=[],mN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function t2(t,e){switch(t){case"focusin":case"focusout":la=null;break;case"dragenter":case"dragleave":ca=null;break;case"mouseover":case"mouseout":ua=null;break;case"pointerover":case"pointerout":p0.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":g0.delete(e.pointerId)}}function _c(t,e,r,n,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},e!==null&&(e=ru(e),e!==null&&$g(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function pN(t,e,r,n,s){switch(e){case"focusin":return la=_c(la,t,e,r,n,s),!0;case"dragenter":return ca=_c(ca,t,e,r,n,s),!0;case"mouseover":return ua=_c(ua,t,e,r,n,s),!0;case"pointerover":var i=s.pointerId;return p0.set(i,_c(p0.get(i)||null,t,e,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,g0.set(i,_c(g0.get(i)||null,t,e,r,n,s)),!0}return!1}function b4(t){var e=Qa(t.target);if(e!==null){var r=Io(e);if(r!==null){if(e=r.tag,e===13){if(e=m4(r),e!==null){t.blockedOn=e,S4(t.priority,function(){k4(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function wh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=pp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);cp=n,r.target.dispatchEvent(n),cp=null}else return e=ru(r),e!==null&&$g(e),t.blockedOn=r,!1;e.shift()}return!0}function r2(t,e,r){wh(t)&&r.delete(e)}function gN(){mp=!1,la!==null&&wh(la)&&(la=null),ca!==null&&wh(ca)&&(ca=null),ua!==null&&wh(ua)&&(ua=null),p0.forEach(r2),g0.forEach(r2)}function Ec(t,e){t.blockedOn===e&&(t.blockedOn=null,mp||(mp=!0,Kn.unstable_scheduleCallback(Kn.unstable_NormalPriority,gN)))}function x0(t){function e(s){return Ec(s,t)}if(0<zu.length){Ec(zu[0],t);for(var r=1;r<zu.length;r++){var n=zu[r];n.blockedOn===t&&(n.blockedOn=null)}}for(la!==null&&Ec(la,t),ca!==null&&Ec(ca,t),ua!==null&&Ec(ua,t),p0.forEach(e),g0.forEach(e),r=0;r<Qi.length;r++)n=Qi[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Qi.length&&(r=Qi[0],r.blockedOn===null);)b4(r),r.blockedOn===null&&Qi.shift()}var wl=ji.ReactCurrentBatchConfig,Hh=!0;function xN(t,e,r,n){var s=Ft,i=wl.transition;wl.transition=null;try{Ft=1,Wg(t,e,r,n)}finally{Ft=s,wl.transition=i}}function vN(t,e,r,n){var s=Ft,i=wl.transition;wl.transition=null;try{Ft=4,Wg(t,e,r,n)}finally{Ft=s,wl.transition=i}}function Wg(t,e,r,n){if(Hh){var s=pp(t,e,r,n);if(s===null)um(t,e,n,Gh,r),t2(t,n);else if(pN(s,t,e,r,n))n.stopPropagation();else if(t2(t,n),e&4&&-1<mN.indexOf(t)){for(;s!==null;){var i=ru(s);if(i!==null&&E4(i),i=pp(t,e,r,n),i===null&&um(t,e,n,Gh,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else um(t,e,n,null,r)}}var Gh=null;function pp(t,e,r,n){if(Gh=null,t=Bg(n),t=Qa(t),t!==null)if(e=Io(t),e===null)t=null;else if(r=e.tag,r===13){if(t=m4(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Gh=t,null}function C4(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(iN()){case Vg:return 1;case v4:return 4;case Wh:case aN:return 16;case y4:return 536870912;default:return 16}default:return 16}}var ra=null,zg=null,_h=null;function N4(){if(_h)return _h;var t,e=zg,r=e.length,n,s="value"in ra?ra.value:ra.textContent,i=s.length;for(t=0;t<r&&e[t]===s[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===s[i-n];n++);return _h=s.slice(t,1<n?1-n:void 0)}function Eh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Hu(){return!0}function n2(){return!1}function Qn(t){function e(r,n,s,i,a){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Hu:n2,this.isPropagationStopped=n2,this}return Jt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Hu)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Hu)},persist:function(){},isPersistent:Hu}),e}var Yl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Hg=Qn(Yl),tu=Jt({},Yl,{view:0,detail:0}),yN=Qn(tu),tm,rm,kc,Kf=Jt({},tu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==kc&&(kc&&t.type==="mousemove"?(tm=t.screenX-kc.screenX,rm=t.screenY-kc.screenY):rm=tm=0,kc=t),tm)},movementY:function(t){return"movementY"in t?t.movementY:rm}}),s2=Qn(Kf),wN=Jt({},Kf,{dataTransfer:0}),_N=Qn(wN),EN=Jt({},tu,{relatedTarget:0}),nm=Qn(EN),kN=Jt({},Yl,{animationName:0,elapsedTime:0,pseudoElement:0}),TN=Qn(kN),SN=Jt({},Yl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),bN=Qn(SN),CN=Jt({},Yl,{data:0}),i2=Qn(CN),NN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},AN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},IN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function RN(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=IN[t])?!!e[t]:!1}function Gg(){return RN}var PN=Jt({},tu,{key:function(t){if(t.key){var e=NN[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Eh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?AN[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gg,charCode:function(t){return t.type==="keypress"?Eh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Eh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),FN=Qn(PN),LN=Jt({},Kf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),a2=Qn(LN),DN=Jt({},tu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gg}),jN=Qn(DN),ON=Jt({},Yl,{propertyName:0,elapsedTime:0,pseudoElement:0}),MN=Qn(ON),BN=Jt({},Kf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),VN=Qn(BN),UN=[9,13,27,32],Kg=Ci&&"CompositionEvent"in window,Gc=null;Ci&&"documentMode"in document&&(Gc=document.documentMode);var $N=Ci&&"TextEvent"in window&&!Gc,A4=Ci&&(!Kg||Gc&&8<Gc&&11>=Gc),o2=String.fromCharCode(32),l2=!1;function I4(t,e){switch(t){case"keyup":return UN.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function R4(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var il=!1;function WN(t,e){switch(t){case"compositionend":return R4(e);case"keypress":return e.which!==32?null:(l2=!0,o2);case"textInput":return t=e.data,t===o2&&l2?null:t;default:return null}}function zN(t,e){if(il)return t==="compositionend"||!Kg&&I4(t,e)?(t=N4(),_h=zg=ra=null,il=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return A4&&e.locale!=="ko"?null:e.data;default:return null}}var HN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function c2(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!HN[t.type]:e==="textarea"}function P4(t,e,r,n){c4(n),e=Kh(e,"onChange"),0<e.length&&(r=new Hg("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Kc=null,v0=null;function GN(t){W4(t,0)}function qf(t){var e=ll(t);if(r4(e))return t}function KN(t,e){if(t==="change")return e}var F4=!1;if(Ci){var sm;if(Ci){var im="oninput"in document;if(!im){var u2=document.createElement("div");u2.setAttribute("oninput","return;"),im=typeof u2.oninput=="function"}sm=im}else sm=!1;F4=sm&&(!document.documentMode||9<document.documentMode)}function h2(){Kc&&(Kc.detachEvent("onpropertychange",L4),v0=Kc=null)}function L4(t){if(t.propertyName==="value"&&qf(v0)){var e=[];P4(e,v0,t,Bg(t)),d4(GN,e)}}function qN(t,e,r){t==="focusin"?(h2(),Kc=e,v0=r,Kc.attachEvent("onpropertychange",L4)):t==="focusout"&&h2()}function XN(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return qf(v0)}function QN(t,e){if(t==="click")return qf(e)}function YN(t,e){if(t==="input"||t==="change")return qf(e)}function JN(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ls=typeof Object.is=="function"?Object.is:JN;function y0(t,e){if(Ls(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Ym.call(e,s)||!Ls(t[s],e[s]))return!1}return!0}function f2(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function d2(t,e){var r=f2(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=f2(r)}}function D4(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?D4(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function j4(){for(var t=window,e=Vh();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Vh(t.document)}return e}function qg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function ZN(t){var e=j4(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&D4(r.ownerDocument.documentElement,r)){if(n!==null&&qg(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!t.extend&&i>n&&(s=n,n=i,i=s),s=d2(r,i);var a=d2(r,n);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var eA=Ci&&"documentMode"in document&&11>=document.documentMode,al=null,gp=null,qc=null,xp=!1;function m2(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;xp||al==null||al!==Vh(n)||(n=al,"selectionStart"in n&&qg(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),qc&&y0(qc,n)||(qc=n,n=Kh(gp,"onSelect"),0<n.length&&(e=new Hg("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=al)))}function Gu(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var ol={animationend:Gu("Animation","AnimationEnd"),animationiteration:Gu("Animation","AnimationIteration"),animationstart:Gu("Animation","AnimationStart"),transitionend:Gu("Transition","TransitionEnd")},am={},O4={};Ci&&(O4=document.createElement("div").style,"AnimationEvent"in window||(delete ol.animationend.animation,delete ol.animationiteration.animation,delete ol.animationstart.animation),"TransitionEvent"in window||delete ol.transitionend.transition);function Xf(t){if(am[t])return am[t];if(!ol[t])return t;var e=ol[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in O4)return am[t]=e[r];return t}var M4=Xf("animationend"),B4=Xf("animationiteration"),V4=Xf("animationstart"),U4=Xf("transitionend"),$4=new Map,p2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ia(t,e){$4.set(t,e),Ao(e,[t])}for(var om=0;om<p2.length;om++){var lm=p2[om],tA=lm.toLowerCase(),rA=lm[0].toUpperCase()+lm.slice(1);Ia(tA,"on"+rA)}Ia(M4,"onAnimationEnd");Ia(B4,"onAnimationIteration");Ia(V4,"onAnimationStart");Ia("dblclick","onDoubleClick");Ia("focusin","onFocus");Ia("focusout","onBlur");Ia(U4,"onTransitionEnd");Rl("onMouseEnter",["mouseout","mouseover"]);Rl("onMouseLeave",["mouseout","mouseover"]);Rl("onPointerEnter",["pointerout","pointerover"]);Rl("onPointerLeave",["pointerout","pointerover"]);Ao("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ao("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ao("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ao("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ao("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ao("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),nA=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fc));function g2(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,tN(n,e,void 0,t),t.currentTarget=null}function W4(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==i&&s.isPropagationStopped())break e;g2(s,o,u),i=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==i&&s.isPropagationStopped())break e;g2(s,o,u),i=l}}}if($h)throw t=fp,$h=!1,fp=null,t}function Vt(t,e){var r=e[Ep];r===void 0&&(r=e[Ep]=new Set);var n=t+"__bubble";r.has(n)||(z4(e,t,2,!1),r.add(n))}function cm(t,e,r){var n=0;e&&(n|=4),z4(r,t,n,e)}var Ku="_reactListening"+Math.random().toString(36).slice(2);function w0(t){if(!t[Ku]){t[Ku]=!0,Y_.forEach(function(r){r!=="selectionchange"&&(nA.has(r)||cm(r,!1,t),cm(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ku]||(e[Ku]=!0,cm("selectionchange",!1,e))}}function z4(t,e,r,n){switch(C4(e)){case 1:var s=xN;break;case 4:s=vN;break;default:s=Wg}r=s.bind(null,e,r,t),s=void 0,!hp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function um(t,e,r,n,s){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;a=a.return}for(;o!==null;){if(a=Qa(o),a===null)return;if(l=a.tag,l===5||l===6){n=i=a;continue e}o=o.parentNode}}n=n.return}d4(function(){var u=i,h=Bg(r),d=[];e:{var m=$4.get(t);if(m!==void 0){var p=Hg,x=t;switch(t){case"keypress":if(Eh(r)===0)break e;case"keydown":case"keyup":p=FN;break;case"focusin":x="focus",p=nm;break;case"focusout":x="blur",p=nm;break;case"beforeblur":case"afterblur":p=nm;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=s2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=_N;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=jN;break;case M4:case B4:case V4:p=TN;break;case U4:p=MN;break;case"scroll":p=yN;break;case"wheel":p=VN;break;case"copy":case"cut":case"paste":p=bN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=a2}var g=(e&4)!==0,y=!g&&t==="scroll",w=g?m!==null?m+"Capture":null:m;g=[];for(var E=u,_;E!==null;){_=E;var N=_.stateNode;if(_.tag===5&&N!==null&&(_=N,w!==null&&(N=m0(E,w),N!=null&&g.push(_0(E,N,_)))),y)break;E=E.return}0<g.length&&(m=new p(m,x,null,r,h),d.push({event:m,listeners:g}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",m&&r!==cp&&(x=r.relatedTarget||r.fromElement)&&(Qa(x)||x[Ni]))break e;if((p||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,p?(x=r.relatedTarget||r.toElement,p=u,x=x?Qa(x):null,x!==null&&(y=Io(x),x!==y||x.tag!==5&&x.tag!==6)&&(x=null)):(p=null,x=u),p!==x)){if(g=s2,N="onMouseLeave",w="onMouseEnter",E="mouse",(t==="pointerout"||t==="pointerover")&&(g=a2,N="onPointerLeave",w="onPointerEnter",E="pointer"),y=p==null?m:ll(p),_=x==null?m:ll(x),m=new g(N,E+"leave",p,r,h),m.target=y,m.relatedTarget=_,N=null,Qa(h)===u&&(g=new g(w,E+"enter",x,r,h),g.target=_,g.relatedTarget=y,N=g),y=N,p&&x)t:{for(g=p,w=x,E=0,_=g;_;_=Xo(_))E++;for(_=0,N=w;N;N=Xo(N))_++;for(;0<E-_;)g=Xo(g),E--;for(;0<_-E;)w=Xo(w),_--;for(;E--;){if(g===w||w!==null&&g===w.alternate)break t;g=Xo(g),w=Xo(w)}g=null}else g=null;p!==null&&x2(d,m,p,g,!1),x!==null&&y!==null&&x2(d,y,x,g,!0)}}e:{if(m=u?ll(u):window,p=m.nodeName&&m.nodeName.toLowerCase(),p==="select"||p==="input"&&m.type==="file")var j=KN;else if(c2(m))if(F4)j=YN;else{j=XN;var D=qN}else(p=m.nodeName)&&p.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(j=QN);if(j&&(j=j(t,u))){P4(d,j,r,h);break e}D&&D(t,m,u),t==="focusout"&&(D=m._wrapperState)&&D.controlled&&m.type==="number"&&sp(m,"number",m.value)}switch(D=u?ll(u):window,t){case"focusin":(c2(D)||D.contentEditable==="true")&&(al=D,gp=u,qc=null);break;case"focusout":qc=gp=al=null;break;case"mousedown":xp=!0;break;case"contextmenu":case"mouseup":case"dragend":xp=!1,m2(d,r,h);break;case"selectionchange":if(eA)break;case"keydown":case"keyup":m2(d,r,h)}var k;if(Kg)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else il?I4(t,r)&&(S="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(A4&&r.locale!=="ko"&&(il||S!=="onCompositionStart"?S==="onCompositionEnd"&&il&&(k=N4()):(ra=h,zg="value"in ra?ra.value:ra.textContent,il=!0)),D=Kh(u,S),0<D.length&&(S=new i2(S,t,null,r,h),d.push({event:S,listeners:D}),k?S.data=k:(k=R4(r),k!==null&&(S.data=k)))),(k=$N?WN(t,r):zN(t,r))&&(u=Kh(u,"onBeforeInput"),0<u.length&&(h=new i2("onBeforeInput","beforeinput",null,r,h),d.push({event:h,listeners:u}),h.data=k))}W4(d,e)})}function _0(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Kh(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=m0(t,r),i!=null&&n.unshift(_0(t,i,s)),i=m0(t,e),i!=null&&n.push(_0(t,i,s))),t=t.return}return n}function Xo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function x2(t,e,r,n,s){for(var i=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,s?(l=m0(r,i),l!=null&&a.unshift(_0(r,l,o))):s||(l=m0(r,i),l!=null&&a.push(_0(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var sA=/\r\n?/g,iA=/\u0000|\uFFFD/g;function v2(t){return(typeof t=="string"?t:""+t).replace(sA,`
`).replace(iA,"")}function qu(t,e,r){if(e=v2(e),v2(t)!==e&&r)throw Error(Ee(425))}function qh(){}var vp=null,yp=null;function wp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var _p=typeof setTimeout=="function"?setTimeout:void 0,aA=typeof clearTimeout=="function"?clearTimeout:void 0,y2=typeof Promise=="function"?Promise:void 0,oA=typeof queueMicrotask=="function"?queueMicrotask:typeof y2<"u"?function(t){return y2.resolve(null).then(t).catch(lA)}:_p;function lA(t){setTimeout(function(){throw t})}function hm(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),x0(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);x0(e)}function ha(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function w2(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Jl=Math.random().toString(36).slice(2),Hs="__reactFiber$"+Jl,E0="__reactProps$"+Jl,Ni="__reactContainer$"+Jl,Ep="__reactEvents$"+Jl,cA="__reactListeners$"+Jl,uA="__reactHandles$"+Jl;function Qa(t){var e=t[Hs];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Ni]||r[Hs]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=w2(t);t!==null;){if(r=t[Hs])return r;t=w2(t)}return e}t=r,r=t.parentNode}return null}function ru(t){return t=t[Hs]||t[Ni],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ll(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Ee(33))}function Qf(t){return t[E0]||null}var kp=[],cl=-1;function Ra(t){return{current:t}}function Wt(t){0>cl||(t.current=kp[cl],kp[cl]=null,cl--)}function Ot(t,e){cl++,kp[cl]=t.current,t.current=e}var _a={},pn=Ra(_a),Fn=Ra(!1),uo=_a;function Pl(t,e){var r=t.type.contextTypes;if(!r)return _a;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=e[i];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Ln(t){return t=t.childContextTypes,t!=null}function Xh(){Wt(Fn),Wt(pn)}function _2(t,e,r){if(pn.current!==_a)throw Error(Ee(168));Ot(pn,e),Ot(Fn,r)}function H4(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(Ee(108,qC(t)||"Unknown",s));return Jt({},r,n)}function Qh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||_a,uo=pn.current,Ot(pn,t),Ot(Fn,Fn.current),!0}function E2(t,e,r){var n=t.stateNode;if(!n)throw Error(Ee(169));r?(t=H4(t,e,uo),n.__reactInternalMemoizedMergedChildContext=t,Wt(Fn),Wt(pn),Ot(pn,t)):Wt(Fn),Ot(Fn,r)}var pi=null,Yf=!1,fm=!1;function G4(t){pi===null?pi=[t]:pi.push(t)}function hA(t){Yf=!0,G4(t)}function Pa(){if(!fm&&pi!==null){fm=!0;var t=0,e=Ft;try{var r=pi;for(Ft=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}pi=null,Yf=!1}catch(s){throw pi!==null&&(pi=pi.slice(t+1)),x4(Vg,Pa),s}finally{Ft=e,fm=!1}}return null}var ul=[],hl=0,Yh=null,Jh=0,is=[],as=0,ho=null,gi=1,xi="";function Ha(t,e){ul[hl++]=Jh,ul[hl++]=Yh,Yh=t,Jh=e}function K4(t,e,r){is[as++]=gi,is[as++]=xi,is[as++]=ho,ho=t;var n=gi;t=xi;var s=32-As(n)-1;n&=~(1<<s),r+=1;var i=32-As(e)+s;if(30<i){var a=s-s%5;i=(n&(1<<a)-1).toString(32),n>>=a,s-=a,gi=1<<32-As(e)+s|r<<s|n,xi=i+t}else gi=1<<i|r<<s|n,xi=t}function Xg(t){t.return!==null&&(Ha(t,1),K4(t,1,0))}function Qg(t){for(;t===Yh;)Yh=ul[--hl],ul[hl]=null,Jh=ul[--hl],ul[hl]=null;for(;t===ho;)ho=is[--as],is[as]=null,xi=is[--as],is[as]=null,gi=is[--as],is[as]=null}var Gn=null,zn=null,Kt=!1,Ss=null;function q4(t,e){var r=os(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function k2(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Gn=t,zn=ha(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Gn=t,zn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=ho!==null?{id:gi,overflow:xi}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=os(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Gn=t,zn=null,!0):!1;default:return!1}}function Tp(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Sp(t){if(Kt){var e=zn;if(e){var r=e;if(!k2(t,e)){if(Tp(t))throw Error(Ee(418));e=ha(r.nextSibling);var n=Gn;e&&k2(t,e)?q4(n,r):(t.flags=t.flags&-4097|2,Kt=!1,Gn=t)}}else{if(Tp(t))throw Error(Ee(418));t.flags=t.flags&-4097|2,Kt=!1,Gn=t}}}function T2(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Gn=t}function Xu(t){if(t!==Gn)return!1;if(!Kt)return T2(t),Kt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!wp(t.type,t.memoizedProps)),e&&(e=zn)){if(Tp(t))throw X4(),Error(Ee(418));for(;e;)q4(t,e),e=ha(e.nextSibling)}if(T2(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Ee(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){zn=ha(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}zn=null}}else zn=Gn?ha(t.stateNode.nextSibling):null;return!0}function X4(){for(var t=zn;t;)t=ha(t.nextSibling)}function Fl(){zn=Gn=null,Kt=!1}function Yg(t){Ss===null?Ss=[t]:Ss.push(t)}var fA=ji.ReactCurrentBatchConfig;function Tc(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ee(309));var n=r.stateNode}if(!n)throw Error(Ee(147,t));var s=n,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var o=s.refs;a===null?delete o[i]:o[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(Ee(284));if(!r._owner)throw Error(Ee(290,t))}return t}function Qu(t,e){throw t=Object.prototype.toString.call(e),Error(Ee(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function S2(t){var e=t._init;return e(t._payload)}function Q4(t){function e(w,E){if(t){var _=w.deletions;_===null?(w.deletions=[E],w.flags|=16):_.push(E)}}function r(w,E){if(!t)return null;for(;E!==null;)e(w,E),E=E.sibling;return null}function n(w,E){for(w=new Map;E!==null;)E.key!==null?w.set(E.key,E):w.set(E.index,E),E=E.sibling;return w}function s(w,E){return w=pa(w,E),w.index=0,w.sibling=null,w}function i(w,E,_){return w.index=_,t?(_=w.alternate,_!==null?(_=_.index,_<E?(w.flags|=2,E):_):(w.flags|=2,E)):(w.flags|=1048576,E)}function a(w){return t&&w.alternate===null&&(w.flags|=2),w}function o(w,E,_,N){return E===null||E.tag!==6?(E=ym(_,w.mode,N),E.return=w,E):(E=s(E,_),E.return=w,E)}function l(w,E,_,N){var j=_.type;return j===sl?h(w,E,_.props.children,N,_.key):E!==null&&(E.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===qi&&S2(j)===E.type)?(N=s(E,_.props),N.ref=Tc(w,E,_),N.return=w,N):(N=Ah(_.type,_.key,_.props,null,w.mode,N),N.ref=Tc(w,E,_),N.return=w,N)}function u(w,E,_,N){return E===null||E.tag!==4||E.stateNode.containerInfo!==_.containerInfo||E.stateNode.implementation!==_.implementation?(E=wm(_,w.mode,N),E.return=w,E):(E=s(E,_.children||[]),E.return=w,E)}function h(w,E,_,N,j){return E===null||E.tag!==7?(E=no(_,w.mode,N,j),E.return=w,E):(E=s(E,_),E.return=w,E)}function d(w,E,_){if(typeof E=="string"&&E!==""||typeof E=="number")return E=ym(""+E,w.mode,_),E.return=w,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Bu:return _=Ah(E.type,E.key,E.props,null,w.mode,_),_.ref=Tc(w,null,E),_.return=w,_;case nl:return E=wm(E,w.mode,_),E.return=w,E;case qi:var N=E._init;return d(w,N(E._payload),_)}if(Rc(E)||yc(E))return E=no(E,w.mode,_,null),E.return=w,E;Qu(w,E)}return null}function m(w,E,_,N){var j=E!==null?E.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return j!==null?null:o(w,E,""+_,N);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Bu:return _.key===j?l(w,E,_,N):null;case nl:return _.key===j?u(w,E,_,N):null;case qi:return j=_._init,m(w,E,j(_._payload),N)}if(Rc(_)||yc(_))return j!==null?null:h(w,E,_,N,null);Qu(w,_)}return null}function p(w,E,_,N,j){if(typeof N=="string"&&N!==""||typeof N=="number")return w=w.get(_)||null,o(E,w,""+N,j);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Bu:return w=w.get(N.key===null?_:N.key)||null,l(E,w,N,j);case nl:return w=w.get(N.key===null?_:N.key)||null,u(E,w,N,j);case qi:var D=N._init;return p(w,E,_,D(N._payload),j)}if(Rc(N)||yc(N))return w=w.get(_)||null,h(E,w,N,j,null);Qu(E,N)}return null}function x(w,E,_,N){for(var j=null,D=null,k=E,S=E=0,b=null;k!==null&&S<_.length;S++){k.index>S?(b=k,k=null):b=k.sibling;var C=m(w,k,_[S],N);if(C===null){k===null&&(k=b);break}t&&k&&C.alternate===null&&e(w,k),E=i(C,E,S),D===null?j=C:D.sibling=C,D=C,k=b}if(S===_.length)return r(w,k),Kt&&Ha(w,S),j;if(k===null){for(;S<_.length;S++)k=d(w,_[S],N),k!==null&&(E=i(k,E,S),D===null?j=k:D.sibling=k,D=k);return Kt&&Ha(w,S),j}for(k=n(w,k);S<_.length;S++)b=p(k,w,S,_[S],N),b!==null&&(t&&b.alternate!==null&&k.delete(b.key===null?S:b.key),E=i(b,E,S),D===null?j=b:D.sibling=b,D=b);return t&&k.forEach(function(A){return e(w,A)}),Kt&&Ha(w,S),j}function g(w,E,_,N){var j=yc(_);if(typeof j!="function")throw Error(Ee(150));if(_=j.call(_),_==null)throw Error(Ee(151));for(var D=j=null,k=E,S=E=0,b=null,C=_.next();k!==null&&!C.done;S++,C=_.next()){k.index>S?(b=k,k=null):b=k.sibling;var A=m(w,k,C.value,N);if(A===null){k===null&&(k=b);break}t&&k&&A.alternate===null&&e(w,k),E=i(A,E,S),D===null?j=A:D.sibling=A,D=A,k=b}if(C.done)return r(w,k),Kt&&Ha(w,S),j;if(k===null){for(;!C.done;S++,C=_.next())C=d(w,C.value,N),C!==null&&(E=i(C,E,S),D===null?j=C:D.sibling=C,D=C);return Kt&&Ha(w,S),j}for(k=n(w,k);!C.done;S++,C=_.next())C=p(k,w,S,C.value,N),C!==null&&(t&&C.alternate!==null&&k.delete(C.key===null?S:C.key),E=i(C,E,S),D===null?j=C:D.sibling=C,D=C);return t&&k.forEach(function(I){return e(w,I)}),Kt&&Ha(w,S),j}function y(w,E,_,N){if(typeof _=="object"&&_!==null&&_.type===sl&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case Bu:e:{for(var j=_.key,D=E;D!==null;){if(D.key===j){if(j=_.type,j===sl){if(D.tag===7){r(w,D.sibling),E=s(D,_.props.children),E.return=w,w=E;break e}}else if(D.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===qi&&S2(j)===D.type){r(w,D.sibling),E=s(D,_.props),E.ref=Tc(w,D,_),E.return=w,w=E;break e}r(w,D);break}else e(w,D);D=D.sibling}_.type===sl?(E=no(_.props.children,w.mode,N,_.key),E.return=w,w=E):(N=Ah(_.type,_.key,_.props,null,w.mode,N),N.ref=Tc(w,E,_),N.return=w,w=N)}return a(w);case nl:e:{for(D=_.key;E!==null;){if(E.key===D)if(E.tag===4&&E.stateNode.containerInfo===_.containerInfo&&E.stateNode.implementation===_.implementation){r(w,E.sibling),E=s(E,_.children||[]),E.return=w,w=E;break e}else{r(w,E);break}else e(w,E);E=E.sibling}E=wm(_,w.mode,N),E.return=w,w=E}return a(w);case qi:return D=_._init,y(w,E,D(_._payload),N)}if(Rc(_))return x(w,E,_,N);if(yc(_))return g(w,E,_,N);Qu(w,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,E!==null&&E.tag===6?(r(w,E.sibling),E=s(E,_),E.return=w,w=E):(r(w,E),E=ym(_,w.mode,N),E.return=w,w=E),a(w)):r(w,E)}return y}var Ll=Q4(!0),Y4=Q4(!1),Zh=Ra(null),ef=null,fl=null,Jg=null;function Zg(){Jg=fl=ef=null}function e1(t){var e=Zh.current;Wt(Zh),t._currentValue=e}function bp(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function _l(t,e){ef=t,Jg=fl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Pn=!0),t.firstContext=null)}function fs(t){var e=t._currentValue;if(Jg!==t)if(t={context:t,memoizedValue:e,next:null},fl===null){if(ef===null)throw Error(Ee(308));fl=t,ef.dependencies={lanes:0,firstContext:t}}else fl=fl.next=t;return e}var Ya=null;function t1(t){Ya===null?Ya=[t]:Ya.push(t)}function J4(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,t1(e)):(r.next=s.next,s.next=r),e.interleaved=r,Ai(t,n)}function Ai(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Xi=!1;function r1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Z4(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ei(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function fa(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,mt&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,Ai(t,r)}return s=n.interleaved,s===null?(e.next=e,t1(n)):(e.next=s.next,s.next=e),n.interleaved=e,Ai(t,r)}function kh(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Ug(t,r)}}function b2(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=a:i=i.next=a,r=r.next}while(r!==null);i===null?s=i=e:i=i.next=e}else s=i=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function tf(t,e,r,n){var s=t.updateQueue;Xi=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?i=u:a.next=u,a=l;var h=t.alternate;h!==null&&(h=h.updateQueue,o=h.lastBaseUpdate,o!==a&&(o===null?h.firstBaseUpdate=u:o.next=u,h.lastBaseUpdate=l))}if(i!==null){var d=s.baseState;a=0,h=u=l=null,o=i;do{var m=o.lane,p=o.eventTime;if((n&m)===m){h!==null&&(h=h.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=t,g=o;switch(m=e,p=r,g.tag){case 1:if(x=g.payload,typeof x=="function"){d=x.call(p,d,m);break e}d=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=g.payload,m=typeof x=="function"?x.call(p,d,m):x,m==null)break e;d=Jt({},d,m);break e;case 2:Xi=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[o]:m.push(o))}else p={eventTime:p,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},h===null?(u=h=p,l=d):h=h.next=p,a|=m;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;m=o,o=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(1);if(h===null&&(l=d),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);mo|=a,t.lanes=a,t.memoizedState=d}}function C2(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(Ee(191,s));s.call(n)}}}var nu={},Xs=Ra(nu),k0=Ra(nu),T0=Ra(nu);function Ja(t){if(t===nu)throw Error(Ee(174));return t}function n1(t,e){switch(Ot(T0,e),Ot(k0,t),Ot(Xs,nu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ap(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=ap(e,t)}Wt(Xs),Ot(Xs,e)}function Dl(){Wt(Xs),Wt(k0),Wt(T0)}function eE(t){Ja(T0.current);var e=Ja(Xs.current),r=ap(e,t.type);e!==r&&(Ot(k0,t),Ot(Xs,r))}function s1(t){k0.current===t&&(Wt(Xs),Wt(k0))}var qt=Ra(0);function rf(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var dm=[];function i1(){for(var t=0;t<dm.length;t++)dm[t]._workInProgressVersionPrimary=null;dm.length=0}var Th=ji.ReactCurrentDispatcher,mm=ji.ReactCurrentBatchConfig,fo=0,Yt=null,Sr=null,Fr=null,nf=!1,Xc=!1,S0=0,dA=0;function rn(){throw Error(Ee(321))}function a1(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Ls(t[r],e[r]))return!1;return!0}function o1(t,e,r,n,s,i){if(fo=i,Yt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Th.current=t===null||t.memoizedState===null?xA:vA,t=r(n,s),Xc){i=0;do{if(Xc=!1,S0=0,25<=i)throw Error(Ee(301));i+=1,Fr=Sr=null,e.updateQueue=null,Th.current=yA,t=r(n,s)}while(Xc)}if(Th.current=sf,e=Sr!==null&&Sr.next!==null,fo=0,Fr=Sr=Yt=null,nf=!1,e)throw Error(Ee(300));return t}function l1(){var t=S0!==0;return S0=0,t}function zs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Fr===null?Yt.memoizedState=Fr=t:Fr=Fr.next=t,Fr}function ds(){if(Sr===null){var t=Yt.alternate;t=t!==null?t.memoizedState:null}else t=Sr.next;var e=Fr===null?Yt.memoizedState:Fr.next;if(e!==null)Fr=e,Sr=t;else{if(t===null)throw Error(Ee(310));Sr=t,t={memoizedState:Sr.memoizedState,baseState:Sr.baseState,baseQueue:Sr.baseQueue,queue:Sr.queue,next:null},Fr===null?Yt.memoizedState=Fr=t:Fr=Fr.next=t}return Fr}function b0(t,e){return typeof e=="function"?e(t):e}function pm(t){var e=ds(),r=e.queue;if(r===null)throw Error(Ee(311));r.lastRenderedReducer=t;var n=Sr,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var o=a=null,l=null,u=i;do{var h=u.lane;if((fo&h)===h)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=d,a=n):l=l.next=d,Yt.lanes|=h,mo|=h}u=u.next}while(u!==null&&u!==i);l===null?a=n:l.next=o,Ls(n,e.memoizedState)||(Pn=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do i=s.lane,Yt.lanes|=i,mo|=i,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function gm(t){var e=ds(),r=e.queue;if(r===null)throw Error(Ee(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,i=e.memoizedState;if(s!==null){r.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);Ls(i,e.memoizedState)||(Pn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,n]}function tE(){}function rE(t,e){var r=Yt,n=ds(),s=e(),i=!Ls(n.memoizedState,s);if(i&&(n.memoizedState=s,Pn=!0),n=n.queue,c1(iE.bind(null,r,n,t),[t]),n.getSnapshot!==e||i||Fr!==null&&Fr.memoizedState.tag&1){if(r.flags|=2048,C0(9,sE.bind(null,r,n,s,e),void 0,null),jr===null)throw Error(Ee(349));fo&30||nE(r,e,s)}return s}function nE(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Yt.updateQueue,e===null?(e={lastEffect:null,stores:null},Yt.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function sE(t,e,r,n){e.value=r,e.getSnapshot=n,aE(e)&&oE(t)}function iE(t,e,r){return r(function(){aE(e)&&oE(t)})}function aE(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Ls(t,r)}catch{return!0}}function oE(t){var e=Ai(t,1);e!==null&&Is(e,t,1,-1)}function N2(t){var e=zs();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:b0,lastRenderedState:t},e.queue=t,t=t.dispatch=gA.bind(null,Yt,t),[e.memoizedState,t]}function C0(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Yt.updateQueue,e===null?(e={lastEffect:null,stores:null},Yt.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function lE(){return ds().memoizedState}function Sh(t,e,r,n){var s=zs();Yt.flags|=t,s.memoizedState=C0(1|e,r,void 0,n===void 0?null:n)}function Jf(t,e,r,n){var s=ds();n=n===void 0?null:n;var i=void 0;if(Sr!==null){var a=Sr.memoizedState;if(i=a.destroy,n!==null&&a1(n,a.deps)){s.memoizedState=C0(e,r,i,n);return}}Yt.flags|=t,s.memoizedState=C0(1|e,r,i,n)}function A2(t,e){return Sh(8390656,8,t,e)}function c1(t,e){return Jf(2048,8,t,e)}function cE(t,e){return Jf(4,2,t,e)}function uE(t,e){return Jf(4,4,t,e)}function hE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function fE(t,e,r){return r=r!=null?r.concat([t]):null,Jf(4,4,hE.bind(null,e,t),r)}function u1(){}function dE(t,e){var r=ds();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&a1(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function mE(t,e){var r=ds();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&a1(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function pE(t,e,r){return fo&21?(Ls(r,e)||(r=w4(),Yt.lanes|=r,mo|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Pn=!0),t.memoizedState=r)}function mA(t,e){var r=Ft;Ft=r!==0&&4>r?r:4,t(!0);var n=mm.transition;mm.transition={};try{t(!1),e()}finally{Ft=r,mm.transition=n}}function gE(){return ds().memoizedState}function pA(t,e,r){var n=ma(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},xE(t))vE(e,r);else if(r=J4(t,e,r,n),r!==null){var s=kn();Is(r,t,n,s),yE(r,e,n)}}function gA(t,e,r){var n=ma(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(xE(t))vE(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,o=i(a,r);if(s.hasEagerState=!0,s.eagerState=o,Ls(o,a)){var l=e.interleaved;l===null?(s.next=s,t1(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}r=J4(t,e,s,n),r!==null&&(s=kn(),Is(r,t,n,s),yE(r,e,n))}}function xE(t){var e=t.alternate;return t===Yt||e!==null&&e===Yt}function vE(t,e){Xc=nf=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function yE(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Ug(t,r)}}var sf={readContext:fs,useCallback:rn,useContext:rn,useEffect:rn,useImperativeHandle:rn,useInsertionEffect:rn,useLayoutEffect:rn,useMemo:rn,useReducer:rn,useRef:rn,useState:rn,useDebugValue:rn,useDeferredValue:rn,useTransition:rn,useMutableSource:rn,useSyncExternalStore:rn,useId:rn,unstable_isNewReconciler:!1},xA={readContext:fs,useCallback:function(t,e){return zs().memoizedState=[t,e===void 0?null:e],t},useContext:fs,useEffect:A2,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Sh(4194308,4,hE.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Sh(4194308,4,t,e)},useInsertionEffect:function(t,e){return Sh(4,2,t,e)},useMemo:function(t,e){var r=zs();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=zs();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=pA.bind(null,Yt,t),[n.memoizedState,t]},useRef:function(t){var e=zs();return t={current:t},e.memoizedState=t},useState:N2,useDebugValue:u1,useDeferredValue:function(t){return zs().memoizedState=t},useTransition:function(){var t=N2(!1),e=t[0];return t=mA.bind(null,t[1]),zs().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Yt,s=zs();if(Kt){if(r===void 0)throw Error(Ee(407));r=r()}else{if(r=e(),jr===null)throw Error(Ee(349));fo&30||nE(n,e,r)}s.memoizedState=r;var i={value:r,getSnapshot:e};return s.queue=i,A2(iE.bind(null,n,i,t),[t]),n.flags|=2048,C0(9,sE.bind(null,n,i,r,e),void 0,null),r},useId:function(){var t=zs(),e=jr.identifierPrefix;if(Kt){var r=xi,n=gi;r=(n&~(1<<32-As(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=S0++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=dA++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},vA={readContext:fs,useCallback:dE,useContext:fs,useEffect:c1,useImperativeHandle:fE,useInsertionEffect:cE,useLayoutEffect:uE,useMemo:mE,useReducer:pm,useRef:lE,useState:function(){return pm(b0)},useDebugValue:u1,useDeferredValue:function(t){var e=ds();return pE(e,Sr.memoizedState,t)},useTransition:function(){var t=pm(b0)[0],e=ds().memoizedState;return[t,e]},useMutableSource:tE,useSyncExternalStore:rE,useId:gE,unstable_isNewReconciler:!1},yA={readContext:fs,useCallback:dE,useContext:fs,useEffect:c1,useImperativeHandle:fE,useInsertionEffect:cE,useLayoutEffect:uE,useMemo:mE,useReducer:gm,useRef:lE,useState:function(){return gm(b0)},useDebugValue:u1,useDeferredValue:function(t){var e=ds();return Sr===null?e.memoizedState=t:pE(e,Sr.memoizedState,t)},useTransition:function(){var t=gm(b0)[0],e=ds().memoizedState;return[t,e]},useMutableSource:tE,useSyncExternalStore:rE,useId:gE,unstable_isNewReconciler:!1};function ks(t,e){if(t&&t.defaultProps){e=Jt({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Cp(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Jt({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Zf={isMounted:function(t){return(t=t._reactInternals)?Io(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=kn(),s=ma(t),i=Ei(n,s);i.payload=e,r!=null&&(i.callback=r),e=fa(t,i,s),e!==null&&(Is(e,t,s,n),kh(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=kn(),s=ma(t),i=Ei(n,s);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=fa(t,i,s),e!==null&&(Is(e,t,s,n),kh(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=kn(),n=ma(t),s=Ei(r,n);s.tag=2,e!=null&&(s.callback=e),e=fa(t,s,n),e!==null&&(Is(e,t,n,r),kh(e,t,n))}};function I2(t,e,r,n,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,i,a):e.prototype&&e.prototype.isPureReactComponent?!y0(r,n)||!y0(s,i):!0}function wE(t,e,r){var n=!1,s=_a,i=e.contextType;return typeof i=="object"&&i!==null?i=fs(i):(s=Ln(e)?uo:pn.current,n=e.contextTypes,i=(n=n!=null)?Pl(t,s):_a),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Zf,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function R2(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Zf.enqueueReplaceState(e,e.state,null)}function Np(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},r1(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=fs(i):(i=Ln(e)?uo:pn.current,s.context=Pl(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Cp(t,e,i,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Zf.enqueueReplaceState(s,s.state,null),tf(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function jl(t,e){try{var r="",n=e;do r+=KC(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function xm(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Ap(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var wA=typeof WeakMap=="function"?WeakMap:Map;function _E(t,e,r){r=Ei(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){of||(of=!0,Bp=n),Ap(t,e)},r}function EE(t,e,r){r=Ei(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){Ap(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Ap(t,e),typeof n!="function"&&(da===null?da=new Set([this]):da.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function P2(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new wA;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=LA.bind(null,t,e,r),e.then(t,t))}function F2(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function L2(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Ei(-1,1),e.tag=2,fa(r,e,1))),r.lanes|=1),t)}var _A=ji.ReactCurrentOwner,Pn=!1;function wn(t,e,r,n){e.child=t===null?Y4(e,null,r,n):Ll(e,t.child,r,n)}function D2(t,e,r,n,s){r=r.render;var i=e.ref;return _l(e,s),n=o1(t,e,r,n,i,s),r=l1(),t!==null&&!Pn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ii(t,e,s)):(Kt&&r&&Xg(e),e.flags|=1,wn(t,e,n,s),e.child)}function j2(t,e,r,n,s){if(t===null){var i=r.type;return typeof i=="function"&&!v1(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,kE(t,e,i,n,s)):(t=Ah(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(r=r.compare,r=r!==null?r:y0,r(a,n)&&t.ref===e.ref)return Ii(t,e,s)}return e.flags|=1,t=pa(i,n),t.ref=e.ref,t.return=e,e.child=t}function kE(t,e,r,n,s){if(t!==null){var i=t.memoizedProps;if(y0(i,n)&&t.ref===e.ref)if(Pn=!1,e.pendingProps=n=i,(t.lanes&s)!==0)t.flags&131072&&(Pn=!0);else return e.lanes=t.lanes,Ii(t,e,s)}return Ip(t,e,r,n,s)}function TE(t,e,r){var n=e.pendingProps,s=n.children,i=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ot(ml,Bn),Bn|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ot(ml,Bn),Bn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Ot(ml,Bn),Bn|=n}else i!==null?(n=i.baseLanes|r,e.memoizedState=null):n=r,Ot(ml,Bn),Bn|=n;return wn(t,e,s,r),e.child}function SE(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Ip(t,e,r,n,s){var i=Ln(r)?uo:pn.current;return i=Pl(e,i),_l(e,s),r=o1(t,e,r,n,i,s),n=l1(),t!==null&&!Pn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ii(t,e,s)):(Kt&&n&&Xg(e),e.flags|=1,wn(t,e,r,s),e.child)}function O2(t,e,r,n,s){if(Ln(r)){var i=!0;Qh(e)}else i=!1;if(_l(e,s),e.stateNode===null)bh(t,e),wE(e,r,n),Np(e,r,n,s),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=r.contextType;typeof u=="object"&&u!==null?u=fs(u):(u=Ln(r)?uo:pn.current,u=Pl(e,u));var h=r.getDerivedStateFromProps,d=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==u)&&R2(e,a,n,u),Xi=!1;var m=e.memoizedState;a.state=m,tf(e,n,a,s),l=e.memoizedState,o!==n||m!==l||Fn.current||Xi?(typeof h=="function"&&(Cp(e,r,h,n),l=e.memoizedState),(o=Xi||I2(e,r,o,n,m,l,u))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=u,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,Z4(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:ks(e.type,o),a.props=u,d=e.pendingProps,m=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=fs(l):(l=Ln(r)?uo:pn.current,l=Pl(e,l));var p=r.getDerivedStateFromProps;(h=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==d||m!==l)&&R2(e,a,n,l),Xi=!1,m=e.memoizedState,a.state=m,tf(e,n,a,s);var x=e.memoizedState;o!==d||m!==x||Fn.current||Xi?(typeof p=="function"&&(Cp(e,r,p,n),x=e.memoizedState),(u=Xi||I2(e,r,u,n,m,x,l)||!1)?(h||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,x,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,x,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=x),a.props=n,a.state=x,a.context=l,n=u):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),n=!1)}return Rp(t,e,r,n,i,s)}function Rp(t,e,r,n,s,i){SE(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return s&&E2(e,r,!1),Ii(t,e,i);n=e.stateNode,_A.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=Ll(e,t.child,null,i),e.child=Ll(e,null,o,i)):wn(t,e,o,i),e.memoizedState=n.state,s&&E2(e,r,!0),e.child}function bE(t){var e=t.stateNode;e.pendingContext?_2(t,e.pendingContext,e.pendingContext!==e.context):e.context&&_2(t,e.context,!1),n1(t,e.containerInfo)}function M2(t,e,r,n,s){return Fl(),Yg(s),e.flags|=256,wn(t,e,r,n),e.child}var Pp={dehydrated:null,treeContext:null,retryLane:0};function Fp(t){return{baseLanes:t,cachePool:null,transitions:null}}function CE(t,e,r){var n=e.pendingProps,s=qt.current,i=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(s&2)!==0),o?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ot(qt,s&1),t===null)return Sp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,i?(n=e.mode,i=e.child,a={mode:"hidden",children:a},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=rd(a,n,0,null),t=no(t,n,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Fp(r),e.memoizedState=Pp,t):h1(e,a));if(s=t.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return EA(t,e,a,n,o,s,r);if(i){i=n.fallback,a=e.mode,s=t.child,o=s.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=pa(s,l),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?i=pa(o,i):(i=no(i,a,r,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,a=t.child.memoizedState,a=a===null?Fp(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~r,e.memoizedState=Pp,n}return i=t.child,t=i.sibling,n=pa(i,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function h1(t,e){return e=rd({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Yu(t,e,r,n){return n!==null&&Yg(n),Ll(e,t.child,null,r),t=h1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function EA(t,e,r,n,s,i,a){if(r)return e.flags&256?(e.flags&=-257,n=xm(Error(Ee(422))),Yu(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=n.fallback,s=e.mode,n=rd({mode:"visible",children:n.children},s,0,null),i=no(i,s,a,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&Ll(e,t.child,null,a),e.child.memoizedState=Fp(a),e.memoizedState=Pp,i);if(!(e.mode&1))return Yu(t,e,a,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(Ee(419)),n=xm(i,n,void 0),Yu(t,e,a,n)}if(o=(a&t.childLanes)!==0,Pn||o){if(n=jr,n!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Ai(t,s),Is(n,t,s,-1))}return x1(),n=xm(Error(Ee(421))),Yu(t,e,a,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=DA.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,zn=ha(s.nextSibling),Gn=e,Kt=!0,Ss=null,t!==null&&(is[as++]=gi,is[as++]=xi,is[as++]=ho,gi=t.id,xi=t.overflow,ho=e),e=h1(e,n.children),e.flags|=4096,e)}function B2(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),bp(t.return,e,r)}function vm(t,e,r,n,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function NE(t,e,r){var n=e.pendingProps,s=n.revealOrder,i=n.tail;if(wn(t,e,n.children,r),n=qt.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&B2(t,r,e);else if(t.tag===19)B2(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Ot(qt,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&rf(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),vm(e,!1,s,r,i);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&rf(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}vm(e,!0,r,null,i);break;case"together":vm(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function bh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ii(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),mo|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Ee(153));if(e.child!==null){for(t=e.child,r=pa(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=pa(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function kA(t,e,r){switch(e.tag){case 3:bE(e),Fl();break;case 5:eE(e);break;case 1:Ln(e.type)&&Qh(e);break;case 4:n1(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;Ot(Zh,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Ot(qt,qt.current&1),e.flags|=128,null):r&e.child.childLanes?CE(t,e,r):(Ot(qt,qt.current&1),t=Ii(t,e,r),t!==null?t.sibling:null);Ot(qt,qt.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return NE(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ot(qt,qt.current),n)break;return null;case 22:case 23:return e.lanes=0,TE(t,e,r)}return Ii(t,e,r)}var AE,Lp,IE,RE;AE=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Lp=function(){};IE=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,Ja(Xs.current);var i=null;switch(r){case"input":s=rp(t,s),n=rp(t,n),i=[];break;case"select":s=Jt({},s,{value:void 0}),n=Jt({},n,{value:void 0}),i=[];break;case"textarea":s=ip(t,s),n=ip(t,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=qh)}op(r,n);var a;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var o=s[u];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(f0.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var l=n[u];if(o=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(i||(i=[]),i.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(f0.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Vt("scroll",t),i||o===l||(i=[])):(i=i||[]).push(u,l))}r&&(i=i||[]).push("style",r);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};RE=function(t,e,r,n){r!==n&&(e.flags|=4)};function Sc(t,e){if(!Kt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function nn(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function TA(t,e,r){var n=e.pendingProps;switch(Qg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nn(e),null;case 1:return Ln(e.type)&&Xh(),nn(e),null;case 3:return n=e.stateNode,Dl(),Wt(Fn),Wt(pn),i1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Xu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ss!==null&&($p(Ss),Ss=null))),Lp(t,e),nn(e),null;case 5:s1(e);var s=Ja(T0.current);if(r=e.type,t!==null&&e.stateNode!=null)IE(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Ee(166));return nn(e),null}if(t=Ja(Xs.current),Xu(e)){n=e.stateNode,r=e.type;var i=e.memoizedProps;switch(n[Hs]=e,n[E0]=i,t=(e.mode&1)!==0,r){case"dialog":Vt("cancel",n),Vt("close",n);break;case"iframe":case"object":case"embed":Vt("load",n);break;case"video":case"audio":for(s=0;s<Fc.length;s++)Vt(Fc[s],n);break;case"source":Vt("error",n);break;case"img":case"image":case"link":Vt("error",n),Vt("load",n);break;case"details":Vt("toggle",n);break;case"input":qv(n,i),Vt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Vt("invalid",n);break;case"textarea":Qv(n,i),Vt("invalid",n)}op(r,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var o=i[a];a==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&qu(n.textContent,o,t),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&qu(n.textContent,o,t),s=["children",""+o]):f0.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Vt("scroll",n)}switch(r){case"input":Vu(n),Xv(n,i,!0);break;case"textarea":Vu(n),Yv(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=qh)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=i4(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[Hs]=e,t[E0]=n,AE(t,e,!1,!1),e.stateNode=t;e:{switch(a=lp(r,n),r){case"dialog":Vt("cancel",t),Vt("close",t),s=n;break;case"iframe":case"object":case"embed":Vt("load",t),s=n;break;case"video":case"audio":for(s=0;s<Fc.length;s++)Vt(Fc[s],t);s=n;break;case"source":Vt("error",t),s=n;break;case"img":case"image":case"link":Vt("error",t),Vt("load",t),s=n;break;case"details":Vt("toggle",t),s=n;break;case"input":qv(t,n),s=rp(t,n),Vt("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=Jt({},n,{value:void 0}),Vt("invalid",t);break;case"textarea":Qv(t,n),s=ip(t,n),Vt("invalid",t);break;default:s=n}op(r,s),o=s;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?l4(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&a4(t,l)):i==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&d0(t,l):typeof l=="number"&&d0(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(f0.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Vt("scroll",t):l!=null&&Dg(t,i,l,a))}switch(r){case"input":Vu(t),Xv(t,n,!1);break;case"textarea":Vu(t),Yv(t);break;case"option":n.value!=null&&t.setAttribute("value",""+wa(n.value));break;case"select":t.multiple=!!n.multiple,i=n.value,i!=null?xl(t,!!n.multiple,i,!1):n.defaultValue!=null&&xl(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=qh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return nn(e),null;case 6:if(t&&e.stateNode!=null)RE(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Ee(166));if(r=Ja(T0.current),Ja(Xs.current),Xu(e)){if(n=e.stateNode,r=e.memoizedProps,n[Hs]=e,(i=n.nodeValue!==r)&&(t=Gn,t!==null))switch(t.tag){case 3:qu(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&qu(n.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Hs]=e,e.stateNode=n}return nn(e),null;case 13:if(Wt(qt),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Kt&&zn!==null&&e.mode&1&&!(e.flags&128))X4(),Fl(),e.flags|=98560,i=!1;else if(i=Xu(e),n!==null&&n.dehydrated!==null){if(t===null){if(!i)throw Error(Ee(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Ee(317));i[Hs]=e}else Fl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;nn(e),i=!1}else Ss!==null&&($p(Ss),Ss=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||qt.current&1?Cr===0&&(Cr=3):x1())),e.updateQueue!==null&&(e.flags|=4),nn(e),null);case 4:return Dl(),Lp(t,e),t===null&&w0(e.stateNode.containerInfo),nn(e),null;case 10:return e1(e.type._context),nn(e),null;case 17:return Ln(e.type)&&Xh(),nn(e),null;case 19:if(Wt(qt),i=e.memoizedState,i===null)return nn(e),null;if(n=(e.flags&128)!==0,a=i.rendering,a===null)if(n)Sc(i,!1);else{if(Cr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=rf(t),a!==null){for(e.flags|=128,Sc(i,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)i=r,t=n,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Ot(qt,qt.current&1|2),e.child}t=t.sibling}i.tail!==null&&cr()>Ol&&(e.flags|=128,n=!0,Sc(i,!1),e.lanes=4194304)}else{if(!n)if(t=rf(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Sc(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Kt)return nn(e),null}else 2*cr()-i.renderingStartTime>Ol&&r!==1073741824&&(e.flags|=128,n=!0,Sc(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(r=i.last,r!==null?r.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=cr(),e.sibling=null,r=qt.current,Ot(qt,n?r&1|2:r&1),e):(nn(e),null);case 22:case 23:return g1(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Bn&1073741824&&(nn(e),e.subtreeFlags&6&&(e.flags|=8192)):nn(e),null;case 24:return null;case 25:return null}throw Error(Ee(156,e.tag))}function SA(t,e){switch(Qg(e),e.tag){case 1:return Ln(e.type)&&Xh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Dl(),Wt(Fn),Wt(pn),i1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return s1(e),null;case 13:if(Wt(qt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Ee(340));Fl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Wt(qt),null;case 4:return Dl(),null;case 10:return e1(e.type._context),null;case 22:case 23:return g1(),null;case 24:return null;default:return null}}var Ju=!1,un=!1,bA=typeof WeakSet=="function"?WeakSet:Set,Le=null;function dl(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){rr(t,e,n)}else r.current=null}function Dp(t,e,r){try{r()}catch(n){rr(t,e,n)}}var V2=!1;function CA(t,e){if(vp=Hh,t=j4(),qg(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,u=0,h=0,d=t,m=null;t:for(;;){for(var p;d!==r||s!==0&&d.nodeType!==3||(o=a+s),d!==i||n!==0&&d.nodeType!==3||(l=a+n),d.nodeType===3&&(a+=d.nodeValue.length),(p=d.firstChild)!==null;)m=d,d=p;for(;;){if(d===t)break t;if(m===r&&++u===s&&(o=a),m===i&&++h===n&&(l=a),(p=d.nextSibling)!==null)break;d=m,m=d.parentNode}d=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(yp={focusedElem:t,selectionRange:r},Hh=!1,Le=e;Le!==null;)if(e=Le,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Le=t;else for(;Le!==null;){e=Le;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var g=x.memoizedProps,y=x.memoizedState,w=e.stateNode,E=w.getSnapshotBeforeUpdate(e.elementType===e.type?g:ks(e.type,g),y);w.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ee(163))}}catch(N){rr(e,e.return,N)}if(t=e.sibling,t!==null){t.return=e.return,Le=t;break}Le=e.return}return x=V2,V2=!1,x}function Qc(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Dp(e,r,i)}s=s.next}while(s!==n)}}function ed(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function jp(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function PE(t){var e=t.alternate;e!==null&&(t.alternate=null,PE(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Hs],delete e[E0],delete e[Ep],delete e[cA],delete e[uA])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function FE(t){return t.tag===5||t.tag===3||t.tag===4}function U2(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||FE(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Op(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=qh));else if(n!==4&&(t=t.child,t!==null))for(Op(t,e,r),t=t.sibling;t!==null;)Op(t,e,r),t=t.sibling}function Mp(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Mp(t,e,r),t=t.sibling;t!==null;)Mp(t,e,r),t=t.sibling}var Wr=null,Ts=!1;function Hi(t,e,r){for(r=r.child;r!==null;)LE(t,e,r),r=r.sibling}function LE(t,e,r){if(qs&&typeof qs.onCommitFiberUnmount=="function")try{qs.onCommitFiberUnmount(Gf,r)}catch{}switch(r.tag){case 5:un||dl(r,e);case 6:var n=Wr,s=Ts;Wr=null,Hi(t,e,r),Wr=n,Ts=s,Wr!==null&&(Ts?(t=Wr,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Wr.removeChild(r.stateNode));break;case 18:Wr!==null&&(Ts?(t=Wr,r=r.stateNode,t.nodeType===8?hm(t.parentNode,r):t.nodeType===1&&hm(t,r),x0(t)):hm(Wr,r.stateNode));break;case 4:n=Wr,s=Ts,Wr=r.stateNode.containerInfo,Ts=!0,Hi(t,e,r),Wr=n,Ts=s;break;case 0:case 11:case 14:case 15:if(!un&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Dp(r,e,a),s=s.next}while(s!==n)}Hi(t,e,r);break;case 1:if(!un&&(dl(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){rr(r,e,o)}Hi(t,e,r);break;case 21:Hi(t,e,r);break;case 22:r.mode&1?(un=(n=un)||r.memoizedState!==null,Hi(t,e,r),un=n):Hi(t,e,r);break;default:Hi(t,e,r)}}function $2(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new bA),e.forEach(function(n){var s=jA.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function ws(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Wr=o.stateNode,Ts=!1;break e;case 3:Wr=o.stateNode.containerInfo,Ts=!0;break e;case 4:Wr=o.stateNode.containerInfo,Ts=!0;break e}o=o.return}if(Wr===null)throw Error(Ee(160));LE(i,a,s),Wr=null,Ts=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){rr(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)DE(e,t),e=e.sibling}function DE(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ws(e,t),Vs(t),n&4){try{Qc(3,t,t.return),ed(3,t)}catch(g){rr(t,t.return,g)}try{Qc(5,t,t.return)}catch(g){rr(t,t.return,g)}}break;case 1:ws(e,t),Vs(t),n&512&&r!==null&&dl(r,r.return);break;case 5:if(ws(e,t),Vs(t),n&512&&r!==null&&dl(r,r.return),t.flags&32){var s=t.stateNode;try{d0(s,"")}catch(g){rr(t,t.return,g)}}if(n&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=r!==null?r.memoizedProps:i,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&n4(s,i),lp(o,a);var u=lp(o,i);for(a=0;a<l.length;a+=2){var h=l[a],d=l[a+1];h==="style"?l4(s,d):h==="dangerouslySetInnerHTML"?a4(s,d):h==="children"?d0(s,d):Dg(s,h,d,u)}switch(o){case"input":np(s,i);break;case"textarea":s4(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?xl(s,!!i.multiple,p,!1):m!==!!i.multiple&&(i.defaultValue!=null?xl(s,!!i.multiple,i.defaultValue,!0):xl(s,!!i.multiple,i.multiple?[]:"",!1))}s[E0]=i}catch(g){rr(t,t.return,g)}}break;case 6:if(ws(e,t),Vs(t),n&4){if(t.stateNode===null)throw Error(Ee(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(g){rr(t,t.return,g)}}break;case 3:if(ws(e,t),Vs(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{x0(e.containerInfo)}catch(g){rr(t,t.return,g)}break;case 4:ws(e,t),Vs(t);break;case 13:ws(e,t),Vs(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(m1=cr())),n&4&&$2(t);break;case 22:if(h=r!==null&&r.memoizedState!==null,t.mode&1?(un=(u=un)||h,ws(e,t),un=u):ws(e,t),Vs(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!h&&t.mode&1)for(Le=t,h=t.child;h!==null;){for(d=Le=h;Le!==null;){switch(m=Le,p=m.child,m.tag){case 0:case 11:case 14:case 15:Qc(4,m,m.return);break;case 1:dl(m,m.return);var x=m.stateNode;if(typeof x.componentWillUnmount=="function"){n=m,r=m.return;try{e=n,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(g){rr(n,r,g)}}break;case 5:dl(m,m.return);break;case 22:if(m.memoizedState!==null){z2(d);continue}}p!==null?(p.return=m,Le=p):z2(d)}h=h.sibling}e:for(h=null,d=t;;){if(d.tag===5){if(h===null){h=d;try{s=d.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=d.stateNode,l=d.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=o4("display",a))}catch(g){rr(t,t.return,g)}}}else if(d.tag===6){if(h===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){rr(t,t.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ws(e,t),Vs(t),n&4&&$2(t);break;case 21:break;default:ws(e,t),Vs(t)}}function Vs(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(FE(r)){var n=r;break e}r=r.return}throw Error(Ee(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(d0(s,""),n.flags&=-33);var i=U2(t);Mp(t,i,s);break;case 3:case 4:var a=n.stateNode.containerInfo,o=U2(t);Op(t,o,a);break;default:throw Error(Ee(161))}}catch(l){rr(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function NA(t,e,r){Le=t,jE(t)}function jE(t,e,r){for(var n=(t.mode&1)!==0;Le!==null;){var s=Le,i=s.child;if(s.tag===22&&n){var a=s.memoizedState!==null||Ju;if(!a){var o=s.alternate,l=o!==null&&o.memoizedState!==null||un;o=Ju;var u=un;if(Ju=a,(un=l)&&!u)for(Le=s;Le!==null;)a=Le,l=a.child,a.tag===22&&a.memoizedState!==null?H2(s):l!==null?(l.return=a,Le=l):H2(s);for(;i!==null;)Le=i,jE(i),i=i.sibling;Le=s,Ju=o,un=u}W2(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Le=i):W2(t)}}function W2(t){for(;Le!==null;){var e=Le;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:un||ed(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!un)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:ks(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&C2(e,i,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}C2(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var d=h.dehydrated;d!==null&&x0(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ee(163))}un||e.flags&512&&jp(e)}catch(m){rr(e,e.return,m)}}if(e===t){Le=null;break}if(r=e.sibling,r!==null){r.return=e.return,Le=r;break}Le=e.return}}function z2(t){for(;Le!==null;){var e=Le;if(e===t){Le=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Le=r;break}Le=e.return}}function H2(t){for(;Le!==null;){var e=Le;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{ed(4,e)}catch(l){rr(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(l){rr(e,s,l)}}var i=e.return;try{jp(e)}catch(l){rr(e,i,l)}break;case 5:var a=e.return;try{jp(e)}catch(l){rr(e,a,l)}}}catch(l){rr(e,e.return,l)}if(e===t){Le=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Le=o;break}Le=e.return}}var AA=Math.ceil,af=ji.ReactCurrentDispatcher,f1=ji.ReactCurrentOwner,cs=ji.ReactCurrentBatchConfig,mt=0,jr=null,yr=null,qr=0,Bn=0,ml=Ra(0),Cr=0,N0=null,mo=0,td=0,d1=0,Yc=null,In=null,m1=0,Ol=1/0,mi=null,of=!1,Bp=null,da=null,Zu=!1,na=null,lf=0,Jc=0,Vp=null,Ch=-1,Nh=0;function kn(){return mt&6?cr():Ch!==-1?Ch:Ch=cr()}function ma(t){return t.mode&1?mt&2&&qr!==0?qr&-qr:fA.transition!==null?(Nh===0&&(Nh=w4()),Nh):(t=Ft,t!==0||(t=window.event,t=t===void 0?16:C4(t.type)),t):1}function Is(t,e,r,n){if(50<Jc)throw Jc=0,Vp=null,Error(Ee(185));eu(t,r,n),(!(mt&2)||t!==jr)&&(t===jr&&(!(mt&2)&&(td|=r),Cr===4&&Yi(t,qr)),Dn(t,n),r===1&&mt===0&&!(e.mode&1)&&(Ol=cr()+500,Yf&&Pa()))}function Dn(t,e){var r=t.callbackNode;fN(t,e);var n=zh(t,t===jr?qr:0);if(n===0)r!==null&&e2(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&e2(r),e===1)t.tag===0?hA(G2.bind(null,t)):G4(G2.bind(null,t)),oA(function(){!(mt&6)&&Pa()}),r=null;else{switch(_4(n)){case 1:r=Vg;break;case 4:r=v4;break;case 16:r=Wh;break;case 536870912:r=y4;break;default:r=Wh}r=zE(r,OE.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function OE(t,e){if(Ch=-1,Nh=0,mt&6)throw Error(Ee(327));var r=t.callbackNode;if(El()&&t.callbackNode!==r)return null;var n=zh(t,t===jr?qr:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=cf(t,n);else{e=n;var s=mt;mt|=2;var i=BE();(jr!==t||qr!==e)&&(mi=null,Ol=cr()+500,ro(t,e));do try{PA();break}catch(o){ME(t,o)}while(1);Zg(),af.current=i,mt=s,yr!==null?e=0:(jr=null,qr=0,e=Cr)}if(e!==0){if(e===2&&(s=dp(t),s!==0&&(n=s,e=Up(t,s))),e===1)throw r=N0,ro(t,0),Yi(t,n),Dn(t,cr()),r;if(e===6)Yi(t,n);else{if(s=t.current.alternate,!(n&30)&&!IA(s)&&(e=cf(t,n),e===2&&(i=dp(t),i!==0&&(n=i,e=Up(t,i))),e===1))throw r=N0,ro(t,0),Yi(t,n),Dn(t,cr()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(Ee(345));case 2:Ga(t,In,mi);break;case 3:if(Yi(t,n),(n&130023424)===n&&(e=m1+500-cr(),10<e)){if(zh(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){kn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=_p(Ga.bind(null,t,In,mi),e);break}Ga(t,In,mi);break;case 4:if(Yi(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var a=31-As(n);i=1<<a,a=e[a],a>s&&(s=a),n&=~i}if(n=s,n=cr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*AA(n/1960))-n,10<n){t.timeoutHandle=_p(Ga.bind(null,t,In,mi),n);break}Ga(t,In,mi);break;case 5:Ga(t,In,mi);break;default:throw Error(Ee(329))}}}return Dn(t,cr()),t.callbackNode===r?OE.bind(null,t):null}function Up(t,e){var r=Yc;return t.current.memoizedState.isDehydrated&&(ro(t,e).flags|=256),t=cf(t,e),t!==2&&(e=In,In=r,e!==null&&$p(e)),t}function $p(t){In===null?In=t:In.push.apply(In,t)}function IA(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!Ls(i(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Yi(t,e){for(e&=~d1,e&=~td,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-As(e),n=1<<r;t[r]=-1,e&=~n}}function G2(t){if(mt&6)throw Error(Ee(327));El();var e=zh(t,0);if(!(e&1))return Dn(t,cr()),null;var r=cf(t,e);if(t.tag!==0&&r===2){var n=dp(t);n!==0&&(e=n,r=Up(t,n))}if(r===1)throw r=N0,ro(t,0),Yi(t,e),Dn(t,cr()),r;if(r===6)throw Error(Ee(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ga(t,In,mi),Dn(t,cr()),null}function p1(t,e){var r=mt;mt|=1;try{return t(e)}finally{mt=r,mt===0&&(Ol=cr()+500,Yf&&Pa())}}function po(t){na!==null&&na.tag===0&&!(mt&6)&&El();var e=mt;mt|=1;var r=cs.transition,n=Ft;try{if(cs.transition=null,Ft=1,t)return t()}finally{Ft=n,cs.transition=r,mt=e,!(mt&6)&&Pa()}}function g1(){Bn=ml.current,Wt(ml)}function ro(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,aA(r)),yr!==null)for(r=yr.return;r!==null;){var n=r;switch(Qg(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Xh();break;case 3:Dl(),Wt(Fn),Wt(pn),i1();break;case 5:s1(n);break;case 4:Dl();break;case 13:Wt(qt);break;case 19:Wt(qt);break;case 10:e1(n.type._context);break;case 22:case 23:g1()}r=r.return}if(jr=t,yr=t=pa(t.current,null),qr=Bn=e,Cr=0,N0=null,d1=td=mo=0,In=Yc=null,Ya!==null){for(e=0;e<Ya.length;e++)if(r=Ya[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var a=i.next;i.next=s,n.next=a}r.pending=n}Ya=null}return t}function ME(t,e){do{var r=yr;try{if(Zg(),Th.current=sf,nf){for(var n=Yt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}nf=!1}if(fo=0,Fr=Sr=Yt=null,Xc=!1,S0=0,f1.current=null,r===null||r.return===null){Cr=1,N0=e,yr=null;break}e:{var i=t,a=r.return,o=r,l=e;if(e=qr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,h=o,d=h.tag;if(!(h.mode&1)&&(d===0||d===11||d===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=F2(a);if(p!==null){p.flags&=-257,L2(p,a,o,i,e),p.mode&1&&P2(i,u,e),e=p,l=u;var x=e.updateQueue;if(x===null){var g=new Set;g.add(l),e.updateQueue=g}else x.add(l);break e}else{if(!(e&1)){P2(i,u,e),x1();break e}l=Error(Ee(426))}}else if(Kt&&o.mode&1){var y=F2(a);if(y!==null){!(y.flags&65536)&&(y.flags|=256),L2(y,a,o,i,e),Yg(jl(l,o));break e}}i=l=jl(l,o),Cr!==4&&(Cr=2),Yc===null?Yc=[i]:Yc.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var w=_E(i,l,e);b2(i,w);break e;case 1:o=l;var E=i.type,_=i.stateNode;if(!(i.flags&128)&&(typeof E.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(da===null||!da.has(_)))){i.flags|=65536,e&=-e,i.lanes|=e;var N=EE(i,o,e);b2(i,N);break e}}i=i.return}while(i!==null)}UE(r)}catch(j){e=j,yr===r&&r!==null&&(yr=r=r.return);continue}break}while(1)}function BE(){var t=af.current;return af.current=sf,t===null?sf:t}function x1(){(Cr===0||Cr===3||Cr===2)&&(Cr=4),jr===null||!(mo&268435455)&&!(td&268435455)||Yi(jr,qr)}function cf(t,e){var r=mt;mt|=2;var n=BE();(jr!==t||qr!==e)&&(mi=null,ro(t,e));do try{RA();break}catch(s){ME(t,s)}while(1);if(Zg(),mt=r,af.current=n,yr!==null)throw Error(Ee(261));return jr=null,qr=0,Cr}function RA(){for(;yr!==null;)VE(yr)}function PA(){for(;yr!==null&&!nN();)VE(yr)}function VE(t){var e=WE(t.alternate,t,Bn);t.memoizedProps=t.pendingProps,e===null?UE(t):yr=e,f1.current=null}function UE(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=SA(r,e),r!==null){r.flags&=32767,yr=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Cr=6,yr=null;return}}else if(r=TA(r,e,Bn),r!==null){yr=r;return}if(e=e.sibling,e!==null){yr=e;return}yr=e=t}while(e!==null);Cr===0&&(Cr=5)}function Ga(t,e,r){var n=Ft,s=cs.transition;try{cs.transition=null,Ft=1,FA(t,e,r,n)}finally{cs.transition=s,Ft=n}return null}function FA(t,e,r,n){do El();while(na!==null);if(mt&6)throw Error(Ee(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Ee(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(dN(t,i),t===jr&&(yr=jr=null,qr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Zu||(Zu=!0,zE(Wh,function(){return El(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=cs.transition,cs.transition=null;var a=Ft;Ft=1;var o=mt;mt|=4,f1.current=null,CA(t,r),DE(r,t),ZN(yp),Hh=!!vp,yp=vp=null,t.current=r,NA(r),sN(),mt=o,Ft=a,cs.transition=i}else t.current=r;if(Zu&&(Zu=!1,na=t,lf=s),i=t.pendingLanes,i===0&&(da=null),oN(r.stateNode),Dn(t,cr()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(of)throw of=!1,t=Bp,Bp=null,t;return lf&1&&t.tag!==0&&El(),i=t.pendingLanes,i&1?t===Vp?Jc++:(Jc=0,Vp=t):Jc=0,Pa(),null}function El(){if(na!==null){var t=_4(lf),e=cs.transition,r=Ft;try{if(cs.transition=null,Ft=16>t?16:t,na===null)var n=!1;else{if(t=na,na=null,lf=0,mt&6)throw Error(Ee(331));var s=mt;for(mt|=4,Le=t.current;Le!==null;){var i=Le,a=i.child;if(Le.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(Le=u;Le!==null;){var h=Le;switch(h.tag){case 0:case 11:case 15:Qc(8,h,i)}var d=h.child;if(d!==null)d.return=h,Le=d;else for(;Le!==null;){h=Le;var m=h.sibling,p=h.return;if(PE(h),h===u){Le=null;break}if(m!==null){m.return=p,Le=m;break}Le=p}}}var x=i.alternate;if(x!==null){var g=x.child;if(g!==null){x.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}Le=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,Le=a;else e:for(;Le!==null;){if(i=Le,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Qc(9,i,i.return)}var w=i.sibling;if(w!==null){w.return=i.return,Le=w;break e}Le=i.return}}var E=t.current;for(Le=E;Le!==null;){a=Le;var _=a.child;if(a.subtreeFlags&2064&&_!==null)_.return=a,Le=_;else e:for(a=E;Le!==null;){if(o=Le,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:ed(9,o)}}catch(j){rr(o,o.return,j)}if(o===a){Le=null;break e}var N=o.sibling;if(N!==null){N.return=o.return,Le=N;break e}Le=o.return}}if(mt=s,Pa(),qs&&typeof qs.onPostCommitFiberRoot=="function")try{qs.onPostCommitFiberRoot(Gf,t)}catch{}n=!0}return n}finally{Ft=r,cs.transition=e}}return!1}function K2(t,e,r){e=jl(r,e),e=_E(t,e,1),t=fa(t,e,1),e=kn(),t!==null&&(eu(t,1,e),Dn(t,e))}function rr(t,e,r){if(t.tag===3)K2(t,t,r);else for(;e!==null;){if(e.tag===3){K2(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(da===null||!da.has(n))){t=jl(r,t),t=EE(e,t,1),e=fa(e,t,1),t=kn(),e!==null&&(eu(e,1,t),Dn(e,t));break}}e=e.return}}function LA(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=kn(),t.pingedLanes|=t.suspendedLanes&r,jr===t&&(qr&r)===r&&(Cr===4||Cr===3&&(qr&130023424)===qr&&500>cr()-m1?ro(t,0):d1|=r),Dn(t,e)}function $E(t,e){e===0&&(t.mode&1?(e=Wu,Wu<<=1,!(Wu&130023424)&&(Wu=4194304)):e=1);var r=kn();t=Ai(t,e),t!==null&&(eu(t,e,r),Dn(t,r))}function DA(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),$E(t,r)}function jA(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Ee(314))}n!==null&&n.delete(e),$E(t,r)}var WE;WE=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Fn.current)Pn=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Pn=!1,kA(t,e,r);Pn=!!(t.flags&131072)}else Pn=!1,Kt&&e.flags&1048576&&K4(e,Jh,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;bh(t,e),t=e.pendingProps;var s=Pl(e,pn.current);_l(e,r),s=o1(null,e,n,t,s,r);var i=l1();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ln(n)?(i=!0,Qh(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,r1(e),s.updater=Zf,e.stateNode=s,s._reactInternals=e,Np(e,n,t,r),e=Rp(null,e,n,!0,i,r)):(e.tag=0,Kt&&i&&Xg(e),wn(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(bh(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=MA(n),t=ks(n,t),s){case 0:e=Ip(null,e,n,t,r);break e;case 1:e=O2(null,e,n,t,r);break e;case 11:e=D2(null,e,n,t,r);break e;case 14:e=j2(null,e,n,ks(n.type,t),r);break e}throw Error(Ee(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:ks(n,s),Ip(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:ks(n,s),O2(t,e,n,s,r);case 3:e:{if(bE(e),t===null)throw Error(Ee(387));n=e.pendingProps,i=e.memoizedState,s=i.element,Z4(t,e),tf(e,n,null,r);var a=e.memoizedState;if(n=a.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=jl(Error(Ee(423)),e),e=M2(t,e,n,r,s);break e}else if(n!==s){s=jl(Error(Ee(424)),e),e=M2(t,e,n,r,s);break e}else for(zn=ha(e.stateNode.containerInfo.firstChild),Gn=e,Kt=!0,Ss=null,r=Y4(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Fl(),n===s){e=Ii(t,e,r);break e}wn(t,e,n,r)}e=e.child}return e;case 5:return eE(e),t===null&&Sp(e),n=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,wp(n,s)?a=null:i!==null&&wp(n,i)&&(e.flags|=32),SE(t,e),wn(t,e,a,r),e.child;case 6:return t===null&&Sp(e),null;case 13:return CE(t,e,r);case 4:return n1(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Ll(e,null,n,r):wn(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:ks(n,s),D2(t,e,n,s,r);case 7:return wn(t,e,e.pendingProps,r),e.child;case 8:return wn(t,e,e.pendingProps.children,r),e.child;case 12:return wn(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,Ot(Zh,n._currentValue),n._currentValue=a,i!==null)if(Ls(i.value,a)){if(i.children===s.children&&!Fn.current){e=Ii(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var o=i.dependencies;if(o!==null){a=i.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=Ei(-1,r&-r),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?l.next=l:(l.next=h.next,h.next=l),u.pending=l}}i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),bp(i.return,r,e),o.lanes|=r;break}l=l.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(Ee(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),bp(a,r,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}wn(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,_l(e,r),s=fs(s),n=n(s),e.flags|=1,wn(t,e,n,r),e.child;case 14:return n=e.type,s=ks(n,e.pendingProps),s=ks(n.type,s),j2(t,e,n,s,r);case 15:return kE(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:ks(n,s),bh(t,e),e.tag=1,Ln(n)?(t=!0,Qh(e)):t=!1,_l(e,r),wE(e,n,s),Np(e,n,s,r),Rp(null,e,n,!0,t,r);case 19:return NE(t,e,r);case 22:return TE(t,e,r)}throw Error(Ee(156,e.tag))};function zE(t,e){return x4(t,e)}function OA(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function os(t,e,r,n){return new OA(t,e,r,n)}function v1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function MA(t){if(typeof t=="function")return v1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Og)return 11;if(t===Mg)return 14}return 2}function pa(t,e){var r=t.alternate;return r===null?(r=os(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Ah(t,e,r,n,s,i){var a=2;if(n=t,typeof t=="function")v1(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case sl:return no(r.children,s,i,e);case jg:a=8,s|=8;break;case Jm:return t=os(12,r,e,s|2),t.elementType=Jm,t.lanes=i,t;case Zm:return t=os(13,r,e,s),t.elementType=Zm,t.lanes=i,t;case ep:return t=os(19,r,e,s),t.elementType=ep,t.lanes=i,t;case e4:return rd(r,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case J_:a=10;break e;case Z_:a=9;break e;case Og:a=11;break e;case Mg:a=14;break e;case qi:a=16,n=null;break e}throw Error(Ee(130,t==null?t:typeof t,""))}return e=os(a,r,e,s),e.elementType=t,e.type=n,e.lanes=i,e}function no(t,e,r,n){return t=os(7,t,n,e),t.lanes=r,t}function rd(t,e,r,n){return t=os(22,t,n,e),t.elementType=e4,t.lanes=r,t.stateNode={isHidden:!1},t}function ym(t,e,r){return t=os(6,t,null,e),t.lanes=r,t}function wm(t,e,r){return e=os(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function BA(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=em(0),this.expirationTimes=em(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=em(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function y1(t,e,r,n,s,i,a,o,l){return t=new BA(t,e,r,o,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=os(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},r1(i),t}function VA(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:nl,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function HE(t){if(!t)return _a;t=t._reactInternals;e:{if(Io(t)!==t||t.tag!==1)throw Error(Ee(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ln(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Ee(171))}if(t.tag===1){var r=t.type;if(Ln(r))return H4(t,r,e)}return e}function GE(t,e,r,n,s,i,a,o,l){return t=y1(r,n,!0,t,s,i,a,o,l),t.context=HE(null),r=t.current,n=kn(),s=ma(r),i=Ei(n,s),i.callback=e??null,fa(r,i,s),t.current.lanes=s,eu(t,s,n),Dn(t,n),t}function nd(t,e,r,n){var s=e.current,i=kn(),a=ma(s);return r=HE(r),e.context===null?e.context=r:e.pendingContext=r,e=Ei(i,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=fa(s,e,a),t!==null&&(Is(t,s,a,i),kh(t,s,a)),a}function uf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function q2(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function w1(t,e){q2(t,e),(t=t.alternate)&&q2(t,e)}function UA(){return null}var KE=typeof reportError=="function"?reportError:function(t){console.error(t)};function _1(t){this._internalRoot=t}sd.prototype.render=_1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Ee(409));nd(t,e,null,null)};sd.prototype.unmount=_1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;po(function(){nd(null,t,null,null)}),e[Ni]=null}};function sd(t){this._internalRoot=t}sd.prototype.unstable_scheduleHydration=function(t){if(t){var e=T4();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Qi.length&&e!==0&&e<Qi[r].priority;r++);Qi.splice(r,0,t),r===0&&b4(t)}};function E1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function id(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function X2(){}function $A(t,e,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var u=uf(a);i.call(u)}}var a=GE(e,n,t,0,null,!1,!1,"",X2);return t._reactRootContainer=a,t[Ni]=a.current,w0(t.nodeType===8?t.parentNode:t),po(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var u=uf(l);o.call(u)}}var l=y1(t,0,!1,null,null,!1,!1,"",X2);return t._reactRootContainer=l,t[Ni]=l.current,w0(t.nodeType===8?t.parentNode:t),po(function(){nd(e,l,r,n)}),l}function ad(t,e,r,n,s){var i=r._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var o=s;s=function(){var l=uf(a);o.call(l)}}nd(e,a,t,s)}else a=$A(r,e,t,s,n);return uf(a)}E4=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Pc(e.pendingLanes);r!==0&&(Ug(e,r|1),Dn(e,cr()),!(mt&6)&&(Ol=cr()+500,Pa()))}break;case 13:po(function(){var n=Ai(t,1);if(n!==null){var s=kn();Is(n,t,1,s)}}),w1(t,1)}};$g=function(t){if(t.tag===13){var e=Ai(t,134217728);if(e!==null){var r=kn();Is(e,t,134217728,r)}w1(t,134217728)}};k4=function(t){if(t.tag===13){var e=ma(t),r=Ai(t,e);if(r!==null){var n=kn();Is(r,t,e,n)}w1(t,e)}};T4=function(){return Ft};S4=function(t,e){var r=Ft;try{return Ft=t,e()}finally{Ft=r}};up=function(t,e,r){switch(e){case"input":if(np(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=Qf(n);if(!s)throw Error(Ee(90));r4(n),np(n,s)}}}break;case"textarea":s4(t,r);break;case"select":e=r.value,e!=null&&xl(t,!!r.multiple,e,!1)}};h4=p1;f4=po;var WA={usingClientEntryPoint:!1,Events:[ru,ll,Qf,c4,u4,p1]},bc={findFiberByHostInstance:Qa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zA={bundleType:bc.bundleType,version:bc.version,rendererPackageName:bc.rendererPackageName,rendererConfig:bc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ji.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=p4(t),t===null?null:t.stateNode},findFiberByHostInstance:bc.findFiberByHostInstance||UA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var eh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!eh.isDisabled&&eh.supportsFiber)try{Gf=eh.inject(zA),qs=eh}catch{}}Xn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=WA;Xn.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!E1(e))throw Error(Ee(200));return VA(t,e,null,r)};Xn.createRoot=function(t,e){if(!E1(t))throw Error(Ee(299));var r=!1,n="",s=KE;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=y1(t,1,!1,null,null,r,!1,n,s),t[Ni]=e.current,w0(t.nodeType===8?t.parentNode:t),new _1(e)};Xn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Ee(188)):(t=Object.keys(t).join(","),Error(Ee(268,t)));return t=p4(e),t=t===null?null:t.stateNode,t};Xn.flushSync=function(t){return po(t)};Xn.hydrate=function(t,e,r){if(!id(e))throw Error(Ee(200));return ad(null,t,e,!0,r)};Xn.hydrateRoot=function(t,e,r){if(!E1(t))throw Error(Ee(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",a=KE;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=GE(e,null,t,1,r??null,s,!1,i,a),t[Ni]=e.current,w0(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new sd(e)};Xn.render=function(t,e,r){if(!id(e))throw Error(Ee(200));return ad(null,t,e,!1,r)};Xn.unmountComponentAtNode=function(t){if(!id(t))throw Error(Ee(40));return t._reactRootContainer?(po(function(){ad(null,null,t,!1,function(){t._reactRootContainer=null,t[Ni]=null})}),!0):!1};Xn.unstable_batchedUpdates=p1;Xn.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!id(r))throw Error(Ee(200));if(t==null||t._reactInternals===void 0)throw Error(Ee(38));return ad(t,e,r,!1,n)};Xn.version="18.3.1-next-f1338f8080-20240426";function qE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(qE)}catch(t){console.error(t)}}qE(),q_.exports=Xn;var HA=q_.exports,Q2=HA;Qm.createRoot=Q2.createRoot,Qm.hydrateRoot=Q2.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function A0(){return A0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},A0.apply(this,arguments)}var sa;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(sa||(sa={}));const Y2="popstate";function GA(t){t===void 0&&(t={});function e(n,s){let{pathname:i,search:a,hash:o}=n.location;return Wp("",{pathname:i,search:a,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:hf(s)}return qA(e,r,null,t)}function ur(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function XE(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function KA(){return Math.random().toString(36).substr(2,8)}function J2(t,e){return{usr:t.state,key:t.key,idx:e}}function Wp(t,e,r,n){return r===void 0&&(r=null),A0({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Zl(e):e,{state:r,key:e&&e.key||n||KA()})}function hf(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Zl(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function qA(t,e,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,a=s.history,o=sa.Pop,l=null,u=h();u==null&&(u=0,a.replaceState(A0({},a.state,{idx:u}),""));function h(){return(a.state||{idx:null}).idx}function d(){o=sa.Pop;let y=h(),w=y==null?null:y-u;u=y,l&&l({action:o,location:g.location,delta:w})}function m(y,w){o=sa.Push;let E=Wp(g.location,y,w);r&&r(E,y),u=h()+1;let _=J2(E,u),N=g.createHref(E);try{a.pushState(_,"",N)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;s.location.assign(N)}i&&l&&l({action:o,location:g.location,delta:1})}function p(y,w){o=sa.Replace;let E=Wp(g.location,y,w);r&&r(E,y),u=h();let _=J2(E,u),N=g.createHref(E);a.replaceState(_,"",N),i&&l&&l({action:o,location:g.location,delta:0})}function x(y){let w=s.location.origin!=="null"?s.location.origin:s.location.href,E=typeof y=="string"?y:hf(y);return E=E.replace(/ $/,"%20"),ur(w,"No window.location.(origin|href) available to create URL for href: "+E),new URL(E,w)}let g={get action(){return o},get location(){return t(s,a)},listen(y){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(Y2,d),l=y,()=>{s.removeEventListener(Y2,d),l=null}},createHref(y){return e(s,y)},createURL:x,encodeLocation(y){let w=x(y);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:m,replace:p,go(y){return a.go(y)}};return g}var Z2;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Z2||(Z2={}));function XA(t,e,r){return r===void 0&&(r="/"),QA(t,e,r,!1)}function QA(t,e,r,n){let s=typeof e=="string"?Zl(e):e,i=k1(s.pathname||"/",r);if(i==null)return null;let a=QE(t);YA(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let u=lI(i);o=aI(a[l],u,n)}return o}function QE(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(i,a,o)=>{let l={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};l.relativePath.startsWith("/")&&(ur(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let u=ga([n,l.relativePath]),h=r.concat(l);i.children&&i.children.length>0&&(ur(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),QE(i.children,e,h,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:sI(u,i.index),routesMeta:h})};return t.forEach((i,a)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))s(i,a);else for(let l of YE(i.path))s(i,a,l)}),e}function YE(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let a=YE(n.join("/")),o=[];return o.push(...a.map(l=>l===""?i:[i,l].join("/"))),s&&o.push(...a),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function YA(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:iI(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const JA=/^:[\w-]+$/,ZA=3,eI=2,tI=1,rI=10,nI=-2,ey=t=>t==="*";function sI(t,e){let r=t.split("/"),n=r.length;return r.some(ey)&&(n+=nI),e&&(n+=eI),r.filter(s=>!ey(s)).reduce((s,i)=>s+(JA.test(i)?ZA:i===""?tI:rI),n)}function iI(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function aI(t,e,r){r===void 0&&(r=!1);let{routesMeta:n}=t,s={},i="/",a=[];for(let o=0;o<n.length;++o){let l=n[o],u=o===n.length-1,h=i==="/"?e:e.slice(i.length)||"/",d=ty({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},h),m=l.route;if(!d&&u&&r&&!n[n.length-1].route.index&&(d=ty({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!d)return null;Object.assign(s,d.params),a.push({params:s,pathname:ga([i,d.pathname]),pathnameBase:fI(ga([i,d.pathnameBase])),route:m}),d.pathnameBase!=="/"&&(i=ga([i,d.pathnameBase]))}return a}function ty(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=oI(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((u,h,d)=>{let{paramName:m,isOptional:p}=h;if(m==="*"){let g=o[d]||"";a=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const x=o[d];return p&&!x?u[m]=void 0:u[m]=(x||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:a,pattern:t}}function oI(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),XE(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function lI(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return XE(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function k1(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function cI(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?Zl(t):t;return{pathname:r?r.startsWith("/")?r:uI(r,e):e,search:dI(n),hash:mI(s)}}function uI(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function _m(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function hI(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function T1(t,e){let r=hI(t);return e?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function S1(t,e,r,n){n===void 0&&(n=!1);let s;typeof t=="string"?s=Zl(t):(s=A0({},t),ur(!s.pathname||!s.pathname.includes("?"),_m("?","pathname","search",s)),ur(!s.pathname||!s.pathname.includes("#"),_m("#","pathname","hash",s)),ur(!s.search||!s.search.includes("#"),_m("#","search","hash",s)));let i=t===""||s.pathname==="",a=i?"/":s.pathname,o;if(a==null)o=r;else{let d=e.length-1;if(!n&&a.startsWith("..")){let m=a.split("/");for(;m[0]==="..";)m.shift(),d-=1;s.pathname=m.join("/")}o=d>=0?e[d]:"/"}let l=cI(s,o),u=a&&a!=="/"&&a.endsWith("/"),h=(i||a===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(u||h)&&(l.pathname+="/"),l}const ga=t=>t.join("/").replace(/\/\/+/g,"/"),fI=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),dI=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,mI=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function pI(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const JE=["post","put","patch","delete"];new Set(JE);const gI=["get",...JE];new Set(gI);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function I0(){return I0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},I0.apply(this,arguments)}const b1=F.createContext(null),xI=F.createContext(null),Fa=F.createContext(null),od=F.createContext(null),Oi=F.createContext({outlet:null,matches:[],isDataRoute:!1}),ZE=F.createContext(null);function vI(t,e){let{relative:r}=e===void 0?{}:e;ec()||ur(!1);let{basename:n,navigator:s}=F.useContext(Fa),{hash:i,pathname:a,search:o}=tk(t,{relative:r}),l=a;return n!=="/"&&(l=a==="/"?n:ga([n,a])),s.createHref({pathname:l,search:o,hash:i})}function ec(){return F.useContext(od)!=null}function su(){return ec()||ur(!1),F.useContext(od).location}function ek(t){F.useContext(Fa).static||F.useLayoutEffect(t)}function Or(){let{isDataRoute:t}=F.useContext(Oi);return t?PI():yI()}function yI(){ec()||ur(!1);let t=F.useContext(b1),{basename:e,future:r,navigator:n}=F.useContext(Fa),{matches:s}=F.useContext(Oi),{pathname:i}=su(),a=JSON.stringify(T1(s,r.v7_relativeSplatPath)),o=F.useRef(!1);return ek(()=>{o.current=!0}),F.useCallback(function(u,h){if(h===void 0&&(h={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let d=S1(u,JSON.parse(a),i,h.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:ga([e,d.pathname])),(h.replace?n.replace:n.push)(d,h.state,h)},[e,n,a,i,t])}function wI(){let{matches:t}=F.useContext(Oi),e=t[t.length-1];return e?e.params:{}}function tk(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=F.useContext(Fa),{matches:s}=F.useContext(Oi),{pathname:i}=su(),a=JSON.stringify(T1(s,n.v7_relativeSplatPath));return F.useMemo(()=>S1(t,JSON.parse(a),i,r==="path"),[t,a,i,r])}function _I(t,e){return EI(t,e)}function EI(t,e,r,n){ec()||ur(!1);let{navigator:s,static:i}=F.useContext(Fa),{matches:a}=F.useContext(Oi),o=a[a.length-1],l=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let h=su(),d;if(e){var m;let w=typeof e=="string"?Zl(e):e;u==="/"||(m=w.pathname)!=null&&m.startsWith(u)||ur(!1),d=w}else d=h;let p=d.pathname||"/",x=p;if(u!=="/"){let w=u.replace(/^\//,"").split("/");x="/"+p.replace(/^\//,"").split("/").slice(w.length).join("/")}let g=!i&&r&&r.matches&&r.matches.length>0?r.matches:XA(t,{pathname:x}),y=CI(g&&g.map(w=>Object.assign({},w,{params:Object.assign({},l,w.params),pathname:ga([u,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?u:ga([u,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),a,r,n);return e&&y?F.createElement(od.Provider,{value:{location:I0({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:sa.Pop}},y):y}function kI(){let t=RI(),e=pI(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return F.createElement(F.Fragment,null,F.createElement("h2",null,"Unexpected Application Error!"),F.createElement("h3",{style:{fontStyle:"italic"}},e),r?F.createElement("pre",{style:s},r):null,i)}const TI=F.createElement(kI,null);class SI extends F.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?F.createElement(Oi.Provider,{value:this.props.routeContext},F.createElement(ZE.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function bI(t){let{routeContext:e,match:r,children:n}=t,s=F.useContext(b1);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),F.createElement(Oi.Provider,{value:e},n)}function CI(t,e,r,n){var s;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var i;if(!r)return null;if(r.errors)t=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let a=t,o=(s=r)==null?void 0:s.errors;if(o!=null){let h=a.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);h>=0||ur(!1),a=a.slice(0,Math.min(a.length,h+1))}let l=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let h=0;h<a.length;h++){let d=a[h];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=h),d.route.id){let{loaderData:m,errors:p}=r,x=d.route.loader&&m[d.route.id]===void 0&&(!p||p[d.route.id]===void 0);if(d.route.lazy||x){l=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((h,d,m)=>{let p,x=!1,g=null,y=null;r&&(p=o&&d.route.id?o[d.route.id]:void 0,g=d.route.errorElement||TI,l&&(u<0&&m===0?(FI("route-fallback",!1),x=!0,y=null):u===m&&(x=!0,y=d.route.hydrateFallbackElement||null)));let w=e.concat(a.slice(0,m+1)),E=()=>{let _;return p?_=g:x?_=y:d.route.Component?_=F.createElement(d.route.Component,null):d.route.element?_=d.route.element:_=h,F.createElement(bI,{match:d,routeContext:{outlet:h,matches:w,isDataRoute:r!=null},children:_})};return r&&(d.route.ErrorBoundary||d.route.errorElement||m===0)?F.createElement(SI,{location:r.location,revalidation:r.revalidation,component:g,error:p,children:E(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):E()},null)}var rk=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(rk||{}),ff=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(ff||{});function NI(t){let e=F.useContext(b1);return e||ur(!1),e}function AI(t){let e=F.useContext(xI);return e||ur(!1),e}function II(t){let e=F.useContext(Oi);return e||ur(!1),e}function nk(t){let e=II(),r=e.matches[e.matches.length-1];return r.route.id||ur(!1),r.route.id}function RI(){var t;let e=F.useContext(ZE),r=AI(ff.UseRouteError),n=nk(ff.UseRouteError);return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function PI(){let{router:t}=NI(rk.UseNavigateStable),e=nk(ff.UseNavigateStable),r=F.useRef(!1);return ek(()=>{r.current=!0}),F.useCallback(function(s,i){i===void 0&&(i={}),r.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,I0({fromRouteId:e},i)))},[t,e])}const ry={};function FI(t,e,r){!e&&!ry[t]&&(ry[t]=!0)}function LI(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function sk(t){let{to:e,replace:r,state:n,relative:s}=t;ec()||ur(!1);let{future:i,static:a}=F.useContext(Fa),{matches:o}=F.useContext(Oi),{pathname:l}=su(),u=Or(),h=S1(e,T1(o,i.v7_relativeSplatPath),l,s==="path"),d=JSON.stringify(h);return F.useEffect(()=>u(JSON.parse(d),{replace:r,state:n,relative:s}),[u,d,s,r,n]),null}function Es(t){ur(!1)}function DI(t){let{basename:e="/",children:r=null,location:n,navigationType:s=sa.Pop,navigator:i,static:a=!1,future:o}=t;ec()&&ur(!1);let l=e.replace(/^\/*/,"/"),u=F.useMemo(()=>({basename:l,navigator:i,static:a,future:I0({v7_relativeSplatPath:!1},o)}),[l,o,i,a]);typeof n=="string"&&(n=Zl(n));let{pathname:h="/",search:d="",hash:m="",state:p=null,key:x="default"}=n,g=F.useMemo(()=>{let y=k1(h,l);return y==null?null:{location:{pathname:y,search:d,hash:m,state:p,key:x},navigationType:s}},[l,h,d,m,p,x,s]);return g==null?null:F.createElement(Fa.Provider,{value:u},F.createElement(od.Provider,{children:r,value:g}))}function jI(t){let{children:e,location:r}=t;return _I(zp(e),r)}new Promise(()=>{});function zp(t,e){e===void 0&&(e=[]);let r=[];return F.Children.forEach(t,(n,s)=>{if(!F.isValidElement(n))return;let i=[...e,s];if(n.type===F.Fragment){r.push.apply(r,zp(n.props.children,i));return}n.type!==Es&&ur(!1),!n.props.index||!n.props.children||ur(!1);let a={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=zp(n.props.children,i)),r.push(a)}),r}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Hp(){return Hp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Hp.apply(this,arguments)}function OI(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,i;for(i=0;i<n.length;i++)s=n[i],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}function MI(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function BI(t,e){return t.button===0&&(!e||e==="_self")&&!MI(t)}const VI=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],UI="6";try{window.__reactRouterVersion=UI}catch{}const $I="startTransition",ny=LC[$I];function WI(t){let{basename:e,children:r,future:n,window:s}=t,i=F.useRef();i.current==null&&(i.current=GA({window:s,v5Compat:!0}));let a=i.current,[o,l]=F.useState({action:a.action,location:a.location}),{v7_startTransition:u}=n||{},h=F.useCallback(d=>{u&&ny?ny(()=>l(d)):l(d)},[l,u]);return F.useLayoutEffect(()=>a.listen(h),[a,h]),F.useEffect(()=>LI(n),[n]),F.createElement(DI,{basename:e,children:r,location:o.location,navigationType:o.action,navigator:a,future:n})}const zI=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",HI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,qa=F.forwardRef(function(e,r){let{onClick:n,relative:s,reloadDocument:i,replace:a,state:o,target:l,to:u,preventScrollReset:h,viewTransition:d}=e,m=OI(e,VI),{basename:p}=F.useContext(Fa),x,g=!1;if(typeof u=="string"&&HI.test(u)&&(x=u,zI))try{let _=new URL(window.location.href),N=u.startsWith("//")?new URL(_.protocol+u):new URL(u),j=k1(N.pathname,p);N.origin===_.origin&&j!=null?u=j+N.search+N.hash:g=!0}catch{}let y=vI(u,{relative:s}),w=GI(u,{replace:a,state:o,target:l,preventScrollReset:h,relative:s,viewTransition:d});function E(_){n&&n(_),_.defaultPrevented||w(_)}return F.createElement("a",Hp({},m,{href:x||y,onClick:g||i?n:E,ref:r,target:l}))});var sy;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(sy||(sy={}));var iy;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(iy||(iy={}));function GI(t,e){let{target:r,replace:n,state:s,preventScrollReset:i,relative:a,viewTransition:o}=e===void 0?{}:e,l=Or(),u=su(),h=tk(t,{relative:a});return F.useCallback(d=>{if(BI(d,r)){d.preventDefault();let m=n!==void 0?n:hf(u)===hf(h);l(t,{replace:m,state:s,preventScrollReset:i,relative:a,viewTransition:o})}},[u,l,h,n,s,r,t,i,a,o])}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ik=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},KI=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[r++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[r++],a=t[r++],o=t[r++],l=((s&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const i=t[r++],a=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},ak={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,o=a?t[s+1]:0,l=s+2<t.length,u=l?t[s+2]:0,h=i>>2,d=(i&3)<<4|o>>4;let m=(o&15)<<2|u>>6,p=u&63;l||(p=64,a||(m=64)),n.push(r[h],r[d],r[m],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(ik(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):KI(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const i=r[t.charAt(s++)],o=s<t.length?r[t.charAt(s)]:0;++s;const u=s<t.length?r[t.charAt(s)]:64;++s;const d=s<t.length?r[t.charAt(s)]:64;if(++s,i==null||o==null||u==null||d==null)throw new qI;const m=i<<2|o>>4;if(n.push(m),u!==64){const p=o<<4&240|u>>2;if(n.push(p),d!==64){const x=u<<6&192|d;n.push(x)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class qI extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const XI=function(t){const e=ik(t);return ak.encodeByteArray(e,!0)},df=function(t){return XI(t).replace(/\./g,"")},ok=function(t){try{return ak.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YI=()=>QI().__FIREBASE_DEFAULTS__,JI=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},ZI=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&ok(t[1]);return e&&JSON.parse(e)},ld=()=>{try{return YI()||JI()||ZI()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},lk=t=>{var e,r;return(r=(e=ld())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},ck=t=>{const e=lk(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},uk=()=>{var t;return(t=ld())===null||t===void 0?void 0:t.config},hk=t=>{var e;return(e=ld())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fk(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),o="";return[df(JSON.stringify(r)),df(JSON.stringify(a)),o].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function t5(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(gn())}function r5(){var t;const e=(t=ld())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function n5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function s5(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function i5(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function a5(){const t=gn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function o5(){return!r5()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function l5(){try{return typeof indexedDB=="object"}catch{return!1}}function c5(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(r){e(r)}})}function uG(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u5="FirebaseError";class si extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=u5,Object.setPrototypeOf(this,si.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,iu.prototype.create)}}class iu{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?h5(i,n):"Error",o=`${this.serviceName}: ${a} (${s}).`;return new si(s,o,n)}}function h5(t,e){return t.replace(f5,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const f5=/\{\$([^}]+)}/g;function d5(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function mf(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const i=t[s],a=e[s];if(ay(i)&&ay(a)){if(!mf(i,a))return!1}else if(i!==a)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function ay(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function au(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Lc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,i]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Dc(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function m5(t,e){const r=new p5(t,e);return r.subscribe.bind(r)}class p5{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");g5(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=Em),s.error===void 0&&(s.error=Em),s.complete===void 0&&(s.complete=Em);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function g5(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Em(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x5=1e3,v5=2,y5=4*60*60*1e3,w5=.5;function hG(t,e=x5,r=v5){const n=e*Math.pow(r,t),s=Math.round(w5*n*(Math.random()-.5)*2);return Math.min(y5,n+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ir(t){return t&&t._delegate?t._delegate:t}class Ea{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ka="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _5{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new e5;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(k5(e))try{this.getOrInitializeService({instanceIdentifier:Ka})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=Ka){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ka){return this.instances.has(e)}getOptions(e=Ka){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(i);n===o&&a.resolve(s)}return s}onInit(e,r){var n;const s=this.normalizeInstanceIdentifier(r),i=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:E5(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Ka){return this.component?this.component.multipleInstances?e:Ka:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function E5(t){return t===Ka?void 0:t}function k5(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T5{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new _5(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ht;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ht||(ht={}));const S5={debug:ht.DEBUG,verbose:ht.VERBOSE,info:ht.INFO,warn:ht.WARN,error:ht.ERROR,silent:ht.SILENT},b5=ht.INFO,C5={[ht.DEBUG]:"log",[ht.VERBOSE]:"log",[ht.INFO]:"info",[ht.WARN]:"warn",[ht.ERROR]:"error"},N5=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=C5[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class C1{constructor(e){this.name=e,this._logLevel=b5,this._logHandler=N5,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ht))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?S5[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ht.DEBUG,...e),this._logHandler(this,ht.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ht.VERBOSE,...e),this._logHandler(this,ht.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ht.INFO,...e),this._logHandler(this,ht.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ht.WARN,...e),this._logHandler(this,ht.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ht.ERROR,...e),this._logHandler(this,ht.ERROR,...e)}}const A5=(t,e)=>e.some(r=>t instanceof r);let oy,ly;function I5(){return oy||(oy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function R5(){return ly||(ly=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const dk=new WeakMap,Gp=new WeakMap,mk=new WeakMap,km=new WeakMap,N1=new WeakMap;function P5(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{r(xa(t.result)),s()},a=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&dk.set(r,t)}).catch(()=>{}),N1.set(e,t),e}function F5(t){if(Gp.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{r(),s()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});Gp.set(t,e)}let Kp={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Gp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||mk.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return xa(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function L5(t){Kp=t(Kp)}function D5(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Tm(this),e,...r);return mk.set(n,e.sort?e.sort():[e]),xa(n)}:R5().includes(t)?function(...e){return t.apply(Tm(this),e),xa(dk.get(this))}:function(...e){return xa(t.apply(Tm(this),e))}}function j5(t){return typeof t=="function"?D5(t):(t instanceof IDBTransaction&&F5(t),A5(t,I5())?new Proxy(t,Kp):t)}function xa(t){if(t instanceof IDBRequest)return P5(t);if(km.has(t))return km.get(t);const e=j5(t);return e!==t&&(km.set(t,e),N1.set(e,t)),e}const Tm=t=>N1.get(t);function O5(t,e,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),o=xa(a);return n&&a.addEventListener("upgradeneeded",l=>{n(xa(a.result),l.oldVersion,l.newVersion,xa(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const M5=["get","getKey","getAll","getAllKeys","count"],B5=["put","add","delete","clear"],Sm=new Map;function cy(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Sm.get(e))return Sm.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=B5.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||M5.includes(r)))return;const i=async function(a,...o){const l=this.transaction(a,s?"readwrite":"readonly");let u=l.store;return n&&(u=u.index(o.shift())),(await Promise.all([u[r](...o),s&&l.done]))[0]};return Sm.set(e,i),i}L5(t=>({...t,get:(e,r,n)=>cy(e,r)||t.get(e,r,n),has:(e,r)=>!!cy(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V5{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(U5(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function U5(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const qp="@firebase/app",uy="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ri=new C1("@firebase/app"),$5="@firebase/app-compat",W5="@firebase/analytics-compat",z5="@firebase/analytics",H5="@firebase/app-check-compat",G5="@firebase/app-check",K5="@firebase/auth",q5="@firebase/auth-compat",X5="@firebase/database",Q5="@firebase/data-connect",Y5="@firebase/database-compat",J5="@firebase/functions",Z5="@firebase/functions-compat",e6="@firebase/installations",t6="@firebase/installations-compat",r6="@firebase/messaging",n6="@firebase/messaging-compat",s6="@firebase/performance",i6="@firebase/performance-compat",a6="@firebase/remote-config",o6="@firebase/remote-config-compat",l6="@firebase/storage",c6="@firebase/storage-compat",u6="@firebase/firestore",h6="@firebase/vertexai-preview",f6="@firebase/firestore-compat",d6="firebase",m6="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xp="[DEFAULT]",p6={[qp]:"fire-core",[$5]:"fire-core-compat",[z5]:"fire-analytics",[W5]:"fire-analytics-compat",[G5]:"fire-app-check",[H5]:"fire-app-check-compat",[K5]:"fire-auth",[q5]:"fire-auth-compat",[X5]:"fire-rtdb",[Q5]:"fire-data-connect",[Y5]:"fire-rtdb-compat",[J5]:"fire-fn",[Z5]:"fire-fn-compat",[e6]:"fire-iid",[t6]:"fire-iid-compat",[r6]:"fire-fcm",[n6]:"fire-fcm-compat",[s6]:"fire-perf",[i6]:"fire-perf-compat",[a6]:"fire-rc",[o6]:"fire-rc-compat",[l6]:"fire-gcs",[c6]:"fire-gcs-compat",[u6]:"fire-fst",[f6]:"fire-fst-compat",[h6]:"fire-vertex","fire-js":"fire-js",[d6]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pf=new Map,g6=new Map,Qp=new Map;function hy(t,e){try{t.container.addComponent(e)}catch(r){Ri.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function go(t){const e=t.name;if(Qp.has(e))return Ri.debug(`There were multiple attempts to register component ${e}.`),!1;Qp.set(e,t);for(const r of pf.values())hy(r,t);for(const r of g6.values())hy(r,t);return!0}function cd(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function ls(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x6={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},va=new iu("app","Firebase",x6);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v6{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ea("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw va.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ro=m6;function pk(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:Xp,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw va.create("bad-app-name",{appName:String(s)});if(r||(r=uk()),!r)throw va.create("no-options");const i=pf.get(s);if(i){if(mf(r,i.options)&&mf(n,i.config))return i;throw va.create("duplicate-app",{appName:s})}const a=new T5(s);for(const l of Qp.values())a.addComponent(l);const o=new v6(r,n,a);return pf.set(s,o),o}function A1(t=Xp){const e=pf.get(t);if(!e&&t===Xp&&uk())return pk();if(!e)throw va.create("no-app",{appName:t});return e}function Qs(t,e,r){var n;let s=(n=p6[t])!==null&&n!==void 0?n:t;r&&(s+=`-${r}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const o=[`Unable to register library "${s}" with version "${e}":`];i&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ri.warn(o.join(" "));return}go(new Ea(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y6="firebase-heartbeat-database",w6=1,R0="firebase-heartbeat-store";let bm=null;function gk(){return bm||(bm=O5(y6,w6,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(R0)}catch(r){console.warn(r)}}}}).catch(t=>{throw va.create("idb-open",{originalErrorMessage:t.message})})),bm}async function _6(t){try{const r=(await gk()).transaction(R0),n=await r.objectStore(R0).get(xk(t));return await r.done,n}catch(e){if(e instanceof si)Ri.warn(e.message);else{const r=va.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ri.warn(r.message)}}}async function fy(t,e){try{const n=(await gk()).transaction(R0,"readwrite");await n.objectStore(R0).put(e,xk(t)),await n.done}catch(r){if(r instanceof si)Ri.warn(r.message);else{const n=va.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Ri.warn(n.message)}}}function xk(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E6=1024,k6=30*24*60*60*1e3;class T6{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new b6(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=dy();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=k6}),this._storage.overwrite(this._heartbeatsCache))}catch(n){Ri.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=dy(),{heartbeatsToSend:n,unsentEntries:s}=S6(this._heartbeatsCache.heartbeats),i=df(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return Ri.warn(r),""}}}function dy(){return new Date().toISOString().substring(0,10)}function S6(t,e=E6){const r=[];let n=t.slice();for(const s of t){const i=r.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),my(r)>e){i.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),my(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class b6{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return l5()?c5().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await _6(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return fy(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return fy(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function my(t){return df(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C6(t){go(new Ea("platform-logger",e=>new V5(e),"PRIVATE")),go(new Ea("heartbeat",e=>new T6(e),"PRIVATE")),Qs(qp,uy,t),Qs(qp,uy,"esm2017"),Qs("fire-js","")}C6("");var py=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var so,vk;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,S){function b(){}b.prototype=S.prototype,k.D=S.prototype,k.prototype=new b,k.prototype.constructor=k,k.C=function(C,A,I){for(var P=Array(arguments.length-2),ue=2;ue<arguments.length;ue++)P[ue-2]=arguments[ue];return S.prototype[A].apply(C,P)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(k,S,b){b||(b=0);var C=Array(16);if(typeof S=="string")for(var A=0;16>A;++A)C[A]=S.charCodeAt(b++)|S.charCodeAt(b++)<<8|S.charCodeAt(b++)<<16|S.charCodeAt(b++)<<24;else for(A=0;16>A;++A)C[A]=S[b++]|S[b++]<<8|S[b++]<<16|S[b++]<<24;S=k.g[0],b=k.g[1],A=k.g[2];var I=k.g[3],P=S+(I^b&(A^I))+C[0]+3614090360&4294967295;S=b+(P<<7&4294967295|P>>>25),P=I+(A^S&(b^A))+C[1]+3905402710&4294967295,I=S+(P<<12&4294967295|P>>>20),P=A+(b^I&(S^b))+C[2]+606105819&4294967295,A=I+(P<<17&4294967295|P>>>15),P=b+(S^A&(I^S))+C[3]+3250441966&4294967295,b=A+(P<<22&4294967295|P>>>10),P=S+(I^b&(A^I))+C[4]+4118548399&4294967295,S=b+(P<<7&4294967295|P>>>25),P=I+(A^S&(b^A))+C[5]+1200080426&4294967295,I=S+(P<<12&4294967295|P>>>20),P=A+(b^I&(S^b))+C[6]+2821735955&4294967295,A=I+(P<<17&4294967295|P>>>15),P=b+(S^A&(I^S))+C[7]+4249261313&4294967295,b=A+(P<<22&4294967295|P>>>10),P=S+(I^b&(A^I))+C[8]+1770035416&4294967295,S=b+(P<<7&4294967295|P>>>25),P=I+(A^S&(b^A))+C[9]+2336552879&4294967295,I=S+(P<<12&4294967295|P>>>20),P=A+(b^I&(S^b))+C[10]+4294925233&4294967295,A=I+(P<<17&4294967295|P>>>15),P=b+(S^A&(I^S))+C[11]+2304563134&4294967295,b=A+(P<<22&4294967295|P>>>10),P=S+(I^b&(A^I))+C[12]+1804603682&4294967295,S=b+(P<<7&4294967295|P>>>25),P=I+(A^S&(b^A))+C[13]+4254626195&4294967295,I=S+(P<<12&4294967295|P>>>20),P=A+(b^I&(S^b))+C[14]+2792965006&4294967295,A=I+(P<<17&4294967295|P>>>15),P=b+(S^A&(I^S))+C[15]+1236535329&4294967295,b=A+(P<<22&4294967295|P>>>10),P=S+(A^I&(b^A))+C[1]+4129170786&4294967295,S=b+(P<<5&4294967295|P>>>27),P=I+(b^A&(S^b))+C[6]+3225465664&4294967295,I=S+(P<<9&4294967295|P>>>23),P=A+(S^b&(I^S))+C[11]+643717713&4294967295,A=I+(P<<14&4294967295|P>>>18),P=b+(I^S&(A^I))+C[0]+3921069994&4294967295,b=A+(P<<20&4294967295|P>>>12),P=S+(A^I&(b^A))+C[5]+3593408605&4294967295,S=b+(P<<5&4294967295|P>>>27),P=I+(b^A&(S^b))+C[10]+38016083&4294967295,I=S+(P<<9&4294967295|P>>>23),P=A+(S^b&(I^S))+C[15]+3634488961&4294967295,A=I+(P<<14&4294967295|P>>>18),P=b+(I^S&(A^I))+C[4]+3889429448&4294967295,b=A+(P<<20&4294967295|P>>>12),P=S+(A^I&(b^A))+C[9]+568446438&4294967295,S=b+(P<<5&4294967295|P>>>27),P=I+(b^A&(S^b))+C[14]+3275163606&4294967295,I=S+(P<<9&4294967295|P>>>23),P=A+(S^b&(I^S))+C[3]+4107603335&4294967295,A=I+(P<<14&4294967295|P>>>18),P=b+(I^S&(A^I))+C[8]+1163531501&4294967295,b=A+(P<<20&4294967295|P>>>12),P=S+(A^I&(b^A))+C[13]+2850285829&4294967295,S=b+(P<<5&4294967295|P>>>27),P=I+(b^A&(S^b))+C[2]+4243563512&4294967295,I=S+(P<<9&4294967295|P>>>23),P=A+(S^b&(I^S))+C[7]+1735328473&4294967295,A=I+(P<<14&4294967295|P>>>18),P=b+(I^S&(A^I))+C[12]+2368359562&4294967295,b=A+(P<<20&4294967295|P>>>12),P=S+(b^A^I)+C[5]+4294588738&4294967295,S=b+(P<<4&4294967295|P>>>28),P=I+(S^b^A)+C[8]+2272392833&4294967295,I=S+(P<<11&4294967295|P>>>21),P=A+(I^S^b)+C[11]+1839030562&4294967295,A=I+(P<<16&4294967295|P>>>16),P=b+(A^I^S)+C[14]+4259657740&4294967295,b=A+(P<<23&4294967295|P>>>9),P=S+(b^A^I)+C[1]+2763975236&4294967295,S=b+(P<<4&4294967295|P>>>28),P=I+(S^b^A)+C[4]+1272893353&4294967295,I=S+(P<<11&4294967295|P>>>21),P=A+(I^S^b)+C[7]+4139469664&4294967295,A=I+(P<<16&4294967295|P>>>16),P=b+(A^I^S)+C[10]+3200236656&4294967295,b=A+(P<<23&4294967295|P>>>9),P=S+(b^A^I)+C[13]+681279174&4294967295,S=b+(P<<4&4294967295|P>>>28),P=I+(S^b^A)+C[0]+3936430074&4294967295,I=S+(P<<11&4294967295|P>>>21),P=A+(I^S^b)+C[3]+3572445317&4294967295,A=I+(P<<16&4294967295|P>>>16),P=b+(A^I^S)+C[6]+76029189&4294967295,b=A+(P<<23&4294967295|P>>>9),P=S+(b^A^I)+C[9]+3654602809&4294967295,S=b+(P<<4&4294967295|P>>>28),P=I+(S^b^A)+C[12]+3873151461&4294967295,I=S+(P<<11&4294967295|P>>>21),P=A+(I^S^b)+C[15]+530742520&4294967295,A=I+(P<<16&4294967295|P>>>16),P=b+(A^I^S)+C[2]+3299628645&4294967295,b=A+(P<<23&4294967295|P>>>9),P=S+(A^(b|~I))+C[0]+4096336452&4294967295,S=b+(P<<6&4294967295|P>>>26),P=I+(b^(S|~A))+C[7]+1126891415&4294967295,I=S+(P<<10&4294967295|P>>>22),P=A+(S^(I|~b))+C[14]+2878612391&4294967295,A=I+(P<<15&4294967295|P>>>17),P=b+(I^(A|~S))+C[5]+4237533241&4294967295,b=A+(P<<21&4294967295|P>>>11),P=S+(A^(b|~I))+C[12]+1700485571&4294967295,S=b+(P<<6&4294967295|P>>>26),P=I+(b^(S|~A))+C[3]+2399980690&4294967295,I=S+(P<<10&4294967295|P>>>22),P=A+(S^(I|~b))+C[10]+4293915773&4294967295,A=I+(P<<15&4294967295|P>>>17),P=b+(I^(A|~S))+C[1]+2240044497&4294967295,b=A+(P<<21&4294967295|P>>>11),P=S+(A^(b|~I))+C[8]+1873313359&4294967295,S=b+(P<<6&4294967295|P>>>26),P=I+(b^(S|~A))+C[15]+4264355552&4294967295,I=S+(P<<10&4294967295|P>>>22),P=A+(S^(I|~b))+C[6]+2734768916&4294967295,A=I+(P<<15&4294967295|P>>>17),P=b+(I^(A|~S))+C[13]+1309151649&4294967295,b=A+(P<<21&4294967295|P>>>11),P=S+(A^(b|~I))+C[4]+4149444226&4294967295,S=b+(P<<6&4294967295|P>>>26),P=I+(b^(S|~A))+C[11]+3174756917&4294967295,I=S+(P<<10&4294967295|P>>>22),P=A+(S^(I|~b))+C[2]+718787259&4294967295,A=I+(P<<15&4294967295|P>>>17),P=b+(I^(A|~S))+C[9]+3951481745&4294967295,k.g[0]=k.g[0]+S&4294967295,k.g[1]=k.g[1]+(A+(P<<21&4294967295|P>>>11))&4294967295,k.g[2]=k.g[2]+A&4294967295,k.g[3]=k.g[3]+I&4294967295}n.prototype.u=function(k,S){S===void 0&&(S=k.length);for(var b=S-this.blockSize,C=this.B,A=this.h,I=0;I<S;){if(A==0)for(;I<=b;)s(this,k,I),I+=this.blockSize;if(typeof k=="string"){for(;I<S;)if(C[A++]=k.charCodeAt(I++),A==this.blockSize){s(this,C),A=0;break}}else for(;I<S;)if(C[A++]=k[I++],A==this.blockSize){s(this,C),A=0;break}}this.h=A,this.o+=S},n.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var S=1;S<k.length-8;++S)k[S]=0;var b=8*this.o;for(S=k.length-8;S<k.length;++S)k[S]=b&255,b/=256;for(this.u(k),k=Array(16),S=b=0;4>S;++S)for(var C=0;32>C;C+=8)k[b++]=this.g[S]>>>C&255;return k};function i(k,S){var b=o;return Object.prototype.hasOwnProperty.call(b,k)?b[k]:b[k]=S(k)}function a(k,S){this.h=S;for(var b=[],C=!0,A=k.length-1;0<=A;A--){var I=k[A]|0;C&&I==S||(b[A]=I,C=!1)}this.g=b}var o={};function l(k){return-128<=k&&128>k?i(k,function(S){return new a([S|0],0>S?-1:0)}):new a([k|0],0>k?-1:0)}function u(k){if(isNaN(k)||!isFinite(k))return d;if(0>k)return y(u(-k));for(var S=[],b=1,C=0;k>=b;C++)S[C]=k/b|0,b*=4294967296;return new a(S,0)}function h(k,S){if(k.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(k.charAt(0)=="-")return y(h(k.substring(1),S));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var b=u(Math.pow(S,8)),C=d,A=0;A<k.length;A+=8){var I=Math.min(8,k.length-A),P=parseInt(k.substring(A,A+I),S);8>I?(I=u(Math.pow(S,I)),C=C.j(I).add(u(P))):(C=C.j(b),C=C.add(u(P)))}return C}var d=l(0),m=l(1),p=l(16777216);t=a.prototype,t.m=function(){if(g(this))return-y(this).m();for(var k=0,S=1,b=0;b<this.g.length;b++){var C=this.i(b);k+=(0<=C?C:4294967296+C)*S,S*=4294967296}return k},t.toString=function(k){if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(x(this))return"0";if(g(this))return"-"+y(this).toString(k);for(var S=u(Math.pow(k,6)),b=this,C="";;){var A=N(b,S).g;b=w(b,A.j(S));var I=((0<b.g.length?b.g[0]:b.h)>>>0).toString(k);if(b=A,x(b))return I+C;for(;6>I.length;)I="0"+I;C=I+C}},t.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h};function x(k){if(k.h!=0)return!1;for(var S=0;S<k.g.length;S++)if(k.g[S]!=0)return!1;return!0}function g(k){return k.h==-1}t.l=function(k){return k=w(this,k),g(k)?-1:x(k)?0:1};function y(k){for(var S=k.g.length,b=[],C=0;C<S;C++)b[C]=~k.g[C];return new a(b,~k.h).add(m)}t.abs=function(){return g(this)?y(this):this},t.add=function(k){for(var S=Math.max(this.g.length,k.g.length),b=[],C=0,A=0;A<=S;A++){var I=C+(this.i(A)&65535)+(k.i(A)&65535),P=(I>>>16)+(this.i(A)>>>16)+(k.i(A)>>>16);C=P>>>16,I&=65535,P&=65535,b[A]=P<<16|I}return new a(b,b[b.length-1]&-2147483648?-1:0)};function w(k,S){return k.add(y(S))}t.j=function(k){if(x(this)||x(k))return d;if(g(this))return g(k)?y(this).j(y(k)):y(y(this).j(k));if(g(k))return y(this.j(y(k)));if(0>this.l(p)&&0>k.l(p))return u(this.m()*k.m());for(var S=this.g.length+k.g.length,b=[],C=0;C<2*S;C++)b[C]=0;for(C=0;C<this.g.length;C++)for(var A=0;A<k.g.length;A++){var I=this.i(C)>>>16,P=this.i(C)&65535,ue=k.i(A)>>>16,de=k.i(A)&65535;b[2*C+2*A]+=P*de,E(b,2*C+2*A),b[2*C+2*A+1]+=I*de,E(b,2*C+2*A+1),b[2*C+2*A+1]+=P*ue,E(b,2*C+2*A+1),b[2*C+2*A+2]+=I*ue,E(b,2*C+2*A+2)}for(C=0;C<S;C++)b[C]=b[2*C+1]<<16|b[2*C];for(C=S;C<2*S;C++)b[C]=0;return new a(b,0)};function E(k,S){for(;(k[S]&65535)!=k[S];)k[S+1]+=k[S]>>>16,k[S]&=65535,S++}function _(k,S){this.g=k,this.h=S}function N(k,S){if(x(S))throw Error("division by zero");if(x(k))return new _(d,d);if(g(k))return S=N(y(k),S),new _(y(S.g),y(S.h));if(g(S))return S=N(k,y(S)),new _(y(S.g),S.h);if(30<k.g.length){if(g(k)||g(S))throw Error("slowDivide_ only works with positive integers.");for(var b=m,C=S;0>=C.l(k);)b=j(b),C=j(C);var A=D(b,1),I=D(C,1);for(C=D(C,2),b=D(b,2);!x(C);){var P=I.add(C);0>=P.l(k)&&(A=A.add(b),I=P),C=D(C,1),b=D(b,1)}return S=w(k,A.j(S)),new _(A,S)}for(A=d;0<=k.l(S);){for(b=Math.max(1,Math.floor(k.m()/S.m())),C=Math.ceil(Math.log(b)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),I=u(b),P=I.j(S);g(P)||0<P.l(k);)b-=C,I=u(b),P=I.j(S);x(I)&&(I=m),A=A.add(I),k=w(k,P)}return new _(A,k)}t.A=function(k){return N(this,k).h},t.and=function(k){for(var S=Math.max(this.g.length,k.g.length),b=[],C=0;C<S;C++)b[C]=this.i(C)&k.i(C);return new a(b,this.h&k.h)},t.or=function(k){for(var S=Math.max(this.g.length,k.g.length),b=[],C=0;C<S;C++)b[C]=this.i(C)|k.i(C);return new a(b,this.h|k.h)},t.xor=function(k){for(var S=Math.max(this.g.length,k.g.length),b=[],C=0;C<S;C++)b[C]=this.i(C)^k.i(C);return new a(b,this.h^k.h)};function j(k){for(var S=k.g.length+1,b=[],C=0;C<S;C++)b[C]=k.i(C)<<1|k.i(C-1)>>>31;return new a(b,k.h)}function D(k,S){var b=S>>5;S%=32;for(var C=k.g.length-b,A=[],I=0;I<C;I++)A[I]=0<S?k.i(I+b)>>>S|k.i(I+b+1)<<32-S:k.i(I+b);return new a(A,k.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,vk=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=h,so=a}).apply(typeof py<"u"?py:typeof self<"u"?self:typeof window<"u"?window:{});var th=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var yk,jc,wk,Ih,Yp,_k,Ek,kk;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,v,T){return f==Array.prototype||f==Object.prototype||(f[v]=T.value),f};function r(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof th=="object"&&th];for(var v=0;v<f.length;++v){var T=f[v];if(T&&T.Math==Math)return T}throw Error("Cannot find global object")}var n=r(this);function s(f,v){if(v)e:{var T=n;f=f.split(".");for(var L=0;L<f.length-1;L++){var ee=f[L];if(!(ee in T))break e;T=T[ee]}f=f[f.length-1],L=T[f],v=v(L),v!=L&&v!=null&&e(T,f,{configurable:!0,writable:!0,value:v})}}function i(f,v){f instanceof String&&(f+="");var T=0,L=!1,ee={next:function(){if(!L&&T<f.length){var se=T++;return{value:v(se,f[se]),done:!1}}return L=!0,{done:!0,value:void 0}}};return ee[Symbol.iterator]=function(){return ee},ee}s("Array.prototype.values",function(f){return f||function(){return i(this,function(v,T){return T})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(f){var v=typeof f;return v=v!="object"?v:f?Array.isArray(f)?"array":v:"null",v=="array"||v=="object"&&typeof f.length=="number"}function u(f){var v=typeof f;return v=="object"&&f!=null||v=="function"}function h(f,v,T){return f.call.apply(f.bind,arguments)}function d(f,v,T){if(!f)throw Error();if(2<arguments.length){var L=Array.prototype.slice.call(arguments,2);return function(){var ee=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ee,L),f.apply(v,ee)}}return function(){return f.apply(v,arguments)}}function m(f,v,T){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:d,m.apply(null,arguments)}function p(f,v){var T=Array.prototype.slice.call(arguments,1);return function(){var L=T.slice();return L.push.apply(L,arguments),f.apply(this,L)}}function x(f,v){function T(){}T.prototype=v.prototype,f.aa=v.prototype,f.prototype=new T,f.prototype.constructor=f,f.Qb=function(L,ee,se){for(var Ie=Array(arguments.length-2),jt=2;jt<arguments.length;jt++)Ie[jt-2]=arguments[jt];return v.prototype[ee].apply(L,Ie)}}function g(f){const v=f.length;if(0<v){const T=Array(v);for(let L=0;L<v;L++)T[L]=f[L];return T}return[]}function y(f,v){for(let T=1;T<arguments.length;T++){const L=arguments[T];if(l(L)){const ee=f.length||0,se=L.length||0;f.length=ee+se;for(let Ie=0;Ie<se;Ie++)f[ee+Ie]=L[Ie]}else f.push(L)}}class w{constructor(v,T){this.i=v,this.j=T,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function E(f){return/^[\s\xa0]*$/.test(f)}function _(){var f=o.navigator;return f&&(f=f.userAgent)?f:""}function N(f){return N[" "](f),f}N[" "]=function(){};var j=_().indexOf("Gecko")!=-1&&!(_().toLowerCase().indexOf("webkit")!=-1&&_().indexOf("Edge")==-1)&&!(_().indexOf("Trident")!=-1||_().indexOf("MSIE")!=-1)&&_().indexOf("Edge")==-1;function D(f,v,T){for(const L in f)v.call(T,f[L],L,f)}function k(f,v){for(const T in f)v.call(void 0,f[T],T,f)}function S(f){const v={};for(const T in f)v[T]=f[T];return v}const b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(f,v){let T,L;for(let ee=1;ee<arguments.length;ee++){L=arguments[ee];for(T in L)f[T]=L[T];for(let se=0;se<b.length;se++)T=b[se],Object.prototype.hasOwnProperty.call(L,T)&&(f[T]=L[T])}}function A(f){var v=1;f=f.split(":");const T=[];for(;0<v&&f.length;)T.push(f.shift()),v--;return f.length&&T.push(f.join(":")),T}function I(f){o.setTimeout(()=>{throw f},0)}function P(){var f=K;let v=null;return f.g&&(v=f.g,f.g=f.g.next,f.g||(f.h=null),v.next=null),v}class ue{constructor(){this.h=this.g=null}add(v,T){const L=de.get();L.set(v,T),this.h?this.h.next=L:this.g=L,this.h=L}}var de=new w(()=>new ie,f=>f.reset());class ie{constructor(){this.next=this.g=this.h=null}set(v,T){this.h=v,this.g=T,this.next=null}reset(){this.next=this.g=this.h=null}}let ge,ne=!1,K=new ue,fe=()=>{const f=o.Promise.resolve(void 0);ge=()=>{f.then(_e)}};var _e=()=>{for(var f;f=P();){try{f.h.call(f.g)}catch(T){I(T)}var v=de;v.j(f),100>v.h&&(v.h++,f.next=v.g,v.g=f)}ne=!1};function B(){this.s=this.s,this.C=this.C}B.prototype.s=!1,B.prototype.ma=function(){this.s||(this.s=!0,this.N())},B.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function q(f,v){this.type=f,this.g=this.target=v,this.defaultPrevented=!1}q.prototype.h=function(){this.defaultPrevented=!0};var H=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var f=!1,v=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const T=()=>{};o.addEventListener("test",T,v),o.removeEventListener("test",T,v)}catch{}return f}();function G(f,v){if(q.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var T=this.type=f.type,L=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=v,v=f.relatedTarget){if(j){e:{try{N(v.nodeName);var ee=!0;break e}catch{}ee=!1}ee||(v=null)}}else T=="mouseover"?v=f.fromElement:T=="mouseout"&&(v=f.toElement);this.relatedTarget=v,L?(this.clientX=L.clientX!==void 0?L.clientX:L.pageX,this.clientY=L.clientY!==void 0?L.clientY:L.pageY,this.screenX=L.screenX||0,this.screenY=L.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:J[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&G.aa.h.call(this)}}x(G,q);var J={2:"touch",3:"pen",4:"mouse"};G.prototype.h=function(){G.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var ae="closure_listenable_"+(1e6*Math.random()|0),re=0;function he(f,v,T,L,ee){this.listener=f,this.proxy=null,this.src=v,this.type=T,this.capture=!!L,this.ha=ee,this.key=++re,this.da=this.fa=!1}function oe(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Pe(f){this.src=f,this.g={},this.h=0}Pe.prototype.add=function(f,v,T,L,ee){var se=f.toString();f=this.g[se],f||(f=this.g[se]=[],this.h++);var Ie=$e(f,v,L,ee);return-1<Ie?(v=f[Ie],T||(v.fa=!1)):(v=new he(v,this.src,se,!!L,ee),v.fa=T,f.push(v)),v};function W(f,v){var T=v.type;if(T in f.g){var L=f.g[T],ee=Array.prototype.indexOf.call(L,v,void 0),se;(se=0<=ee)&&Array.prototype.splice.call(L,ee,1),se&&(oe(v),f.g[T].length==0&&(delete f.g[T],f.h--))}}function $e(f,v,T,L){for(var ee=0;ee<f.length;++ee){var se=f[ee];if(!se.da&&se.listener==v&&se.capture==!!T&&se.ha==L)return ee}return-1}var Oe="closure_lm_"+(1e6*Math.random()|0),We={};function Ue(f,v,T,L,ee){if(L&&L.once)return ye(f,v,T,L,ee);if(Array.isArray(v)){for(var se=0;se<v.length;se++)Ue(f,v[se],T,L,ee);return null}return T=Et(T),f&&f[ae]?f.K(v,T,u(L)?!!L.capture:!!L,ee):Te(f,v,T,!1,L,ee)}function Te(f,v,T,L,ee,se){if(!v)throw Error("Invalid event type");var Ie=u(ee)?!!ee.capture:!!ee,jt=_t(f);if(jt||(f[Oe]=jt=new Pe(f)),T=jt.add(v,T,L,Ie,se),T.proxy)return T;if(L=Ae(),T.proxy=L,L.src=f,L.listener=T,f.addEventListener)H||(ee=Ie),ee===void 0&&(ee=!1),f.addEventListener(v.toString(),L,ee);else if(f.attachEvent)f.attachEvent(bt(v.toString()),L);else if(f.addListener&&f.removeListener)f.addListener(L);else throw Error("addEventListener and attachEvent are unavailable.");return T}function Ae(){function f(T){return v.call(f.src,f.listener,T)}const v=Mt;return f}function ye(f,v,T,L,ee){if(Array.isArray(v)){for(var se=0;se<v.length;se++)ye(f,v[se],T,L,ee);return null}return T=Et(T),f&&f[ae]?f.L(v,T,u(L)?!!L.capture:!!L,ee):Te(f,v,T,!0,L,ee)}function De(f,v,T,L,ee){if(Array.isArray(v))for(var se=0;se<v.length;se++)De(f,v[se],T,L,ee);else L=u(L)?!!L.capture:!!L,T=Et(T),f&&f[ae]?(f=f.i,v=String(v).toString(),v in f.g&&(se=f.g[v],T=$e(se,T,L,ee),-1<T&&(oe(se[T]),Array.prototype.splice.call(se,T,1),se.length==0&&(delete f.g[v],f.h--)))):f&&(f=_t(f))&&(v=f.g[v.toString()],f=-1,v&&(f=$e(v,T,L,ee)),(T=-1<f?v[f]:null)&&st(T))}function st(f){if(typeof f!="number"&&f&&!f.da){var v=f.src;if(v&&v[ae])W(v.i,f);else{var T=f.type,L=f.proxy;v.removeEventListener?v.removeEventListener(T,L,f.capture):v.detachEvent?v.detachEvent(bt(T),L):v.addListener&&v.removeListener&&v.removeListener(L),(T=_t(v))?(W(T,f),T.h==0&&(T.src=null,v[Oe]=null)):oe(f)}}}function bt(f){return f in We?We[f]:We[f]="on"+f}function Mt(f,v){if(f.da)f=!0;else{v=new G(v,this);var T=f.listener,L=f.ha||f.src;f.fa&&st(f),f=T.call(L,v)}return f}function _t(f){return f=f[Oe],f instanceof Pe?f:null}var er="__closure_events_fn_"+(1e9*Math.random()>>>0);function Et(f){return typeof f=="function"?f:(f[er]||(f[er]=function(v){return f.handleEvent(v)}),f[er])}function kt(){B.call(this),this.i=new Pe(this),this.M=this,this.F=null}x(kt,B),kt.prototype[ae]=!0,kt.prototype.removeEventListener=function(f,v,T,L){De(this,f,v,T,L)};function Xe(f,v){var T,L=f.F;if(L)for(T=[];L;L=L.F)T.push(L);if(f=f.M,L=v.type||v,typeof v=="string")v=new q(v,f);else if(v instanceof q)v.target=v.target||f;else{var ee=v;v=new q(L,f),C(v,ee)}if(ee=!0,T)for(var se=T.length-1;0<=se;se--){var Ie=v.g=T[se];ee=Gt(Ie,L,!0,v)&&ee}if(Ie=v.g=f,ee=Gt(Ie,L,!0,v)&&ee,ee=Gt(Ie,L,!1,v)&&ee,T)for(se=0;se<T.length;se++)Ie=v.g=T[se],ee=Gt(Ie,L,!1,v)&&ee}kt.prototype.N=function(){if(kt.aa.N.call(this),this.i){var f=this.i,v;for(v in f.g){for(var T=f.g[v],L=0;L<T.length;L++)oe(T[L]);delete f.g[v],f.h--}}this.F=null},kt.prototype.K=function(f,v,T,L){return this.i.add(String(f),v,!1,T,L)},kt.prototype.L=function(f,v,T,L){return this.i.add(String(f),v,!0,T,L)};function Gt(f,v,T,L){if(v=f.i.g[String(v)],!v)return!0;v=v.concat();for(var ee=!0,se=0;se<v.length;++se){var Ie=v[se];if(Ie&&!Ie.da&&Ie.capture==T){var jt=Ie.listener,Ur=Ie.ha||Ie.src;Ie.fa&&W(f.i,Ie),ee=jt.call(Ur,L)!==!1&&ee}}return ee&&!L.defaultPrevented}function ze(f,v,T){if(typeof f=="function")T&&(f=m(f,T));else if(f&&typeof f.handleEvent=="function")f=m(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:o.setTimeout(f,v||0)}function xt(f){f.g=ze(()=>{f.g=null,f.i&&(f.i=!1,xt(f))},f.l);const v=f.h;f.h=null,f.m.apply(null,v)}class Tt extends B{constructor(v,T){super(),this.m=v,this.l=T,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:xt(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Se(f){B.call(this),this.h=f,this.g={}}x(Se,B);var Ze=[];function _r(f){D(f.g,function(v,T){this.g.hasOwnProperty(T)&&st(v)},f),f.g={}}Se.prototype.N=function(){Se.aa.N.call(this),_r(this)},Se.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var dt=o.JSON.stringify,Ct=o.JSON.parse,Er=class{stringify(f){return o.JSON.stringify(f,void 0)}parse(f){return o.JSON.parse(f,void 0)}};function kr(){}kr.prototype.h=null;function ke(f){return f.h||(f.h=f.i())}function ut(){}var Br={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ir(){q.call(this,"d")}x(Ir,q);function Zr(){q.call(this,"c")}x(Zr,q);var xs={},zo=null;function Ui(){return zo=zo||new kt}xs.La="serverreachability";function Va(f){q.call(this,xs.La,f)}x(Va,q);function Ms(f){const v=Ui();Xe(v,new Va(v))}xs.STAT_EVENT="statevent";function Ua(f,v){q.call(this,xs.STAT_EVENT,f),this.stat=v}x(Ua,q);function Tr(f){const v=Ui();Xe(v,new Ua(v,f))}xs.Ma="timingevent";function $i(f,v){q.call(this,xs.Ma,f),this.size=v}x($i,q);function ui(f,v){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){f()},v)}function hi(){this.g=!0}hi.prototype.xa=function(){this.g=!1};function hc(f,v,T,L,ee,se){f.info(function(){if(f.g)if(se)for(var Ie="",jt=se.split("&"),Ur=0;Ur<jt.length;Ur++){var vt=jt[Ur].split("=");if(1<vt.length){var en=vt[0];vt=vt[1];var tn=en.split("_");Ie=2<=tn.length&&tn[1]=="type"?Ie+(en+"="+vt+"&"):Ie+(en+"=redacted&")}}else Ie=null;else Ie=se;return"XMLHTTP REQ ("+L+") [attempt "+ee+"]: "+v+`
`+T+`
`+Ie})}function R(f,v,T,L,ee,se,Ie){f.info(function(){return"XMLHTTP RESP ("+L+") [ attempt "+ee+"]: "+v+`
`+T+`
`+se+" "+Ie})}function V(f,v,T,L){f.info(function(){return"XMLHTTP TEXT ("+v+"): "+M(f,T)+(L?" "+L:"")})}function O(f,v){f.info(function(){return"TIMEOUT: "+v})}hi.prototype.info=function(){};function M(f,v){if(!f.g)return v;if(!v)return null;try{var T=JSON.parse(v);if(T){for(f=0;f<T.length;f++)if(Array.isArray(T[f])){var L=T[f];if(!(2>L.length)){var ee=L[1];if(Array.isArray(ee)&&!(1>ee.length)){var se=ee[0];if(se!="noop"&&se!="stop"&&se!="close")for(var Ie=1;Ie<ee.length;Ie++)ee[Ie]=""}}}}return dt(T)}catch{return v}}var U={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},z={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},te;function X(){}x(X,kr),X.prototype.g=function(){return new XMLHttpRequest},X.prototype.i=function(){return{}},te=new X;function Q(f,v,T,L){this.j=f,this.i=v,this.l=T,this.R=L||1,this.U=new Se(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Y}function Y(){this.i=null,this.g="",this.h=!1}var Z={},ce={};function xe(f,v,T){f.L=1,f.v=Au(fi(v)),f.m=T,f.P=!0,Ne(f,null)}function Ne(f,v){f.F=Date.now(),Be(f),f.A=fi(f.v);var T=f.A,L=f.R;Array.isArray(L)||(L=[String(L)]),wv(T.i,"t",L),f.C=0,T=f.j.J,f.h=new Y,f.g=Mv(f.j,T?v:null,!f.m),0<f.O&&(f.M=new Tt(m(f.Y,f,f.g),f.O)),v=f.U,T=f.g,L=f.ca;var ee="readystatechange";Array.isArray(ee)||(ee&&(Ze[0]=ee.toString()),ee=Ze);for(var se=0;se<ee.length;se++){var Ie=Ue(T,ee[se],L||v.handleEvent,!1,v.h||v);if(!Ie)break;v.g[Ie.key]=Ie}v=f.H?S(f.H):{},f.m?(f.u||(f.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,v)):(f.u="GET",f.g.ea(f.A,f.u,null,v)),Ms(),hc(f.i,f.u,f.A,f.l,f.R,f.m)}Q.prototype.ca=function(f){f=f.target;const v=this.M;v&&di(f)==3?v.j():this.Y(f)},Q.prototype.Y=function(f){try{if(f==this.g)e:{const tn=di(this.g);var v=this.g.Ba();const qo=this.g.Z();if(!(3>tn)&&(tn!=3||this.g&&(this.h.h||this.g.oa()||Cv(this.g)))){this.J||tn!=4||v==7||(v==8||0>=qo?Ms(3):Ms(2)),et(this);var T=this.g.Z();this.X=T;t:if(we(this)){var L=Cv(this.g);f="";var ee=L.length,se=di(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Vr(this),ot(this);var Ie="";break t}this.h.i=new o.TextDecoder}for(v=0;v<ee;v++)this.h.h=!0,f+=this.h.i.decode(L[v],{stream:!(se&&v==ee-1)});L.length=0,this.h.g+=f,this.C=0,Ie=this.h.g}else Ie=this.g.oa();if(this.o=T==200,R(this.i,this.u,this.A,this.l,this.R,tn,T),this.o){if(this.T&&!this.K){t:{if(this.g){var jt,Ur=this.g;if((jt=Ur.g?Ur.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(jt)){var vt=jt;break t}}vt=null}if(T=vt)V(this.i,this.l,T,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,vs(this,T);else{this.o=!1,this.s=3,Tr(12),Vr(this),ot(this);break e}}if(this.P){T=!0;let ys;for(;!this.J&&this.C<Ie.length;)if(ys=Re(this,Ie),ys==ce){tn==4&&(this.s=4,Tr(14),T=!1),V(this.i,this.l,null,"[Incomplete Response]");break}else if(ys==Z){this.s=4,Tr(15),V(this.i,this.l,Ie,"[Invalid Chunk]"),T=!1;break}else V(this.i,this.l,ys,null),vs(this,ys);if(we(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),tn!=4||Ie.length!=0||this.h.h||(this.s=1,Tr(16),T=!1),this.o=this.o&&T,!T)V(this.i,this.l,Ie,"[Invalid Chunked Response]"),Vr(this),ot(this);else if(0<Ie.length&&!this.W){this.W=!0;var en=this.j;en.g==this&&en.ba&&!en.M&&(en.j.info("Great, no buffering proxy detected. Bytes received: "+Ie.length),Kd(en),en.M=!0,Tr(11))}}else V(this.i,this.l,Ie,null),vs(this,Ie);tn==4&&Vr(this),this.o&&!this.J&&(tn==4?Lv(this.j,this):(this.o=!1,Be(this)))}else pC(this.g),T==400&&0<Ie.indexOf("Unknown SID")?(this.s=3,Tr(12)):(this.s=0,Tr(13)),Vr(this),ot(this)}}}catch{}finally{}};function we(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function Re(f,v){var T=f.C,L=v.indexOf(`
`,T);return L==-1?ce:(T=Number(v.substring(T,L)),isNaN(T)?Z:(L+=1,L+T>v.length?ce:(v=v.slice(L,L+T),f.C=L+T,v)))}Q.prototype.cancel=function(){this.J=!0,Vr(this)};function Be(f){f.S=Date.now()+f.I,Nt(f,f.I)}function Nt(f,v){if(f.B!=null)throw Error("WatchDog timer not null");f.B=ui(m(f.ba,f),v)}function et(f){f.B&&(o.clearTimeout(f.B),f.B=null)}Q.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(O(this.i,this.A),this.L!=2&&(Ms(),Tr(17)),Vr(this),this.s=2,ot(this)):Nt(this,this.S-f)};function ot(f){f.j.G==0||f.J||Lv(f.j,f)}function Vr(f){et(f);var v=f.M;v&&typeof v.ma=="function"&&v.ma(),f.M=null,_r(f.U),f.g&&(v=f.g,f.g=null,v.abort(),v.ma())}function vs(f,v){try{var T=f.j;if(T.G!=0&&(T.g==f||$d(T.h,f))){if(!f.K&&$d(T.h,f)&&T.G==3){try{var L=T.Da.g.parse(v)}catch{L=null}if(Array.isArray(L)&&L.length==3){var ee=L;if(ee[0]==0){e:if(!T.u){if(T.g)if(T.g.F+3e3<f.F)Du(T),Fu(T);else break e;Gd(T),Tr(18)}}else T.za=ee[1],0<T.za-T.T&&37500>ee[2]&&T.F&&T.v==0&&!T.C&&(T.C=ui(m(T.Za,T),6e3));if(1>=Jn(T.h)&&T.ca){try{T.ca()}catch{}T.ca=void 0}}else za(T,11)}else if((f.K||T.g==f)&&Du(T),!E(v))for(ee=T.Da.g.parse(v),v=0;v<ee.length;v++){let vt=ee[v];if(T.T=vt[0],vt=vt[1],T.G==2)if(vt[0]=="c"){T.K=vt[1],T.ia=vt[2];const en=vt[3];en!=null&&(T.la=en,T.j.info("VER="+T.la));const tn=vt[4];tn!=null&&(T.Aa=tn,T.j.info("SVER="+T.Aa));const qo=vt[5];qo!=null&&typeof qo=="number"&&0<qo&&(L=1.5*qo,T.L=L,T.j.info("backChannelRequestTimeoutMs_="+L)),L=T;const ys=f.g;if(ys){const Ou=ys.g?ys.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ou){var se=L.h;se.g||Ou.indexOf("spdy")==-1&&Ou.indexOf("quic")==-1&&Ou.indexOf("h2")==-1||(se.j=se.l,se.g=new Set,se.h&&(Wd(se,se.h),se.h=null))}if(L.D){const qd=ys.g?ys.g.getResponseHeader("X-HTTP-Session-Id"):null;qd&&(L.ya=qd,Bt(L.I,L.D,qd))}}T.G=3,T.l&&T.l.ua(),T.ba&&(T.R=Date.now()-f.F,T.j.info("Handshake RTT: "+T.R+"ms")),L=T;var Ie=f;if(L.qa=Ov(L,L.J?L.ia:null,L.W),Ie.K){fv(L.h,Ie);var jt=Ie,Ur=L.L;Ur&&(jt.I=Ur),jt.B&&(et(jt),Be(jt)),L.g=Ie}else Pv(L);0<T.i.length&&Lu(T)}else vt[0]!="stop"&&vt[0]!="close"||za(T,7);else T.G==3&&(vt[0]=="stop"||vt[0]=="close"?vt[0]=="stop"?za(T,7):Hd(T):vt[0]!="noop"&&T.l&&T.l.ta(vt),T.v=0)}}Ms(4)}catch{}}var $a=class{constructor(f,v){this.g=f,this.map=v}};function Bs(f){this.l=f||10,o.PerformanceNavigationTiming?(f=o.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ho(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Jn(f){return f.h?1:f.g?f.g.size:0}function $d(f,v){return f.h?f.h==v:f.g?f.g.has(v):!1}function Wd(f,v){f.g?f.g.add(v):f.h=v}function fv(f,v){f.h&&f.h==v?f.h=null:f.g&&f.g.has(v)&&f.g.delete(v)}Bs.prototype.cancel=function(){if(this.i=dv(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function dv(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let v=f.i;for(const T of f.g.values())v=v.concat(T.D);return v}return g(f.i)}function eC(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(l(f)){for(var v=[],T=f.length,L=0;L<T;L++)v.push(f[L]);return v}v=[],T=0;for(L in f)v[T++]=f[L];return v}function tC(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(l(f)||typeof f=="string"){var v=[];f=f.length;for(var T=0;T<f;T++)v.push(T);return v}v=[],T=0;for(const L in f)v[T++]=L;return v}}}function mv(f,v){if(f.forEach&&typeof f.forEach=="function")f.forEach(v,void 0);else if(l(f)||typeof f=="string")Array.prototype.forEach.call(f,v,void 0);else for(var T=tC(f),L=eC(f),ee=L.length,se=0;se<ee;se++)v.call(void 0,L[se],T&&T[se],f)}var pv=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function rC(f,v){if(f){f=f.split("&");for(var T=0;T<f.length;T++){var L=f[T].indexOf("="),ee=null;if(0<=L){var se=f[T].substring(0,L);ee=f[T].substring(L+1)}else se=f[T];v(se,ee?decodeURIComponent(ee.replace(/\+/g," ")):"")}}}function Wa(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof Wa){this.h=f.h,Cu(this,f.j),this.o=f.o,this.g=f.g,Nu(this,f.s),this.l=f.l;var v=f.i,T=new mc;T.i=v.i,v.g&&(T.g=new Map(v.g),T.h=v.h),gv(this,T),this.m=f.m}else f&&(v=String(f).match(pv))?(this.h=!1,Cu(this,v[1]||"",!0),this.o=fc(v[2]||""),this.g=fc(v[3]||"",!0),Nu(this,v[4]),this.l=fc(v[5]||"",!0),gv(this,v[6]||"",!0),this.m=fc(v[7]||"")):(this.h=!1,this.i=new mc(null,this.h))}Wa.prototype.toString=function(){var f=[],v=this.j;v&&f.push(dc(v,xv,!0),":");var T=this.g;return(T||v=="file")&&(f.push("//"),(v=this.o)&&f.push(dc(v,xv,!0),"@"),f.push(encodeURIComponent(String(T)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),T=this.s,T!=null&&f.push(":",String(T))),(T=this.l)&&(this.g&&T.charAt(0)!="/"&&f.push("/"),f.push(dc(T,T.charAt(0)=="/"?iC:sC,!0))),(T=this.i.toString())&&f.push("?",T),(T=this.m)&&f.push("#",dc(T,oC)),f.join("")};function fi(f){return new Wa(f)}function Cu(f,v,T){f.j=T?fc(v,!0):v,f.j&&(f.j=f.j.replace(/:$/,""))}function Nu(f,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);f.s=v}else f.s=null}function gv(f,v,T){v instanceof mc?(f.i=v,lC(f.i,f.h)):(T||(v=dc(v,aC)),f.i=new mc(v,f.h))}function Bt(f,v,T){f.i.set(v,T)}function Au(f){return Bt(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function fc(f,v){return f?v?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function dc(f,v,T){return typeof f=="string"?(f=encodeURI(f).replace(v,nC),T&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function nC(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var xv=/[#\/\?@]/g,sC=/[#\?:]/g,iC=/[#\?]/g,aC=/[#\?@]/g,oC=/#/g;function mc(f,v){this.h=this.g=null,this.i=f||null,this.j=!!v}function Wi(f){f.g||(f.g=new Map,f.h=0,f.i&&rC(f.i,function(v,T){f.add(decodeURIComponent(v.replace(/\+/g," ")),T)}))}t=mc.prototype,t.add=function(f,v){Wi(this),this.i=null,f=Go(this,f);var T=this.g.get(f);return T||this.g.set(f,T=[]),T.push(v),this.h+=1,this};function vv(f,v){Wi(f),v=Go(f,v),f.g.has(v)&&(f.i=null,f.h-=f.g.get(v).length,f.g.delete(v))}function yv(f,v){return Wi(f),v=Go(f,v),f.g.has(v)}t.forEach=function(f,v){Wi(this),this.g.forEach(function(T,L){T.forEach(function(ee){f.call(v,ee,L,this)},this)},this)},t.na=function(){Wi(this);const f=Array.from(this.g.values()),v=Array.from(this.g.keys()),T=[];for(let L=0;L<v.length;L++){const ee=f[L];for(let se=0;se<ee.length;se++)T.push(v[L])}return T},t.V=function(f){Wi(this);let v=[];if(typeof f=="string")yv(this,f)&&(v=v.concat(this.g.get(Go(this,f))));else{f=Array.from(this.g.values());for(let T=0;T<f.length;T++)v=v.concat(f[T])}return v},t.set=function(f,v){return Wi(this),this.i=null,f=Go(this,f),yv(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[v]),this.h+=1,this},t.get=function(f,v){return f?(f=this.V(f),0<f.length?String(f[0]):v):v};function wv(f,v,T){vv(f,v),0<T.length&&(f.i=null,f.g.set(Go(f,v),g(T)),f.h+=T.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],v=Array.from(this.g.keys());for(var T=0;T<v.length;T++){var L=v[T];const se=encodeURIComponent(String(L)),Ie=this.V(L);for(L=0;L<Ie.length;L++){var ee=se;Ie[L]!==""&&(ee+="="+encodeURIComponent(String(Ie[L]))),f.push(ee)}}return this.i=f.join("&")};function Go(f,v){return v=String(v),f.j&&(v=v.toLowerCase()),v}function lC(f,v){v&&!f.j&&(Wi(f),f.i=null,f.g.forEach(function(T,L){var ee=L.toLowerCase();L!=ee&&(vv(this,L),wv(this,ee,T))},f)),f.j=v}function cC(f,v){const T=new hi;if(o.Image){const L=new Image;L.onload=p(zi,T,"TestLoadImage: loaded",!0,v,L),L.onerror=p(zi,T,"TestLoadImage: error",!1,v,L),L.onabort=p(zi,T,"TestLoadImage: abort",!1,v,L),L.ontimeout=p(zi,T,"TestLoadImage: timeout",!1,v,L),o.setTimeout(function(){L.ontimeout&&L.ontimeout()},1e4),L.src=f}else v(!1)}function uC(f,v){const T=new hi,L=new AbortController,ee=setTimeout(()=>{L.abort(),zi(T,"TestPingServer: timeout",!1,v)},1e4);fetch(f,{signal:L.signal}).then(se=>{clearTimeout(ee),se.ok?zi(T,"TestPingServer: ok",!0,v):zi(T,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(ee),zi(T,"TestPingServer: error",!1,v)})}function zi(f,v,T,L,ee){try{ee&&(ee.onload=null,ee.onerror=null,ee.onabort=null,ee.ontimeout=null),L(T)}catch{}}function hC(){this.g=new Er}function fC(f,v,T){const L=T||"";try{mv(f,function(ee,se){let Ie=ee;u(ee)&&(Ie=dt(ee)),v.push(L+se+"="+encodeURIComponent(Ie))})}catch(ee){throw v.push(L+"type="+encodeURIComponent("_badmap")),ee}}function Iu(f){this.l=f.Ub||null,this.j=f.eb||!1}x(Iu,kr),Iu.prototype.g=function(){return new Ru(this.l,this.j)},Iu.prototype.i=function(f){return function(){return f}}({});function Ru(f,v){kt.call(this),this.D=f,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(Ru,kt),t=Ru.prototype,t.open=function(f,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=v,this.readyState=1,gc(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(v.body=f),(this.D||o).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,pc(this)),this.readyState=0},t.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,gc(this)),this.g&&(this.readyState=3,gc(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;_v(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function _v(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}t.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var v=f.value?f.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!f.done}))&&(this.response=this.responseText+=v)}f.done?pc(this):gc(this),this.readyState==3&&_v(this)}},t.Ra=function(f){this.g&&(this.response=this.responseText=f,pc(this))},t.Qa=function(f){this.g&&(this.response=f,pc(this))},t.ga=function(){this.g&&pc(this)};function pc(f){f.readyState=4,f.l=null,f.j=null,f.v=null,gc(f)}t.setRequestHeader=function(f,v){this.u.append(f,v)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],v=this.h.entries();for(var T=v.next();!T.done;)T=T.value,f.push(T[0]+": "+T[1]),T=v.next();return f.join(`\r
`)};function gc(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Ru.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function Ev(f){let v="";return D(f,function(T,L){v+=L,v+=":",v+=T,v+=`\r
`}),v}function zd(f,v,T){e:{for(L in T){var L=!1;break e}L=!0}L||(T=Ev(T),typeof f=="string"?T!=null&&encodeURIComponent(String(T)):Bt(f,v,T))}function tr(f){kt.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(tr,kt);var dC=/^https?$/i,mC=["POST","PUT"];t=tr.prototype,t.Ha=function(f){this.J=f},t.ea=function(f,v,T,L){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);v=v?v.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():te.g(),this.v=this.o?ke(this.o):ke(te),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(v,String(f),!0),this.B=!1}catch(se){kv(this,se);return}if(f=T||"",T=new Map(this.headers),L)if(Object.getPrototypeOf(L)===Object.prototype)for(var ee in L)T.set(ee,L[ee]);else if(typeof L.keys=="function"&&typeof L.get=="function")for(const se of L.keys())T.set(se,L.get(se));else throw Error("Unknown input type for opt_headers: "+String(L));L=Array.from(T.keys()).find(se=>se.toLowerCase()=="content-type"),ee=o.FormData&&f instanceof o.FormData,!(0<=Array.prototype.indexOf.call(mC,v,void 0))||L||ee||T.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[se,Ie]of T)this.g.setRequestHeader(se,Ie);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{bv(this),this.u=!0,this.g.send(f),this.u=!1}catch(se){kv(this,se)}};function kv(f,v){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=v,f.m=5,Tv(f),Pu(f)}function Tv(f){f.A||(f.A=!0,Xe(f,"complete"),Xe(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,Xe(this,"complete"),Xe(this,"abort"),Pu(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Pu(this,!0)),tr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Sv(this):this.bb())},t.bb=function(){Sv(this)};function Sv(f){if(f.h&&typeof a<"u"&&(!f.v[1]||di(f)!=4||f.Z()!=2)){if(f.u&&di(f)==4)ze(f.Ea,0,f);else if(Xe(f,"readystatechange"),di(f)==4){f.h=!1;try{const Ie=f.Z();e:switch(Ie){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var T;if(!(T=v)){var L;if(L=Ie===0){var ee=String(f.D).match(pv)[1]||null;!ee&&o.self&&o.self.location&&(ee=o.self.location.protocol.slice(0,-1)),L=!dC.test(ee?ee.toLowerCase():"")}T=L}if(T)Xe(f,"complete"),Xe(f,"success");else{f.m=6;try{var se=2<di(f)?f.g.statusText:""}catch{se=""}f.l=se+" ["+f.Z()+"]",Tv(f)}}finally{Pu(f)}}}}function Pu(f,v){if(f.g){bv(f);const T=f.g,L=f.v[0]?()=>{}:null;f.g=null,f.v=null,v||Xe(f,"ready");try{T.onreadystatechange=L}catch{}}}function bv(f){f.I&&(o.clearTimeout(f.I),f.I=null)}t.isActive=function(){return!!this.g};function di(f){return f.g?f.g.readyState:0}t.Z=function(){try{return 2<di(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(f){if(this.g){var v=this.g.responseText;return f&&v.indexOf(f)==0&&(v=v.substring(f.length)),Ct(v)}};function Cv(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function pC(f){const v={};f=(f.g&&2<=di(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let L=0;L<f.length;L++){if(E(f[L]))continue;var T=A(f[L]);const ee=T[0];if(T=T[1],typeof T!="string")continue;T=T.trim();const se=v[ee]||[];v[ee]=se,se.push(T)}k(v,function(L){return L.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function xc(f,v,T){return T&&T.internalChannelParams&&T.internalChannelParams[f]||v}function Nv(f){this.Aa=0,this.i=[],this.j=new hi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=xc("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=xc("baseRetryDelayMs",5e3,f),this.cb=xc("retryDelaySeedMs",1e4,f),this.Wa=xc("forwardChannelMaxRetries",2,f),this.wa=xc("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new Bs(f&&f.concurrentRequestLimit),this.Da=new hC,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Nv.prototype,t.la=8,t.G=1,t.connect=function(f,v,T,L){Tr(0),this.W=f,this.H=v||{},T&&L!==void 0&&(this.H.OSID=T,this.H.OAID=L),this.F=this.X,this.I=Ov(this,null,this.W),Lu(this)};function Hd(f){if(Av(f),f.G==3){var v=f.U++,T=fi(f.I);if(Bt(T,"SID",f.K),Bt(T,"RID",v),Bt(T,"TYPE","terminate"),vc(f,T),v=new Q(f,f.j,v),v.L=2,v.v=Au(fi(T)),T=!1,o.navigator&&o.navigator.sendBeacon)try{T=o.navigator.sendBeacon(v.v.toString(),"")}catch{}!T&&o.Image&&(new Image().src=v.v,T=!0),T||(v.g=Mv(v.j,null),v.g.ea(v.v)),v.F=Date.now(),Be(v)}jv(f)}function Fu(f){f.g&&(Kd(f),f.g.cancel(),f.g=null)}function Av(f){Fu(f),f.u&&(o.clearTimeout(f.u),f.u=null),Du(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&o.clearTimeout(f.s),f.s=null)}function Lu(f){if(!Ho(f.h)&&!f.s){f.s=!0;var v=f.Ga;ge||fe(),ne||(ge(),ne=!0),K.add(v,f),f.B=0}}function gC(f,v){return Jn(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=v.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=ui(m(f.Ga,f,v),Dv(f,f.B)),f.B++,!0)}t.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const ee=new Q(this,this.j,f);let se=this.o;if(this.S&&(se?(se=S(se),C(se,this.S)):se=this.S),this.m!==null||this.O||(ee.H=se,se=null),this.P)e:{for(var v=0,T=0;T<this.i.length;T++){t:{var L=this.i[T];if("__data__"in L.map&&(L=L.map.__data__,typeof L=="string")){L=L.length;break t}L=void 0}if(L===void 0)break;if(v+=L,4096<v){v=T;break e}if(v===4096||T===this.i.length-1){v=T+1;break e}}v=1e3}else v=1e3;v=Rv(this,ee,v),T=fi(this.I),Bt(T,"RID",f),Bt(T,"CVER",22),this.D&&Bt(T,"X-HTTP-Session-Id",this.D),vc(this,T),se&&(this.O?v="headers="+encodeURIComponent(String(Ev(se)))+"&"+v:this.m&&zd(T,this.m,se)),Wd(this.h,ee),this.Ua&&Bt(T,"TYPE","init"),this.P?(Bt(T,"$req",v),Bt(T,"SID","null"),ee.T=!0,xe(ee,T,null)):xe(ee,T,v),this.G=2}}else this.G==3&&(f?Iv(this,f):this.i.length==0||Ho(this.h)||Iv(this))};function Iv(f,v){var T;v?T=v.l:T=f.U++;const L=fi(f.I);Bt(L,"SID",f.K),Bt(L,"RID",T),Bt(L,"AID",f.T),vc(f,L),f.m&&f.o&&zd(L,f.m,f.o),T=new Q(f,f.j,T,f.B+1),f.m===null&&(T.H=f.o),v&&(f.i=v.D.concat(f.i)),v=Rv(f,T,1e3),T.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),Wd(f.h,T),xe(T,L,v)}function vc(f,v){f.H&&D(f.H,function(T,L){Bt(v,L,T)}),f.l&&mv({},function(T,L){Bt(v,L,T)})}function Rv(f,v,T){T=Math.min(f.i.length,T);var L=f.l?m(f.l.Na,f.l,f):null;e:{var ee=f.i;let se=-1;for(;;){const Ie=["count="+T];se==-1?0<T?(se=ee[0].g,Ie.push("ofs="+se)):se=0:Ie.push("ofs="+se);let jt=!0;for(let Ur=0;Ur<T;Ur++){let vt=ee[Ur].g;const en=ee[Ur].map;if(vt-=se,0>vt)se=Math.max(0,ee[Ur].g-100),jt=!1;else try{fC(en,Ie,"req"+vt+"_")}catch{L&&L(en)}}if(jt){L=Ie.join("&");break e}}}return f=f.i.splice(0,T),v.D=f,L}function Pv(f){if(!f.g&&!f.u){f.Y=1;var v=f.Fa;ge||fe(),ne||(ge(),ne=!0),K.add(v,f),f.v=0}}function Gd(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=ui(m(f.Fa,f),Dv(f,f.v)),f.v++,!0)}t.Fa=function(){if(this.u=null,Fv(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=ui(m(this.ab,this),f)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Tr(10),Fu(this),Fv(this))};function Kd(f){f.A!=null&&(o.clearTimeout(f.A),f.A=null)}function Fv(f){f.g=new Q(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var v=fi(f.qa);Bt(v,"RID","rpc"),Bt(v,"SID",f.K),Bt(v,"AID",f.T),Bt(v,"CI",f.F?"0":"1"),!f.F&&f.ja&&Bt(v,"TO",f.ja),Bt(v,"TYPE","xmlhttp"),vc(f,v),f.m&&f.o&&zd(v,f.m,f.o),f.L&&(f.g.I=f.L);var T=f.g;f=f.ia,T.L=1,T.v=Au(fi(v)),T.m=null,T.P=!0,Ne(T,f)}t.Za=function(){this.C!=null&&(this.C=null,Fu(this),Gd(this),Tr(19))};function Du(f){f.C!=null&&(o.clearTimeout(f.C),f.C=null)}function Lv(f,v){var T=null;if(f.g==v){Du(f),Kd(f),f.g=null;var L=2}else if($d(f.h,v))T=v.D,fv(f.h,v),L=1;else return;if(f.G!=0){if(v.o)if(L==1){T=v.m?v.m.length:0,v=Date.now()-v.F;var ee=f.B;L=Ui(),Xe(L,new $i(L,T)),Lu(f)}else Pv(f);else if(ee=v.s,ee==3||ee==0&&0<v.X||!(L==1&&gC(f,v)||L==2&&Gd(f)))switch(T&&0<T.length&&(v=f.h,v.i=v.i.concat(T)),ee){case 1:za(f,5);break;case 4:za(f,10);break;case 3:za(f,6);break;default:za(f,2)}}}function Dv(f,v){let T=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(T*=2),T*v}function za(f,v){if(f.j.info("Error code "+v),v==2){var T=m(f.fb,f),L=f.Xa;const ee=!L;L=new Wa(L||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Cu(L,"https"),Au(L),ee?cC(L.toString(),T):uC(L.toString(),T)}else Tr(2);f.G=0,f.l&&f.l.sa(v),jv(f),Av(f)}t.fb=function(f){f?(this.j.info("Successfully pinged google.com"),Tr(2)):(this.j.info("Failed to ping google.com"),Tr(1))};function jv(f){if(f.G=0,f.ka=[],f.l){const v=dv(f.h);(v.length!=0||f.i.length!=0)&&(y(f.ka,v),y(f.ka,f.i),f.h.i.length=0,g(f.i),f.i.length=0),f.l.ra()}}function Ov(f,v,T){var L=T instanceof Wa?fi(T):new Wa(T);if(L.g!="")v&&(L.g=v+"."+L.g),Nu(L,L.s);else{var ee=o.location;L=ee.protocol,v=v?v+"."+ee.hostname:ee.hostname,ee=+ee.port;var se=new Wa(null);L&&Cu(se,L),v&&(se.g=v),ee&&Nu(se,ee),T&&(se.l=T),L=se}return T=f.D,v=f.ya,T&&v&&Bt(L,T,v),Bt(L,"VER",f.la),vc(f,L),L}function Mv(f,v,T){if(v&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=f.Ca&&!f.pa?new tr(new Iu({eb:T})):new tr(f.pa),v.Ha(f.J),v}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Bv(){}t=Bv.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ju(){}ju.prototype.g=function(f,v){return new Mn(f,v)};function Mn(f,v){kt.call(this),this.g=new Nv(v),this.l=f,this.h=v&&v.messageUrlParams||null,f=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(f?f["X-WebChannel-Content-Type"]=v.messageContentType:f={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(f?f["X-WebChannel-Client-Profile"]=v.va:f={"X-WebChannel-Client-Profile":v.va}),this.g.S=f,(f=v&&v.Sb)&&!E(f)&&(this.g.m=f),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!E(v)&&(this.g.D=v,f=this.h,f!==null&&v in f&&(f=this.h,v in f&&delete f[v])),this.j=new Ko(this)}x(Mn,kt),Mn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Mn.prototype.close=function(){Hd(this.g)},Mn.prototype.o=function(f){var v=this.g;if(typeof f=="string"){var T={};T.__data__=f,f=T}else this.u&&(T={},T.__data__=dt(f),f=T);v.i.push(new $a(v.Ya++,f)),v.G==3&&Lu(v)},Mn.prototype.N=function(){this.g.l=null,delete this.j,Hd(this.g),delete this.g,Mn.aa.N.call(this)};function Vv(f){Ir.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var v=f.__sm__;if(v){e:{for(const T in v){f=T;break e}f=void 0}(this.i=f)&&(f=this.i,v=v!==null&&f in v?v[f]:void 0),this.data=v}else this.data=f}x(Vv,Ir);function Uv(){Zr.call(this),this.status=1}x(Uv,Zr);function Ko(f){this.g=f}x(Ko,Bv),Ko.prototype.ua=function(){Xe(this.g,"a")},Ko.prototype.ta=function(f){Xe(this.g,new Vv(f))},Ko.prototype.sa=function(f){Xe(this.g,new Uv)},Ko.prototype.ra=function(){Xe(this.g,"b")},ju.prototype.createWebChannel=ju.prototype.g,Mn.prototype.send=Mn.prototype.o,Mn.prototype.open=Mn.prototype.m,Mn.prototype.close=Mn.prototype.close,kk=function(){return new ju},Ek=function(){return Ui()},_k=xs,Yp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},U.NO_ERROR=0,U.TIMEOUT=8,U.HTTP_ERROR=6,Ih=U,z.COMPLETE="complete",wk=z,ut.EventType=Br,Br.OPEN="a",Br.CLOSE="b",Br.ERROR="c",Br.MESSAGE="d",kt.prototype.listen=kt.prototype.K,jc=ut,tr.prototype.listenOnce=tr.prototype.L,tr.prototype.getLastError=tr.prototype.Ka,tr.prototype.getLastErrorCode=tr.prototype.Ba,tr.prototype.getStatus=tr.prototype.Z,tr.prototype.getResponseJson=tr.prototype.Oa,tr.prototype.getResponseText=tr.prototype.oa,tr.prototype.send=tr.prototype.ea,tr.prototype.setWithCredentials=tr.prototype.Ha,yk=tr}).apply(typeof th<"u"?th:typeof self<"u"?self:typeof window<"u"?window:{});const gy="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}on.UNAUTHENTICATED=new on(null),on.GOOGLE_CREDENTIALS=new on("google-credentials-uid"),on.FIRST_PARTY=new on("first-party-uid"),on.MOCK_USER=new on("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tc="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xo=new C1("@firebase/firestore");function Cc(){return xo.logLevel}function je(t,...e){if(xo.logLevel<=ht.DEBUG){const r=e.map(I1);xo.debug(`Firestore (${tc}): ${t}`,...r)}}function Pi(t,...e){if(xo.logLevel<=ht.ERROR){const r=e.map(I1);xo.error(`Firestore (${tc}): ${t}`,...r)}}function Ml(t,...e){if(xo.logLevel<=ht.WARN){const r=e.map(I1);xo.warn(`Firestore (${tc}): ${t}`,...r)}}function I1(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qe(t="Unexpected state"){const e=`FIRESTORE (${tc}) INTERNAL ASSERTION FAILED: `+t;throw Pi(e),new Error(e)}function Lt(t,e){t||Qe()}function Je(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const me={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Fe extends si{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tk{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class N6{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(on.UNAUTHENTICATED))}shutdown(){}}class A6{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class I6{constructor(e){this.t=e,this.currentUser=on.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Lt(this.o===void 0);let n=this.i;const s=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let i=new ki;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ki,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},o=l=>{je("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(je("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ki)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(je("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Lt(typeof n.accessToken=="string"),new Tk(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Lt(e===null||typeof e=="string"),new on(e)}}class R6{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=on.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class P6{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new R6(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(on.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class F6{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class L6{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){Lt(this.o===void 0);const n=i=>{i.error!=null&&je("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,je("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const s=i=>{je("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):je("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Lt(typeof r.token=="string"),this.R=r.token,new F6(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D6(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const s=D6(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<r&&(n+=e.charAt(s[i]%e.length))}return n}}function wt(t,e){return t<e?-1:t>e?1:0}function Bl(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Fe(me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Fe(me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Fe(me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Fe(me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Nr.fromMillis(Date.now())}static fromDate(e){return Nr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new Nr(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?wt(this.nanoseconds,e.nanoseconds):wt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ye(e)}static min(){return new Ye(new Nr(0,0))}static max(){return new Ye(new Nr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0{constructor(e,r,n){r===void 0?r=0:r>e.length&&Qe(),n===void 0?n=e.length-r:n>e.length-r&&Qe(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return P0.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof P0?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const i=e.get(s),a=r.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class $t extends P0{construct(e,r,n){return new $t(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Fe(me.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new $t(r)}static emptyPath(){return new $t([])}}const j6=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Gr extends P0{construct(e,r,n){return new Gr(e,r,n)}static isValidIdentifier(e){return j6.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Gr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Gr(["__name__"])}static fromServerFormat(e){const r=[];let n="",s=0;const i=()=>{if(n.length===0)throw new Fe(me.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;s<e.length;){const o=e[s];if(o==="\\"){if(s+1===e.length)throw new Fe(me.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Fe(me.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,s+=2}else o==="`"?(a=!a,s++):o!=="."||a?(n+=o,s++):(i(),s++)}if(i(),a)throw new Fe(me.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Gr(r)}static emptyPath(){return new Gr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e){this.path=e}static fromPath(e){return new Ve($t.fromString(e))}static fromName(e){return new Ve($t.fromString(e).popFirst(5))}static empty(){return new Ve($t.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&$t.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return $t.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ve(new $t(e.slice()))}}function O6(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=Ye.fromTimestamp(n===1e9?new Nr(r+1,0):new Nr(r,n));return new ka(s,Ve.empty(),e)}function M6(t){return new ka(t.readTime,t.key,-1)}class ka{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new ka(Ye.min(),Ve.empty(),-1)}static max(){return new ka(Ye.max(),Ve.empty(),-1)}}function B6(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Ve.comparator(t.documentKey,e.documentKey),r!==0?r:wt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V6="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class U6{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ou(t){if(t.code!==me.FAILED_PRECONDITION||t.message!==V6)throw t;je("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Qe(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new ve((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof ve?r:ve.resolve(r)}catch(r){return ve.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):ve.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):ve.reject(r)}static resolve(e){return new ve((r,n)=>{r(e)})}static reject(e){return new ve((r,n)=>{n(e)})}static waitFor(e){return new ve((r,n)=>{let s=0,i=0,a=!1;e.forEach(o=>{++s,o.next(()=>{++i,a&&i===s&&r()},l=>n(l))}),a=!0,i===s&&r()})}static or(e){let r=ve.resolve(!1);for(const n of e)r=r.next(s=>s?ve.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,i)=>{n.push(r.call(this,s,i))}),this.waitFor(n)}static mapArray(e,r){return new ve((n,s)=>{const i=e.length,a=new Array(i);let o=0;for(let l=0;l<i;l++){const u=l;r(e[u]).next(h=>{a[u]=h,++o,o===i&&n(a)},h=>s(h))}})}static doWhile(e,r){return new ve((n,s)=>{const i=()=>{e()===!0?r().next(()=>{i()},s):n()};i()})}}function $6(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function lu(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R1{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}R1.oe=-1;function ud(t){return t==null}function gf(t){return t===0&&1/t==-1/0}function W6(t){return typeof t=="number"&&Number.isInteger(t)&&!gf(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xy(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Po(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function bk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e,r){this.comparator=e,this.root=r||zr.EMPTY}insert(e,r){return new Zt(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,zr.BLACK,null,null))}remove(e){return new Zt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,zr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new rh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new rh(this.root,e,this.comparator,!1)}getReverseIterator(){return new rh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new rh(this.root,e,this.comparator,!0)}}class rh{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class zr{constructor(e,r,n,s,i){this.key=e,this.value=r,this.color=n??zr.RED,this.left=s??zr.EMPTY,this.right=i??zr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,i){return new zr(e??this.key,r??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,r,n),null):i===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return zr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return zr.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,zr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,zr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Qe();const e=this.left.check();if(e!==this.right.check())throw Qe();return e+(this.isRed()?0:1)}}zr.EMPTY=null,zr.RED=!0,zr.BLACK=!1;zr.EMPTY=new class{constructor(){this.size=0}get key(){throw Qe()}get value(){throw Qe()}get color(){throw Qe()}get left(){throw Qe()}get right(){throw Qe()}copy(e,r,n,s,i){return this}insert(e,r,n){return new zr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(e){this.comparator=e,this.data=new Zt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new vy(this.data.getIterator())}getIteratorFrom(e){return new vy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Xr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Xr(this.comparator);return r.data=e,r}}class vy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e){this.fields=e,e.sort(Gr.comparator)}static empty(){return new Hn([])}unionWith(e){let r=new Xr(Gr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Hn(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Bl(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ck extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Ck("Invalid base64 string: "+i):i}}(e);return new Yr(r)}static fromUint8Array(e){const r=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new Yr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return wt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Yr.EMPTY_BYTE_STRING=new Yr("");const z6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ta(t){if(Lt(!!t),typeof t=="string"){let e=0;const r=z6.exec(t);if(Lt(!!r),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:lr(t.seconds),nanos:lr(t.nanos)}}function lr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function vo(t){return typeof t=="string"?Yr.fromBase64String(t):Yr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P1(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function F1(t){const e=t.mapValue.fields.__previous_value__;return P1(e)?F1(e):e}function F0(t){const e=Ta(t.mapValue.fields.__local_write_time__.timestampValue);return new Nr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H6{constructor(e,r,n,s,i,a,o,l,u){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=u}}class L0{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new L0("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof L0&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nh={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function yo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?P1(t)?4:K6(t)?9007199254740991:G6(t)?10:11:Qe()}function ti(t,e){if(t===e)return!0;const r=yo(t);if(r!==yo(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return F0(t).isEqual(F0(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=Ta(s.timestampValue),o=Ta(i.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return vo(s.bytesValue).isEqual(vo(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return lr(s.geoPointValue.latitude)===lr(i.geoPointValue.latitude)&&lr(s.geoPointValue.longitude)===lr(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return lr(s.integerValue)===lr(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=lr(s.doubleValue),o=lr(i.doubleValue);return a===o?gf(a)===gf(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return Bl(t.arrayValue.values||[],e.arrayValue.values||[],ti);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},o=i.mapValue.fields||{};if(xy(a)!==xy(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!ti(a[l],o[l])))return!1;return!0}(t,e);default:return Qe()}}function D0(t,e){return(t.values||[]).find(r=>ti(r,e))!==void 0}function Vl(t,e){if(t===e)return 0;const r=yo(t),n=yo(e);if(r!==n)return wt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return wt(t.booleanValue,e.booleanValue);case 2:return function(i,a){const o=lr(i.integerValue||i.doubleValue),l=lr(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return yy(t.timestampValue,e.timestampValue);case 4:return yy(F0(t),F0(e));case 5:return wt(t.stringValue,e.stringValue);case 6:return function(i,a){const o=vo(i),l=vo(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const o=i.split("/"),l=a.split("/");for(let u=0;u<o.length&&u<l.length;u++){const h=wt(o[u],l[u]);if(h!==0)return h}return wt(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const o=wt(lr(i.latitude),lr(a.latitude));return o!==0?o:wt(lr(i.longitude),lr(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return wy(t.arrayValue,e.arrayValue);case 10:return function(i,a){var o,l,u,h;const d=i.fields||{},m=a.fields||{},p=(o=d.value)===null||o===void 0?void 0:o.arrayValue,x=(l=m.value)===null||l===void 0?void 0:l.arrayValue,g=wt(((u=p==null?void 0:p.values)===null||u===void 0?void 0:u.length)||0,((h=x==null?void 0:x.values)===null||h===void 0?void 0:h.length)||0);return g!==0?g:wy(p,x)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===nh.mapValue&&a===nh.mapValue)return 0;if(i===nh.mapValue)return 1;if(a===nh.mapValue)return-1;const o=i.fields||{},l=Object.keys(o),u=a.fields||{},h=Object.keys(u);l.sort(),h.sort();for(let d=0;d<l.length&&d<h.length;++d){const m=wt(l[d],h[d]);if(m!==0)return m;const p=Vl(o[l[d]],u[h[d]]);if(p!==0)return p}return wt(l.length,h.length)}(t.mapValue,e.mapValue);default:throw Qe()}}function yy(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return wt(t,e);const r=Ta(t),n=Ta(e),s=wt(r.seconds,n.seconds);return s!==0?s:wt(r.nanos,n.nanos)}function wy(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const i=Vl(r[s],n[s]);if(i)return i}return wt(r.length,n.length)}function Ul(t){return Jp(t)}function Jp(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Ta(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return vo(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Ve.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const i of r.values||[])s?s=!1:n+=",",n+=Jp(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const a of n)i?i=!1:s+=",",s+=`${a}:${Jp(r.fields[a])}`;return s+"}"}(t.mapValue):Qe()}function _y(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Zp(t){return!!t&&"integerValue"in t}function L1(t){return!!t&&"arrayValue"in t}function Ey(t){return!!t&&"nullValue"in t}function ky(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Rh(t){return!!t&&"mapValue"in t}function G6(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Zc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Po(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Zc(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Zc(t.arrayValue.values[r]);return e}return Object.assign({},t)}function K6(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e){this.value=e}static empty(){return new Rn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Rh(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Zc(r)}setAll(e){let r=Gr.emptyPath(),n={},s=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,s),n={},s=[],r=o.popLast()}a?n[o.lastSegment()]=Zc(a):s.push(o.lastSegment())});const i=this.getFieldsMap(r);this.applyChanges(i,n,s)}delete(e){const r=this.field(e.popLast());Rh(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return ti(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];Rh(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){Po(r,(s,i)=>e[s]=i);for(const s of n)delete e[s]}clone(){return new Rn(Zc(this.value))}}function Nk(t){const e=[];return Po(t.fields,(r,n)=>{const s=new Gr([r]);if(Rh(n)){const i=Nk(n.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new Hn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e,r,n,s,i,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=i,this.data=a,this.documentState=o}static newInvalidDocument(e){return new hn(e,0,Ye.min(),Ye.min(),Ye.min(),Rn.empty(),0)}static newFoundDocument(e,r,n,s){return new hn(e,1,r,Ye.min(),n,s,0)}static newNoDocument(e,r){return new hn(e,2,r,Ye.min(),Ye.min(),Rn.empty(),0)}static newUnknownDocument(e,r){return new hn(e,3,r,Ye.min(),Ye.min(),Rn.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Ye.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Rn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Rn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ye.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof hn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new hn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf{constructor(e,r){this.position=e,this.inclusive=r}}function Ty(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?n=Ve.comparator(Ve.fromName(a.referenceValue),r.key):n=Vl(a,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function Sy(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!ti(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0{constructor(e,r="asc"){this.field=e,this.dir=r}}function q6(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{}class wr extends Ak{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new Q6(e,r,n):r==="array-contains"?new Z6(e,n):r==="in"?new eR(e,n):r==="not-in"?new tR(e,n):r==="array-contains-any"?new rR(e,n):new wr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new Y6(e,n):new J6(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Vl(r,this.value)):r!==null&&yo(this.value)===yo(r)&&this.matchesComparison(Vl(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Qe()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ds extends Ak{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new Ds(e,r)}matches(e){return Ik(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Ik(t){return t.op==="and"}function Rk(t){return X6(t)&&Ik(t)}function X6(t){for(const e of t.filters)if(e instanceof Ds)return!1;return!0}function eg(t){if(t instanceof wr)return t.field.canonicalString()+t.op.toString()+Ul(t.value);if(Rk(t))return t.filters.map(e=>eg(e)).join(",");{const e=t.filters.map(r=>eg(r)).join(",");return`${t.op}(${e})`}}function Pk(t,e){return t instanceof wr?function(n,s){return s instanceof wr&&n.op===s.op&&n.field.isEqual(s.field)&&ti(n.value,s.value)}(t,e):t instanceof Ds?function(n,s){return s instanceof Ds&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((i,a,o)=>i&&Pk(a,s.filters[o]),!0):!1}(t,e):void Qe()}function Fk(t){return t instanceof wr?function(r){return`${r.field.canonicalString()} ${r.op} ${Ul(r.value)}`}(t):t instanceof Ds?function(r){return r.op.toString()+" {"+r.getFilters().map(Fk).join(" ,")+"}"}(t):"Filter"}class Q6 extends wr{constructor(e,r,n){super(e,r,n),this.key=Ve.fromName(n.referenceValue)}matches(e){const r=Ve.comparator(e.key,this.key);return this.matchesComparison(r)}}class Y6 extends wr{constructor(e,r){super(e,"in",r),this.keys=Lk("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class J6 extends wr{constructor(e,r){super(e,"not-in",r),this.keys=Lk("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function Lk(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Ve.fromName(n.referenceValue))}class Z6 extends wr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return L1(r)&&D0(r.arrayValue,this.value)}}class eR extends wr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&D0(this.value.arrayValue,r)}}class tR extends wr{constructor(e,r){super(e,"not-in",r)}matches(e){if(D0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!D0(this.value.arrayValue,r)}}class rR extends wr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!L1(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>D0(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{constructor(e,r=null,n=[],s=[],i=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=a,this.endAt=o,this.ue=null}}function by(t,e=null,r=[],n=[],s=null,i=null,a=null){return new nR(t,e,r,n,s,i,a)}function D1(t){const e=Je(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>eg(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),ud(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Ul(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Ul(n)).join(",")),e.ue=r}return e.ue}function j1(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!q6(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!Pk(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Sy(t.startAt,e.startAt)&&Sy(t.endAt,e.endAt)}function tg(t){return Ve.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc{constructor(e,r=null,n=[],s=[],i=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function sR(t,e,r,n,s,i,a,o){return new rc(t,e,r,n,s,i,a,o)}function O1(t){return new rc(t)}function Cy(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Dk(t){return t.collectionGroup!==null}function e0(t){const e=Je(t);if(e.ce===null){e.ce=[];const r=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Xr(Gr.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(o=o.add(u.field))})}),o})(e).forEach(i=>{r.has(i.canonicalString())||i.isKeyField()||e.ce.push(new j0(i,n))}),r.has(Gr.keyField().canonicalString())||e.ce.push(new j0(Gr.keyField(),n))}return e.ce}function Ys(t){const e=Je(t);return e.le||(e.le=iR(e,e0(t))),e.le}function iR(t,e){if(t.limitType==="F")return by(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new j0(s.field,i)});const r=t.endAt?new xf(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new xf(t.startAt.position,t.startAt.inclusive):null;return by(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function rg(t,e){const r=t.filters.concat([e]);return new rc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function ng(t,e,r){return new rc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function hd(t,e){return j1(Ys(t),Ys(e))&&t.limitType===e.limitType}function jk(t){return`${D1(Ys(t))}|lt:${t.limitType}`}function Zo(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>Fk(s)).join(", ")}]`),ud(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>Ul(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>Ul(s)).join(",")),`Target(${n})`}(Ys(t))}; limitType=${t.limitType})`}function fd(t,e){return e.isFoundDocument()&&function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):Ve.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,s){for(const i of e0(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(a,o,l){const u=Ty(a,o,l);return a.inclusive?u<=0:u<0}(n.startAt,e0(n),s)||n.endAt&&!function(a,o,l){const u=Ty(a,o,l);return a.inclusive?u>=0:u>0}(n.endAt,e0(n),s))}(t,e)}function aR(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Ok(t){return(e,r)=>{let n=!1;for(const s of e0(t)){const i=oR(s,e,r);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function oR(t,e,r){const n=t.field.isKeyField()?Ve.comparator(e.key,r.key):function(i,a,o){const l=a.data.field(i),u=o.data.field(i);return l!==null&&u!==null?Vl(l,u):Qe()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Qe()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Po(this.inner,(r,n)=>{for(const[s,i]of n)e(s,i)})}isEmpty(){return bk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lR=new Zt(Ve.comparator);function Fi(){return lR}const Mk=new Zt(Ve.comparator);function Oc(...t){let e=Mk;for(const r of t)e=e.insert(r.key,r);return e}function Bk(t){let e=Mk;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Za(){return t0()}function Vk(){return t0()}function t0(){return new nc(t=>t.toString(),(t,e)=>t.isEqual(e))}const cR=new Zt(Ve.comparator),uR=new Xr(Ve.comparator);function ct(...t){let e=uR;for(const r of t)e=e.add(r);return e}const hR=new Xr(wt);function fR(){return hR}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M1(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:gf(e)?"-0":e}}function Uk(t){return{integerValue:""+t}}function dR(t,e){return W6(e)?Uk(e):M1(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(){this._=void 0}}function mR(t,e,r){return t instanceof vf?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&P1(i)&&(i=F1(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(r,e):t instanceof O0?Wk(t,e):t instanceof M0?zk(t,e):function(s,i){const a=$k(s,i),o=Ny(a)+Ny(s.Pe);return Zp(a)&&Zp(s.Pe)?Uk(o):M1(s.serializer,o)}(t,e)}function pR(t,e,r){return t instanceof O0?Wk(t,e):t instanceof M0?zk(t,e):r}function $k(t,e){return t instanceof yf?function(n){return Zp(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class vf extends dd{}class O0 extends dd{constructor(e){super(),this.elements=e}}function Wk(t,e){const r=Hk(e);for(const n of t.elements)r.some(s=>ti(s,n))||r.push(n);return{arrayValue:{values:r}}}class M0 extends dd{constructor(e){super(),this.elements=e}}function zk(t,e){let r=Hk(e);for(const n of t.elements)r=r.filter(s=>!ti(s,n));return{arrayValue:{values:r}}}class yf extends dd{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function Ny(t){return lr(t.integerValue||t.doubleValue)}function Hk(t){return L1(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function gR(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof O0&&s instanceof O0||n instanceof M0&&s instanceof M0?Bl(n.elements,s.elements,ti):n instanceof yf&&s instanceof yf?ti(n.Pe,s.Pe):n instanceof vf&&s instanceof vf}(t.transform,e.transform)}class xR{constructor(e,r){this.version=e,this.transformResults=r}}class us{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new us}static exists(e){return new us(void 0,e)}static updateTime(e){return new us(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ph(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class md{}function Gk(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new B1(t.key,us.none()):new cu(t.key,t.data,us.none());{const r=t.data,n=Rn.empty();let s=new Xr(Gr.comparator);for(let i of e.fields)if(!s.has(i)){let a=r.field(i);a===null&&i.length>1&&(i=i.popLast(),a=r.field(i)),a===null?n.delete(i):n.set(i,a),s=s.add(i)}return new La(t.key,n,new Hn(s.toArray()),us.none())}}function vR(t,e,r){t instanceof cu?function(s,i,a){const o=s.value.clone(),l=Iy(s.fieldTransforms,i,a.transformResults);o.setAll(l),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof La?function(s,i,a){if(!Ph(s.precondition,i))return void i.convertToUnknownDocument(a.version);const o=Iy(s.fieldTransforms,i,a.transformResults),l=i.data;l.setAll(Kk(s)),l.setAll(o),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function r0(t,e,r,n){return t instanceof cu?function(i,a,o,l){if(!Ph(i.precondition,a))return o;const u=i.value.clone(),h=Ry(i.fieldTransforms,l,a);return u.setAll(h),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof La?function(i,a,o,l){if(!Ph(i.precondition,a))return o;const u=Ry(i.fieldTransforms,l,a),h=a.data;return h.setAll(Kk(i)),h.setAll(u),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),o===null?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(d=>d.field))}(t,e,r,n):function(i,a,o){return Ph(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function yR(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),i=$k(n.transform,s||null);i!=null&&(r===null&&(r=Rn.empty()),r.set(n.field,i))}return r||null}function Ay(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&Bl(n,s,(i,a)=>gR(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class cu extends md{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class La extends md{constructor(e,r,n,s,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Kk(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function Iy(t,e,r){const n=new Map;Lt(t.length===r.length);for(let s=0;s<r.length;s++){const i=t[s],a=i.transform,o=e.data.field(i.field);n.set(i.field,pR(a,o,r[s]))}return n}function Ry(t,e,r){const n=new Map;for(const s of t){const i=s.transform,a=r.data.field(s.field);n.set(s.field,mR(i,a,e))}return n}class B1 extends md{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class wR extends md{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _R{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&vR(i,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=r0(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=r0(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=Vk();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let o=this.applyToLocalView(a,i.mutatedFields);o=r.has(s.key)?null:o;const l=Gk(a,o);l!==null&&n.set(s.key,l),a.isValidDocument()||a.convertToNoDocument(Ye.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),ct())}isEqual(e){return this.batchId===e.batchId&&Bl(this.mutations,e.mutations,(r,n)=>Ay(r,n))&&Bl(this.baseMutations,e.baseMutations,(r,n)=>Ay(r,n))}}class V1{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){Lt(e.mutations.length===n.length);let s=function(){return cR}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,n[a].version);return new V1(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ER{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kR{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pr,ft;function TR(t){switch(t){default:return Qe();case me.CANCELLED:case me.UNKNOWN:case me.DEADLINE_EXCEEDED:case me.RESOURCE_EXHAUSTED:case me.INTERNAL:case me.UNAVAILABLE:case me.UNAUTHENTICATED:return!1;case me.INVALID_ARGUMENT:case me.NOT_FOUND:case me.ALREADY_EXISTS:case me.PERMISSION_DENIED:case me.FAILED_PRECONDITION:case me.ABORTED:case me.OUT_OF_RANGE:case me.UNIMPLEMENTED:case me.DATA_LOSS:return!0}}function qk(t){if(t===void 0)return Pi("GRPC error has no .code"),me.UNKNOWN;switch(t){case pr.OK:return me.OK;case pr.CANCELLED:return me.CANCELLED;case pr.UNKNOWN:return me.UNKNOWN;case pr.DEADLINE_EXCEEDED:return me.DEADLINE_EXCEEDED;case pr.RESOURCE_EXHAUSTED:return me.RESOURCE_EXHAUSTED;case pr.INTERNAL:return me.INTERNAL;case pr.UNAVAILABLE:return me.UNAVAILABLE;case pr.UNAUTHENTICATED:return me.UNAUTHENTICATED;case pr.INVALID_ARGUMENT:return me.INVALID_ARGUMENT;case pr.NOT_FOUND:return me.NOT_FOUND;case pr.ALREADY_EXISTS:return me.ALREADY_EXISTS;case pr.PERMISSION_DENIED:return me.PERMISSION_DENIED;case pr.FAILED_PRECONDITION:return me.FAILED_PRECONDITION;case pr.ABORTED:return me.ABORTED;case pr.OUT_OF_RANGE:return me.OUT_OF_RANGE;case pr.UNIMPLEMENTED:return me.UNIMPLEMENTED;case pr.DATA_LOSS:return me.DATA_LOSS;default:return Qe()}}(ft=pr||(pr={}))[ft.OK=0]="OK",ft[ft.CANCELLED=1]="CANCELLED",ft[ft.UNKNOWN=2]="UNKNOWN",ft[ft.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ft[ft.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ft[ft.NOT_FOUND=5]="NOT_FOUND",ft[ft.ALREADY_EXISTS=6]="ALREADY_EXISTS",ft[ft.PERMISSION_DENIED=7]="PERMISSION_DENIED",ft[ft.UNAUTHENTICATED=16]="UNAUTHENTICATED",ft[ft.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ft[ft.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ft[ft.ABORTED=10]="ABORTED",ft[ft.OUT_OF_RANGE=11]="OUT_OF_RANGE",ft[ft.UNIMPLEMENTED=12]="UNIMPLEMENTED",ft[ft.INTERNAL=13]="INTERNAL",ft[ft.UNAVAILABLE=14]="UNAVAILABLE",ft[ft.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SR(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bR=new so([4294967295,4294967295],0);function Py(t){const e=SR().encode(t),r=new vk;return r.update(e),new Uint8Array(r.digest())}function Fy(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new so([r,n],0),new so([s,i],0)]}class U1{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Mc(`Invalid padding: ${r}`);if(n<0)throw new Mc(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Mc(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Mc(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=so.fromNumber(this.Ie)}Ee(e,r,n){let s=e.add(r.multiply(so.fromNumber(n)));return s.compare(bR)===1&&(s=new so([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=Py(e),[n,s]=Fy(r);for(let i=0;i<this.hashCount;i++){const a=this.Ee(n,s,i);if(!this.de(a))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new U1(i,s,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=Py(e),[n,s]=Fy(r);for(let i=0;i<this.hashCount;i++){const a=this.Ee(n,s,i);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Mc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(e,r,n,s,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,uu.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new pd(Ye.min(),s,new Zt(wt),Fi(),ct())}}class uu{constructor(e,r,n,s,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new uu(n,r,ct(),ct(),ct())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,r,n,s){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=s}}class Xk{constructor(e,r){this.targetId=e,this.me=r}}class Qk{constructor(e,r,n=Yr.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class Ly{constructor(){this.fe=0,this.ge=jy(),this.pe=Yr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ct(),r=ct(),n=ct();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:Qe()}}),new uu(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=jy()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Lt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class CR{constructor(e){this.Le=e,this.Be=new Map,this.ke=Fi(),this.qe=Dy(),this.Qe=new Zt(wt)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:Qe()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,s)=>{this.ze(s)&&r(s)})}He(e){const r=e.targetId,n=e.me.count,s=this.Je(r);if(s){const i=s.target;if(tg(i))if(n===0){const a=new Ve(i.path);this.Ue(r,a,hn.newNoDocument(a,Ye.min()))}else Lt(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,u)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=r;let a,o;try{a=vo(n).toUint8Array()}catch(l){if(l instanceof Ck)return Ml("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new U1(a,s,i)}catch(l){return Ml(l instanceof Mc?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let s=0;return n.forEach(i=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,i,null),s++)}),s}rt(e){const r=new Map;this.Be.forEach((i,a)=>{const o=this.Je(a);if(o){if(i.current&&tg(o.target)){const l=new Ve(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,hn.newNoDocument(l,e))}i.be&&(r.set(a,i.ve()),i.Ce())}});let n=ct();this.qe.forEach((i,a)=>{let o=!0;a.forEachWhile(l=>{const u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new pd(e,r,this.Qe,this.ke,n);return this.ke=Fi(),this.qe=Dy(),this.Qe=new Zt(wt),s}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,r)?s.Fe(r,1):s.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new Ly,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new Xr(wt),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||je("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Ly),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function Dy(){return new Zt(Ve.comparator)}function jy(){return new Zt(Ve.comparator)}const NR=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),AR=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),IR=(()=>({and:"AND",or:"OR"}))();class RR{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function sg(t,e){return t.useProto3Json||ud(e)?e:{value:e}}function wf(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Yk(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function PR(t,e){return wf(t,e.toTimestamp())}function Js(t){return Lt(!!t),Ye.fromTimestamp(function(r){const n=Ta(r);return new Nr(n.seconds,n.nanos)}(t))}function $1(t,e){return ig(t,e).canonicalString()}function ig(t,e){const r=function(s){return new $t(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function Jk(t){const e=$t.fromString(t);return Lt(nT(e)),e}function ag(t,e){return $1(t.databaseId,e.path)}function Cm(t,e){const r=Jk(e);if(r.get(1)!==t.databaseId.projectId)throw new Fe(me.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Fe(me.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Ve(eT(r))}function Zk(t,e){return $1(t.databaseId,e)}function FR(t){const e=Jk(t);return e.length===4?$t.emptyPath():eT(e)}function og(t){return new $t(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function eT(t){return Lt(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Oy(t,e,r){return{name:ag(t,e),fields:r.value.mapValue.fields}}function LR(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Qe()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,h){return u.useProto3Json?(Lt(h===void 0||typeof h=="string"),Yr.fromBase64String(h||"")):(Lt(h===void 0||h instanceof Buffer||h instanceof Uint8Array),Yr.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(u){const h=u.code===void 0?me.UNKNOWN:qk(u.code);return new Fe(h,u.message||"")}(a);r=new Qk(n,s,i,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=Cm(t,n.document.name),i=Js(n.document.updateTime),a=n.document.createTime?Js(n.document.createTime):Ye.min(),o=new Rn({mapValue:{fields:n.document.fields}}),l=hn.newFoundDocument(s,i,a,o),u=n.targetIds||[],h=n.removedTargetIds||[];r=new Fh(u,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=Cm(t,n.document),i=n.readTime?Js(n.readTime):Ye.min(),a=hn.newNoDocument(s,i),o=n.removedTargetIds||[];r=new Fh([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=Cm(t,n.document),i=n.removedTargetIds||[];r=new Fh([],i,s,null)}else{if(!("filter"in e))return Qe();{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,a=new kR(s,i),o=n.targetId;r=new Xk(o,a)}}return r}function DR(t,e){let r;if(e instanceof cu)r={update:Oy(t,e.key,e.value)};else if(e instanceof B1)r={delete:ag(t,e.key)};else if(e instanceof La)r={update:Oy(t,e.key,e.data),updateMask:zR(e.fieldMask)};else{if(!(e instanceof wR))return Qe();r={verify:ag(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(i,a){const o=a.transform;if(o instanceof vf)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof O0)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof M0)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof yf)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw Qe()}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:PR(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Qe()}(t,e.precondition)),r}function jR(t,e){return t&&t.length>0?(Lt(e!==void 0),t.map(r=>function(s,i){let a=s.updateTime?Js(s.updateTime):Js(i);return a.isEqual(Ye.min())&&(a=Js(i)),new xR(a,s.transformResults||[])}(r,e))):[]}function OR(t,e){return{documents:[Zk(t,e.path)]}}function MR(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Zk(t,s);const i=function(u){if(u.length!==0)return rT(Ds.create(u,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const a=function(u){if(u.length!==0)return u.map(h=>function(m){return{field:el(m.field),direction:UR(m.dir)}}(h))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=sg(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:r,parent:s}}function BR(t){let e=FR(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){Lt(n===1);const h=r.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];r.where&&(i=function(d){const m=tT(d);return m instanceof Ds&&Rk(m)?m.getFilters():[m]}(r.where));let a=[];r.orderBy&&(a=function(d){return d.map(m=>function(x){return new j0(tl(x.field),function(y){switch(y){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(m))}(r.orderBy));let o=null;r.limit&&(o=function(d){let m;return m=typeof d=="object"?d.value:d,ud(m)?null:m}(r.limit));let l=null;r.startAt&&(l=function(d){const m=!!d.before,p=d.values||[];return new xf(p,m)}(r.startAt));let u=null;return r.endAt&&(u=function(d){const m=!d.before,p=d.values||[];return new xf(p,m)}(r.endAt)),sR(e,s,a,i,o,"F",l,u)}function VR(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Qe()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function tT(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=tl(r.unaryFilter.field);return wr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=tl(r.unaryFilter.field);return wr.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=tl(r.unaryFilter.field);return wr.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=tl(r.unaryFilter.field);return wr.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Qe()}}(t):t.fieldFilter!==void 0?function(r){return wr.create(tl(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Qe()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Ds.create(r.compositeFilter.filters.map(n=>tT(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Qe()}}(r.compositeFilter.op))}(t):Qe()}function UR(t){return NR[t]}function $R(t){return AR[t]}function WR(t){return IR[t]}function el(t){return{fieldPath:t.canonicalString()}}function tl(t){return Gr.fromServerFormat(t.fieldPath)}function rT(t){return t instanceof wr?function(r){if(r.op==="=="){if(ky(r.value))return{unaryFilter:{field:el(r.field),op:"IS_NAN"}};if(Ey(r.value))return{unaryFilter:{field:el(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(ky(r.value))return{unaryFilter:{field:el(r.field),op:"IS_NOT_NAN"}};if(Ey(r.value))return{unaryFilter:{field:el(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:el(r.field),op:$R(r.op),value:r.value}}}(t):t instanceof Ds?function(r){const n=r.getFilters().map(s=>rT(s));return n.length===1?n[0]:{compositeFilter:{op:WR(r.op),filters:n}}}(t):Qe()}function zR(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function nT(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(e,r,n,s,i=Ye.min(),a=Ye.min(),o=Yr.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new ia(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new ia(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ia(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ia(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HR{constructor(e){this.ct=e}}function GR(t){const e=BR({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?ng(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KR{constructor(){this.un=new qR}addToCollectionParentIndex(e,r){return this.un.add(r),ve.resolve()}getCollectionParents(e,r){return ve.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return ve.resolve()}deleteFieldIndex(e,r){return ve.resolve()}deleteAllFieldIndexes(e){return ve.resolve()}createTargetIndexes(e,r){return ve.resolve()}getDocumentsMatchingTarget(e,r){return ve.resolve(null)}getIndexType(e,r){return ve.resolve(0)}getFieldIndexes(e,r){return ve.resolve([])}getNextCollectionGroupToUpdate(e){return ve.resolve(null)}getMinOffset(e,r){return ve.resolve(ka.min())}getMinOffsetFromCollectionGroup(e,r){return ve.resolve(ka.min())}updateCollectionGroup(e,r,n){return ve.resolve()}updateIndexEntries(e,r){return ve.resolve()}}class qR{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new Xr($t.comparator),i=!s.has(n);return this.index[r]=s.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Xr($t.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new $l(0)}static kn(){return new $l(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{constructor(){this.changes=new nc(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,hn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?ve.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QR{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YR{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&r0(n.mutation,s,Hn.empty(),Nr.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,ct()).next(()=>n))}getLocalViewOfDocuments(e,r,n=ct()){const s=Za();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(i=>{let a=Oc();return i.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=Za();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,ct()))}populateOverlays(e,r,n){const s=[];return n.forEach(i=>{r.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,s){let i=Fi();const a=t0(),o=function(){return t0()}();return r.forEach((l,u)=>{const h=n.get(u.key);s.has(u.key)&&(h===void 0||h.mutation instanceof La)?i=i.insert(u.key,u):h!==void 0?(a.set(u.key,h.mutation.getFieldMask()),r0(h.mutation,u,h.mutation.getFieldMask(),Nr.now())):a.set(u.key,Hn.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((u,h)=>a.set(u,h)),r.forEach((u,h)=>{var d;return o.set(u,new QR(h,(d=a.get(u))!==null&&d!==void 0?d:null))}),o))}recalculateAndSaveOverlays(e,r){const n=t0();let s=new Zt((a,o)=>a-o),i=ct();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const u=r.get(l);if(u===null)return;let h=n.get(l)||Hn.empty();h=o.applyToLocalView(u,h),n.set(l,h);const d=(s.get(o.batchId)||ct()).add(l);s=s.insert(o.batchId,d)})}).next(()=>{const a=[],o=s.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),u=l.key,h=l.value,d=Vk();h.forEach(m=>{if(!i.has(m)){const p=Gk(r.get(m),n.get(m));p!==null&&d.set(m,p),i=i.add(m)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,d))}return ve.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(a){return Ve.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):Dk(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-i.size):ve.resolve(Za());let o=-1,l=i;return a.next(u=>ve.forEach(u,(h,d)=>(o<d.largestBatchId&&(o=d.largestBatchId),i.get(h)?ve.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{l=l.insert(h,m)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,l,u,ct())).next(h=>({batchId:o,changes:Bk(h)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Ve(r)).next(n=>{let s=Oc();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const i=r.collectionGroup;let a=Oc();return this.indexManager.getCollectionParents(e,i).next(o=>ve.forEach(o,l=>{const u=function(d,m){return new rc(m,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(r,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,n,s).next(h=>{h.forEach((d,m)=>{a=a.insert(d,m)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,s))).next(a=>{i.forEach((l,u)=>{const h=u.getKey();a.get(h)===null&&(a=a.insert(h,hn.newInvalidDocument(h)))});let o=Oc();return a.forEach((l,u)=>{const h=i.get(l);h!==void 0&&r0(h.mutation,u,Hn.empty(),Nr.now()),fd(r,u)&&(o=o.insert(l,u))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JR{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return ve.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:Js(s.createTime)}}(r)),ve.resolve()}getNamedQuery(e,r){return ve.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(s){return{name:s.name,query:GR(s.bundledQuery),readTime:Js(s.readTime)}}(r)),ve.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZR{constructor(){this.overlays=new Zt(Ve.comparator),this.Ir=new Map}getOverlay(e,r){return ve.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Za();return ve.forEach(r,s=>this.getOverlay(e,s).next(i=>{i!==null&&n.set(s,i)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,i)=>{this.ht(e,r,i)}),ve.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.Ir.get(n);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(n)),ve.resolve()}getOverlaysForCollection(e,r,n){const s=Za(),i=r.length+1,a=new Ve(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,u=l.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===i&&l.largestBatchId>n&&s.set(l.getKey(),l)}return ve.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let i=new Zt((u,h)=>u-h);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let h=i.get(u.largestBatchId);h===null&&(h=Za(),i=i.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const o=Za(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,h)=>o.set(u,h)),!(o.size()>=s)););return ve.resolve(o)}ht(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const a=this.Ir.get(s.largestBatchId).delete(n.key);this.Ir.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new ER(r,n));let i=this.Ir.get(r);i===void 0&&(i=ct(),this.Ir.set(r,i)),this.Ir.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e8{constructor(){this.sessionToken=Yr.EMPTY_BYTE_STRING}getSessionToken(e){return ve.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,ve.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1{constructor(){this.Tr=new Xr(Rr.Er),this.dr=new Xr(Rr.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new Rr(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new Rr(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new Ve(new $t([])),n=new Rr(r,e),s=new Rr(r,e+1),i=[];return this.dr.forEachInRange([n,s],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new Ve(new $t([])),n=new Rr(r,e),s=new Rr(r,e+1);let i=ct();return this.dr.forEachInRange([n,s],a=>{i=i.add(a.key)}),i}containsKey(e){const r=new Rr(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Rr{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return Ve.comparator(e.key,r.key)||wt(e.wr,r.wr)}static Ar(e,r){return wt(e.wr,r.wr)||Ve.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t8{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new Xr(Rr.Er)}checkEmpty(e){return ve.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new _R(i,r,n,s);this.mutationQueue.push(a);for(const o of s)this.br=this.br.add(new Rr(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return ve.resolve(a)}lookupMutationBatch(e,r){return ve.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.vr(n),i=s<0?0:s;return ve.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ve.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return ve.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Rr(r,0),s=new Rr(r,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([n,s],a=>{const o=this.Dr(a.wr);i.push(o)}),ve.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Xr(wt);return r.forEach(s=>{const i=new Rr(s,0),a=new Rr(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],o=>{n=n.add(o.wr)})}),ve.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let i=n;Ve.isDocumentKey(i)||(i=i.child(""));const a=new Rr(new Ve(i),0);let o=new Xr(wt);return this.br.forEachWhile(l=>{const u=l.key.path;return!!n.isPrefixOf(u)&&(u.length===s&&(o=o.add(l.wr)),!0)},a),ve.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const s=this.Dr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){Lt(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return ve.forEach(r.mutations,s=>{const i=new Rr(s.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new Rr(r,0),s=this.br.firstAfterOrEqual(n);return ve.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,ve.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r8{constructor(e){this.Mr=e,this.docs=function(){return new Zt(Ve.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),i=s?s.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return ve.resolve(n?n.document.mutableCopy():hn.newInvalidDocument(r))}getEntries(e,r){let n=Fi();return r.forEach(s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():hn.newInvalidDocument(s))}),ve.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let i=Fi();const a=r.path,o=new Ve(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:u,value:{document:h}}=l.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||B6(M6(h),n)<=0||(s.has(h.key)||fd(r,h))&&(i=i.insert(h.key,h.mutableCopy()))}return ve.resolve(i)}getAllFromCollectionGroup(e,r,n,s){Qe()}Or(e,r){return ve.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new n8(this)}getSize(e){return ve.resolve(this.size)}}class n8 extends XR{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.cr.addEntry(e,s)):this.cr.removeEntry(n)}),ve.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s8{constructor(e){this.persistence=e,this.Nr=new nc(r=>D1(r),j1),this.lastRemoteSnapshotVersion=Ye.min(),this.highestTargetId=0,this.Lr=0,this.Br=new W1,this.targetCount=0,this.kr=$l.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,s)=>r(s)),ve.resolve()}getLastRemoteSnapshotVersion(e){return ve.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ve.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),ve.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),ve.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new $l(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,ve.resolve()}updateTargetData(e,r){return this.Kn(r),ve.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,ve.resolve()}removeTargets(e,r,n){let s=0;const i=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),s++)}),ve.waitFor(i).next(()=>s)}getTargetCount(e){return ve.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return ve.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),ve.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const s=this.persistence.referenceDelegate,i=[];return s&&r.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),ve.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),ve.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return ve.resolve(n)}containsKey(e,r){return ve.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i8{constructor(e,r){this.qr={},this.overlays={},this.Qr=new R1(0),this.Kr=!1,this.Kr=!0,this.$r=new e8,this.referenceDelegate=e(this),this.Ur=new s8(this),this.indexManager=new KR,this.remoteDocumentCache=function(s){return new r8(s)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new HR(r),this.Gr=new JR(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new ZR,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new t8(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){je("MemoryPersistence","Starting transaction:",e);const s=new a8(this.Qr.next());return this.referenceDelegate.zr(),n(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,r){return ve.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class a8 extends U6{constructor(e){super(),this.currentSequenceNumber=e}}class z1{constructor(e){this.persistence=e,this.Jr=new W1,this.Yr=null}static Zr(e){return new z1(e)}get Xr(){if(this.Yr)return this.Yr;throw Qe()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),ve.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),ve.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),ve.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(s=>this.Xr.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ve.forEach(this.Xr,n=>{const s=Ve.fromPath(n);return this.ei(e,s).next(i=>{i||r.removeEntry(s,Ye.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return ve.or([()=>ve.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H1{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=s}static Wi(e,r){let n=ct(),s=ct();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new H1(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o8{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l8{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return o5()?8:$6(gn())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,s){const i={result:null};return this.Yi(e,r).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,r,s,n).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new o8;return this.Xi(e,r,a).next(o=>{if(i.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>i.result)}es(e,r,n,s){return n.documentReadCount<this.ji?(Cc()<=ht.DEBUG&&je("QueryEngine","SDK will not create cache indexes for query:",Zo(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),ve.resolve()):(Cc()<=ht.DEBUG&&je("QueryEngine","Query:",Zo(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.Hi*s?(Cc()<=ht.DEBUG&&je("QueryEngine","The SDK decides to create cache indexes for query:",Zo(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ys(r))):ve.resolve())}Yi(e,r){if(Cy(r))return ve.resolve(null);let n=Ys(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=ng(r,null,"F"),n=Ys(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const a=ct(...i);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const u=this.ts(r,o);return this.ns(r,u,a,l.readTime)?this.Yi(e,ng(r,null,"F")):this.rs(e,u,r,l)}))})))}Zi(e,r,n,s){return Cy(r)||s.isEqual(Ye.min())?ve.resolve(null):this.Ji.getDocuments(e,n).next(i=>{const a=this.ts(r,i);return this.ns(r,a,n,s)?ve.resolve(null):(Cc()<=ht.DEBUG&&je("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Zo(r)),this.rs(e,a,r,O6(s,-1)).next(o=>o))})}ts(e,r){let n=new Xr(Ok(e));return r.forEach((s,i)=>{fd(e,i)&&(n=n.add(i))}),n}ns(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,r,n){return Cc()<=ht.DEBUG&&je("QueryEngine","Using full collection scan to execute query:",Zo(r)),this.Ji.getDocumentsMatchingQuery(e,r,ka.min(),n)}rs(e,r,n,s){return this.Ji.getDocumentsMatchingQuery(e,n,s).next(i=>(r.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c8{constructor(e,r,n,s){this.persistence=e,this.ss=r,this.serializer=s,this.os=new Zt(wt),this._s=new nc(i=>D1(i),j1),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new YR(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function u8(t,e,r,n){return new c8(t,e,r,n)}async function sT(t,e){const r=Je(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(i=>(s=i,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(i=>{const a=[],o=[];let l=ct();for(const u of s){a.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}for(const u of i){o.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}return r.localDocuments.getDocuments(n,l).next(u=>({hs:u,removedBatchIds:a,addedBatchIds:o}))})})}function h8(t,e){const r=Je(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),i=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,u,h){const d=u.batch,m=d.keys();let p=ve.resolve();return m.forEach(x=>{p=p.next(()=>h.getEntry(l,x)).next(g=>{const y=u.docVersions.get(x);Lt(y!==null),g.version.compareTo(y)<0&&(d.applyToRemoteDocument(g,u),g.isValidDocument()&&(g.setReadTime(u.commitVersion),h.addEntry(g)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,d))}(r,n,e,i).next(()=>i.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=ct();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(l=l.add(o.batch.mutations[u].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function iT(t){const e=Je(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function f8(t,e){const r=Je(t),n=e.snapshotVersion;let s=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});s=r.os;const o=[];e.targetChanges.forEach((h,d)=>{const m=s.get(d);if(!m)return;o.push(r.Ur.removeMatchingKeys(i,h.removedDocuments,d).next(()=>r.Ur.addMatchingKeys(i,h.addedDocuments,d)));let p=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(d)!==null?p=p.withResumeToken(Yr.EMPTY_BYTE_STRING,Ye.min()).withLastLimboFreeSnapshotVersion(Ye.min()):h.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(h.resumeToken,n)),s=s.insert(d,p),function(g,y,w){return g.resumeToken.approximateByteSize()===0||y.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(m,p,h)&&o.push(r.Ur.updateTargetData(i,p))});let l=Fi(),u=ct();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(i,h))}),o.push(d8(i,a,e.documentUpdates).next(h=>{l=h.Ps,u=h.Is})),!n.isEqual(Ye.min())){const h=r.Ur.getLastRemoteSnapshotVersion(i).next(d=>r.Ur.setTargetsMetadata(i,i.currentSequenceNumber,n));o.push(h)}return ve.waitFor(o).next(()=>a.apply(i)).next(()=>r.localDocuments.getLocalViewOfDocuments(i,l,u)).next(()=>l)}).then(i=>(r.os=s,i))}function d8(t,e,r){let n=ct(),s=ct();return r.forEach(i=>n=n.add(i)),e.getEntries(t,n).next(i=>{let a=Fi();return r.forEach((o,l)=>{const u=i.get(o);l.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(o)),l.isNoDocument()&&l.version.isEqual(Ye.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):je("LocalStore","Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",l.version)}),{Ps:a,Is:s}})}function m8(t,e){const r=Je(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function p8(t,e){const r=Je(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Ur.getTargetData(n,e).next(i=>i?(s=i,ve.resolve(s)):r.Ur.allocateTargetId(n).next(a=>(s=new ia(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.os.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function lg(t,e,r){const n=Je(t),s=n.os.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,a=>n.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!lu(a))throw a;je("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(s.target)}function My(t,e,r){const n=Je(t);let s=Ye.min(),i=ct();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,u,h){const d=Je(l),m=d._s.get(h);return m!==void 0?ve.resolve(d.os.get(m)):d.Ur.getTargetData(u,h)}(n,a,Ys(e)).next(o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{i=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?s:Ye.min(),r?i:ct())).next(o=>(g8(n,aR(e),o),{documents:o,Ts:i})))}function g8(t,e,r){let n=t.us.get(e)||Ye.min();r.forEach((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),t.us.set(e,n)}class By{constructor(){this.activeTargetIds=fR()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class x8{constructor(){this.so=new By,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new By,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v8{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){je("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){je("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sh=null;function Nm(){return sh===null?sh=function(){return 268435456+Math.round(2147483648*Math.random())}():sh++,"0x"+sh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y8={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w8{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sn="WebChannelConnection";class _8 extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(r,n,s,i,a){const o=Nm(),l=this.xo(r,n.toUriEncodedString());je("RestConnection",`Sending RPC '${r}' ${o}:`,l,s);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,i,a),this.No(r,l,u,s).then(h=>(je("RestConnection",`Received RPC '${r}' ${o}: `,h),h),h=>{throw Ml("RestConnection",`RPC '${r}' ${o} failed with error: `,h,"url: ",l,"request:",s),h})}Lo(r,n,s,i,a,o){return this.Mo(r,n,s,i,a)}Oo(r,n,s){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+tc}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,a)=>r[a]=i),s&&s.headers.forEach((i,a)=>r[a]=i)}xo(r,n){const s=y8[r];return`${this.Do}/v1/${n}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,s){const i=Nm();return new Promise((a,o)=>{const l=new yk;l.setWithCredentials(!0),l.listenOnce(wk.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Ih.NO_ERROR:const h=l.getResponseJson();je(sn,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(h)),a(h);break;case Ih.TIMEOUT:je(sn,`RPC '${e}' ${i} timed out`),o(new Fe(me.DEADLINE_EXCEEDED,"Request time out"));break;case Ih.HTTP_ERROR:const d=l.getStatus();if(je(sn,`RPC '${e}' ${i} failed with status:`,d,"response text:",l.getResponseText()),d>0){let m=l.getResponseJson();Array.isArray(m)&&(m=m[0]);const p=m==null?void 0:m.error;if(p&&p.status&&p.message){const x=function(y){const w=y.toLowerCase().replace(/_/g,"-");return Object.values(me).indexOf(w)>=0?w:me.UNKNOWN}(p.status);o(new Fe(x,p.message))}else o(new Fe(me.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new Fe(me.UNAVAILABLE,"Connection failed."));break;default:Qe()}}finally{je(sn,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(s);je(sn,`RPC '${e}' ${i} sending request:`,s),l.send(r,"POST",u,n,15)})}Bo(e,r,n){const s=Nm(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=kk(),o=Ek(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const h=i.join("");je(sn,`Creating RPC '${e}' stream ${s}: ${h}`,l);const d=a.createWebChannel(h,l);let m=!1,p=!1;const x=new w8({Io:y=>{p?je(sn,`Not sending because RPC '${e}' stream ${s} is closed:`,y):(m||(je(sn,`Opening RPC '${e}' stream ${s} transport.`),d.open(),m=!0),je(sn,`RPC '${e}' stream ${s} sending:`,y),d.send(y))},To:()=>d.close()}),g=(y,w,E)=>{y.listen(w,_=>{try{E(_)}catch(N){setTimeout(()=>{throw N},0)}})};return g(d,jc.EventType.OPEN,()=>{p||(je(sn,`RPC '${e}' stream ${s} transport opened.`),x.yo())}),g(d,jc.EventType.CLOSE,()=>{p||(p=!0,je(sn,`RPC '${e}' stream ${s} transport closed`),x.So())}),g(d,jc.EventType.ERROR,y=>{p||(p=!0,Ml(sn,`RPC '${e}' stream ${s} transport errored:`,y),x.So(new Fe(me.UNAVAILABLE,"The operation could not be completed")))}),g(d,jc.EventType.MESSAGE,y=>{var w;if(!p){const E=y.data[0];Lt(!!E);const _=E,N=_.error||((w=_[0])===null||w===void 0?void 0:w.error);if(N){je(sn,`RPC '${e}' stream ${s} received error:`,N);const j=N.status;let D=function(b){const C=pr[b];if(C!==void 0)return qk(C)}(j),k=N.message;D===void 0&&(D=me.INTERNAL,k="Unknown error status: "+j+" with message "+N.message),p=!0,x.So(new Fe(D,k)),d.close()}else je(sn,`RPC '${e}' stream ${s} received:`,E),x.bo(E)}}),g(o,_k.STAT_EVENT,y=>{y.stat===Yp.PROXY?je(sn,`RPC '${e}' stream ${s} detected buffering proxy`):y.stat===Yp.NOPROXY&&je(sn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.wo()},0),x}}function Am(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gd(t){return new RR(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aT{constructor(e,r,n=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),s=Math.max(0,r-n);s>0&&je("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oT{constructor(e,r,n,s,i,a,o,l){this.ui=e,this.Ho=n,this.Jo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new aT(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===me.RESOURCE_EXHAUSTED?(Pi(r.toString()),Pi("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===me.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.Yo===r&&this.P_(n,s)},n=>{e(()=>{const s=new Fe(me.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(s)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{n(()=>this.I_(s))}),this.stream.onMessage(s=>{n(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return je("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(je("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class E8 extends oT{constructor(e,r,n,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=LR(this.serializer,e),n=function(i){if(!("targetChange"in i))return Ye.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Ye.min():a.readTime?Js(a.readTime):Ye.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=og(this.serializer),r.addTarget=function(i,a){let o;const l=a.target;if(o=tg(l)?{documents:OR(i,l)}:{query:MR(i,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=Yk(i,a.resumeToken);const u=sg(i,a.expectedCount);u!==null&&(o.expectedCount=u)}else if(a.snapshotVersion.compareTo(Ye.min())>0){o.readTime=wf(i,a.snapshotVersion.toTimestamp());const u=sg(i,a.expectedCount);u!==null&&(o.expectedCount=u)}return o}(this.serializer,e);const n=VR(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=og(this.serializer),r.removeTarget=e,this.a_(r)}}class k8 extends oT{constructor(e,r,n,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return Lt(!!e.streamToken),this.lastStreamToken=e.streamToken,Lt(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Lt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=jR(e.writeResults,e.commitTime),n=Js(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=og(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>DR(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T8 extends class{}{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new Fe(me.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,ig(r,n),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Fe(me.UNKNOWN,i.toString())})}Lo(e,r,n,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,ig(r,n),s,a,o,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Fe(me.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class S8{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Pi(r),this.D_=!1):je("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b8{constructor(e,r,n,s,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{n.enqueueAndForget(async()=>{Fo(this)&&(je("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=Je(l);u.L_.add(4),await hu(u),u.q_.set("Unknown"),u.L_.delete(4),await xd(u)}(this))})}),this.q_=new S8(n,s)}}async function xd(t){if(Fo(t))for(const e of t.B_)await e(!0)}async function hu(t){for(const e of t.B_)await e(!1)}function lT(t,e){const r=Je(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),X1(r)?q1(r):sc(r).r_()&&K1(r,e))}function G1(t,e){const r=Je(t),n=sc(r);r.N_.delete(e),n.r_()&&cT(r,e),r.N_.size===0&&(n.r_()?n.o_():Fo(r)&&r.q_.set("Unknown"))}function K1(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ye.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}sc(t).A_(e)}function cT(t,e){t.Q_.xe(e),sc(t).R_(e)}function q1(t){t.Q_=new CR({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),sc(t).start(),t.q_.v_()}function X1(t){return Fo(t)&&!sc(t).n_()&&t.N_.size>0}function Fo(t){return Je(t).L_.size===0}function uT(t){t.Q_=void 0}async function C8(t){t.q_.set("Online")}async function N8(t){t.N_.forEach((e,r)=>{K1(t,e)})}async function A8(t,e){uT(t),X1(t)?(t.q_.M_(e),q1(t)):t.q_.set("Unknown")}async function I8(t,e,r){if(t.q_.set("Online"),e instanceof Qk&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const o of i.targetIds)s.N_.has(o)&&(await s.remoteSyncer.rejectListen(o,a),s.N_.delete(o),s.Q_.removeTarget(o))}(t,e)}catch(n){je("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await _f(t,n)}else if(e instanceof Fh?t.Q_.Ke(e):e instanceof Xk?t.Q_.He(e):t.Q_.We(e),!r.isEqual(Ye.min()))try{const n=await iT(t.localStore);r.compareTo(n)>=0&&await function(i,a){const o=i.Q_.rt(a);return o.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const h=i.N_.get(u);h&&i.N_.set(u,h.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,u)=>{const h=i.N_.get(l);if(!h)return;i.N_.set(l,h.withResumeToken(Yr.EMPTY_BYTE_STRING,h.snapshotVersion)),cT(i,l);const d=new ia(h.target,l,u,h.sequenceNumber);K1(i,d)}),i.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){je("RemoteStore","Failed to raise snapshot:",n),await _f(t,n)}}async function _f(t,e,r){if(!lu(e))throw e;t.L_.add(1),await hu(t),t.q_.set("Offline"),r||(r=()=>iT(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{je("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await xd(t)})}function hT(t,e){return e().catch(r=>_f(t,r,e))}async function vd(t){const e=Je(t),r=Sa(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;R8(e);)try{const s=await m8(e.localStore,n);if(s===null){e.O_.length===0&&r.o_();break}n=s.batchId,P8(e,s)}catch(s){await _f(e,s)}fT(e)&&dT(e)}function R8(t){return Fo(t)&&t.O_.length<10}function P8(t,e){t.O_.push(e);const r=Sa(t);r.r_()&&r.V_&&r.m_(e.mutations)}function fT(t){return Fo(t)&&!Sa(t).n_()&&t.O_.length>0}function dT(t){Sa(t).start()}async function F8(t){Sa(t).p_()}async function L8(t){const e=Sa(t);for(const r of t.O_)e.m_(r.mutations)}async function D8(t,e,r){const n=t.O_.shift(),s=V1.from(n,e,r);await hT(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await vd(t)}async function j8(t,e){e&&Sa(t).V_&&await async function(n,s){if(function(a){return TR(a)&&a!==me.ABORTED}(s.code)){const i=n.O_.shift();Sa(n).s_(),await hT(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await vd(n)}}(t,e),fT(t)&&dT(t)}async function Uy(t,e){const r=Je(t);r.asyncQueue.verifyOperationInProgress(),je("RemoteStore","RemoteStore received new credentials");const n=Fo(r);r.L_.add(3),await hu(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await xd(r)}async function O8(t,e){const r=Je(t);e?(r.L_.delete(2),await xd(r)):e||(r.L_.add(2),await hu(r),r.q_.set("Unknown"))}function sc(t){return t.K_||(t.K_=function(r,n,s){const i=Je(r);return i.w_(),new E8(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:C8.bind(null,t),Ro:N8.bind(null,t),mo:A8.bind(null,t),d_:I8.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),X1(t)?q1(t):t.q_.set("Unknown")):(await t.K_.stop(),uT(t))})),t.K_}function Sa(t){return t.U_||(t.U_=function(r,n,s){const i=Je(r);return i.w_(),new k8(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:F8.bind(null,t),mo:j8.bind(null,t),f_:L8.bind(null,t),g_:D8.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await vd(t)):(await t.U_.stop(),t.O_.length>0&&(je("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q1{constructor(e,r,n,s,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new ki,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,i){const a=Date.now()+n,o=new Q1(e,r,a,s,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Fe(me.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Y1(t,e){if(Pi("AsyncQueue",`${e}: ${t}`),lu(t))return new Fe(me.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(e){this.comparator=e?(r,n)=>e(r,n)||Ve.comparator(r.key,n.key):(r,n)=>Ve.comparator(r.key,n.key),this.keyedMap=Oc(),this.sortedSet=new Zt(this.comparator)}static emptySet(e){return new kl(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof kl)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new kl;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y{constructor(){this.W_=new Zt(Ve.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):Qe():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class Wl{constructor(e,r,n,s,i,a,o,l,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,s,i){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new Wl(e,r,kl.emptySet(r),a,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M8{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class B8{constructor(){this.queries=Wy(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const s=Je(r),i=s.queries;s.queries=Wy(),i.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new Fe(me.ABORTED,"Firestore shutting down"))}}function Wy(){return new nc(t=>jk(t),hd)}async function mT(t,e){const r=Je(t);let n=3;const s=e.query;let i=r.queries.get(s);i?!i.H_()&&e.J_()&&(n=2):(i=new M8,n=e.J_()?0:1);try{switch(n){case 0:i.z_=await r.onListen(s,!0);break;case 1:i.z_=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(a){const o=Y1(a,`Initialization of query '${Zo(e.query)}' failed`);return void e.onError(o)}r.queries.set(s,i),i.j_.push(e),e.Z_(r.onlineState),i.z_&&e.X_(i.z_)&&J1(r)}async function pT(t,e){const r=Je(t),n=e.query;let s=3;const i=r.queries.get(n);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function V8(t,e){const r=Je(t);let n=!1;for(const s of e){const i=s.query,a=r.queries.get(i);if(a){for(const o of a.j_)o.X_(s)&&(n=!0);a.z_=s}}n&&J1(r)}function U8(t,e,r){const n=Je(t),s=n.queries.get(e);if(s)for(const i of s.j_)i.onError(r);n.queries.delete(e)}function J1(t){t.Y_.forEach(e=>{e.next()})}var cg,zy;(zy=cg||(cg={})).ea="default",zy.Cache="cache";class gT{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new Wl(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=Wl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==cg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xT{constructor(e){this.key=e}}class vT{constructor(e){this.key=e}}class $8{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ct(),this.mutatedKeys=ct(),this.Aa=Ok(e),this.Ra=new kl(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new $y,s=r?r.Ra:this.Ra;let i=r?r.mutatedKeys:this.mutatedKeys,a=s,o=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,d)=>{const m=s.get(h),p=fd(this.query,d)?d:null,x=!!m&&this.mutatedKeys.has(m.key),g=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let y=!1;m&&p?m.data.isEqual(p.data)?x!==g&&(n.track({type:3,doc:p}),y=!0):this.ga(m,p)||(n.track({type:2,doc:p}),y=!0,(l&&this.Aa(p,l)>0||u&&this.Aa(p,u)<0)&&(o=!0)):!m&&p?(n.track({type:0,doc:p}),y=!0):m&&!p&&(n.track({type:1,doc:m}),y=!0,(l||u)&&(o=!0)),y&&(p?(a=a.add(p),i=g?i.add(h):i.delete(h)):(a=a.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const h=this.query.limitType==="F"?a.last():a.first();a=a.delete(h.key),i=i.delete(h.key),n.track({type:1,doc:h})}return{Ra:a,fa:n,ns:o,mutatedKeys:i}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((h,d)=>function(p,x){const g=y=>{switch(y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Qe()}};return g(p)-g(x)}(h.type,d.type)||this.Aa(h.doc,d.doc)),this.pa(n),s=s!=null&&s;const o=r&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,u=l!==this.Ea;return this.Ea=l,a.length!==0||u?{snapshot:new Wl(this.query,e.Ra,i,a,e.mutatedKeys,l===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new $y,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ct(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new vT(n))}),this.da.forEach(n=>{e.has(n)||r.push(new xT(n))}),r}ba(e){this.Ta=e.Ts,this.da=ct();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return Wl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class W8{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class z8{constructor(e){this.key=e,this.va=!1}}class H8{constructor(e,r,n,s,i,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new nc(o=>jk(o),hd),this.Ma=new Map,this.xa=new Set,this.Oa=new Zt(Ve.comparator),this.Na=new Map,this.La=new W1,this.Ba={},this.ka=new Map,this.qa=$l.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function G8(t,e,r=!0){const n=TT(t);let s;const i=n.Fa.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await yT(n,e,r,!0),s}async function K8(t,e){const r=TT(t);await yT(r,e,!0,!1)}async function yT(t,e,r,n){const s=await p8(t.localStore,Ys(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,r);let o;return n&&(o=await q8(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&r&&lT(t.remoteStore,s),o}async function q8(t,e,r,n,s){t.Ka=(d,m,p)=>async function(g,y,w,E){let _=y.view.ma(w);_.ns&&(_=await My(g.localStore,y.query,!1).then(({documents:k})=>y.view.ma(k,_)));const N=E&&E.targetChanges.get(y.targetId),j=E&&E.targetMismatches.get(y.targetId)!=null,D=y.view.applyChanges(_,g.isPrimaryClient,N,j);return Gy(g,y.targetId,D.wa),D.snapshot}(t,d,m,p);const i=await My(t.localStore,e,!0),a=new $8(e,i.Ts),o=a.ma(i.documents),l=uu.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),u=a.applyChanges(o,t.isPrimaryClient,l);Gy(t,r,u.wa);const h=new W8(e,r,a);return t.Fa.set(e,h),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),u.snapshot}async function X8(t,e,r){const n=Je(t),s=n.Fa.get(e),i=n.Ma.get(s.targetId);if(i.length>1)return n.Ma.set(s.targetId,i.filter(a=>!hd(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await lg(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&G1(n.remoteStore,s.targetId),ug(n,s.targetId)}).catch(ou)):(ug(n,s.targetId),await lg(n.localStore,s.targetId,!0))}async function Q8(t,e){const r=Je(t),n=r.Fa.get(e),s=r.Ma.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),G1(r.remoteStore,n.targetId))}async function Y8(t,e,r){const n=sP(t);try{const s=await function(a,o){const l=Je(a),u=Nr.now(),h=o.reduce((p,x)=>p.add(x.key),ct());let d,m;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let x=Fi(),g=ct();return l.cs.getEntries(p,h).next(y=>{x=y,x.forEach((w,E)=>{E.isValidDocument()||(g=g.add(w))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,x)).next(y=>{d=y;const w=[];for(const E of o){const _=yR(E,d.get(E.key).overlayedDocument);_!=null&&w.push(new La(E.key,_,Nk(_.value.mapValue),us.exists(!0)))}return l.mutationQueue.addMutationBatch(p,u,w,o)}).next(y=>{m=y;const w=y.applyToLocalDocumentSet(d,g);return l.documentOverlayCache.saveOverlays(p,y.batchId,w)})}).then(()=>({batchId:m.batchId,changes:Bk(d)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(a,o,l){let u=a.Ba[a.currentUser.toKey()];u||(u=new Zt(wt)),u=u.insert(o,l),a.Ba[a.currentUser.toKey()]=u}(n,s.batchId,r),await fu(n,s.changes),await vd(n.remoteStore)}catch(s){const i=Y1(s,"Failed to persist write");r.reject(i)}}async function wT(t,e){const r=Je(t);try{const n=await f8(r.localStore,e);e.targetChanges.forEach((s,i)=>{const a=r.Na.get(i);a&&(Lt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.va=!0:s.modifiedDocuments.size>0?Lt(a.va):s.removedDocuments.size>0&&(Lt(a.va),a.va=!1))}),await fu(r,n,e)}catch(n){await ou(n)}}function Hy(t,e,r){const n=Je(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Fa.forEach((i,a)=>{const o=a.view.Z_(e);o.snapshot&&s.push(o.snapshot)}),function(a,o){const l=Je(a);l.onlineState=o;let u=!1;l.queries.forEach((h,d)=>{for(const m of d.j_)m.Z_(o)&&(u=!0)}),u&&J1(l)}(n.eventManager,e),s.length&&n.Ca.d_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function J8(t,e,r){const n=Je(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Na.get(e),i=s&&s.key;if(i){let a=new Zt(Ve.comparator);a=a.insert(i,hn.newNoDocument(i,Ye.min()));const o=ct().add(i),l=new pd(Ye.min(),new Map,new Zt(wt),a,o);await wT(n,l),n.Oa=n.Oa.remove(i),n.Na.delete(e),Z1(n)}else await lg(n.localStore,e,!1).then(()=>ug(n,e,r)).catch(ou)}async function Z8(t,e){const r=Je(t),n=e.batch.batchId;try{const s=await h8(r.localStore,e);ET(r,n,null),_T(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await fu(r,s)}catch(s){await ou(s)}}async function eP(t,e,r){const n=Je(t);try{const s=await function(a,o){const l=Je(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return l.mutationQueue.lookupMutationBatch(u,o).next(d=>(Lt(d!==null),h=d.keys(),l.mutationQueue.removeMutationBatch(u,d))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,h,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>l.localDocuments.getDocuments(u,h))})}(n.localStore,e);ET(n,e,r),_T(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await fu(n,s)}catch(s){await ou(s)}}function _T(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function ET(t,e,r){const n=Je(t);let s=n.Ba[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(r?i.reject(r):i.resolve(),s=s.remove(e)),n.Ba[n.currentUser.toKey()]=s}}function ug(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||kT(t,n)})}function kT(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(G1(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),Z1(t))}function Gy(t,e,r){for(const n of r)n instanceof xT?(t.La.addReference(n.key,e),tP(t,n)):n instanceof vT?(je("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||kT(t,n.key)):Qe()}function tP(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(je("SyncEngine","New document in limbo: "+r),t.xa.add(n),Z1(t))}function Z1(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new Ve($t.fromString(e)),n=t.qa.next();t.Na.set(n,new z8(r)),t.Oa=t.Oa.insert(r,n),lT(t.remoteStore,new ia(Ys(O1(r.path)),n,"TargetPurposeLimboResolution",R1.oe))}}async function fu(t,e,r){const n=Je(t),s=[],i=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(u=>{var h;if((u||r)&&n.isPrimaryClient){const d=u?!u.fromCache:(h=r==null?void 0:r.targetChanges.get(l.targetId))===null||h===void 0?void 0:h.current;n.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(u){s.push(u);const d=H1.Wi(l.targetId,u);i.push(d)}}))}),await Promise.all(a),n.Ca.d_(s),await async function(l,u){const h=Je(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>ve.forEach(u,m=>ve.forEach(m.$i,p=>h.persistence.referenceDelegate.addReference(d,m.targetId,p)).next(()=>ve.forEach(m.Ui,p=>h.persistence.referenceDelegate.removeReference(d,m.targetId,p)))))}catch(d){if(!lu(d))throw d;je("LocalStore","Failed to update sequence numbers: "+d)}for(const d of u){const m=d.targetId;if(!d.fromCache){const p=h.os.get(m),x=p.snapshotVersion,g=p.withLastLimboFreeSnapshotVersion(x);h.os=h.os.insert(m,g)}}}(n.localStore,i))}async function rP(t,e){const r=Je(t);if(!r.currentUser.isEqual(e)){je("SyncEngine","User change. New user:",e.toKey());const n=await sT(r.localStore,e);r.currentUser=e,function(i,a){i.ka.forEach(o=>{o.forEach(l=>{l.reject(new Fe(me.CANCELLED,a))})}),i.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await fu(r,n.hs)}}function nP(t,e){const r=Je(t),n=r.Na.get(e);if(n&&n.va)return ct().add(n.key);{let s=ct();const i=r.Ma.get(e);if(!i)return s;for(const a of i){const o=r.Fa.get(a);s=s.unionWith(o.view.Va)}return s}}function TT(t){const e=Je(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=wT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=nP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=J8.bind(null,e),e.Ca.d_=V8.bind(null,e.eventManager),e.Ca.$a=U8.bind(null,e.eventManager),e}function sP(t){const e=Je(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Z8.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=eP.bind(null,e),e}class Ef{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=gd(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return u8(this.persistence,new l8,e.initialUser,this.serializer)}Ga(e){return new i8(z1.Zr,this.serializer)}Wa(e){return new x8}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ef.provider={build:()=>new Ef};class hg{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Hy(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=rP.bind(null,this.syncEngine),await O8(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new B8}()}createDatastore(e){const r=gd(e.databaseInfo.databaseId),n=function(i){return new _8(i)}(e.databaseInfo);return function(i,a,o,l){return new T8(i,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,i,a,o){return new b8(n,s,i,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>Hy(this.syncEngine,r,0),function(){return Vy.D()?new Vy:new v8}())}createSyncEngine(e,r){return function(s,i,a,o,l,u,h){const d=new H8(s,i,a,o,l,u);return h&&(d.Qa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const i=Je(s);je("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await hu(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}hg.provider={build:()=>new hg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ST{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Pi("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(e,r,n,s,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=on.UNAUTHENTICATED,this.clientId=Sk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async a=>{je("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(je("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ki;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Y1(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Im(t,e){t.asyncQueue.verifyOperationInProgress(),je("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await sT(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Ky(t,e){t.asyncQueue.verifyOperationInProgress();const r=await aP(t);je("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>Uy(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>Uy(e.remoteStore,s)),t._onlineComponents=e}async function aP(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){je("FirestoreClient","Using user provided OfflineComponentProvider");try{await Im(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===me.FAILED_PRECONDITION||s.code===me.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;Ml("Error using user provided cache. Falling back to memory cache: "+r),await Im(t,new Ef)}}else je("FirestoreClient","Using default OfflineComponentProvider"),await Im(t,new Ef);return t._offlineComponents}async function bT(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(je("FirestoreClient","Using user provided OnlineComponentProvider"),await Ky(t,t._uninitializedComponentsProvider._online)):(je("FirestoreClient","Using default OnlineComponentProvider"),await Ky(t,new hg))),t._onlineComponents}function oP(t){return bT(t).then(e=>e.syncEngine)}async function CT(t){const e=await bT(t),r=e.eventManager;return r.onListen=G8.bind(null,e.syncEngine),r.onUnlisten=X8.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=K8.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=Q8.bind(null,e.syncEngine),r}function lP(t,e,r={}){const n=new ki;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,o,l,u){const h=new ST({next:m=>{h.Za(),a.enqueueAndForget(()=>pT(i,d));const p=m.docs.has(o);!p&&m.fromCache?u.reject(new Fe(me.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&m.fromCache&&l&&l.source==="server"?u.reject(new Fe(me.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),d=new gT(O1(o.path),h,{includeMetadataChanges:!0,_a:!0});return mT(i,d)}(await CT(t),t.asyncQueue,e,r,n)),n.promise}function cP(t,e,r={}){const n=new ki;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,o,l,u){const h=new ST({next:m=>{h.Za(),a.enqueueAndForget(()=>pT(i,d)),m.fromCache&&l.source==="server"?u.reject(new Fe(me.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),d=new gT(o,h,{includeMetadataChanges:!0,_a:!0});return mT(i,d)}(await CT(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NT(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qy=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AT(t,e,r){if(!r)throw new Fe(me.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function uP(t,e,r,n){if(e===!0&&n===!0)throw new Fe(me.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function Xy(t){if(!Ve.isDocumentKey(t))throw new Fe(me.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Qy(t){if(Ve.isDocumentKey(t))throw new Fe(me.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function yd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Qe()}function js(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Fe(me.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=yd(t);throw new Fe(me.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yy{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Fe(me.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Fe(me.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}uP("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=NT((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Fe(me.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Fe(me.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Fe(me.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class wd{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Yy({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Fe(me.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Fe(me.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Yy(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new N6;switch(n.type){case"firstParty":return new P6(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Fe(me.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=qy.get(r);n&&(je("ComponentProvider","Removing Datastore"),qy.delete(r),n.terminate())}(this),Promise.resolve()}}function hP(t,e,r,n={}){var s;const i=(t=js(t,wd))._getSettings(),a=`${e}:${r}`;if(i.host!=="firestore.googleapis.com"&&i.host!==a&&Ml("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=on.MOCK_USER;else{o=fk(n.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const u=n.mockUserToken.sub||n.mockUserToken.user_id;if(!u)throw new Fe(me.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new on(u)}t._authCredentials=new A6(new Tk(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Lo(this.firestore,e,this._query)}}class Tn{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ya(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Tn(this.firestore,e,this._key)}}class ya extends Lo{constructor(e,r,n){super(e,r,O1(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Tn(this.firestore,null,new Ve(e))}withConverter(e){return new ya(this.firestore,e,this._path)}}function Jr(t,e,...r){if(t=ir(t),AT("collection","path",e),t instanceof wd){const n=$t.fromString(e,...r);return Qy(n),new ya(t,null,n)}{if(!(t instanceof Tn||t instanceof ya))throw new Fe(me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child($t.fromString(e,...r));return Qy(n),new ya(t.firestore,null,n)}}function hr(t,e,...r){if(t=ir(t),arguments.length===1&&(e=Sk.newId()),AT("doc","path",e),t instanceof wd){const n=$t.fromString(e,...r);return Xy(n),new Tn(t,null,new Ve(n))}{if(!(t instanceof Tn||t instanceof ya))throw new Fe(me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child($t.fromString(e,...r));return Xy(n),new Tn(t.firestore,t instanceof ya?t.converter:null,new Ve(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new aT(this,"async_queue_retry"),this.Vu=()=>{const n=Am();n&&je("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=Am();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=Am();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new ki;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!lu(e))throw e;je("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const s=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw Pi("INTERNAL UNHANDLED ERROR: ",s),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const s=Q1.createAndSchedule(this,e,r,n,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&Qe()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}class Do extends wd{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new Jy,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Jy(e),this._firestoreClient=void 0,await e}}}function fP(t,e){const r=typeof t=="object"?t:A1(),n=typeof t=="string"?t:e||"(default)",s=cd(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=ck("firestore");i&&hP(s,...i)}return s}function ex(t){if(t._terminated)throw new Fe(me.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||dP(t),t._firestoreClient}function dP(t){var e,r,n;const s=t._freezeSettings(),i=function(o,l,u,h){return new H6(o,l,u,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,NT(h.experimentalLongPollingOptions),h.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new iP(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new zl(Yr.fromBase64String(e))}catch(r){throw new Fe(me.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new zl(Yr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Fe(me.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Gr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tx{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rx{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Fe(me.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Fe(me.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return wt(this._lat,e._lat)||wt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nx{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mP=/^__.*__$/;class pP{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new La(e,this.data,this.fieldMask,r,this.fieldTransforms):new cu(e,this.data,r,this.fieldTransforms)}}class IT{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new La(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function RT(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Qe()}}class sx{constructor(e,r,n,s,i,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new sx(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.Ou(e),s}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return kf(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(RT(this.Cu)&&mP.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class gP{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||gd(e)}Qu(e,r,n,s=!1){return new sx({Cu:e,methodName:r,qu:n,path:Gr.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ed(t){const e=t._freezeSettings(),r=gd(t._databaseId);return new gP(t._databaseId,!!e.ignoreUndefinedProperties,r)}function PT(t,e,r,n,s,i={}){const a=t.Qu(i.merge||i.mergeFields?2:0,e,r,s);ix("Data must be an object, but it was:",a,n);const o=FT(n,a);let l,u;if(i.merge)l=new Hn(a.fieldMask),u=a.fieldTransforms;else if(i.mergeFields){const h=[];for(const d of i.mergeFields){const m=fg(e,d,r);if(!a.contains(m))throw new Fe(me.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);DT(h,m)||h.push(m)}l=new Hn(h),u=a.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,u=a.fieldTransforms;return new pP(new Rn(o),l,u)}class kd extends tx{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof kd}}function xP(t,e,r,n){const s=t.Qu(1,e,r);ix("Data must be an object, but it was:",s,n);const i=[],a=Rn.empty();Po(n,(l,u)=>{const h=ax(e,l,r);u=ir(u);const d=s.Nu(h);if(u instanceof kd)i.push(h);else{const m=du(u,d);m!=null&&(i.push(h),a.set(h,m))}});const o=new Hn(i);return new IT(a,o,s.fieldTransforms)}function vP(t,e,r,n,s,i){const a=t.Qu(1,e,r),o=[fg(e,n,r)],l=[s];if(i.length%2!=0)throw new Fe(me.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)o.push(fg(e,i[m])),l.push(i[m+1]);const u=[],h=Rn.empty();for(let m=o.length-1;m>=0;--m)if(!DT(u,o[m])){const p=o[m];let x=l[m];x=ir(x);const g=a.Nu(p);if(x instanceof kd)u.push(p);else{const y=du(x,g);y!=null&&(u.push(p),h.set(p,y))}}const d=new Hn(u);return new IT(h,d,a.fieldTransforms)}function yP(t,e,r,n=!1){return du(r,t.Qu(n?4:3,e))}function du(t,e){if(LT(t=ir(t)))return ix("Unsupported field value:",e,t),FT(t,e);if(t instanceof tx)return function(n,s){if(!RT(s.Cu))throw s.Bu(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,s){const i=[];let a=0;for(const o of n){let l=du(o,s.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}}(t,e)}return function(n,s){if((n=ir(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return dR(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=Nr.fromDate(n);return{timestampValue:wf(s.serializer,i)}}if(n instanceof Nr){const i=new Nr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:wf(s.serializer,i)}}if(n instanceof rx)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof zl)return{bytesValue:Yk(s.serializer,n._byteString)};if(n instanceof Tn){const i=s.databaseId,a=n.firestore._databaseId;if(!a.isEqual(i))throw s.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:$1(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof nx)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return M1(o.serializer,l)})}}}}}}(n,s);throw s.Bu(`Unsupported field value: ${yd(n)}`)}(t,e)}function FT(t,e){const r={};return bk(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Po(t,(n,s)=>{const i=du(s,e.Mu(n));i!=null&&(r[n]=i)}),{mapValue:{fields:r}}}function LT(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Nr||t instanceof rx||t instanceof zl||t instanceof Tn||t instanceof tx||t instanceof nx)}function ix(t,e,r){if(!LT(r)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(r)){const n=yd(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function fg(t,e,r){if((e=ir(e))instanceof _d)return e._internalPath;if(typeof e=="string")return ax(t,e);throw kf("Field path arguments must be of type string or ",t,!1,void 0,r)}const wP=new RegExp("[~\\*/\\[\\]]");function ax(t,e,r){if(e.search(wP)>=0)throw kf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new _d(...e.split("."))._internalPath}catch{throw kf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function kf(t,e,r,n,s){const i=n&&!n.isEmpty(),a=s!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${n}`),a&&(l+=` in document ${s}`),l+=")"),new Fe(me.INVALID_ARGUMENT,o+t+l)}function DT(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jT{constructor(e,r,n,s,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Tn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new _P(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Td("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class _P extends jT{data(){return super.data()}}function Td(t,e){return typeof e=="string"?ax(t,e):e instanceof _d?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EP(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Fe(me.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ox{}class OT extends ox{}function Os(t,e,...r){let n=[];e instanceof ox&&n.push(e),n=n.concat(r),function(i){const a=i.filter(l=>l instanceof lx).length,o=i.filter(l=>l instanceof Sd).length;if(a>1||a>0&&o>0)throw new Fe(me.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class Sd extends OT{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Sd(e,r,n)}_apply(e){const r=this._parse(e);return MT(e._query,r),new Lo(e.firestore,e.converter,rg(e._query,r))}_parse(e){const r=Ed(e.firestore);return function(i,a,o,l,u,h,d){let m;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Fe(me.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){ew(d,h);const p=[];for(const x of d)p.push(Zy(l,i,x));m={arrayValue:{values:p}}}else m=Zy(l,i,d)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||ew(d,h),m=yP(o,a,d,h==="in"||h==="not-in");return wr.create(u,h,m)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function ri(t,e,r){const n=e,s=Td("where",t);return Sd._create(s,n,r)}class lx extends ox{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new lx(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Ds.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,i){let a=s;const o=i.getFlattenedFilters();for(const l of o)MT(a,l),a=rg(a,l)}(e._query,r),new Lo(e.firestore,e.converter,rg(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class cx extends OT{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new cx(e,r)}_apply(e){const r=function(s,i,a){if(s.startAt!==null)throw new Fe(me.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Fe(me.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new j0(i,a)}(e._query,this._field,this._direction);return new Lo(e.firestore,e.converter,function(s,i){const a=s.explicitOrderBy.concat([i]);return new rc(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,r))}}function kP(t,e="asc"){const r=e,n=Td("orderBy",t);return cx._create(n,r)}function Zy(t,e,r){if(typeof(r=ir(r))=="string"){if(r==="")throw new Fe(me.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Dk(e)&&r.indexOf("/")!==-1)throw new Fe(me.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child($t.fromString(r));if(!Ve.isDocumentKey(n))throw new Fe(me.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return _y(t,new Ve(n))}if(r instanceof Tn)return _y(t,r._key);throw new Fe(me.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${yd(r)}.`)}function ew(t,e){if(!Array.isArray(t)||t.length===0)throw new Fe(me.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function MT(t,e){const r=function(s,i){for(const a of s)for(const o of a.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Fe(me.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Fe(me.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class TP{convertValue(e,r="none"){switch(yo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return lr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(vo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Qe()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Po(e,(s,i)=>{n[s]=this.convertValue(i,r)}),n}convertVectorValue(e){var r,n,s;const i=(s=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(a=>lr(a.doubleValue));return new nx(i)}convertGeoPoint(e){return new rx(lr(e.latitude),lr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=F1(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(F0(e));default:return null}}convertTimestamp(e){const r=Ta(e);return new Nr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=$t.fromString(e);Lt(nT(n));const s=new L0(n.get(1),n.get(3)),i=new Ve(n.popFirst(5));return s.isEqual(r)||Pi(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BT(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bc{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class VT extends jT{constructor(e,r,n,s,i,a){super(e,r,n,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Lh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Td("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class Lh extends VT{data(e={}){return super.data(e)}}class SP{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new Bc(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Lh(this._firestore,this._userDataWriter,n.key,n,new Bc(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Fe(me.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(o=>{const l=new Lh(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Bc(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>i||o.type!==3).map(o=>{const l=new Lh(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Bc(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,h=-1;return o.type!==0&&(u=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),h=a.indexOf(o.doc.key)),{type:bP(o.type),doc:l,oldIndex:u,newIndex:h}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function bP(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Qe()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hl(t){t=js(t,Tn);const e=js(t.firestore,Do);return lP(ex(e),t._key).then(r=>CP(e,t,r))}class UT extends TP{constructor(e){super(),this.firestore=e}convertBytes(e){return new zl(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Tn(this.firestore,null,r)}}function bn(t){t=js(t,Lo);const e=js(t.firestore,Do),r=ex(e),n=new UT(e);return EP(t._query),cP(r,t._query).then(s=>new SP(e,n,t,s))}function Tf(t,e,r){t=js(t,Tn);const n=js(t.firestore,Do),s=BT(t.converter,e,r);return bd(n,[PT(Ed(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,us.none())])}function mu(t,e,r,...n){t=js(t,Tn);const s=js(t.firestore,Do),i=Ed(s);let a;return a=typeof(e=ir(e))=="string"||e instanceof _d?vP(i,"updateDoc",t._key,e,r,n):xP(i,"updateDoc",t._key,e),bd(s,[a.toMutation(t._key,us.exists(!0))])}function io(t){return bd(js(t.firestore,Do),[new B1(t._key,us.none())])}function ux(t,e){const r=js(t.firestore,Do),n=hr(t),s=BT(t.converter,e);return bd(r,[PT(Ed(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,us.exists(!1))]).then(()=>n)}function bd(t,e){return function(n,s){const i=new ki;return n.asyncQueue.enqueueAndForget(async()=>Y8(await oP(n),s,i)),i.promise}(ex(t),e)}function CP(t,e,r){const n=r.docs.get(e._key),s=new UT(t);return new VT(t,s,e._key,n,new Bc(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(s){tc=s})(Ro),go(new Ea("firestore",(n,{instanceIdentifier:s,options:i})=>{const a=n.getProvider("app").getImmediate(),o=new Do(new I6(n.getProvider("auth-internal")),new L6(n.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Fe(me.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new L0(u.options.projectId,h)}(a,s),a);return i=Object.assign({useFetchStreams:r},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),Qs(gy,"4.7.3",e),Qs(gy,"4.7.3","esm2017")})();const NP="modulepreload",AP=function(t){return"/"+t},tw={},IP=function(e,r,n){if(!r||r.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(r.map(i=>{if(i=AP(i),i in tw)return;tw[i]=!0;const a=i.endsWith(".css"),o=a?'[rel="stylesheet"]':"";if(!!n)for(let h=s.length-1;h>=0;h--){const d=s[h];if(d.href===i&&(!a||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${o}`))return;const u=document.createElement("link");if(u.rel=a?"stylesheet":NP,a||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),a)return new Promise((h,d)=>{u.addEventListener("load",h),u.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=i,window.dispatchEvent(a),!a.defaultPrevented)throw i})};var RP="firebase",PP="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qs(RP,PP,"app");function hx(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function $T(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const FP=$T,WT=new iu("auth","Firebase",$T());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sf=new C1("@firebase/auth");function LP(t,...e){Sf.logLevel<=ht.WARN&&Sf.warn(`Auth (${Ro}): ${t}`,...e)}function Dh(t,...e){Sf.logLevel<=ht.ERROR&&Sf.error(`Auth (${Ro}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ms(t,...e){throw dx(t,...e)}function Rs(t,...e){return dx(t,...e)}function fx(t,e,r){const n=Object.assign(Object.assign({},FP()),{[e]:r});return new iu("auth","Firebase",n).create(e,{appName:t.name})}function Zs(t){return fx(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function zT(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&ms(t,"argument-error"),fx(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function dx(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return WT.create(t,...e)}function qe(t,e,...r){if(!t)throw dx(e,...r)}function vi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Dh(e),new Error(e)}function Li(t,e){t||vi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function DP(){return rw()==="http:"||rw()==="https:"}function rw(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jP(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(DP()||s5()||"connection"in navigator)?navigator.onLine:!0}function OP(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e,r){this.shortDelay=e,this.longDelay=r,Li(r>e,"Short delay should be less than long delay!"),this.isMobile=t5()||i5()}get(){return jP()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mx(t,e){Li(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HT{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;vi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;vi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;vi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BP=new pu(3e4,6e4);function Da(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function ii(t,e,r,n,s={}){return GT(t,s,async()=>{let i={},a={};n&&(e==="GET"?a=n:i={body:JSON.stringify(n)});const o=au(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:l},i);return n5()||(u.referrerPolicy="no-referrer"),HT.fetch()(KT(t,t.config.apiHost,r,o),u)})}async function GT(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},MP),e);try{const s=new UP(t),i=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw ih(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const o=i.ok?a.errorMessage:a.error.message,[l,u]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw ih(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw ih(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw ih(t,"user-disabled",a);const h=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw fx(t,h,u);ms(t,h)}}catch(s){if(s instanceof si)throw s;ms(t,"network-request-failed",{message:String(s)})}}async function gu(t,e,r,n,s={}){const i=await ii(t,e,r,n,s);return"mfaPendingCredential"in i&&ms(t,"multi-factor-auth-required",{_serverResponse:i}),i}function KT(t,e,r,n){const s=`${e}${r}?${n}`;return t.config.emulator?mx(t.config,s):`${t.config.apiScheme}://${s}`}function VP(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class UP{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Rs(this.auth,"network-request-failed")),BP.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function ih(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=Rs(t,e,n);return s.customData._tokenResponse=r,s}function nw(t){return t!==void 0&&t.enterprise!==void 0}class $P{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return VP(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function WP(t,e){return ii(t,"GET","/v2/recaptchaConfig",Da(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zP(t,e){return ii(t,"POST","/v1/accounts:delete",e)}async function qT(t,e){return ii(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n0(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function HP(t,e=!1){const r=ir(t),n=await r.getIdToken(e),s=px(n);qe(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:n0(Rm(s.auth_time)),issuedAtTime:n0(Rm(s.iat)),expirationTime:n0(Rm(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Rm(t){return Number(t)*1e3}function px(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Dh("JWT malformed, contained fewer than 3 sections"),null;try{const s=ok(r);return s?JSON.parse(s):(Dh("Failed to decode base64 JWT payload"),null)}catch(s){return Dh("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function sw(t){const e=px(t);return qe(e,"internal-error"),qe(typeof e.exp<"u","internal-error"),qe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wo(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof si&&GP(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function GP({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KP{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mg{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=n0(this.lastLoginAt),this.creationTime=n0(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bf(t){var e;const r=t.auth,n=await t.getIdToken(),s=await wo(t,qT(r,{idToken:n}));qe(s==null?void 0:s.users.length,r,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const a=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?XT(i.providerUserInfo):[],o=XP(t.providerData,a),l=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),h=l?u:!1,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new mg(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(t,d)}async function qP(t){const e=ir(t);await bf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function XP(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function XT(t){return t.map(e=>{var{providerId:r}=e,n=hx(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QP(t,e){const r=await GT(t,{},async()=>{const n=au({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=KT(t,s,"/v1/token",`key=${i}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",HT.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function YP(t,e){return ii(t,"POST","/v2/accounts:revokeToken",Da(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){qe(e.idToken,"internal-error"),qe(typeof e.idToken<"u","internal-error"),qe(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):sw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){qe(e.length!==0,"internal-error");const r=sw(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(qe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:i}=await QP(e,r);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:i}=r,a=new Tl;return n&&(qe(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),s&&(qe(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(qe(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Tl,this.toJSON())}_performRefresh(){return vi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gi(t,e){qe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class yi{constructor(e){var{uid:r,auth:n,stsTokenManager:s}=e,i=hx(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new KP(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new mg(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await wo(this,this.stsTokenManager.getToken(this.auth,e));return qe(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return HP(this,e)}reload(){return qP(this)}_assign(e){this!==e&&(qe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new yi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){qe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await bf(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ls(this.auth.app))return Promise.reject(Zs(this.auth));const e=await this.getIdToken();return await wo(this,zP(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,s,i,a,o,l,u,h;const d=(n=r.displayName)!==null&&n!==void 0?n:void 0,m=(s=r.email)!==null&&s!==void 0?s:void 0,p=(i=r.phoneNumber)!==null&&i!==void 0?i:void 0,x=(a=r.photoURL)!==null&&a!==void 0?a:void 0,g=(o=r.tenantId)!==null&&o!==void 0?o:void 0,y=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,w=(u=r.createdAt)!==null&&u!==void 0?u:void 0,E=(h=r.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:_,emailVerified:N,isAnonymous:j,providerData:D,stsTokenManager:k}=r;qe(_&&k,e,"internal-error");const S=Tl.fromJSON(this.name,k);qe(typeof _=="string",e,"internal-error"),Gi(d,e.name),Gi(m,e.name),qe(typeof N=="boolean",e,"internal-error"),qe(typeof j=="boolean",e,"internal-error"),Gi(p,e.name),Gi(x,e.name),Gi(g,e.name),Gi(y,e.name),Gi(w,e.name),Gi(E,e.name);const b=new yi({uid:_,auth:e,email:m,emailVerified:N,displayName:d,isAnonymous:j,photoURL:x,phoneNumber:p,tenantId:g,stsTokenManager:S,createdAt:w,lastLoginAt:E});return D&&Array.isArray(D)&&(b.providerData=D.map(C=>Object.assign({},C))),y&&(b._redirectEventId=y),b}static async _fromIdTokenResponse(e,r,n=!1){const s=new Tl;s.updateFromServerResponse(r);const i=new yi({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await bf(i),i}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];qe(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?XT(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),o=new Tl;o.updateFromIdToken(n);const l=new yi({uid:s.localId,auth:e,stsTokenManager:o,isAnonymous:a}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new mg(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iw=new Map;function wi(t){Li(t instanceof Function,"Expected a class definition");let e=iw.get(t);return e?(Li(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,iw.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}QT.type="NONE";const aw=QT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jh(t,e,r){return`firebase:${t}:${e}:${r}`}class Sl{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=jh(this.userKey,s.apiKey,i),this.fullPersistenceKey=jh("persistence",s.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?yi._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Sl(wi(aw),e,n);const s=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||wi(aw);const a=jh(n,e.config.apiKey,e.name);let o=null;for(const u of r)try{const h=await u._get(a);if(h){const d=yi._fromJSON(e,h);u!==i&&(o=d),i=u;break}}catch{}const l=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Sl(i,e,n):(i=l[0],o&&await i._set(a,o.toJSON()),await Promise.all(r.map(async u=>{if(u!==i)try{await u._remove(a)}catch{}})),new Sl(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ow(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(eS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(YT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(rS(e))return"Blackberry";if(nS(e))return"Webos";if(JT(e))return"Safari";if((e.includes("chrome/")||ZT(e))&&!e.includes("edge/"))return"Chrome";if(tS(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function YT(t=gn()){return/firefox\//i.test(t)}function JT(t=gn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ZT(t=gn()){return/crios\//i.test(t)}function eS(t=gn()){return/iemobile/i.test(t)}function tS(t=gn()){return/android/i.test(t)}function rS(t=gn()){return/blackberry/i.test(t)}function nS(t=gn()){return/webos/i.test(t)}function gx(t=gn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function JP(t=gn()){var e;return gx(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function ZP(){return a5()&&document.documentMode===10}function sS(t=gn()){return gx(t)||tS(t)||nS(t)||rS(t)||/windows phone/i.test(t)||eS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iS(t,e=[]){let r;switch(t){case"Browser":r=ow(gn());break;case"Worker":r=`${ow(gn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Ro}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eF{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((a,o)=>{try{const l=e(i);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tF(t,e={}){return ii(t,"GET","/v2/passwordPolicy",Da(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rF=6;class nF{constructor(e){var r,n,s,i;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:rF,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,s,i,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sF{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new lw(this),this.idTokenSubscription=new lw(this),this.beforeStateQueue=new eF(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=WT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=wi(r)),this._initializationPromise=this.queue(async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await Sl.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await qT(this,{idToken:e}),n=await yi._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(ls(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return qe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await bf(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=OP()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ls(this.app))return Promise.reject(Zs(this));const r=e?ir(e):null;return r&&qe(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&qe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ls(this.app)?Promise.reject(Zs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ls(this.app)?Promise.reject(Zs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(wi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await tF(this),r=new nF(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new iu("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await YP(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&wi(e)||this._popupRedirectResolver;qe(r,this,"argument-error"),this.redirectPersistenceManager=await Sl.create(this,[wi(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(qe(o,this,"internal-error"),o.then(()=>{a||i(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,s);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return qe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=iS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&LP(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function ai(t){return ir(t)}class lw{constructor(e){this.auth=e,this.observer=null,this.addObserver=m5(r=>this.observer=r)}get next(){return qe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function iF(t){Cd=t}function aS(t){return Cd.loadJS(t)}function aF(){return Cd.recaptchaEnterpriseScript}function oF(){return Cd.gapiScript}function lF(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const cF="recaptcha-enterprise",uF="NO_RECAPTCHA";class hF{constructor(e){this.type=cF,this.auth=ai(e)}async verify(e="verify",r=!1){async function n(i){if(!r){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(a,o)=>{WP(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const u=new $P(l);return i.tenantId==null?i._agentRecaptchaConfig=u:i._tenantRecaptchaConfigs[i.tenantId]=u,a(u.siteKey)}}).catch(l=>{o(l)})})}function s(i,a,o){const l=window.grecaptcha;nw(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(u=>{a(u)}).catch(()=>{a(uF)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,a)=>{n(this.auth).then(o=>{if(!r&&nw(window.grecaptcha))s(o,i,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=aF();l.length!==0&&(l+=o),aS(l).then(()=>{s(o,i,a)}).catch(u=>{a(u)})}}).catch(o=>{a(o)})})}}async function cw(t,e,r,n=!1){const s=new hF(t);let i;try{i=await s.verify(r)}catch{i=await s.verify(r,!0)}const a=Object.assign({},e);return n?Object.assign(a,{captchaResp:i}):Object.assign(a,{captchaResponse:i}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function pg(t,e,r,n){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await cw(t,e,r,r==="getOobCode");return n(t,i)}else return n(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await cw(t,e,r,r==="getOobCode");return n(t,a)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fF(t,e){const r=cd(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),i=r.getOptions();if(mf(i,e??{}))return s;ms(s,"already-initialized")}return r.initialize({options:e})}function dF(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(wi);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function mF(t,e,r){const n=ai(t);qe(n._canInitEmulator,n,"emulator-config-failed"),qe(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!!(r!=null&&r.disableWarnings),i=oS(e),{host:a,port:o}=pF(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${i}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||gF()}function oS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function pF(t){const e=oS(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:uw(n.substr(i.length+1))}}else{const[i,a]=n.split(":");return{host:i,port:uw(a)}}}function uw(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function gF(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xx{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return vi("not implemented")}_getIdTokenResponse(e){return vi("not implemented")}_linkToIdToken(e,r){return vi("not implemented")}_getReauthenticationResolver(e){return vi("not implemented")}}async function xF(t,e){return ii(t,"POST","/v1/accounts:update",e)}async function vF(t,e){return ii(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yF(t,e){return gu(t,"POST","/v1/accounts:signInWithPassword",Da(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wF(t,e){return gu(t,"POST","/v1/accounts:signInWithEmailLink",Da(t,e))}async function _F(t,e){return gu(t,"POST","/v1/accounts:signInWithEmailLink",Da(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B0 extends xx{constructor(e,r,n,s=null){super("password",n),this._email=e,this._password=r,this._tenantId=s}static _fromEmailAndPassword(e,r){return new B0(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new B0(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return pg(e,r,"signInWithPassword",yF);case"emailLink":return wF(e,{email:this._email,oobCode:this._password});default:ms(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return pg(e,n,"signUpPassword",vF);case"emailLink":return _F(e,{idToken:r,email:this._email,oobCode:this._password});default:ms(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bl(t,e){return gu(t,"POST","/v1/accounts:signInWithIdp",Da(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EF="http://localhost";class _o extends xx{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new _o(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):ms("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s}=r,i=hx(r,["providerId","signInMethod"]);if(!n||!s)return null;const a=new _o(n,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return bl(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,bl(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,bl(e,r)}buildRequest(){const e={requestUri:EF,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=au(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kF(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function TF(t){const e=Lc(Dc(t)).link,r=e?Lc(Dc(e)).deep_link_id:null,n=Lc(Dc(t)).deep_link_id;return(n?Lc(Dc(n)).link:null)||n||r||e||t}class vx{constructor(e){var r,n,s,i,a,o;const l=Lc(Dc(e)),u=(r=l.apiKey)!==null&&r!==void 0?r:null,h=(n=l.oobCode)!==null&&n!==void 0?n:null,d=kF((s=l.mode)!==null&&s!==void 0?s:null);qe(u&&h&&d,"argument-error"),this.apiKey=u,this.operation=d,this.code=h,this.continueUrl=(i=l.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(a=l.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(o=l.tenantId)!==null&&o!==void 0?o:null}static parseLink(e){const r=TF(e);try{return new vx(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(){this.providerId=jo.PROVIDER_ID}static credential(e,r){return B0._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=vx.parseLink(r);return qe(n,"argument-error"),B0._fromEmailAndCode(e,n.code,n.tenantId)}}jo.PROVIDER_ID="password";jo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";jo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu extends Nd{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji extends xu{constructor(){super("facebook.com")}static credential(e){return _o._fromParams({providerId:Ji.PROVIDER_ID,signInMethod:Ji.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ji.credentialFromTaggedObject(e)}static credentialFromError(e){return Ji.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ji.credential(e.oauthAccessToken)}catch{return null}}}Ji.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ji.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs extends xu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return _o._fromParams({providerId:Gs.PROVIDER_ID,signInMethod:Gs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Gs.credentialFromTaggedObject(e)}static credentialFromError(e){return Gs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Gs.credential(r,n)}catch{return null}}}Gs.GOOGLE_SIGN_IN_METHOD="google.com";Gs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi extends xu{constructor(){super("github.com")}static credential(e){return _o._fromParams({providerId:Zi.PROVIDER_ID,signInMethod:Zi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zi.credentialFromTaggedObject(e)}static credentialFromError(e){return Zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zi.credential(e.oauthAccessToken)}catch{return null}}}Zi.GITHUB_SIGN_IN_METHOD="github.com";Zi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea extends xu{constructor(){super("twitter.com")}static credential(e,r){return _o._fromParams({providerId:ea.PROVIDER_ID,signInMethod:ea.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return ea.credentialFromTaggedObject(e)}static credentialFromError(e){return ea.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return ea.credential(r,n)}catch{return null}}}ea.TWITTER_SIGN_IN_METHOD="twitter.com";ea.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SF(t,e){return gu(t,"POST","/v1/accounts:signUp",Da(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const i=await yi._fromIdTokenResponse(e,n,s),a=hw(n);return new Eo({user:i,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=hw(n);return new Eo({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function hw(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf extends si{constructor(e,r,n,s){var i;super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Cf.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new Cf(e,r,n,s)}}function lS(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Cf._fromErrorAndOperation(t,i,e,n):i})}async function bF(t,e,r=!1){const n=await wo(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Eo._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cS(t,e,r=!1){const{auth:n}=t;if(ls(n.app))return Promise.reject(Zs(n));const s="reauthenticate";try{const i=await wo(t,lS(n,s,e,t),r);qe(i.idToken,n,"internal-error");const a=px(i.idToken);qe(a,n,"internal-error");const{sub:o}=a;return qe(t.uid===o,n,"user-mismatch"),Eo._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&ms(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uS(t,e,r=!1){if(ls(t.app))return Promise.reject(Zs(t));const n="signIn",s=await lS(t,n,e),i=await Eo._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(i.user),i}async function CF(t,e){return uS(ai(t),e)}async function NF(t,e){return cS(ir(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hS(t){const e=ai(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function yx(t,e,r){if(ls(t.app))return Promise.reject(Zs(t));const n=ai(t),a=await pg(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",SF).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&hS(t),l}),o=await Eo._fromIdTokenResponse(n,"signIn",a);return await n._updateCurrentUser(o.user),o}function AF(t,e,r){return ls(t.app)?Promise.reject(Zs(t)):CF(ir(t),jo.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&hS(t),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IF(t,e){return ii(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ad(t,{displayName:e,photoURL:r}){if(e===void 0&&r===void 0)return;const n=ir(t),i={idToken:await n.getIdToken(),displayName:e,photoUrl:r,returnSecureToken:!0},a=await wo(n,IF(n.auth,i));n.displayName=a.displayName||null,n.photoURL=a.photoUrl||null;const o=n.providerData.find(({providerId:l})=>l==="password");o&&(o.displayName=n.displayName,o.photoURL=n.photoURL),await n._updateTokensIfNecessary(a)}function RF(t,e){return PF(ir(t),null,e)}async function PF(t,e,r){const{auth:n}=t,i={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(i.email=e),r&&(i.password=r);const a=await wo(t,xF(n,i));await t._updateTokensIfNecessary(a,!0)}function FF(t,e,r,n){return ir(t).onIdTokenChanged(e,r,n)}function LF(t,e,r){return ir(t).beforeAuthStateChanged(e,r)}function DF(t,e,r,n){return ir(t).onAuthStateChanged(e,r,n)}function fS(t){return ir(t).signOut()}const Nf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Nf,"1"),this.storage.removeItem(Nf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jF=1e3,OF=10;class mS extends dS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=sS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},i=this.storage.getItem(n);ZP()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,OF):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},jF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}mS.type="LOCAL";const MF=mS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS extends dS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}pS.type="SESSION";const gS=pS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BF(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new Id(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:i}=r.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(a).map(async u=>u(r.origin,i)),l=await BF(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Id.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wx(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VF{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((o,l)=>{const u=wx("",20);s.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:s,onMessage(d){const m=d;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(m.data.response);break;default:clearTimeout(h),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ei(){return window}function UF(t){ei().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xS(){return typeof ei().WorkerGlobalScope<"u"&&typeof ei().importScripts=="function"}async function $F(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function WF(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function zF(){return xS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vS="firebaseLocalStorageDb",HF=1,Af="firebaseLocalStorage",yS="fbase_key";class vu{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Rd(t,e){return t.transaction([Af],e?"readwrite":"readonly").objectStore(Af)}function GF(){const t=indexedDB.deleteDatabase(vS);return new vu(t).toPromise()}function gg(){const t=indexedDB.open(vS,HF);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Af,{keyPath:yS})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Af)?e(n):(n.close(),await GF(),e(await gg()))})})}async function fw(t,e,r){const n=Rd(t,!0).put({[yS]:e,value:r});return new vu(n).toPromise()}async function KF(t,e){const r=Rd(t,!1).get(e),n=await new vu(r).toPromise();return n===void 0?null:n.value}function dw(t,e){const r=Rd(t,!0).delete(e);return new vu(r).toPromise()}const qF=800,XF=3;class wS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await gg(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>XF)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return xS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Id._getInstance(zF()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await $F(),!this.activeServiceWorker)return;this.sender=new VF(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||WF()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await gg();return await fw(e,Nf,"1"),await dw(e,Nf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>fw(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>KF(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>dw(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Rd(s,!1).getAll();return new vu(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),qF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}wS.type="LOCAL";const QF=wS;new pu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _x(t,e){return e?wi(e):(qe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ex extends xx{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return bl(e,this._buildIdpRequest())}_linkToIdToken(e,r){return bl(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return bl(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function YF(t){return uS(t.auth,new Ex(t),t.bypassAuthState)}function JF(t){const{auth:e,user:r}=t;return qe(r,e,"internal-error"),cS(r,new Ex(t),t.bypassAuthState)}async function ZF(t){const{auth:e,user:r}=t;return qe(r,e,"internal-error"),bF(r,new Ex(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _S{constructor(e,r,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:i,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return YF;case"linkViaPopup":case"linkViaRedirect":return ZF;case"reauthViaPopup":case"reauthViaRedirect":return JF;default:ms(this.auth,"internal-error")}}resolve(e){Li(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Li(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e7=new pu(2e3,1e4);async function ES(t,e,r){if(ls(t.app))return Promise.reject(Rs(t,"operation-not-supported-in-this-environment"));const n=ai(t);zT(t,e,Nd);const s=_x(n,r);return new eo(n,"signInViaPopup",e,s).executeNotNull()}class eo extends _S{constructor(e,r,n,s,i){super(e,r,s,i),this.provider=n,this.authWindow=null,this.pollId=null,eo.currentPopupAction&&eo.currentPopupAction.cancel(),eo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return qe(e,this.auth,"internal-error"),e}async onExecution(){Li(this.filter.length===1,"Popup operations only handle one event");const e=wx();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Rs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Rs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,eo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Rs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,e7.get())};e()}}eo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t7="pendingRedirect",Oh=new Map;class r7 extends _S{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Oh.get(this.auth._key());if(!e){try{const n=await n7(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Oh.set(this.auth._key(),e)}return this.bypassAuthState||Oh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function n7(t,e){const r=TS(e),n=kS(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}async function s7(t,e){return kS(t)._set(TS(e),"true")}function i7(t,e){Oh.set(t._key(),e)}function kS(t){return wi(t._redirectPersistence)}function TS(t){return jh(t7,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a7(t,e,r){return o7(t,e,r)}async function o7(t,e,r){if(ls(t.app))return Promise.reject(Zs(t));const n=ai(t);zT(t,e,Nd),await n._initializationPromise;const s=_x(n,r);return await s7(s,n),s._openRedirect(n,e,"signInViaRedirect")}async function l7(t,e){return await ai(t)._initializationPromise,SS(t,e,!1)}async function SS(t,e,r=!1){if(ls(t.app))return Promise.reject(Zs(t));const n=ai(t),s=_x(n,e),a=await new r7(n,s,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c7=10*60*1e3;class u7{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!h7(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!bS(e)){const s=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(Rs(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=c7&&this.cachedEventUids.clear(),this.cachedEventUids.has(mw(e))}saveEventToCache(e){this.cachedEventUids.add(mw(e)),this.lastProcessedEventTime=Date.now()}}function mw(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function bS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function h7(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return bS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f7(t,e={}){return ii(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d7=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,m7=/^https?/;async function p7(t){if(t.config.emulator)return;const{authorizedDomains:e}=await f7(t);for(const r of e)try{if(g7(r))return}catch{}ms(t,"unauthorized-domain")}function g7(t){const e=dg(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!m7.test(r))return!1;if(d7.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x7=new pu(3e4,6e4);function pw(){const t=ei().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function v7(t){return new Promise((e,r)=>{var n,s,i;function a(){pw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{pw(),r(Rs(t,"network-request-failed"))},timeout:x7.get()})}if(!((s=(n=ei().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=ei().gapi)===null||i===void 0)&&i.load)a();else{const o=lF("iframefcb");return ei()[o]=()=>{gapi.load?a():r(Rs(t,"network-request-failed"))},aS(`${oF()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw Mh=null,e})}let Mh=null;function y7(t){return Mh=Mh||v7(t),Mh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w7=new pu(5e3,15e3),_7="__/auth/iframe",E7="emulator/auth/iframe",k7={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},T7=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function S7(t){const e=t.config;qe(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?mx(e,E7):`https://${t.config.authDomain}/${_7}`,n={apiKey:e.apiKey,appName:t.name,v:Ro},s=T7.get(t.config.apiHost);s&&(n.eid=s);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${au(n).slice(1)}`}async function b7(t){const e=await y7(t),r=ei().gapi;return qe(r,t,"internal-error"),e.open({where:document.body,url:S7(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:k7,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const a=Rs(t,"network-request-failed"),o=ei().setTimeout(()=>{i(a)},w7.get());function l(){ei().clearTimeout(o),s(n)}n.ping(l).then(l,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C7={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},N7=500,A7=600,I7="_blank",R7="http://localhost";class gw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function P7(t,e,r,n=N7,s=A7){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},C7),{width:n.toString(),height:s.toString(),top:i,left:a}),u=gn().toLowerCase();r&&(o=ZT(u)?I7:r),YT(u)&&(e=e||R7,l.scrollbars="yes");const h=Object.entries(l).reduce((m,[p,x])=>`${m}${p}=${x},`,"");if(JP(u)&&o!=="_self")return F7(e||"",o),new gw(null);const d=window.open(e||"",o,h);qe(d,t,"popup-blocked");try{d.focus()}catch{}return new gw(d)}function F7(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L7="__/auth/handler",D7="emulator/auth/handler",j7=encodeURIComponent("fac");async function xw(t,e,r,n,s,i){qe(t.config.authDomain,t,"auth-domain-config-required"),qe(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Ro,eventId:s};if(e instanceof Nd){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",d5(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,d]of Object.entries(i||{}))a[h]=d}if(e instanceof xu){const h=e.getScopes().filter(d=>d!=="");h.length>0&&(a.scopes=h.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const h of Object.keys(o))o[h]===void 0&&delete o[h];const l=await t._getAppCheckToken(),u=l?`#${j7}=${encodeURIComponent(l)}`:"";return`${O7(t)}?${au(o).slice(1)}${u}`}function O7({config:t}){return t.emulator?mx(t,D7):`https://${t.authDomain}/${L7}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pm="webStorageSupport";class M7{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=gS,this._completeRedirectFn=SS,this._overrideRedirectResult=i7}async _openPopup(e,r,n,s){var i;Li((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const a=await xw(e,r,n,dg(),s);return P7(e,a,wx())}async _openRedirect(e,r,n,s){await this._originValidation(e);const i=await xw(e,r,n,dg(),s);return UF(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:i}=this.eventManagers[r];return s?Promise.resolve(s):(Li(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await b7(e),n=new u7(e);return r.register("authEvent",s=>(qe(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Pm,{type:Pm},s=>{var i;const a=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Pm];a!==void 0&&r(!!a),ms(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=p7(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return sS()||JT()||gx()}}const B7=M7;var vw="@firebase/auth",yw="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V7{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){qe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U7(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function $7(t){go(new Ea("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;qe(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:iS(t)},u=new sF(n,s,i,l);return dF(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),go(new Ea("auth-internal",e=>{const r=ai(e.getProvider("auth").getImmediate());return(n=>new V7(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Qs(vw,yw,U7(t)),Qs(vw,yw,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W7=5*60,z7=hk("authIdTokenMaxAge")||W7;let ww=null;const H7=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>z7)return;const s=r==null?void 0:r.token;ww!==s&&(ww=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function CS(t=A1()){const e=cd(t,"auth");if(e.isInitialized())return e.getImmediate();const r=fF(t,{popupRedirectResolver:B7,persistence:[QF,MF,gS]}),n=hk("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const a=H7(i.toString());LF(r,a,()=>a(r.currentUser)),FF(r,o=>a(o))}}const s=lk("auth");return s&&mF(r,`http://${s}`),r}function G7(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}iF({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const i=Rs("internal-error");i.customData=s,r(i)},n.type="text/javascript",n.charset="UTF-8",G7().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});$7("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NS="firebasestorage.googleapis.com",K7="storageBucket",q7=2*60*1e3,X7=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi extends si{constructor(e,r,n=0){super(Fm(e),`Firebase Storage: ${r} (${Fm(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,oi.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Fm(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ni;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ni||(ni={}));function Fm(t){return"storage/"+t}function Q7(){const t="An unknown error occurred, please check the error payload for server response.";return new oi(ni.UNKNOWN,t)}function Y7(){return new oi(ni.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function J7(){return new oi(ni.CANCELED,"User canceled the upload/download.")}function Z7(t){return new oi(ni.INVALID_URL,"Invalid URL '"+t+"'.")}function e9(t){return new oi(ni.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function _w(t){return new oi(ni.INVALID_ARGUMENT,t)}function AS(){return new oi(ni.APP_DELETED,"The Firebase app was deleted.")}function t9(t){return new oi(ni.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=bs.makeFromUrl(e,r)}catch{return new bs(e,"")}if(n.path==="")return n;throw e9(e)}static makeFromUrl(e,r){let n=null;const s="([A-Za-z0-9.\\-_]+)";function i(N){N.path.charAt(N.path.length-1)==="/"&&(N.path_=N.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+s+a,"i"),l={bucket:1,path:3};function u(N){N.path_=decodeURIComponent(N.path)}const h="v[A-Za-z0-9_]+",d=r.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",p=new RegExp(`^https?://${d}/${h}/b/${s}/o${m}`,"i"),x={bucket:1,path:3},g=r===NS?"(?:storage.googleapis.com|storage.cloud.google.com)":r,y="([^?#]*)",w=new RegExp(`^https?://${g}/${s}/${y}`,"i"),_=[{regex:o,indices:l,postModify:i},{regex:p,indices:x,postModify:u},{regex:w,indices:{bucket:1,path:2},postModify:u}];for(let N=0;N<_.length;N++){const j=_[N],D=j.regex.exec(e);if(D){const k=D[j.indices.bucket];let S=D[j.indices.path];S||(S=""),n=new bs(k,S),j.postModify(n);break}}if(n==null)throw Z7(e);return n}}class r9{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n9(t,e,r){let n=1,s=null,i=null,a=!1,o=0;function l(){return o===2}let u=!1;function h(...y){u||(u=!0,e.apply(null,y))}function d(y){s=setTimeout(()=>{s=null,t(p,l())},y)}function m(){i&&clearTimeout(i)}function p(y,...w){if(u){m();return}if(y){m(),h.call(null,y,...w);return}if(l()||a){m(),h.call(null,y,...w);return}n<64&&(n*=2);let _;o===1?(o=2,_=0):_=(n+Math.random())*1e3,d(_)}let x=!1;function g(y){x||(x=!0,m(),!u&&(s!==null?(y||(o=2),clearTimeout(s),d(0)):y||(o=1)))}return d(0),i=setTimeout(()=>{a=!0,g(!0)},r),g}function s9(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i9(t){return t!==void 0}function Ew(t,e,r,n){if(n<e)throw _w(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw _w(`Invalid value for '${t}'. Expected ${r} or less.`)}function a9(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const s=e(n)+"="+e(t[n]);r=r+s+"&"}return r=r.slice(0,-1),r}var If;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(If||(If={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o9(t,e){const r=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return r||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l9{constructor(e,r,n,s,i,a,o,l,u,h,d,m=!0){this.url_=e,this.method_=r,this.headers_=n,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=h,this.connectionFactory_=d,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,x)=>{this.resolve_=p,this.reject_=x,this.start_()})}start_(){const e=(n,s)=>{if(s){n(!1,new ah(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const a=o=>{const l=o.loaded,u=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,u)};this.progressCallback_!==null&&i.addUploadProgressListener(a),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(a),this.pendingConnection_=null;const o=i.getErrorCode()===If.NO_ERROR,l=i.getStatus();if(!o||o9(l,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===If.ABORT;n(!1,new ah(!1,null,h));return}const u=this.successCodes_.indexOf(l)!==-1;n(!0,new ah(u,i))})},r=(n,s)=>{const i=this.resolve_,a=this.reject_,o=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());i9(l)?i(l):i()}catch(l){a(l)}else if(o!==null){const l=Q7();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(s.canceled){const l=this.appDelete_?AS():J7();a(l)}else{const l=Y7();a(l)}};this.canceled_?r(!1,new ah(!1,null,!0)):this.backoffId_=n9(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&s9(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ah{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function c9(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function u9(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function h9(t,e){e&&(t["X-Firebase-GMPID"]=e)}function f9(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function d9(t,e,r,n,s,i,a=!0){const o=a9(t.urlParams),l=t.url+o,u=Object.assign({},t.headers);return h9(u,e),c9(u,r),u9(u,i),f9(u,n),new l9(l,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m9(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function p9(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rf{constructor(e,r){this._service=e,r instanceof bs?this._location=r:this._location=bs.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new Rf(e,r)}get root(){const e=new bs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return p9(this._location.path)}get storage(){return this._service}get parent(){const e=m9(this._location.path);if(e===null)return null;const r=new bs(this._location.bucket,e);return new Rf(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw t9(e)}}function kw(t,e){const r=e==null?void 0:e[K7];return r==null?null:bs.makeFromBucketSpec(r,t)}function g9(t,e,r,n={}){t.host=`${e}:${r}`,t._protocol="http";const{mockUserToken:s}=n;s&&(t._overrideAuthToken=typeof s=="string"?s:fk(s,t.app.options.projectId))}class x9{constructor(e,r,n,s,i){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=NS,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=q7,this._maxUploadRetryTime=X7,this._requests=new Set,s!=null?this._bucket=bs.makeFromBucketSpec(s,this._host):this._bucket=kw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=bs.makeFromBucketSpec(this._url,e):this._bucket=kw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Ew("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Ew("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Rf(this,e)}_makeRequest(e,r,n,s,i=!0){if(this._deleted)return new r9(AS());{const a=d9(e,this._appId,n,s,r,this._firebaseVersion,i);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,r){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,s).getPromise()}}const Tw="@firebase/storage",Sw="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IS="storage";function v9(t=A1(),e){t=ir(t);const n=cd(t,IS).getImmediate({identifier:e}),s=ck("storage");return s&&y9(n,...s),n}function y9(t,e,r,n={}){g9(t,e,r,n)}function w9(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new x9(r,n,s,e,Ro)}function _9(){go(new Ea(IS,w9,"PUBLIC").setMultipleInstances(!0)),Qs(Tw,Sw,""),Qs(Tw,Sw,"esm2017")}_9();const E9={apiKey:"AIzaSyDj_FhdiYG8sgrqzSBlf9SrGF8FQR4fCI4",authDomain:"tailieu-89ca9.firebaseapp.com",projectId:"tailieu-89ca9",storageBucket:"tailieu-89ca9.firebasestorage.app",messagingSenderId:"739034600322",appId:"1:739034600322:web:771c49578c29c8cabe359b",measurementId:"G-4KTZWXH5KE"};let Nc,at,St,k9,T9;try{Nc=pk(E9),at=fP(Nc),St=CS(Nc),k9=v9(Nc),typeof window<"u"&&IP(()=>import("./index.esm-2200ccfc.js"),[]).then(({getAnalytics:t})=>{try{T9=t(Nc)}catch(e){console.warn("Analytics không thể khởi tạo:",e)}}).catch(t=>{console.warn("Không thể load module Analytics:",t)})}catch(t){console.error("Lỗi khởi tạo Firebase:",t)}const Rt={CATEGORIES:"categories",DOCUMENTS:"documents",QUESTIONS:"questions",USER_PREFERENCES:"userPreferences",USERS:"users"},kx=async()=>{try{const t=Jr(at,"categories"),e=await bn(t),r=[];for(const n of e.docs){const s=n.data(),i=Jr(at,"documents"),a=Os(i,ri("categoryId","==",n.id)),o=await bn(a);r.push({id:n.id,...s,documentCount:o.docs.length})}return r.sort((n,s)=>(n.stt||0)-(s.stt||0))}catch(t){throw console.error("Error getting categories:",t),t}},Tx=async()=>{try{const t=Jr(at,Rt.CATEGORIES);let r=(await bn(t)).docs.map(s=>({id:s.id,...s.data()}));r=r.sort((s,i)=>(s.stt||0)-(i.stt||0));const n=[];for(const s of r){const i=Os(Jr(at,Rt.DOCUMENTS),ri("categoryId","==",s.id));let o=(await bn(i)).docs.map(l=>({id:l.id,...l.data()}));o=o.sort((l,u)=>(l.stt||0)-(u.stt||0)),n.push({...s,documents:o})}return n}catch(t){throw console.error("Error getting categories with documents:",t),t}},S9=async t=>{try{const e=Jr(at,Rt.CATEGORIES),r=await bn(e);let n=0;r.docs.forEach(a=>{const o=a.data().stt||0;o>n&&(n=o)});const s={...t,stt:n+1,createdAt:new Date,updatedAt:new Date};return{id:(await ux(Jr(at,Rt.CATEGORIES),s)).id,...s}}catch(e){throw console.error("Error adding category:",e),e}},b9=async(t,e)=>{try{const r=hr(at,Rt.CATEGORIES,t),n={...e,updatedAt:new Date};return await mu(r,n),{id:t,...n}}catch(r){throw console.error("Error updating category:",r),r}},C9=async t=>{try{const e=Os(Jr(at,Rt.DOCUMENTS),ri("categoryId","==",t)),n=(await bn(e)).docs.map(async s=>{const i=s.id,a=Os(Jr(at,Rt.QUESTIONS),ri("documentId","==",i)),l=(await bn(a)).docs.map(u=>io(hr(at,Rt.QUESTIONS,u.id)));return await Promise.all(l),io(hr(at,Rt.DOCUMENTS,i))});return await Promise.all(n),await io(hr(at,Rt.CATEGORIES,t)),{success:!0,message:"Đã xóa danh mục và tất cả tài liệu liên quan"}}catch(e){throw console.error("Error deleting category:",e),e}},RS=async t=>{try{const e=hr(at,Rt.CATEGORIES,t),r=await Hl(e),s=(r.exists()?r.data():{}).logo||null,i=Os(Jr(at,Rt.DOCUMENTS),ri("categoryId","==",t));return(await bn(i)).docs.map(o=>({id:o.id,...o.data(),categoryLogo:s})).sort((o,l)=>(o.stt||0)-(l.stt||0))}catch(e){throw console.error("Error getting documents:",e),e}},N9=async t=>{try{const e=Jr(at,Rt.QUESTIONS);try{const r=Os(e,ri("documentId","==",t),kP("stt","asc"));return(await bn(r)).docs.map(s=>({id:s.id,...s.data(),question:s.data().question||"",answer:s.data().answer||"",stt:s.data().stt||0}))}catch{const n=Os(e,ri("documentId","==",t));return(await bn(n)).docs.map(a=>({id:a.id,...a.data(),question:a.data().question||"",answer:a.data().answer||"",stt:a.data().stt||0})).sort((a,o)=>(a.stt||0)-(o.stt||0))}}catch(e){throw console.error("Error fetching questions:",e),e}},Lm=async()=>{try{console.log("Fetching all questions with document info");const t=Jr(at,"questions"),e=await bn(t);if(e.empty)return console.log("No questions found in Firestore"),[];console.log("Questions fetched, count:",e.size);const r=e.docs.map(s=>({id:s.id,...s.data()})),n=await Promise.all(r.map(async s=>{if(!s.documentId)return console.log("Question has no documentId:",s),{...s,documentTitle:"Không có tài liệu",categoryId:"",categoryTitle:"Không có danh mục"};try{const i=hr(at,"documents",s.documentId),a=await Hl(i);if(!a.exists())return console.log(`Document with ID ${s.documentId} not found for question:`,s),{...s,documentTitle:"Tài liệu không tồn tại",categoryId:"",categoryTitle:"Không có danh mục"};const o=a.data();let l={title:"Không có danh mục",logo:null};if(o.categoryId){const u=hr(at,"categories",o.categoryId),h=await Hl(u);h.exists()&&(l=h.data())}return{...s,documentTitle:o.title||"Không có tiêu đề",categoryId:o.categoryId||"",categoryTitle:l.title||"Không có danh mục",categoryLogo:l.logo||null}}catch(i){return console.error(`Error getting document info for question ${s.id}:`,i),{...s,documentTitle:"Lỗi tải tài liệu",categoryId:"",categoryTitle:"Lỗi tải danh mục"}}}));return console.log("Questions with document info:",n),n}catch(t){throw console.error("Error in getAllQuestionsWithDocumentInfo:",t),t}},bw=async t=>{try{const e=Os(Jr(at,Rt.QUESTIONS),ri("documentId","==",t.documentId)),r=await bn(e);let n=0;r.docs.forEach(a=>{const o=a.data().stt||0;o>n&&(n=o)});const s={...t,stt:n+1,createdAt:new Date,updatedAt:new Date};return{id:(await ux(Jr(at,Rt.QUESTIONS),s)).id,...s}}catch(e){throw console.error("Error adding question:",e),e}},A9=async(t,e)=>{try{const r=hr(at,Rt.QUESTIONS,t),n={...e,updatedAt:new Date};return await mu(r,n),{id:t,...n}}catch(r){throw console.error("Error updating question:",r),r}},I9=async t=>{try{return await io(hr(at,Rt.QUESTIONS,t)),{success:!0,message:"Đã xóa câu hỏi thành công"}}catch(e){throw console.error("Error deleting question:",e),e}},Pd=async(t,e)=>{try{if(!t)throw new Error("User ID is required to save preferences");const r=hr(at,Rt.USER_PREFERENCES,t);return await Tf(r,{...e,updatedAt:new Date},{merge:!0}),!0}catch(r){throw console.error("Error saving user preferences:",r),r}},Gl=async(t,e)=>{try{const r=hr(at,Rt.USERS,t),n=await Hl(r);if(n.exists()){const s=n.data(),i={...e,role:s.role||e.role||"fuser",createdAt:s.createdAt||new Date,updatedAt:new Date};await mu(r,i)}else{const s={...e,role:e.role||"fuser",createdAt:new Date,updatedAt:new Date};await Tf(r,s)}return!0}catch(r){throw console.error("Lỗi khi lưu thông tin người dùng:",r),r}},R9=async t=>{try{const e=hr(at,Rt.USERS,t),r=await Hl(e);return r.exists()&&r.data().role||"fuser"}catch(e){return console.error("Lỗi khi lấy vai trò người dùng:",e),"fuser"}},PS=async()=>{try{const t=Os(Jr(at,Rt.USERS));return(await bn(t)).docs.map(r=>({id:r.id,...r.data()}))}catch(t){throw console.error("Error getting users:",t),t}},FS=async(t,e)=>{try{const r=hr(at,Rt.USERS,t);return await mu(r,{role:e,updatedAt:new Date}),!0}catch(r){throw console.error("Lỗi khi cập nhật vai trò người dùng:",r),r}},LS=async t=>{try{return await io(hr(at,Rt.USERS,t)),console.log("Đã xóa người dùng khỏi Firestore thành công"),!0}catch(e){throw console.error("Lỗi khi xóa người dùng:",e),e}},P9=async t=>{try{const e=Os(Jr(at,Rt.QUESTIONS),ri("documentId","==",t)),n=(await bn(e)).docs.map(s=>io(hr(at,Rt.QUESTIONS,s.id)));return await Promise.all(n),await io(hr(at,Rt.DOCUMENTS,t)),{success:!0,message:"Đã xóa tài liệu và tất cả câu hỏi liên quan"}}catch(e){throw console.error("Error deleting document:",e),e}},F9=async t=>{try{const e=Os(Jr(at,Rt.DOCUMENTS),ri("categoryId","==",t.categoryId)),r=await bn(e);let n=0;r.docs.forEach(a=>{const o=a.data().stt||0;o>n&&(n=o)});const s={...t,stt:n+1,slug:t.title.toLowerCase().replace(/\s+/g,"_").replace(/[^\w\s]/gi,""),createdAt:new Date,updatedAt:new Date};return{id:(await ux(Jr(at,Rt.DOCUMENTS),s)).id,...s}}catch(e){throw console.error("Error adding document:",e),e}},L9=async(t,e)=>{try{const r=hr(at,Rt.DOCUMENTS,t),n={...e,slug:e.title.toLowerCase().replace(/\s+/g,"_").replace(/[^\w\s]/gi,""),updatedAt:new Date};return await mu(r,n),{id:t,...n}}catch(r){throw console.error("Error updating document:",r),r}},vr={DEFAULT:"theme-green",BLUE:"theme-blue",RED:"theme-red",PURPLE:"theme-purple",YELLOW:"theme-yellow",BROWN:"theme-brown",BLACK:"theme-black",WHITE:"theme-white"},DS=F.createContext(),Mr=()=>F.useContext(DS),D9=({children:t})=>{const[e,r]=F.useState(!1),[n,s]=F.useState(vr.DEFAULT);F.useEffect(()=>{const o=localStorage.getItem("darkMode")==="true",l=localStorage.getItem("themeColor")||vr.DEFAULT;r(o),s(l),o?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),document.documentElement.className=document.documentElement.className.replace(/theme-\w+/g,"").trim()+" "+l},[]),F.useEffect(()=>{const o=async()=>{const l=St.currentUser;if(l)try{await Pd(l.uid,{darkMode:e,themeColor:n,updatedAt:new Date}),console.log("Theme preferences saved")}catch(u){console.error("Error saving theme preferences:",u)}};localStorage.setItem("darkMode",e.toString()),localStorage.setItem("themeColor",n),o()},[e,n]);const i=()=>{r(o=>{const l=!o;return l?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),l})},a=o=>{Object.values(vr).includes(o)&&(s(o),document.documentElement.className=document.documentElement.className.replace(/theme-\w+/g,"").trim()+" "+o)};return c.jsx(DS.Provider,{value:{isDarkMode:e,toggleDarkMode:i,themeColor:n,changeThemeColor:a,THEME_COLORS:vr},children:t})};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function j9(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(h){try{u(n.next(h))}catch(d){a(d)}}function l(h){try{u(n.throw(h))}catch(d){a(d)}}function u(h){h.done?i(h.value):s(h.value).then(o,l)}u((n=n.apply(t,e||[])).next())})}function O9(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(u){return function(h){return l([u,h])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,s=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){r.label=u[1];break}if(u[0]===6&&r.label<i[1]){r.label=i[1],i=u;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(u);break}i[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(h){u=[6,h],s=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var pl=function(){return pl=Object.assign||function(e){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},pl.apply(this,arguments)},jS=function(t){return{loading:t==null,value:t}},M9=function(){return function(t,e){switch(e.type){case"error":return pl(pl({},t),{error:e.error,loading:!1,value:void 0});case"reset":return jS(e.defaultValue);case"value":return pl(pl({},t),{error:void 0,loading:!1,value:e.value});default:return t}}},B9=function(t){var e=t?t():void 0,r=F.useReducer(M9(),jS(e)),n=r[0],s=r[1],i=F.useCallback(function(){var l=t?t():void 0;s({type:"reset",defaultValue:l})},[t]),a=F.useCallback(function(l){s({type:"error",error:l})},[]),o=F.useCallback(function(l){s({type:"value",value:l})},[]);return F.useMemo(function(){return{error:n.error,loading:n.loading,reset:i,setError:a,setValue:o,value:n.value}},[n.error,n.loading,i,a,o,n.value])},vn=function(t,e){var r=B9(function(){return t.currentUser}),n=r.error,s=r.loading,i=r.setError,a=r.setValue,o=r.value;return F.useEffect(function(){var l=DF(t,function(u){return j9(void 0,void 0,void 0,function(){var h;return O9(this,function(d){switch(d.label){case 0:if(!(e!=null&&e.onUserChanged))return[3,4];d.label=1;case 1:return d.trys.push([1,3,,4]),[4,e.onUserChanged(u)];case 2:return d.sent(),[3,4];case 3:return h=d.sent(),i(h),[3,4];case 4:return a(u),[2]}})})},i);return function(){l()}},[t]),[o,s,n]};const OS=F.createContext({userRole:"fuser",isAdmin:!1,isPaidUser:!1,isFreeUser:!0,loading:!0}),Yn=()=>F.useContext(OS),V9=({children:t})=>{const[e,r]=vn(St),[n,s]=F.useState("fuser"),[i,a]=F.useState(!0);F.useEffect(()=>{(async()=>{if(!r){if(e)try{const m=await R9(e.uid);s(m)}catch(m){console.error("Lỗi khi lấy vai trò người dùng:",m),s("fuser")}else s("fuser");a(!1)}})()},[e,r]);const h={userRole:n,isAdmin:n==="admin",isPaidUser:n==="puser",isFreeUser:n==="fuser",loading:r||i};return c.jsx(OS.Provider,{value:h,children:t})},ja=({isOpen:t,onClose:e})=>{const{isDarkMode:r,themeColor:n,changeThemeColor:s,toggleDarkMode:i,THEME_COLORS:a}=Mr(),o=F.useRef(null);return F.useEffect(()=>{if(!t)return;const l=u=>{o.current&&!o.current.contains(u.target)&&e()};return document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[t,e]),t?c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80",children:c.jsxs("div",{ref:o,className:`${r?"bg-gray-800 text-white":"bg-white text-gray-800"} rounded-lg shadow-xl p-4 max-w-sm w-[90%] mx-auto border-2 ${r?"border-gray-700":"border-gray-300"}`,style:{backdropFilter:"blur(0px)",backgroundColor:r?"#1f2937":"#ffffff"},children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h3",{className:"text-lg font-medium",children:"Tùy chỉnh giao diện"}),c.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"mb-5 border-b pb-4",children:[c.jsx("h4",{className:"text-sm font-medium mb-3",children:"Chế độ sáng/tối"}),c.jsxs("button",{onClick:i,className:`w-full flex items-center justify-between p-3 rounded-md ${r?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors`,children:[c.jsxs("div",{className:"flex items-center",children:[r?c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}):c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),c.jsx("span",{children:r?"Chế độ tối":"Chế độ sáng"})]}),c.jsx("span",{className:`px-2 py-1 rounded text-xs ${r?"bg-gray-600 text-gray-300":"bg-gray-200 text-gray-700"}`,children:"Đang bật"})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-sm font-medium mb-3",children:"Màu chủ đề"}),c.jsx("p",{className:`mb-4 text-xs ${r?"text-gray-400":"text-gray-600"}`,children:"Chọn màu chủ đề cho ứng dụng"}),c.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-3 mb-4",children:[c.jsx("div",{className:`theme-color-option theme-color-default ${n===a.DEFAULT?"active":""}`,onClick:()=>s(a.DEFAULT),title:"Mặc định"}),c.jsx("div",{className:`theme-color-option theme-color-blue ${n===a.BLUE?"active":""}`,onClick:()=>s(a.BLUE),title:"Xanh dương"}),c.jsx("div",{className:`theme-color-option theme-color-red ${n===a.RED?"active":""}`,onClick:()=>s(a.RED),title:"Đỏ"}),c.jsx("div",{className:`theme-color-option theme-color-purple ${n===a.PURPLE?"active":""}`,onClick:()=>s(a.PURPLE),title:"Tím"}),c.jsx("div",{className:`theme-color-option theme-color-yellow ${n===a.YELLOW?"active":""}`,onClick:()=>s(a.YELLOW),title:"Vàng"}),c.jsx("div",{className:`theme-color-option theme-color-brown ${n===a.BROWN?"active":""}`,onClick:()=>s(a.BROWN),title:"Nâu"}),c.jsx("div",{className:`theme-color-option theme-color-black ${n===a.BLACK?"active":""}`,onClick:()=>s(a.BLACK),title:"Đen"}),c.jsx("div",{className:`theme-color-option theme-color-white ${n===a.WHITE?"active":""}`,onClick:()=>s(a.WHITE),title:"Trắng"})]})]}),c.jsx("div",{className:`p-3 rounded-md text-sm ${r?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-700"}`,children:c.jsxs("p",{className:"mb-2",children:[c.jsx("strong",{children:"Lưu ý:"})," Thay đổi màu chủ đề sẽ chỉ có hiệu lực khi ở chế độ sáng."]})})]})}):null},Dm=t=>t.toLowerCase().replace("/s+/g","_").replace("/[^w-]+/g","").replace("/--+/g","_"),MS=t=>t?{business:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),economics:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),accounting:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),finance:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),management:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),marketing:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"})]}),law:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"})}),technology:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),science:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),education:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[c.jsx("path",{d:"M12 14l9-5-9-5-9 5 9 5z"}),c.jsx("path",{d:"M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 14l9-5-9-5-9 5 9 5zm0 0l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14zm-4 6v-7.5l4-2.222"})]}),language:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"})}),statistics:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"})}),mathematics:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.871 4A17.926 17.926 0 003 12c0 2.874.673 5.59 1.871 8m14.13 0a17.926 17.926 0 001.87-8c0-2.874-.673-5.59-1.87-8M9 9h1.246a1 1 0 01.961.725l1.586 5.55a1 1 0 00.961.725H15m1-7h-.08a2 2 0 00-1.519.698L9.6 15.302A2 2 0 018.08 16H8"})}),international:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),social:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),political:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z"})}),history:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}[t]||MS(null):c.jsx("svg",{className:"w-5 h-5 flex-shrink-0 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),BS=t=>t?{business:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),economics:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),accounting:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),finance:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),management:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),marketing:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"})]}),law:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"})}),technology:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),science:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),education:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[c.jsx("path",{d:"M12 14l9-5-9-5-9 5 9 5z"}),c.jsx("path",{d:"M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 14l9-5-9-5-9 5 9 5zm0 0l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14zm-4 6v-7.5l4-2.222"})]}),language:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"})}),statistics:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"})}),mathematics:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.871 4A17.926 17.926 0 003 12c0 2.874.673 5.59 1.871 8m14.13 0a17.926 17.926 0 001.87-8c0-2.874-.673-5.59-1.87-8M9 9h1.246a1 1 0 01.961.725l1.586 5.55a1 1 0 00.961.725H15m1-7h-.08a2 2 0 00-1.519.698L9.6 15.302A2 2 0 018.08 16H8"})}),international:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),social:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),political:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z"})}),history:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 flex-shrink-0 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}[t]||BS(null):c.jsx("svg",{className:"w-4 h-4 flex-shrink-0 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})});function ic({sidebarData:t,documents:e,openMain:r,setOpenMain:n,selectedCategory:s,selectedDocument:i,setSelectedDocument:a,setSearch:o,setDocuments:l,isOpen:u,setIsOpen:h,hideDocumentTree:d=!1}){const m=Or(),[p,x]=F.useState(!1),[g,y]=F.useState(window.innerWidth),{isDarkMode:w,toggleDarkMode:E,setIsThemePickerOpen:_}=Mr();vn(St);const{isAdmin:N}=Yn(),[j,D]=F.useState(!1);F.useEffect(()=>{const I=()=>{const P=window.innerWidth;y(P),P<770?x(!1):P>=770&&P<1280?x(!0):x(!1)};return window.addEventListener("resize",I),I(),()=>{window.removeEventListener("resize",I)}},[]);const k=(I,P)=>{a(P),o("");const ue=Dm(I.title);m(`/${ue}/${P.slug}`),g<770&&h(!1)},S=async(I,P)=>{if(r===I){n(-1);return}if(n(I),e[P.id]){const ue=e[P.id];if(ue&&ue.length>0){const de=Dm(P.title);m(`/${de}/${ue[0].slug}`),a(ue[0])}}else try{const ue=await RS(P.id);if(l(de=>({...de,[P.id]:ue})),ue.length>0){const de=Dm(P.title);m(`/${de}/${ue[0].slug}`),a(ue[0])}}catch(ue){console.error("Error loading documents:",ue)}},b=`
    h-screen overflow-y-auto border-r ${w?"border-gray-700":"border-green-800"} transition-all duration-300 scrollbar-hide
    ${p&&g>=770&&g<1280?"w-16":"w-72"}
    ${g<770?u?"fixed left-0 top-0 z-50 shadow-lg w-72":"fixed -left-80 top-0 z-50":"relative h-screen flex-shrink-0"}
    theme-sidebar text-white
  `,C=()=>g<770&&u?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:()=>h(!1)}):null,A=!p||g<770;return c.jsxs(c.Fragment,{children:[g<770&&u&&c.jsx("button",{onClick:()=>h(!1),className:"fixed top-4 left-[260px] z-[60] bg-gray-800 text-white rounded-full p-1.5 shadow-xl hover:bg-gray-700 transition-colors","aria-label":"Đóng sidebar",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),c.jsx(C,{}),c.jsxs("aside",{className:b,children:[c.jsxs("div",{className:"sticky top-0 theme-sidebar z-10",children:[c.jsxs("div",{className:`p-4 flex items-center justify-between border-b ${w?"border-gray-700":"border-green-600"}`,children:[c.jsxs(qa,{to:"/",className:"flex items-center overflow-hidden",children:[c.jsx("div",{className:"p-1 mr-2 flex-shrink-0",children:c.jsxs("svg",{className:"w-6 h-6 text-white",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:[c.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),c.jsx("path",{d:"M4 11.5l8 4 8-4M4 15l8 4 8-4"})]})}),A&&c.jsx("span",{className:"text-lg font-medium truncate",children:"Tài liệu HOU"})]}),g>=770&&g<1280&&c.jsx("button",{onClick:()=>x(!p),className:"p-1 rounded-full hover:bg-gray-700/30 transition-colors",title:p?"Mở rộng":"Thu gọn",children:c.jsx("svg",{className:`w-5 h-5 transform transition-transform ${p?"rotate-0":"rotate-180"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})})]}),N&&c.jsxs("div",{className:`border-b ${w?"border-gray-700":"border-green-600"}`,children:[c.jsxs(qa,{to:"/admin/users",className:`flex items-center px-4 py-3 transition-colors ${w?"hover:bg-gray-700":"hover:bg-green-800"}`,children:[c.jsx("svg",{className:"w-5 h-5 mr-3 text-white flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),A&&c.jsx("span",{className:"text-white font-medium",children:"Quản lý tài khoản"})]}),c.jsxs(qa,{to:"/admin/categories",className:`flex items-center px-4 py-3 transition-colors ${w?"hover:bg-gray-700":"hover:bg-green-800"}`,children:[c.jsx("svg",{className:"w-5 h-5 mr-3 text-white flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),A&&c.jsx("span",{className:"text-white font-medium",children:"Quản lý danh mục"})]}),c.jsxs(qa,{to:"/admin/documents",className:`flex items-center px-4 py-3 transition-colors ${w?"hover:bg-gray-700":"hover:bg-green-800"}`,children:[c.jsx("svg",{className:"w-5 h-5 mr-3 text-white flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),A&&c.jsx("span",{className:"text-white font-medium",children:"Quản lý tài liệu"})]}),c.jsxs(qa,{to:"/admin/questions",className:`flex items-center px-4 py-3 transition-colors ${w?"hover:bg-gray-700":"hover:bg-green-800"}`,children:[c.jsx("svg",{className:"w-5 h-5 mr-3 text-white flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),A&&c.jsx("span",{className:"text-white font-medium",children:"Quản lý bộ câu hỏi"})]})]})]}),c.jsx("nav",{className:"mt-2 px-2 overflow-y-auto",children:c.jsx("ul",{className:"space-y-1",children:!d&&t&&t.map((I,P)=>c.jsxs("li",{className:"rounded-md overflow-hidden",children:[c.jsxs("button",{className:`w-full flex items-center ${p&&g>=770?"justify-center":"justify-between"} px-3 py-2.5 text-sm font-medium text-left transition-all duration-200 rounded-md ${r===P?w?"bg-slate-700 text-white":"theme-category-selected text-white":`text-white hover:${w?"bg-slate-700":"theme-button-hover"} hover:shadow-md`}`,style:r===P&&w?{backgroundColor:"#334155"}:{},onClick:()=>S(P,I),children:[c.jsxs("div",{className:"flex items-center flex-1 min-w-0",children:[c.jsx("div",{className:"flex-shrink-0",children:MS(I.logo)}),A&&c.jsx("span",{className:"truncate ml-2 mr-2",children:I.title})]}),A&&c.jsx("svg",{className:`w-4 h-4 flex-shrink-0 transition-transform duration-200 ${r===P?"transform rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),r===P&&e&&e[I.id]&&c.jsx("ul",{className:`mt-1 ${A?"pl-4":""} space-y-0.5 py-1 ${A?(w?"bg-slate-700/50":"theme-category-container")+" rounded-md mx-1":""}`,style:A&&w?{backgroundColor:"rgba(51, 65, 85, 0.5)"}:{},children:e[I.id].map(ue=>c.jsx("li",{children:c.jsxs("button",{className:`group flex items-center w-full ${A?"px-3":"px-1"} py-2 text-sm rounded-md transition-all duration-200 ${p&&g>=770&&g<1280?"justify-center":""} ${i&&i.id===ue.id?A?(w?"bg-slate-600/50":"theme-document-selected")+" text-white font-medium shadow-sm":"text-white font-medium":`text-white hover:${w?"bg-slate-700":"theme-button-hover"} hover:text-white hover:shadow-sm`}`,style:i&&i.id===ue.id&&A&&w?{backgroundColor:"rgba(71, 85, 105, 0.5)"}:{},onClick:()=>k(I,ue),children:[BS(ue.categoryLogo),A&&c.jsx("span",{className:"truncate flex-1 min-w-0 ml-2",children:ue.title})]})},ue.id))})]},I.id||P))})})]}),c.jsx(ja,{isOpen:j,onClose:()=>D(!1),isDarkMode:w,toggleDarkMode:E})]})}const U9=({filteredQuestions:t})=>{const{isDarkMode:e}=Mr();Or();const[r,n]=F.useState(-1),s=o=>{n(r===o?-1:o)};if(t.length===0)return c.jsx("div",{className:"flex-1 flex items-center justify-center p-6",children:c.jsxs("div",{className:"text-center max-w-md",children:[c.jsx("svg",{className:`mx-auto h-12 w-12 ${e?"text-gray-500":"text-gray-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),c.jsx("h3",{className:`mt-4 text-lg font-medium ${e?"text-gray-300":"text-gray-900"}`,children:"Không có câu hỏi nào"}),c.jsx("p",{className:`mt-2 text-sm ${e?"text-gray-400":"text-gray-500"}`,children:"Không tìm thấy câu hỏi phù hợp với tìm kiếm của bạn."})]})});const i=()=>{const o=l=>(l.preventDefault(),!1);return c.jsx("div",{className:`overflow-hidden rounded-lg shadow ${e?"bg-gray-800":"bg-white"} mx-6`,onCopy:o,onCut:o,onDragStart:o,style:{userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",onContextMenu:l=>l.preventDefault(),children:[c.jsx("thead",{className:e?"bg-gray-700":"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{scope:"col",className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${e?"text-gray-300":"text-gray-500"}`,style:{width:"60px"},children:"STT"}),c.jsx("th",{scope:"col",className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${e?"text-gray-300":"text-gray-500"}`,style:{width:"40%"},children:"Câu hỏi"}),c.jsx("th",{scope:"col",className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${e?"text-gray-300":"text-gray-500"}`,children:"Câu trả lời"})]})}),c.jsx("tbody",{className:`divide-y ${e?"divide-gray-700":"divide-gray-200"}`,children:t.map((l,u)=>c.jsxs("tr",{className:e?"hover:bg-gray-700":"hover:bg-gray-50",children:[c.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm font-medium ${e?"text-white":"text-gray-900"}`,children:u+1}),c.jsx("td",{className:`px-6 py-4 text-sm ${e?"text-white":"text-gray-900"}`,children:c.jsx("div",{className:"break-words","data-nocopy":"true",children:l.question})}),c.jsx("td",{className:`px-6 py-4 text-sm ${e?"text-white":"text-gray-900"}`,children:c.jsx("div",{className:"break-words whitespace-pre-line","data-nocopy":"true",children:l.answer})})]},l.id||u))})]})})})},a=()=>{const o=l=>(l.preventDefault(),!1);return c.jsx("div",{className:"space-y-4 px-4",onCopy:o,onCut:o,onDragStart:o,onContextMenu:l=>l.preventDefault(),style:{userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},children:t.map((l,u)=>c.jsxs("div",{className:`border rounded-lg overflow-hidden ${e?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} shadow-sm`,children:[c.jsxs("button",{onClick:()=>s(u),className:`w-full px-4 py-3 flex items-center justify-between text-left focus:outline-none ${e?"hover:bg-gray-700/50":"hover:bg-gray-50"}`,children:[c.jsxs("div",{className:"flex items-start",children:[c.jsx("span",{className:`inline-flex items-center justify-center flex-shrink-0 w-6 h-6 mr-2 rounded-full text-xs ${e?"bg-gray-700 text-gray-300":"bg-gray-200 text-gray-800"}`,children:u+1}),c.jsx("span",{className:`text-sm font-medium ${e?"text-white":"text-gray-900"}`,"data-nocopy":"true",children:l.question})]}),c.jsx("svg",{className:`flex-shrink-0 w-5 h-5 transition-transform duration-200 ${r===u?"transform rotate-180":""} ${e?"text-gray-400":"text-gray-500"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),r===u&&c.jsx("div",{className:`px-4 pb-4 pt-1 text-sm ${e?"text-gray-300 border-t border-gray-700":"text-gray-700 border-t border-gray-200"}`,children:c.jsx("div",{className:"whitespace-pre-line","data-nocopy":"true",children:l.answer})})]},l.id||u))})};return c.jsxs("div",{className:"py-4",children:[c.jsx("div",{className:"hidden md:block",children:c.jsx(i,{})}),c.jsx("div",{className:"md:hidden",children:c.jsx(a,{})})]})},VS=F.createContext({showSidebar:!0,setShowSidebar:()=>{}}),$9=()=>F.useContext(VS),W9=({children:t})=>{const[e,r]=F.useState(!0),n={showSidebar:e,setShowSidebar:r};return c.jsx(VS.Provider,{value:n,children:t})},US=({isOpen:t,onClose:e,isDarkMode:r})=>{const{themeColor:n,changeThemeColor:s,toggleDarkMode:i,THEME_COLORS:a}=Mr(),o=F.useRef(null);return F.useEffect(()=>{if(!t)return;const l=u=>{o.current&&!o.current.contains(u.target)&&e()};return document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[t,e]),t?c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80",children:c.jsxs("div",{ref:o,className:`${r?"bg-gray-800 text-white":"bg-white text-gray-800"} rounded-lg shadow-xl p-4 max-w-sm w-[90%] mx-auto border-2 ${r?"border-gray-700":"border-gray-300"}`,style:{backdropFilter:"blur(0px)",backgroundColor:r?"#1f2937":"#ffffff"},children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h3",{className:"text-lg font-medium",children:"Tùy chỉnh giao diện"}),c.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"mb-5 border-b pb-4",children:[c.jsx("h4",{className:"text-sm font-medium mb-3",children:"Chế độ sáng/tối"}),c.jsxs("button",{onClick:i,className:`w-full flex items-center justify-between p-3 rounded-md 
              ${r?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors`,children:[c.jsxs("div",{className:"flex items-center",children:[r?c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}):c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),c.jsx("span",{children:r?"Chế độ tối":"Chế độ sáng"})]}),c.jsx("span",{className:`px-2 py-1 rounded text-xs ${r?"bg-gray-600 text-gray-300":"bg-gray-200 text-gray-700"}`,children:"Đang bật"})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-sm font-medium mb-3",children:"Màu chủ đề"}),c.jsx("p",{className:`mb-4 text-xs ${r?"text-gray-400":"text-gray-600"}`,children:"Chọn màu chủ đề cho ứng dụng"}),c.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-3 mb-4",children:[c.jsx("div",{className:`theme-color-option theme-color-default ${n===a.DEFAULT?"active":""}`,onClick:()=>s(a.DEFAULT),title:"Mặc định"}),c.jsx("div",{className:`theme-color-option theme-color-blue ${n===a.BLUE?"active":""}`,onClick:()=>s(a.BLUE),title:"Xanh dương"}),c.jsx("div",{className:`theme-color-option theme-color-red ${n===a.RED?"active":""}`,onClick:()=>s(a.RED),title:"Đỏ"}),c.jsx("div",{className:`theme-color-option theme-color-purple ${n===a.PURPLE?"active":""}`,onClick:()=>s(a.PURPLE),title:"Tím"}),c.jsx("div",{className:`theme-color-option theme-color-yellow ${n===a.YELLOW?"active":""}`,onClick:()=>s(a.YELLOW),title:"Vàng"}),c.jsx("div",{className:`theme-color-option theme-color-brown ${n===a.BROWN?"active":""}`,onClick:()=>s(a.BROWN),title:"Nâu"}),c.jsx("div",{className:`theme-color-option theme-color-black ${n===a.BLACK?"active":""}`,onClick:()=>s(a.BLACK),title:"Đen"}),c.jsx("div",{className:`theme-color-option theme-color-white ${n===a.WHITE?"active":""}`,onClick:()=>s(a.WHITE),title:"Trắng"})]})]}),c.jsx("div",{className:`p-3 rounded-md text-sm ${r?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-700"}`,children:c.jsxs("p",{className:"mb-2",children:[c.jsx("strong",{children:"Lưu ý:"})," Thay đổi màu chủ đề sẽ chỉ có hiệu lực khi ở chế độ sáng."]})})]})}):null},z9=()=>{const{isDarkMode:t,toggleDarkMode:e,themeColor:r}=Mr();Yn(),$9();const n=Or(),[s]=vn(St),[i,a]=F.useState(!1),[o,l]=F.useState(!1),u=F.useRef(null),h=()=>{St.signOut(),a(!1)},d=()=>{a(!1),n("/profile")};F.useEffect(()=>{const x=g=>{u.current&&!u.current.contains(g.target)&&a(!1)};return document.addEventListener("mousedown",x),()=>{document.removeEventListener("mousedown",x)}},[]);const p=(()=>{if(t)return"bg-gray-900";switch(r){case vr.DEFAULT:return"bg-green-900";case vr.BLUE:return"bg-blue-900";case vr.RED:return"bg-red-900";case vr.PURPLE:return"bg-purple-900";case vr.YELLOW:return"bg-yellow-800";case vr.BROWN:return"bg-amber-900";case vr.BLACK:return"bg-gray-900";case vr.WHITE:return"bg-slate-800";default:return"bg-green-900"}})();return c.jsxs("header",{className:`${p} text-white px-4 py-3 flex items-center justify-between shadow-md`,children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"p-1",children:c.jsxs("svg",{className:"w-5 h-5 text-white",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:[c.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),c.jsx("path",{d:"M4 11.5l8 4 8-4M4 15l8 4 8-4"})]})}),c.jsx("span",{className:"font-medium",children:"Tài liệu HOU"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>l(!0),className:"text-white p-1 rounded-full hover:bg-white/10 transition-colors","aria-label":"Tùy chỉnh giao diện",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})})}),s?c.jsxs("div",{className:"relative",ref:u,children:[c.jsxs("button",{onClick:()=>a(!i),className:"text-white px-2 py-1 rounded-full hover:bg-white/20 transition-colors flex items-center gap-1",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})}),c.jsx("span",{className:"text-sm",children:s.displayName?s.displayName.split(" ")[0]:"Tài khoản"}),c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),i&&c.jsxs("div",{className:`absolute right-0 mt-2 w-48 py-1 rounded-md shadow-lg z-10 border-2 ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-300"}`,style:{backdropFilter:"blur(0px)",backgroundColor:t?"#1f2937":"#ffffff"},children:[c.jsxs("button",{onClick:d,className:`block w-full text-left px-4 py-2 text-sm ${t?"text-gray-300 hover:bg-gray-700":"text-gray-700 hover:bg-gray-100"}`,children:[c.jsx("svg",{className:"w-4 h-4 inline mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Tài khoản của tôi"]}),c.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 my-1"}),c.jsxs("button",{onClick:h,className:`block w-full text-left px-4 py-2 text-sm ${t?"text-gray-300 hover:bg-gray-700":"text-gray-700 hover:bg-gray-100"}`,children:[c.jsx("svg",{className:"w-4 h-4 inline mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Đăng xuất"]})]})]}):c.jsxs("button",{onClick:()=>n("/login"),className:"text-white px-2 py-1 rounded-full hover:bg-white/20 transition-colors flex items-center gap-1",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-6-3a2 2 0 11-4 0 2 2 0 014 0zm-2 4a5 5 0 00-4.546 2.916A5.986 5.986 0 0010 16a5.986 5.986 0 004.546-2.084A5 5 0 0010 11z",clipRule:"evenodd"})}),c.jsx("span",{className:"text-sm",children:"Đăng nhập"})]})]}),c.jsx(US,{isOpen:o,onClose:()=>l(!1),isDarkMode:t})]})},ac=({selectedCategory:t,selectedDocument:e,setIsSidebarOpen:r})=>{const{isDarkMode:n,toggleDarkMode:s,themeColor:i}=Mr();Yn();const a=Or(),[o]=vn(St),[l,u]=F.useState(!1),[h,d]=F.useState(!1),m=F.useRef(null),p=()=>{St.signOut(),u(!1)},x=()=>{u(!1),a("/profile")};F.useEffect(()=>{const w=E=>{m.current&&!m.current.contains(E.target)&&u(!1)};return document.addEventListener("mousedown",w),()=>{document.removeEventListener("mousedown",w)}},[]);const y=(()=>{if(n)return"bg-gray-900";switch(i){case vr.DEFAULT:return"bg-green-900";case vr.BLUE:return"bg-blue-900";case vr.RED:return"bg-red-900";case vr.PURPLE:return"bg-purple-900";case vr.YELLOW:return"bg-yellow-800";case vr.BROWN:return"bg-amber-900";case vr.BLACK:return"bg-gray-900";case vr.WHITE:return"bg-slate-800";default:return"bg-green-900"}})();return c.jsxs("header",{className:`${y} text-white px-4 py-3 flex flex-col shadow-md sticky top-0 z-10`,children:[c.jsxs("div",{className:"flex items-center justify-between w-full",children:[c.jsxs(qa,{to:"/",className:"flex items-center gap-2 overflow-hidden",children:[c.jsx("div",{className:"p-1 flex-shrink-0",children:c.jsxs("svg",{className:"w-5 h-5 text-white",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:[c.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),c.jsx("path",{d:"M4 11.5l8 4 8-4M4 15l8 4 8-4"})]})}),c.jsx("span",{className:"font-medium truncate max-w-[140px]",children:(t==null?void 0:t.title)||"Tài liệu HOU"})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("button",{onClick:()=>d(!0),className:"p-2 rounded-full hover:bg-white/10 transition-colors","aria-label":"Tùy chỉnh giao diện",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"text-white h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})})}),o?c.jsxs("div",{className:"relative",ref:m,children:[c.jsxs("button",{onClick:()=>u(!l),className:"text-white px-2 py-1 rounded-full hover:bg-white/20 transition-colors flex items-center gap-1 mr-2",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})}),c.jsx("span",{className:"text-sm max-w-[80px] truncate",children:o.displayName?o.displayName.split(" ")[0]:"Tài khoản"}),c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),l&&c.jsxs("div",{className:`absolute right-0 mt-2 w-48 py-1 rounded-md shadow-lg z-20 border ${n?"bg-gray-800 border-gray-700":"bg-white border-gray-300"}`,style:{backdropFilter:"blur(8px)"},children:[c.jsxs("button",{onClick:x,className:`block w-full text-left px-4 py-2 text-sm ${n?"text-gray-300 hover:bg-gray-700":"text-gray-700 hover:bg-gray-100"}`,children:[c.jsx("svg",{className:"w-4 h-4 inline mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Tài khoản của tôi"]}),c.jsx("div",{className:`border-t ${n?"border-gray-700":"border-gray-200"} my-1`}),c.jsxs("button",{onClick:p,className:`block w-full text-left px-4 py-2 text-sm ${n?"text-gray-300 hover:bg-gray-700":"text-gray-700 hover:bg-gray-100"}`,children:[c.jsx("svg",{className:"w-4 h-4 inline mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Đăng xuất"]})]})]}):c.jsxs("button",{onClick:()=>a("/login"),className:"text-white px-2 py-1 rounded-full hover:bg-white/20 transition-colors flex items-center gap-1 mr-2",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-6-3a2 2 0 11-4 0 2 2 0 014 0zm-2 4a5 5 0 00-4.546 2.916A5.986 5.986 0 0010 16a5.986 5.986 0 004.546-2.084A5 5 0 0010 11z",clipRule:"evenodd"})}),c.jsx("span",{className:"text-sm",children:"Đăng nhập"})]}),c.jsx("button",{onClick:()=>r(!0),className:"text-white flex-shrink-0 p-2 rounded-full hover:bg-white/10 transition-colors","aria-label":"Mở menu",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16m-7 6h7"})})})]})]}),e&&c.jsx("div",{className:"ml-7 mt-1 text-sm text-white/90 truncate max-w-full pr-8",children:e==null?void 0:e.title}),c.jsx(US,{isOpen:h,onClose:()=>d(!1),isDarkMode:n,toggleDarkMode:s})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Pf={};Pf.version="0.18.5";var $S=1252,H9=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Sx={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},bx=function(t){H9.indexOf(t)!=-1&&($S=Sx[0]=t)};function G9(){bx(1252)}var Cs=function(t){bx(t)};function Cx(){Cs(1200),G9()}function Cw(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function K9(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function WS(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Vc=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?K9(t.slice(2)):e==254&&r==255?WS(t.slice(2)):e==65279?t.slice(1):t},oh=function(e){return String.fromCharCode(e)},Nw=function(e){return String.fromCharCode(e)},ta,aa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function V0(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0,l=0,u=0;u<t.length;)r=t.charCodeAt(u++),i=r>>2,n=t.charCodeAt(u++),a=(r&3)<<4|n>>4,s=t.charCodeAt(u++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),e+=aa.charAt(i)+aa.charAt(a)+aa.charAt(o)+aa.charAt(l);return e}function qn(t){var e="",r=0,n=0,s=0,i=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)i=aa.indexOf(t.charAt(u++)),a=aa.indexOf(t.charAt(u++)),r=i<<2|a>>4,e+=String.fromCharCode(r),o=aa.indexOf(t.charAt(u++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=aa.indexOf(t.charAt(u++)),s=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(s));return e}var nt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Mi=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function ba(t){return nt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Aw(t){return nt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var $n=function(e){return nt?Mi(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Fd(t){if(typeof ArrayBuffer>"u")return $n(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Oa(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function q9(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function Nx(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Nx(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Lr=nt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Mi(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function X9(t){for(var e=[],r=0,n=t.length+250,s=ba(t.length+255),i=0;i<t.length;++i){var a=t.charCodeAt(i);if(a<128)s[r++]=a;else if(a<2048)s[r++]=192|a>>6&31,s[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++i)&1023;s[r++]=240|a>>8&7,s[r++]=128|a>>2&63,s[r++]=128|o>>6&15|(a&3)<<4,s[r++]=128|o&63}else s[r++]=224|a>>12&15,s[r++]=128|a>>6&63,s[r++]=128|a&63;r>n&&(e.push(s.slice(0,r)),r=0,s=ba(65535),n=65530)}return e.push(s.slice(0,r)),Lr(e)}var Sn=/\u0000/g,Uc=/[\u0001-\u0006]/g;function Cl(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Ns(t,e){var r=""+t;return r.length>=e?r:nr("0",e-r.length)+r}function Ax(t,e){var r=""+t;return r.length>=e?r:nr(" ",e-r.length)+r}function Ff(t,e){var r=""+t;return r.length>=e?r:r+nr(" ",e-r.length)}function Q9(t,e){var r=""+Math.round(t);return r.length>=e?r:nr("0",e-r.length)+r}function Y9(t,e){var r=""+t;return r.length>=e?r:nr("0",e-r.length)+r}var Iw=Math.pow(2,32);function Qo(t,e){if(t>Iw||t<-Iw)return Q9(t,e);var r=Math.round(t);return Y9(r,e)}function Lf(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Rw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],jm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function J9(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t}var He={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Pw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Z9={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Df(t,e,r){for(var n=t<0?-1:1,s=t*n,i=0,a=1,o=0,l=1,u=0,h=0,d=Math.floor(s);u<e&&(d=Math.floor(s),o=d*a+i,h=d*u+l,!(s-d<5e-8));)s=1/(s-d),i=a,a=o,l=u,u=h;if(h>e&&(u>e?(h=l,o=i):(h=u,o=a)),!r)return[0,n*o,h];var m=Math.floor(n*o/h);return[m,n*o-m*h,h]}function to(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),i=0,a=[],o={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=iL(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=i,o}var zS=new Date(1899,11,31,0,0,0),eL=zS.getTime(),tL=new Date(1900,2,1,0,0,0);function HS(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=tL&&(r+=24*60*60*1e3),(r-(eL+(t.getTimezoneOffset()-zS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ix(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function rL(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function nL(t){var e=t<0?12:11,r=Ix(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function sL(t){var e=Ix(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function U0(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=nL(t):e===10?r=t.toFixed(10).substr(0,12):r=sL(t),Ix(rL(r.toUpperCase()))}function ko(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):U0(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return ps(14,HS(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function iL(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function aL(t,e,r,n){var s="",i=0,a=0,o=r.y,l,u=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,u=e.length;break;case 3:return jm[r.m-1][1];case 5:return jm[r.m-1][0];default:return jm[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,u=e.length;break;case 3:return Rw[r.q][0];default:return Rw[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Ns(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,i=Math.round(a*(r.S+r.u)),i>=60*a&&(i=0),e==="s"?i===0?"0":""+i/a:(s=Ns(i,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=o,u=1;break}var h=u>0?Ns(l,u):"";return h}function oa(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var GS=/%/g;function oL(t,e,r){var n=e.replace(GS,""),s=e.length-n.length;return Ti(t,n,r*Math.pow(10,2*s))+nr("%",s)}function lL(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ti(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function KS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+KS(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,h){return l+u+h.substr(0,(s+i)%s)+"."+h.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var qS=/# (\?+)( ?)\/( ?)(\d+)/;function cL(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),i=Math.floor(s/n),a=s-i*n,o=n;return r+(i===0?"":""+i)+" "+(a===0?nr(" ",t[1].length+1+t[4].length):Ax(a,t[1].length)+t[2]+"/"+t[3]+Ns(o,t[4].length))}function uL(t,e,r){return r+(e===0?"":""+e)+nr(" ",t[1].length+2+t[4].length)}var XS=/^#*0*\.([0#]+)/,QS=/\).*[0#]/,YS=/\(###\) ###\\?-####/;function _n(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Fw(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Lw(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function hL(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function fL(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function es(t,e,r){if(t.charCodeAt(0)===40&&!e.match(QS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?es("n",n,r):"("+es("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return lL(t,e,r);if(e.indexOf("%")!==-1)return oL(t,e,r);if(e.indexOf("E")!==-1)return KS(e,r);if(e.charCodeAt(0)===36)return"$"+es(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Qo(l,e.length);if(e.match(/^[#?]+$/))return s=Qo(r,0),s==="0"&&(s=""),s.length>e.length?s:_n(e.substr(0,e.length-s.length))+s;if(i=e.match(qS))return cL(i,l,u);if(e.match(/^#+0+$/))return u+Qo(l,e.length-e.indexOf("0"));if(i=e.match(XS))return s=Fw(r,i[1].length).replace(/^([^\.]+)$/,"$1."+_n(i[1])).replace(/\.$/,"."+_n(i[1])).replace(/\.(\d*)$/,function(x,g){return"."+g+nr("0",_n(i[1]).length-g.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return u+Fw(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return u+oa(Qo(l,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+es(t,e,-r):oa(""+(Math.floor(r)+hL(r,i[1].length)))+"."+Ns(Lw(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return es(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Cl(es(t,e.replace(/[\\-]/g,""),r)),a=0,Cl(Cl(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<s.length?s.charAt(a++):x==="0"?"0":""}));if(e.match(YS))return s=es(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var h="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=Df(l,Math.pow(10,a)-1,!1),s=""+u,h=Ti("n",i[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),s+=h+i[2]+"/"+i[3],h=Ff(o[2],a),h.length<i[4].length&&(h=_n(i[4].substr(i[4].length-h.length))+h),s+=h,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=Df(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Ax(o[1],a)+i[2]+"/"+i[3]+Ff(o[2],a):nr(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=Qo(r,0),e.length<=s.length?s:_n(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var d=e.indexOf(".")-a,m=e.length-s.length-d;return _n(e.substr(0,d)+s+e.substr(e.length-m))}if(i=e.match(/^00,000\.([#0]*0)$/))return a=Lw(r,i[1].length),r<0?"-"+es(t,e,-r):oa(fL(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Ns(0,3-x.length):"")+x})+"."+Ns(a,i[1].length);switch(e){case"###,##0.00":return es(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=oa(Qo(l,0));return p!=="0"?u+p:"";case"###,###.00":return es(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return es(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function dL(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ti(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function mL(t,e,r){var n=e.replace(GS,""),s=e.length-n.length;return Ti(t,n,r*Math.pow(10,2*s))+nr("%",s)}function JS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+JS(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,h){return l+u+h.substr(0,(s+i)%s)+"."+h.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function $s(t,e,r){if(t.charCodeAt(0)===40&&!e.match(QS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?$s("n",n,r):"("+$s("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return dL(t,e,r);if(e.indexOf("%")!==-1)return mL(t,e,r);if(e.indexOf("E")!==-1)return JS(e,r);if(e.charCodeAt(0)===36)return"$"+$s(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Ns(l,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:_n(e.substr(0,e.length-s.length))+s;if(i=e.match(qS))return uL(i,l,u);if(e.match(/^#+0+$/))return u+Ns(l,e.length-e.indexOf("0"));if(i=e.match(XS))return s=(""+r).replace(/^([^\.]+)$/,"$1."+_n(i[1])).replace(/\.$/,"."+_n(i[1])),s=s.replace(/\.(\d*)$/,function(x,g){return"."+g+nr("0",_n(i[1]).length-g.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return u+oa(""+l);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+$s(t,e,-r):oa(""+r)+"."+nr("0",i[1].length);if(i=e.match(/^#,#*,#0/))return $s(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Cl($s(t,e.replace(/[\\-]/g,""),r)),a=0,Cl(Cl(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<s.length?s.charAt(a++):x==="0"?"0":""}));if(e.match(YS))return s=$s(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var h="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=Df(l,Math.pow(10,a)-1,!1),s=""+u,h=Ti("n",i[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),s+=h+i[2]+"/"+i[3],h=Ff(o[2],a),h.length<i[4].length&&(h=_n(i[4].substr(i[4].length-h.length))+h),s+=h,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=Df(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Ax(o[1],a)+i[2]+"/"+i[3]+Ff(o[2],a):nr(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:_n(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var d=e.indexOf(".")-a,m=e.length-s.length-d;return _n(e.substr(0,d)+s+e.substr(e.length-m))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+$s(t,e,-r):oa(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Ns(0,3-x.length):"")+x})+"."+Ns(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var p=oa(""+l);return p!=="0"?u+p:"";default:if(e.match(/\.[0#?]*$/))return $s(t,e.slice(0,e.lastIndexOf(".")),r)+_n(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ti(t,e,r){return(r|0)===r?$s(t,e,r):es(t,e,r)}function pL(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var ZS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function oc(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Lf(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="上午/下午")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(ZS))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function gL(t,e,r,n){for(var s=[],i="",a=0,o="",l="t",u,h,d,m="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Lf(t,a))throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"G",v:"General"},a+=7;break;case'"':for(i="";(d=t.charCodeAt(++a))!==34&&a<t.length;)i+=String.fromCharCode(d);s[s.length]={t:"t",v:i},++a;break;case"\\":var p=t.charAt(++a),x=p==="("||p===")"?p:"t";s[s.length]={t:x,v:p},++a;break;case"_":s[s.length]={t:"t",v:" "},a+=2;break;case"@":s[s.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(u==null&&(u=to(e,r,t.charAt(a+1)==="2"),u==null))return"";s[s.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=to(e,r),u==null))return"";for(i=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)i+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),s[s.length]={t:o,v:i},l=o;break;case"A":case"a":case"上":var g={t:o,v:o};if(u==null&&(u=to(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",m="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",a+=5,m="h"):t.substr(a,5).toUpperCase()==="上午/下午"?(u!=null&&(g.v=u.H>=12?"下午":"上午"),g.t="T",a+=5,m="h"):(g.t="t",++a),u==null&&g.t==="T")return"";s[s.length]=g,l=o;break;case"[":for(i=o;t.charAt(a++)!=="]"&&a<t.length;)i+=t.charAt(a);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(ZS)){if(u==null&&(u=to(e,r),u==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",oc(t)||(s[s.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=o;++a<t.length&&(o=t.charAt(a))==="0";)i+=o;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)i+=o;s[s.length]={t:"n",v:i};break;case"?":for(i=o;t.charAt(++a)===o;)i+=o;s[s.length]={t:o,v:i},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)i+=t.charAt(a);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:o,v:o},++a;break;case"$":s[s.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"t",v:o},++a;break}var y=0,w=0,E;for(a=s.length-1,l="t";a>=0;--a)switch(s[a].t){case"h":case"H":s[a].t=m,l="h",y<1&&(y=1);break;case"s":(E=s[a].v.match(/\.0+$/))&&(w=Math.max(w,E[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":l=s[a].t;break;case"m":l==="s"&&(s[a].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&s[a].v.match(/[Hh]/)&&(y=1),y<2&&s[a].v.match(/[Mm]/)&&(y=2),y<3&&s[a].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var _="",N;for(a=0;a<s.length;++a)switch(s[a].t){case"t":case"T":case" ":case"D":break;case"X":s[a].v="",s[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[a].v=aL(s[a].t.charCodeAt(0),s[a].v,u,w),s[a].t="t";break;case"n":case"?":for(N=a+1;s[N]!=null&&((o=s[N].t)==="?"||o==="D"||(o===" "||o==="t")&&s[N+1]!=null&&(s[N+1].t==="?"||s[N+1].t==="t"&&s[N+1].v==="/")||s[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[N].v==="/"||s[N].v===" "&&s[N+1]!=null&&s[N+1].t=="?"));)s[a].v+=s[N].v,s[N]={v:"",t:";"},++N;_+=s[a].v,a=N-1;break;case"G":s[a].t="t",s[a].v=ko(e,r);break}var j="",D,k;if(_.length>0){_.charCodeAt(0)==40?(D=e<0&&_.charCodeAt(0)===45?-e:e,k=Ti("n",_,D)):(D=e<0&&n>1?-e:e,k=Ti("n",_,D),D<0&&s[0]&&s[0].t=="t"&&(k=k.substr(1),s[0].v="-"+s[0].v)),N=k.length-1;var S=s.length;for(a=0;a<s.length;++a)if(s[a]!=null&&s[a].t!="t"&&s[a].v.indexOf(".")>-1){S=a;break}var b=s.length;if(S===s.length&&k.indexOf("E")===-1){for(a=s.length-1;a>=0;--a)s[a]==null||"n?".indexOf(s[a].t)===-1||(N>=s[a].v.length-1?(N-=s[a].v.length,s[a].v=k.substr(N+1,s[a].v.length)):N<0?s[a].v="":(s[a].v=k.substr(0,N+1),N=-1),s[a].t="t",b=a);N>=0&&b<s.length&&(s[b].v=k.substr(0,N+1)+s[b].v)}else if(S!==s.length&&k.indexOf("E")===-1){for(N=k.indexOf(".")-1,a=S;a>=0;--a)if(!(s[a]==null||"n?".indexOf(s[a].t)===-1)){for(h=s[a].v.indexOf(".")>-1&&a===S?s[a].v.indexOf(".")-1:s[a].v.length-1,j=s[a].v.substr(h+1);h>=0;--h)N>=0&&(s[a].v.charAt(h)==="0"||s[a].v.charAt(h)==="#")&&(j=k.charAt(N--)+j);s[a].v=j,s[a].t="t",b=a}for(N>=0&&b<s.length&&(s[b].v=k.substr(0,N+1)+s[b].v),N=k.indexOf(".")+1,a=S;a<s.length;++a)if(!(s[a]==null||"n?(".indexOf(s[a].t)===-1&&a!==S)){for(h=s[a].v.indexOf(".")>-1&&a===S?s[a].v.indexOf(".")+1:0,j=s[a].v.substr(0,h);h<s[a].v.length;++h)N<k.length&&(j+=k.charAt(N++));s[a].v=j,s[a].t="t",b=a}}}for(a=0;a<s.length;++a)s[a]!=null&&"n?".indexOf(s[a].t)>-1&&(D=n>1&&e<0&&a>0&&s[a-1].v==="-"?-e:e,s[a].v=Ti(s[a].t,s[a].v,D),s[a].t="t");var C="";for(a=0;a!==s.length;++a)s[a]!=null&&(C+=s[a].v);return C}var Dw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function jw(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function xL(t,e){var r=pL(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Dw),o=r[1].match(Dw);return jw(e,a)?[n,r[0]]:jw(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,i]}function ps(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:He)[t],n==null&&(n=r.table&&r.table[Pw[t]]||He[Pw[t]]),n==null&&(n=Z9[t]||"General");break}if(Lf(n,0))return ko(e,r);e instanceof Date&&(e=HS(e,r.date1904));var s=xL(n,e);if(Lf(s[1]))return ko(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return gL(s[1],e,r,s[0])}function Si(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(He[r]==null){e<0&&(e=r);continue}if(He[r]==t){e=r;break}}e<0&&(e=391)}return He[e]=t,e}function Ld(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Si(t[e],e)}function lc(){He=J9()}var vL={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},eb=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function yL(t){var e=typeof t=="number"?He[t]:t;return e=e.replace(eb,"(\\d+)"),new RegExp("^"+e+"$")}function wL(t,e,r){var n=-1,s=-1,i=-1,a=-1,o=-1,l=-1;(e.match(eb)||[]).forEach(function(d,m){var p=parseInt(r[m+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=p;break;case"d":i=p;break;case"h":a=p;break;case"s":l=p;break;case"m":a>=0?o=p:s=p;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var h=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?u:n==-1&&s==-1&&i==-1?h:u+"T"+h}var _L=function(){var t={};t.version="1.2.0";function e(){for(var k=0,S=new Array(256),b=0;b!=256;++b)k=b,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,S[b]=k;return typeof Int32Array<"u"?new Int32Array(S):S}var r=e();function n(k){var S=0,b=0,C=0,A=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(C=0;C!=256;++C)A[C]=k[C];for(C=0;C!=256;++C)for(b=k[C],S=256+C;S<4096;S+=256)b=A[S]=b>>>8^k[b&255];var I=[];for(C=1;C!=16;++C)I[C-1]=typeof Int32Array<"u"?A.subarray(C*256,C*256+256):A.slice(C*256,C*256+256);return I}var s=n(r),i=s[0],a=s[1],o=s[2],l=s[3],u=s[4],h=s[5],d=s[6],m=s[7],p=s[8],x=s[9],g=s[10],y=s[11],w=s[12],E=s[13],_=s[14];function N(k,S){for(var b=S^-1,C=0,A=k.length;C<A;)b=b>>>8^r[(b^k.charCodeAt(C++))&255];return~b}function j(k,S){for(var b=S^-1,C=k.length-15,A=0;A<C;)b=_[k[A++]^b&255]^E[k[A++]^b>>8&255]^w[k[A++]^b>>16&255]^y[k[A++]^b>>>24]^g[k[A++]]^x[k[A++]]^p[k[A++]]^m[k[A++]]^d[k[A++]]^h[k[A++]]^u[k[A++]]^l[k[A++]]^o[k[A++]]^a[k[A++]]^i[k[A++]]^r[k[A++]];for(C+=15;A<C;)b=b>>>8^r[(b^k[A++])&255];return~b}function D(k,S){for(var b=S^-1,C=0,A=k.length,I=0,P=0;C<A;)I=k.charCodeAt(C++),I<128?b=b>>>8^r[(b^I)&255]:I<2048?(b=b>>>8^r[(b^(192|I>>6&31))&255],b=b>>>8^r[(b^(128|I&63))&255]):I>=55296&&I<57344?(I=(I&1023)+64,P=k.charCodeAt(C++)&1023,b=b>>>8^r[(b^(240|I>>8&7))&255],b=b>>>8^r[(b^(128|I>>2&63))&255],b=b>>>8^r[(b^(128|P>>6&15|(I&3)<<4))&255],b=b>>>8^r[(b^(128|P&63))&255]):(b=b>>>8^r[(b^(224|I>>12&15))&255],b=b>>>8^r[(b^(128|I>>6&63))&255],b=b>>>8^r[(b^(128|I&63))&255]);return~b}return t.table=r,t.bstr=N,t.buf=j,t.str=D,t}(),Me=function(){var e={};e.version="1.2.1";function r(R,V){for(var O=R.split("/"),M=V.split("/"),U=0,z=0,te=Math.min(O.length,M.length);U<te;++U){if(z=O[U].length-M[U].length)return z;if(O[U]!=M[U])return O[U]<M[U]?-1:1}return O.length-M.length}function n(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:n(R.slice(0,-1));var V=R.lastIndexOf("/");return V===-1?R:R.slice(0,V+1)}function s(R){if(R.charAt(R.length-1)=="/")return s(R.slice(0,-1));var V=R.lastIndexOf("/");return V===-1?R:R.slice(V+1)}function i(R,V){typeof V=="string"&&(V=new Date(V));var O=V.getHours();O=O<<6|V.getMinutes(),O=O<<5|V.getSeconds()>>>1,R.write_shift(2,O);var M=V.getFullYear()-1980;M=M<<4|V.getMonth()+1,M=M<<5|V.getDate(),R.write_shift(2,M)}function a(R){var V=R.read_shift(2)&65535,O=R.read_shift(2)&65535,M=new Date,U=O&31;O>>>=5;var z=O&15;O>>>=4,M.setMilliseconds(0),M.setFullYear(O+1980),M.setMonth(z-1),M.setDate(U);var te=V&31;V>>>=5;var X=V&63;return V>>>=6,M.setHours(V),M.setMinutes(X),M.setSeconds(te<<1),M}function o(R){Hr(R,0);for(var V={},O=0;R.l<=R.length-4;){var M=R.read_shift(2),U=R.read_shift(2),z=R.l+U,te={};switch(M){case 21589:O=R.read_shift(1),O&1&&(te.mtime=R.read_shift(4)),U>5&&(O&2&&(te.atime=R.read_shift(4)),O&4&&(te.ctime=R.read_shift(4))),te.mtime&&(te.mt=new Date(te.mtime*1e3));break}R.l=z,V[M]=te}return V}var l;function u(){return l||(l={})}function h(R,V){if(R[0]==80&&R[1]==75)return ke(R,V);if((R[0]|32)==109&&(R[1]|32)==105)return Ms(R,V);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var O=3,M=512,U=0,z=0,te=0,X=0,Q=0,Y=[],Z=R.slice(0,512);Hr(Z,0);var ce=d(Z);switch(O=ce[0],O){case 3:M=512;break;case 4:M=4096;break;case 0:if(ce[1]==0)return ke(R,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}M!==512&&(Z=R.slice(0,M),Hr(Z,28));var xe=R.slice(0,M);m(Z,O);var Ne=Z.read_shift(4,"i");if(O===3&&Ne!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ne);Z.l+=4,te=Z.read_shift(4,"i"),Z.l+=4,Z.chk("00100000","Mini Stream Cutoff Size: "),X=Z.read_shift(4,"i"),U=Z.read_shift(4,"i"),Q=Z.read_shift(4,"i"),z=Z.read_shift(4,"i");for(var we=-1,Re=0;Re<109&&(we=Z.read_shift(4,"i"),!(we<0));++Re)Y[Re]=we;var Be=p(R,M);y(Q,z,Be,M,Y);var Nt=E(Be,te,Y,M);Nt[te].name="!Directory",U>0&&X!==P&&(Nt[X].name="!MiniFAT"),Nt[Y[0]].name="!FAT",Nt.fat_addrs=Y,Nt.ssz=M;var et={},ot=[],Vr=[],vs=[];_(te,Nt,Be,ot,U,et,Vr,X),x(Vr,vs,ot),ot.shift();var $a={FileIndex:Vr,FullPaths:vs};return V&&V.raw&&($a.raw={header:xe,sectors:Be}),$a}function d(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(ue,"Header Signature: "),R.l+=16;var V=R.read_shift(2,"u");return[R.read_shift(2,"u"),V]}function m(R,V){var O=9;switch(R.l+=2,O=R.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function p(R,V){for(var O=Math.ceil(R.length/V)-1,M=[],U=1;U<O;++U)M[U-1]=R.slice(U*V,(U+1)*V);return M[O-1]=R.slice(O*V),M}function x(R,V,O){for(var M=0,U=0,z=0,te=0,X=0,Q=O.length,Y=[],Z=[];M<Q;++M)Y[M]=Z[M]=M,V[M]=O[M];for(;X<Z.length;++X)M=Z[X],U=R[M].L,z=R[M].R,te=R[M].C,Y[M]===M&&(U!==-1&&Y[U]!==U&&(Y[M]=Y[U]),z!==-1&&Y[z]!==z&&(Y[M]=Y[z])),te!==-1&&(Y[te]=M),U!==-1&&M!=Y[M]&&(Y[U]=Y[M],Z.lastIndexOf(U)<X&&Z.push(U)),z!==-1&&M!=Y[M]&&(Y[z]=Y[M],Z.lastIndexOf(z)<X&&Z.push(z));for(M=1;M<Q;++M)Y[M]===M&&(z!==-1&&Y[z]!==z?Y[M]=Y[z]:U!==-1&&Y[U]!==U&&(Y[M]=Y[U]));for(M=1;M<Q;++M)if(R[M].type!==0){if(X=M,X!=Y[X])do X=Y[X],V[M]=V[X]+"/"+V[M];while(X!==0&&Y[X]!==-1&&X!=Y[X]);Y[M]=-1}for(V[0]+="/",M=1;M<Q;++M)R[M].type!==2&&(V[M]+="/")}function g(R,V,O){for(var M=R.start,U=R.size,z=[],te=M;O&&U>0&&te>=0;)z.push(V.slice(te*I,te*I+I)),U-=I,te=Xa(O,te*4);return z.length===0?le(0):Lr(z).slice(0,R.size)}function y(R,V,O,M,U){var z=P;if(R===P){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var te=O[R],X=(M>>>2)-1;if(!te)return;for(var Q=0;Q<X&&(z=Xa(te,Q*4))!==P;++Q)U.push(z);y(Xa(te,M-4),V-1,O,M,U)}}function w(R,V,O,M,U){var z=[],te=[];U||(U=[]);var X=M-1,Q=0,Y=0;for(Q=V;Q>=0;){U[Q]=!0,z[z.length]=Q,te.push(R[Q]);var Z=O[Math.floor(Q*4/M)];if(Y=Q*4&X,M<4+Y)throw new Error("FAT boundary crossed: "+Q+" 4 "+M);if(!R[Z])break;Q=Xa(R[Z],Y)}return{nodes:z,data:qw([te])}}function E(R,V,O,M){var U=R.length,z=[],te=[],X=[],Q=[],Y=M-1,Z=0,ce=0,xe=0,Ne=0;for(Z=0;Z<U;++Z)if(X=[],xe=Z+V,xe>=U&&(xe-=U),!te[xe]){Q=[];var we=[];for(ce=xe;ce>=0;){we[ce]=!0,te[ce]=!0,X[X.length]=ce,Q.push(R[ce]);var Re=O[Math.floor(ce*4/M)];if(Ne=ce*4&Y,M<4+Ne)throw new Error("FAT boundary crossed: "+ce+" 4 "+M);if(!R[Re]||(ce=Xa(R[Re],Ne),we[ce]))break}z[xe]={nodes:X,data:qw([Q])}}return z}function _(R,V,O,M,U,z,te,X){for(var Q=0,Y=M.length?2:0,Z=V[R].data,ce=0,xe=0,Ne;ce<Z.length;ce+=128){var we=Z.slice(ce,ce+128);Hr(we,64),xe=we.read_shift(2),Ne=Ox(we,0,xe-Y),M.push(Ne);var Re={name:Ne,type:we.read_shift(1),color:we.read_shift(1),L:we.read_shift(4,"i"),R:we.read_shift(4,"i"),C:we.read_shift(4,"i"),clsid:we.read_shift(16),state:we.read_shift(4,"i"),start:0,size:0},Be=we.read_shift(2)+we.read_shift(2)+we.read_shift(2)+we.read_shift(2);Be!==0&&(Re.ct=N(we,we.l-8));var Nt=we.read_shift(2)+we.read_shift(2)+we.read_shift(2)+we.read_shift(2);Nt!==0&&(Re.mt=N(we,we.l-8)),Re.start=we.read_shift(4,"i"),Re.size=we.read_shift(4,"i"),Re.size<0&&Re.start<0&&(Re.size=Re.type=0,Re.start=P,Re.name=""),Re.type===5?(Q=Re.start,U>0&&Q!==P&&(V[Q].name="!StreamData")):Re.size>=4096?(Re.storage="fat",V[Re.start]===void 0&&(V[Re.start]=w(O,Re.start,V.fat_addrs,V.ssz)),V[Re.start].name=Re.name,Re.content=V[Re.start].data.slice(0,Re.size)):(Re.storage="minifat",Re.size<0?Re.size=0:Q!==P&&Re.start!==P&&V[Q]&&(Re.content=g(Re,V[Q].data,(V[X]||{}).data))),Re.content&&Hr(Re.content,0),z[Ne]=Re,te.push(Re)}}function N(R,V){return new Date((Un(R,V+4)/1e7*Math.pow(2,32)+Un(R,V)/1e7-11644473600)*1e3)}function j(R,V){return u(),h(l.readFileSync(R),V)}function D(R,V){var O=V&&V.type;switch(O||nt&&Buffer.isBuffer(R)&&(O="buffer"),O||"base64"){case"file":return j(R,V);case"base64":return h($n(qn(R)),V);case"binary":return h($n(R),V)}return h(R,V)}function k(R,V){var O=V||{},M=O.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=M+"/",R.FileIndex[0]={name:M,type:5}),O.CLSID&&(R.FileIndex[0].clsid=O.CLSID),S(R)}function S(R){var V="Sh33tJ5";if(!Me.find(R,"/"+V)){var O=le(4);O[0]=55,O[1]=O[3]=50,O[2]=54,R.FileIndex.push({name:V,type:2,content:O,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+V),b(R)}}function b(R,V){k(R);for(var O=!1,M=!1,U=R.FullPaths.length-1;U>=0;--U){var z=R.FileIndex[U];switch(z.type){case 0:M?O=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:M=!0,isNaN(z.R*z.L*z.C)&&(O=!0),z.R>-1&&z.L>-1&&z.R==z.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!V)){var te=new Date(1987,1,19),X=0,Q=Object.create?Object.create(null):{},Y=[];for(U=0;U<R.FullPaths.length;++U)Q[R.FullPaths[U]]=!0,R.FileIndex[U].type!==0&&Y.push([R.FullPaths[U],R.FileIndex[U]]);for(U=0;U<Y.length;++U){var Z=n(Y[U][0]);M=Q[Z],M||(Y.push([Z,{name:s(Z).replace("/",""),type:1,clsid:ie,ct:te,mt:te,content:null}]),Q[Z]=!0)}for(Y.sort(function(Ne,we){return r(Ne[0],we[0])}),R.FullPaths=[],R.FileIndex=[],U=0;U<Y.length;++U)R.FullPaths[U]=Y[U][0],R.FileIndex[U]=Y[U][1];for(U=0;U<Y.length;++U){var ce=R.FileIndex[U],xe=R.FullPaths[U];if(ce.name=s(xe).replace("/",""),ce.L=ce.R=ce.C=-(ce.color=1),ce.size=ce.content?ce.content.length:0,ce.start=0,ce.clsid=ce.clsid||ie,U===0)ce.C=Y.length>1?1:-1,ce.size=0,ce.type=5;else if(xe.slice(-1)=="/"){for(X=U+1;X<Y.length&&n(R.FullPaths[X])!=xe;++X);for(ce.C=X>=Y.length?-1:X,X=U+1;X<Y.length&&n(R.FullPaths[X])!=n(xe);++X);ce.R=X>=Y.length?-1:X,ce.type=1}else n(R.FullPaths[U+1]||"")==n(xe)&&(ce.R=U+1),ce.type=2}}}function C(R,V){var O=V||{};if(O.fileType=="mad")return Ua(R,O);switch(b(R),O.fileType){case"zip":return Br(R,O)}var M=function(Ne){for(var we=0,Re=0,Be=0;Be<Ne.FileIndex.length;++Be){var Nt=Ne.FileIndex[Be];if(Nt.content){var et=Nt.content.length;et>0&&(et<4096?we+=et+63>>6:Re+=et+511>>9)}}for(var ot=Ne.FullPaths.length+3>>2,Vr=we+7>>3,vs=we+127>>7,$a=Vr+Re+ot+vs,Bs=$a+127>>7,Ho=Bs<=109?0:Math.ceil((Bs-109)/127);$a+Bs+Ho+127>>7>Bs;)Ho=++Bs<=109?0:Math.ceil((Bs-109)/127);var Jn=[1,Ho,Bs,vs,ot,Re,we,0];return Ne.FileIndex[0].size=we<<6,Jn[7]=(Ne.FileIndex[0].start=Jn[0]+Jn[1]+Jn[2]+Jn[3]+Jn[4]+Jn[5])+(Jn[6]+7>>3),Jn}(R),U=le(M[7]<<9),z=0,te=0;{for(z=0;z<8;++z)U.write_shift(1,de[z]);for(z=0;z<8;++z)U.write_shift(2,0);for(U.write_shift(2,62),U.write_shift(2,3),U.write_shift(2,65534),U.write_shift(2,9),U.write_shift(2,6),z=0;z<3;++z)U.write_shift(2,0);for(U.write_shift(4,0),U.write_shift(4,M[2]),U.write_shift(4,M[0]+M[1]+M[2]+M[3]-1),U.write_shift(4,0),U.write_shift(4,4096),U.write_shift(4,M[3]?M[0]+M[1]+M[2]-1:P),U.write_shift(4,M[3]),U.write_shift(-4,M[1]?M[0]-1:P),U.write_shift(4,M[1]),z=0;z<109;++z)U.write_shift(-4,z<M[2]?M[1]+z:-1)}if(M[1])for(te=0;te<M[1];++te){for(;z<236+te*127;++z)U.write_shift(-4,z<M[2]?M[1]+z:-1);U.write_shift(-4,te===M[1]-1?P:te+1)}var X=function(Ne){for(te+=Ne;z<te-1;++z)U.write_shift(-4,z+1);Ne&&(++z,U.write_shift(-4,P))};for(te=z=0,te+=M[1];z<te;++z)U.write_shift(-4,ge.DIFSECT);for(te+=M[2];z<te;++z)U.write_shift(-4,ge.FATSECT);X(M[3]),X(M[4]);for(var Q=0,Y=0,Z=R.FileIndex[0];Q<R.FileIndex.length;++Q)Z=R.FileIndex[Q],Z.content&&(Y=Z.content.length,!(Y<4096)&&(Z.start=te,X(Y+511>>9)));for(X(M[6]+7>>3);U.l&511;)U.write_shift(-4,ge.ENDOFCHAIN);for(te=z=0,Q=0;Q<R.FileIndex.length;++Q)Z=R.FileIndex[Q],Z.content&&(Y=Z.content.length,!(!Y||Y>=4096)&&(Z.start=te,X(Y+63>>6)));for(;U.l&511;)U.write_shift(-4,ge.ENDOFCHAIN);for(z=0;z<M[4]<<2;++z){var ce=R.FullPaths[z];if(!ce||ce.length===0){for(Q=0;Q<17;++Q)U.write_shift(4,0);for(Q=0;Q<3;++Q)U.write_shift(4,-1);for(Q=0;Q<12;++Q)U.write_shift(4,0);continue}Z=R.FileIndex[z],z===0&&(Z.start=Z.size?Z.start-1:P);var xe=z===0&&O.root||Z.name;if(Y=2*(xe.length+1),U.write_shift(64,xe,"utf16le"),U.write_shift(2,Y),U.write_shift(1,Z.type),U.write_shift(1,Z.color),U.write_shift(-4,Z.L),U.write_shift(-4,Z.R),U.write_shift(-4,Z.C),Z.clsid)U.write_shift(16,Z.clsid,"hex");else for(Q=0;Q<4;++Q)U.write_shift(4,0);U.write_shift(4,Z.state||0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,Z.start),U.write_shift(4,Z.size),U.write_shift(4,0)}for(z=1;z<R.FileIndex.length;++z)if(Z=R.FileIndex[z],Z.size>=4096)if(U.l=Z.start+1<<9,nt&&Buffer.isBuffer(Z.content))Z.content.copy(U,U.l,0,Z.size),U.l+=Z.size+511&-512;else{for(Q=0;Q<Z.size;++Q)U.write_shift(1,Z.content[Q]);for(;Q&511;++Q)U.write_shift(1,0)}for(z=1;z<R.FileIndex.length;++z)if(Z=R.FileIndex[z],Z.size>0&&Z.size<4096)if(nt&&Buffer.isBuffer(Z.content))Z.content.copy(U,U.l,0,Z.size),U.l+=Z.size+63&-64;else{for(Q=0;Q<Z.size;++Q)U.write_shift(1,Z.content[Q]);for(;Q&63;++Q)U.write_shift(1,0)}if(nt)U.l=U.length;else for(;U.l<U.length;)U.write_shift(1,0);return U}function A(R,V){var O=R.FullPaths.map(function(Q){return Q.toUpperCase()}),M=O.map(function(Q){var Y=Q.split("/");return Y[Y.length-(Q.slice(-1)=="/"?2:1)]}),U=!1;V.charCodeAt(0)===47?(U=!0,V=O[0].slice(0,-1)+V):U=V.indexOf("/")!==-1;var z=V.toUpperCase(),te=U===!0?O.indexOf(z):M.indexOf(z);if(te!==-1)return R.FileIndex[te];var X=!z.match(Uc);for(z=z.replace(Sn,""),X&&(z=z.replace(Uc,"!")),te=0;te<O.length;++te)if((X?O[te].replace(Uc,"!"):O[te]).replace(Sn,"")==z||(X?M[te].replace(Uc,"!"):M[te]).replace(Sn,"")==z)return R.FileIndex[te];return null}var I=64,P=-2,ue="d0cf11e0a1b11ae1",de=[208,207,17,224,161,177,26,225],ie="00000000000000000000000000000000",ge={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:P,FREESECT:-1,HEADER_SIGNATURE:ue,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ie,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ne(R,V,O){u();var M=C(R,O);l.writeFileSync(V,M)}function K(R){for(var V=new Array(R.length),O=0;O<R.length;++O)V[O]=String.fromCharCode(R[O]);return V.join("")}function fe(R,V){var O=C(R,V);switch(V&&V.type||"buffer"){case"file":return u(),l.writeFileSync(V.filename,O),O;case"binary":return typeof O=="string"?O:K(O);case"base64":return V0(typeof O=="string"?O:K(O));case"buffer":if(nt)return Buffer.isBuffer(O)?O:Mi(O);case"array":return typeof O=="string"?$n(O):O}return O}var _e;function B(R){try{var V=R.InflateRaw,O=new V;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)_e=R;else throw new Error("zlib does not expose bytesRead")}catch(M){console.error("cannot use native zlib: "+(M.message||M))}}function q(R,V){if(!_e)return Er(R,V);var O=_e.InflateRaw,M=new O,U=M._processChunk(R.slice(R.l),M._finishFlushFlag);return R.l+=M.bytesRead,U}function H(R){return _e?_e.deflateRawSync(R):ze(R)}var G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ae=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function re(R){var V=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(V>>16|V>>8|V)&255}for(var he=typeof Uint8Array<"u",oe=he?new Uint8Array(256):[],Pe=0;Pe<256;++Pe)oe[Pe]=re(Pe);function W(R,V){var O=oe[R&255];return V<=8?O>>>8-V:(O=O<<8|oe[R>>8&255],V<=16?O>>>16-V:(O=O<<8|oe[R>>16&255],O>>>24-V))}function $e(R,V){var O=V&7,M=V>>>3;return(R[M]|(O<=6?0:R[M+1]<<8))>>>O&3}function Oe(R,V){var O=V&7,M=V>>>3;return(R[M]|(O<=5?0:R[M+1]<<8))>>>O&7}function We(R,V){var O=V&7,M=V>>>3;return(R[M]|(O<=4?0:R[M+1]<<8))>>>O&15}function Ue(R,V){var O=V&7,M=V>>>3;return(R[M]|(O<=3?0:R[M+1]<<8))>>>O&31}function Te(R,V){var O=V&7,M=V>>>3;return(R[M]|(O<=1?0:R[M+1]<<8))>>>O&127}function Ae(R,V,O){var M=V&7,U=V>>>3,z=(1<<O)-1,te=R[U]>>>M;return O<8-M||(te|=R[U+1]<<8-M,O<16-M)||(te|=R[U+2]<<16-M,O<24-M)||(te|=R[U+3]<<24-M),te&z}function ye(R,V,O){var M=V&7,U=V>>>3;return M<=5?R[U]|=(O&7)<<M:(R[U]|=O<<M&255,R[U+1]=(O&7)>>8-M),V+3}function De(R,V,O){var M=V&7,U=V>>>3;return O=(O&1)<<M,R[U]|=O,V+1}function st(R,V,O){var M=V&7,U=V>>>3;return O<<=M,R[U]|=O&255,O>>>=8,R[U+1]=O,V+8}function bt(R,V,O){var M=V&7,U=V>>>3;return O<<=M,R[U]|=O&255,O>>>=8,R[U+1]=O&255,R[U+2]=O>>>8,V+16}function Mt(R,V){var O=R.length,M=2*O>V?2*O:V+5,U=0;if(O>=V)return R;if(nt){var z=Aw(M);if(R.copy)R.copy(z);else for(;U<R.length;++U)z[U]=R[U];return z}else if(he){var te=new Uint8Array(M);if(te.set)te.set(R);else for(;U<O;++U)te[U]=R[U];return te}return R.length=M,R}function _t(R){for(var V=new Array(R),O=0;O<R;++O)V[O]=0;return V}function er(R,V,O){var M=1,U=0,z=0,te=0,X=0,Q=R.length,Y=he?new Uint16Array(32):_t(32);for(z=0;z<32;++z)Y[z]=0;for(z=Q;z<O;++z)R[z]=0;Q=R.length;var Z=he?new Uint16Array(Q):_t(Q);for(z=0;z<Q;++z)Y[U=R[z]]++,M<U&&(M=U),Z[z]=0;for(Y[0]=0,z=1;z<=M;++z)Y[z+16]=X=X+Y[z-1]<<1;for(z=0;z<Q;++z)X=R[z],X!=0&&(Z[z]=Y[X+16]++);var ce=0;for(z=0;z<Q;++z)if(ce=R[z],ce!=0)for(X=W(Z[z],M)>>M-ce,te=(1<<M+4-ce)-1;te>=0;--te)V[X|te<<ce]=ce&15|z<<4;return M}var Et=he?new Uint16Array(512):_t(512),kt=he?new Uint16Array(32):_t(32);if(!he){for(var Xe=0;Xe<512;++Xe)Et[Xe]=0;for(Xe=0;Xe<32;++Xe)kt[Xe]=0}(function(){for(var R=[],V=0;V<32;V++)R.push(5);er(R,kt,32);var O=[];for(V=0;V<=143;V++)O.push(8);for(;V<=255;V++)O.push(9);for(;V<=279;V++)O.push(7);for(;V<=287;V++)O.push(8);er(O,Et,288)})();var Gt=function(){for(var V=he?new Uint8Array(32768):[],O=0,M=0;O<ae.length-1;++O)for(;M<ae[O+1];++M)V[M]=O;for(;M<32768;++M)V[M]=29;var U=he?new Uint8Array(259):[];for(O=0,M=0;O<J.length-1;++O)for(;M<J[O+1];++M)U[M]=O;function z(X,Q){for(var Y=0;Y<X.length;){var Z=Math.min(65535,X.length-Y),ce=Y+Z==X.length;for(Q.write_shift(1,+ce),Q.write_shift(2,Z),Q.write_shift(2,~Z&65535);Z-- >0;)Q[Q.l++]=X[Y++]}return Q.l}function te(X,Q){for(var Y=0,Z=0,ce=he?new Uint16Array(32768):[];Z<X.length;){var xe=Math.min(65535,X.length-Z);if(xe<10){for(Y=ye(Q,Y,+(Z+xe==X.length)),Y&7&&(Y+=8-(Y&7)),Q.l=Y/8|0,Q.write_shift(2,xe),Q.write_shift(2,~xe&65535);xe-- >0;)Q[Q.l++]=X[Z++];Y=Q.l*8;continue}Y=ye(Q,Y,+(Z+xe==X.length)+2);for(var Ne=0;xe-- >0;){var we=X[Z];Ne=(Ne<<5^we)&32767;var Re=-1,Be=0;if((Re=ce[Ne])&&(Re|=Z&-32768,Re>Z&&(Re-=32768),Re<Z))for(;X[Re+Be]==X[Z+Be]&&Be<250;)++Be;if(Be>2){we=U[Be],we<=22?Y=st(Q,Y,oe[we+1]>>1)-1:(st(Q,Y,3),Y+=5,st(Q,Y,oe[we-23]>>5),Y+=3);var Nt=we<8?0:we-4>>2;Nt>0&&(bt(Q,Y,Be-J[we]),Y+=Nt),we=V[Z-Re],Y=st(Q,Y,oe[we]>>3),Y-=3;var et=we<4?0:we-2>>1;et>0&&(bt(Q,Y,Z-Re-ae[we]),Y+=et);for(var ot=0;ot<Be;++ot)ce[Ne]=Z&32767,Ne=(Ne<<5^X[Z])&32767,++Z;xe-=Be-1}else we<=143?we=we+48:Y=De(Q,Y,1),Y=st(Q,Y,oe[we]),ce[Ne]=Z&32767,++Z}Y=st(Q,Y,0)-1}return Q.l=(Y+7)/8|0,Q.l}return function(Q,Y){return Q.length<8?z(Q,Y):te(Q,Y)}}();function ze(R){var V=le(50+Math.floor(R.length*1.1)),O=Gt(R,V);return V.slice(0,O)}var xt=he?new Uint16Array(32768):_t(32768),Tt=he?new Uint16Array(32768):_t(32768),Se=he?new Uint16Array(128):_t(128),Ze=1,_r=1;function dt(R,V){var O=Ue(R,V)+257;V+=5;var M=Ue(R,V)+1;V+=5;var U=We(R,V)+4;V+=4;for(var z=0,te=he?new Uint8Array(19):_t(19),X=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Q=1,Y=he?new Uint8Array(8):_t(8),Z=he?new Uint8Array(8):_t(8),ce=te.length,xe=0;xe<U;++xe)te[G[xe]]=z=Oe(R,V),Q<z&&(Q=z),Y[z]++,V+=3;var Ne=0;for(Y[0]=0,xe=1;xe<=Q;++xe)Z[xe]=Ne=Ne+Y[xe-1]<<1;for(xe=0;xe<ce;++xe)(Ne=te[xe])!=0&&(X[xe]=Z[Ne]++);var we=0;for(xe=0;xe<ce;++xe)if(we=te[xe],we!=0){Ne=oe[X[xe]]>>8-we;for(var Re=(1<<7-we)-1;Re>=0;--Re)Se[Ne|Re<<we]=we&7|xe<<3}var Be=[];for(Q=1;Be.length<O+M;)switch(Ne=Se[Te(R,V)],V+=Ne&7,Ne>>>=3){case 16:for(z=3+$e(R,V),V+=2,Ne=Be[Be.length-1];z-- >0;)Be.push(Ne);break;case 17:for(z=3+Oe(R,V),V+=3;z-- >0;)Be.push(0);break;case 18:for(z=11+Te(R,V),V+=7;z-- >0;)Be.push(0);break;default:Be.push(Ne),Q<Ne&&(Q=Ne);break}var Nt=Be.slice(0,O),et=Be.slice(O);for(xe=O;xe<286;++xe)Nt[xe]=0;for(xe=M;xe<30;++xe)et[xe]=0;return Ze=er(Nt,xt,286),_r=er(et,Tt,30),V}function Ct(R,V){if(R[0]==3&&!(R[1]&3))return[ba(V),2];for(var O=0,M=0,U=Aw(V||1<<18),z=0,te=U.length>>>0,X=0,Q=0;!(M&1);){if(M=Oe(R,O),O+=3,M>>>1)M>>1==1?(X=9,Q=5):(O=dt(R,O),X=Ze,Q=_r);else{O&7&&(O+=8-(O&7));var Y=R[O>>>3]|R[(O>>>3)+1]<<8;if(O+=32,Y>0)for(!V&&te<z+Y&&(U=Mt(U,z+Y),te=U.length);Y-- >0;)U[z++]=R[O>>>3],O+=8;continue}for(;;){!V&&te<z+32767&&(U=Mt(U,z+32767),te=U.length);var Z=Ae(R,O,X),ce=M>>>1==1?Et[Z]:xt[Z];if(O+=ce&15,ce>>>=4,!(ce>>>8&255))U[z++]=ce;else{if(ce==256)break;ce-=257;var xe=ce<8?0:ce-4>>2;xe>5&&(xe=0);var Ne=z+J[ce];xe>0&&(Ne+=Ae(R,O,xe),O+=xe),Z=Ae(R,O,Q),ce=M>>>1==1?kt[Z]:Tt[Z],O+=ce&15,ce>>>=4;var we=ce<4?0:ce-2>>1,Re=ae[ce];for(we>0&&(Re+=Ae(R,O,we),O+=we),!V&&te<Ne&&(U=Mt(U,Ne+100),te=U.length);z<Ne;)U[z]=U[z-Re],++z}}}return V?[U,O+7>>>3]:[U.slice(0,z),O+7>>>3]}function Er(R,V){var O=R.slice(R.l||0),M=Ct(O,V);return R.l+=M[1],M[0]}function kr(R,V){if(R)typeof console<"u"&&console.error(V);else throw new Error(V)}function ke(R,V){var O=R;Hr(O,0);var M=[],U=[],z={FileIndex:M,FullPaths:U};k(z,{root:V.root});for(var te=O.length-4;(O[te]!=80||O[te+1]!=75||O[te+2]!=5||O[te+3]!=6)&&te>=0;)--te;O.l=te+4,O.l+=4;var X=O.read_shift(2);O.l+=6;var Q=O.read_shift(4);for(O.l=Q,te=0;te<X;++te){O.l+=20;var Y=O.read_shift(4),Z=O.read_shift(4),ce=O.read_shift(2),xe=O.read_shift(2),Ne=O.read_shift(2);O.l+=8;var we=O.read_shift(4),Re=o(O.slice(O.l+ce,O.l+ce+xe));O.l+=ce+xe+Ne;var Be=O.l;O.l=we+4,ut(O,Y,Z,z,Re),O.l=Be}return z}function ut(R,V,O,M,U){R.l+=2;var z=R.read_shift(2),te=R.read_shift(2),X=a(R);if(z&8257)throw new Error("Unsupported ZIP encryption");for(var Q=R.read_shift(4),Y=R.read_shift(4),Z=R.read_shift(4),ce=R.read_shift(2),xe=R.read_shift(2),Ne="",we=0;we<ce;++we)Ne+=String.fromCharCode(R[R.l++]);if(xe){var Re=o(R.slice(R.l,R.l+xe));(Re[21589]||{}).mt&&(X=Re[21589].mt),((U||{})[21589]||{}).mt&&(X=U[21589].mt)}R.l+=xe;var Be=R.slice(R.l,R.l+Y);switch(te){case 8:Be=q(R,Z);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+te)}var Nt=!1;z&8&&(Q=R.read_shift(4),Q==134695760&&(Q=R.read_shift(4),Nt=!0),Y=R.read_shift(4),Z=R.read_shift(4)),Y!=V&&kr(Nt,"Bad compressed size: "+V+" != "+Y),Z!=O&&kr(Nt,"Bad uncompressed size: "+O+" != "+Z),$i(M,Ne,Be,{unsafe:!0,mt:X})}function Br(R,V){var O=V||{},M=[],U=[],z=le(1),te=O.compression?8:0,X=0,Q=0,Y=0,Z=0,ce=0,xe=R.FullPaths[0],Ne=xe,we=R.FileIndex[0],Re=[],Be=0;for(Q=1;Q<R.FullPaths.length;++Q)if(Ne=R.FullPaths[Q].slice(xe.length),we=R.FileIndex[Q],!(!we.size||!we.content||Ne=="Sh33tJ5")){var Nt=Z,et=le(Ne.length);for(Y=0;Y<Ne.length;++Y)et.write_shift(1,Ne.charCodeAt(Y)&127);et=et.slice(0,et.l),Re[ce]=_L.buf(we.content,0);var ot=we.content;te==8&&(ot=H(ot)),z=le(30),z.write_shift(4,67324752),z.write_shift(2,20),z.write_shift(2,X),z.write_shift(2,te),we.mt?i(z,we.mt):z.write_shift(4,0),z.write_shift(-4,Re[ce]),z.write_shift(4,ot.length),z.write_shift(4,we.content.length),z.write_shift(2,et.length),z.write_shift(2,0),Z+=z.length,M.push(z),Z+=et.length,M.push(et),Z+=ot.length,M.push(ot),z=le(46),z.write_shift(4,33639248),z.write_shift(2,0),z.write_shift(2,20),z.write_shift(2,X),z.write_shift(2,te),z.write_shift(4,0),z.write_shift(-4,Re[ce]),z.write_shift(4,ot.length),z.write_shift(4,we.content.length),z.write_shift(2,et.length),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(4,0),z.write_shift(4,Nt),Be+=z.l,U.push(z),Be+=et.length,U.push(et),++ce}return z=le(22),z.write_shift(4,101010256),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,ce),z.write_shift(2,ce),z.write_shift(4,Be),z.write_shift(4,Z),z.write_shift(2,0),Lr([Lr(M),Lr(U),z])}var Ir={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Zr(R,V){if(R.ctype)return R.ctype;var O=R.name||"",M=O.match(/\.([^\.]+)$/);return M&&Ir[M[1]]||V&&(M=(O=V).match(/[\.\\]([^\.\\])+$/),M&&Ir[M[1]])?Ir[M[1]]:"application/octet-stream"}function xs(R){for(var V=V0(R),O=[],M=0;M<V.length;M+=76)O.push(V.slice(M,M+76));return O.join(`\r
`)+`\r
`}function zo(R){var V=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Y){var Z=Y.charCodeAt(0).toString(16).toUpperCase();return"="+(Z.length==1?"0"+Z:Z)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],M=V.split(`\r
`),U=0;U<M.length;++U){var z=M[U];if(z.length==0){O.push("");continue}for(var te=0;te<z.length;){var X=76,Q=z.slice(te,te+X);Q.charAt(X-1)=="="?X--:Q.charAt(X-2)=="="?X-=2:Q.charAt(X-3)=="="&&(X-=3),Q=z.slice(te,te+X),te+=X,te<z.length&&(Q+="="),O.push(Q)}}return O.join(`\r
`)}function Ui(R){for(var V=[],O=0;O<R.length;++O){for(var M=R[O];O<=R.length&&M.charAt(M.length-1)=="=";)M=M.slice(0,M.length-1)+R[++O];V.push(M)}for(var U=0;U<V.length;++U)V[U]=V[U].replace(/[=][0-9A-Fa-f]{2}/g,function(z){return String.fromCharCode(parseInt(z.slice(1),16))});return $n(V.join(`\r
`))}function Va(R,V,O){for(var M="",U="",z="",te,X=0;X<10;++X){var Q=V[X];if(!Q||Q.match(/^\s*$/))break;var Y=Q.match(/^(.*?):\s*([^\s].*)$/);if(Y)switch(Y[1].toLowerCase()){case"content-location":M=Y[2].trim();break;case"content-type":z=Y[2].trim();break;case"content-transfer-encoding":U=Y[2].trim();break}}switch(++X,U.toLowerCase()){case"base64":te=$n(qn(V.slice(X).join("")));break;case"quoted-printable":te=Ui(V.slice(X));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+U)}var Z=$i(R,M.slice(O.length),te,{unsafe:!0});z&&(Z.ctype=z)}function Ms(R,V){if(K(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=V&&V.root||"",M=(nt&&Buffer.isBuffer(R)?R.toString("binary"):K(R)).split(`\r
`),U=0,z="";for(U=0;U<M.length;++U)if(z=M[U],!!/^Content-Location:/i.test(z)&&(z=z.slice(z.indexOf("file")),O||(O=z.slice(0,z.lastIndexOf("/")+1)),z.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),z.slice(0,O.length)!=O););var te=(M[1]||"").match(/boundary="(.*?)"/);if(!te)throw new Error("MAD cannot find boundary");var X="--"+(te[1]||""),Q=[],Y=[],Z={FileIndex:Q,FullPaths:Y};k(Z);var ce,xe=0;for(U=0;U<M.length;++U){var Ne=M[U];Ne!==X&&Ne!==X+"--"||(xe++&&Va(Z,M.slice(ce,U),O),ce=U)}return Z}function Ua(R,V){var O=V||{},M=O.boundary||"SheetJS";M="------="+M;for(var U=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+M.slice(2)+'"',"","",""],z=R.FullPaths[0],te=z,X=R.FileIndex[0],Q=1;Q<R.FullPaths.length;++Q)if(te=R.FullPaths[Q].slice(z.length),X=R.FileIndex[Q],!(!X.size||!X.content||te=="Sh33tJ5")){te=te.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Be){return"_x"+Be.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Be){return"_u"+Be.charCodeAt(0).toString(16)+"_"});for(var Y=X.content,Z=nt&&Buffer.isBuffer(Y)?Y.toString("binary"):K(Y),ce=0,xe=Math.min(1024,Z.length),Ne=0,we=0;we<=xe;++we)(Ne=Z.charCodeAt(we))>=32&&Ne<128&&++ce;var Re=ce>=xe*4/5;U.push(M),U.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+te),U.push("Content-Transfer-Encoding: "+(Re?"quoted-printable":"base64")),U.push("Content-Type: "+Zr(X,te)),U.push(""),U.push(Re?zo(Z):xs(Z))}return U.push(M+`--\r
`),U.join(`\r
`)}function Tr(R){var V={};return k(V,R),V}function $i(R,V,O,M){var U=M&&M.unsafe;U||k(R);var z=!U&&Me.find(R,V);if(!z){var te=R.FullPaths[0];V.slice(0,te.length)==te?te=V:(te.slice(-1)!="/"&&(te+="/"),te=(te+V).replace("//","/")),z={name:s(V),type:2},R.FileIndex.push(z),R.FullPaths.push(te),U||Me.utils.cfb_gc(R)}return z.content=O,z.size=O?O.length:0,M&&(M.CLSID&&(z.clsid=M.CLSID),M.mt&&(z.mt=M.mt),M.ct&&(z.ct=M.ct)),z}function ui(R,V){k(R);var O=Me.find(R,V);if(O){for(var M=0;M<R.FileIndex.length;++M)if(R.FileIndex[M]==O)return R.FileIndex.splice(M,1),R.FullPaths.splice(M,1),!0}return!1}function hi(R,V,O){k(R);var M=Me.find(R,V);if(M){for(var U=0;U<R.FileIndex.length;++U)if(R.FileIndex[U]==M)return R.FileIndex[U].name=s(O),R.FullPaths[U]=O,!0}return!1}function hc(R){b(R,!0)}return e.find=A,e.read=D,e.parse=h,e.write=fe,e.writeFile=ne,e.utils={cfb_new:Tr,cfb_add:$i,cfb_del:ui,cfb_mov:hi,cfb_gc:hc,ReadShift:s0,CheckField:kb,prep_blob:Hr,bconcat:Lr,use_zlib:B,_deflateRaw:ze,_inflateRaw:Er,consts:ge},e}();function EL(t){return typeof t=="string"?Fd(t):Array.isArray(t)?q9(t):t}function yu(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Fd(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Ks(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var s=new Blob([EL(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,t);if(typeof saveAs<"u")return saveAs(s,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=i,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=Oa(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function kL(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function ar(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Ow(t,e){for(var r=[],n=ar(t),s=0;s!==n.length;++s)r[t[n[s]][e]]==null&&(r[t[n[s]][e]]=n[s]);return r}function Dd(t){for(var e=[],r=ar(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function jd(t){for(var e=[],r=ar(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function TL(t){for(var e=[],r=ar(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var jf=new Date(1899,11,30,0,0,0);function Ar(t,e){var r=t.getTime();e&&(r-=1462*24*60*60*1e3);var n=jf.getTime()+(t.getTimezoneOffset()-jf.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var tb=new Date,SL=jf.getTime()+(tb.getTimezoneOffset()-jf.getTimezoneOffset())*6e4,Mw=tb.getTimezoneOffset();function Od(t){var e=new Date;return e.setTime(t*24*60*60*1e3+SL),e.getTimezoneOffset()!==Mw&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Mw)*6e4),e}function bL(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(n=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[i],10)}return e}var Bw=new Date("2017-02-19T19:06:09.000Z"),rb=isNaN(Bw.getFullYear())?new Date("2/19/17"):Bw,CL=rb.getFullYear()==2017;function zt(t,e){var r=new Date(t);if(CL)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(rb.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function To(t,e){if(nt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Ks(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Ks(WS(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Ks(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Ks(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function Ht(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Ht(t[r]));return e}function nr(t,e){for(var r="";r.length<e;)r+=t;return r}function Ps(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(e=Number(n)))?e/r:e}var NL=["january","february","march","april","may","june","july","august","september","october","november","december"];function Kl(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&NL.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var AL=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var i=r.split(n),a=[i[0]],o=1;o<i.length;++o)a.push(s),a.push(i[o]);return a}}();function nb(t){return t?t.content&&t.type?To(t.content,!0):t.data?Vc(t.data):t.asNodeBuffer&&nt?Vc(t.asNodeBuffer().toString("binary")):t.asBinary?Vc(t.asBinary()):t._data&&t._data.getContent?Vc(To(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function sb(t){if(!t)return null;if(t.data)return Cw(t.data);if(t.asNodeBuffer&&nt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?Cw(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function IL(t){return t&&t.name.slice(-4)===".bin"?sb(t):nb(t)}function ns(t,e){for(var r=t.FullPaths||ar(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var a=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||s==a)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function Rx(t,e){var r=ns(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function gr(t,e,r){if(!r)return IL(Rx(t,e));if(!e)return null;try{return gr(t,e)}catch{return null}}function Wn(t,e,r){if(!r)return nb(Rx(t,e));if(!e)return null;try{return Wn(t,e)}catch{return null}}function ib(t,e,r){if(!r)return sb(Rx(t,e));if(!e)return null;try{return ib(t,e)}catch{return null}}function Vw(t){for(var e=t.FullPaths||ar(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function rt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return nt?n=Mi(r):n=X9(r),Me.utils.cfb_add(t,e,n)}Me.utils.cfb_add(t,e,r)}else t.file(e,r)}function Px(){return Me.utils.cfb_new()}function ab(t,e){switch(e.type){case"base64":return Me.read(t,{type:"base64"});case"binary":return Me.read(t,{type:"binary"});case"buffer":case"array":return Me.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function $c(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var dr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,RL=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Uw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,PL=/<[^>]*>/g,yn=dr.match(Uw)?Uw:PL,FL=/<\w*:/,LL=/<(\/?)\w+:/;function Ke(t,e,r){for(var n={},s=0,i=0;s!==t.length&&!((i=t.charCodeAt(s))===32||i===10||i===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var a=t.match(RL),o=0,l="",u=0,h="",d="",m=1;if(a)for(u=0;u!=a.length;++u){for(d=a[u],i=0;i!=d.length&&d.charCodeAt(i)!==61;++i);for(h=d.slice(0,i).trim();d.charCodeAt(i+1)==32;)++i;for(m=(s=d.charCodeAt(i+1))==34||s==39?1:0,l=d.slice(i+1+m,d.length-m),o=0;o!=h.length&&h.charCodeAt(o)!==58;++o);if(o===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=l,r||(n[h.toLowerCase()]=l);else{var p=(o===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(o+1);if(n[p]&&h.slice(o-3,o)=="ext")continue;n[p]=l,r||(n[p.toLowerCase()]=l)}}return n}function li(t){return t.replace(LL,"<$1")}var ob={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Fx=Dd(ob),pt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(t,function(o,l){return ob[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,a)+r(s.slice(a+3))}}(),Lx=/[&<>'"]/g,DL=/[\u0000-\u0008\u000b-\u001f]/g;function Pt(t){var e=t+"";return e.replace(Lx,function(r){return Fx[r]}).replace(DL,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function $w(t){return Pt(t).replace(/ /g,"_x0020_")}var lb=/[\u0000-\u001f]/g;function Dx(t){var e=t+"";return e.replace(Lx,function(r){return Fx[r]}).replace(/\n/g,"<br/>").replace(lb,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function jL(t){var e=t+"";return e.replace(Lx,function(r){return Fx[r]}).replace(lb,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Ww=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function OL(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ut(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Om(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=s&63,e+=String.fromCharCode(a);continue}if(i=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(i&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function zw(t){var e=ba(2*t.length),r,n,s=1,i=0,a=0,o;for(n=0;n<t.length;n+=s)s=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[i++]=a&255,e[i++]=a>>>8,a=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function Hw(t){return Mi(t,"binary").toString("utf8")}var lh="foo bar bazâð£",Dt=nt&&(Hw(lh)==Om(lh)&&Hw||zw(lh)==Om(lh)&&zw)||Om,Ks=nt?function(t){return Mi(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},$0=function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),cb=function(){var t=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),ML=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),BL=/<\/?(?:vt:)?variant>/g,VL=/<(?:vt:)([^>]*)>([\s\S]*)</;function Gw(t,e){var r=Ke(t),n=t.match(ML(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(i){var a=i.replace(BL,"").match(VL);a&&s.push({v:Dt(a[2]),t:a[1]})}),s}var ub=/(^\s|\s$|\n)/;function Kr(t,e){return"<"+t+(e.match(ub)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function W0(t){return ar(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function be(t,e,r){return"<"+t+(r!=null?W0(r):"")+(e!=null?(e.match(ub)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function xg(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function UL(t,e){switch(typeof t){case"string":var r=be("vt:lpwstr",Pt(t));return e&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return be((t|0)==t?"vt:i4":"vt:r8",Pt(String(t)));case"boolean":return be("vt:bool",t?"true":"false")}if(t instanceof Date)return be("vt:filetime",xg(t));throw new Error("Unable to serialize "+t)}function jx(t){if(nt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Dt(Oa(Nx(t)));throw new Error("Bad input format: expected Buffer or string")}var z0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,br={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Oo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Vn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function $L(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,i=5;i>=0;--i)s=s*256+t[e+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function WL(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,i=0,a=n?-e:e;isFinite(a)?a==0?s=i=0:(s=Math.floor(Math.log(a)/Math.LN2),i=a*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(e)?26985:0);for(var o=0;o<=5;++o,i/=256)t[r+o]=i&255;t[r+6]=(s&15)<<4|i&15,t[r+7]=s>>4|n}var Kw=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,i=t[0][n].length;s<i;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},qw=nt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Mi(e)})):Kw(t)}:Kw,Xw=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(_i(t,s)));return n.join("").replace(Sn,"")},Ox=nt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Sn,""):Xw(t,e,r)}:Xw,Qw=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},hb=nt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Qw(t,e,r)}:Qw,Yw=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(rl(t,s)));return n.join("")},wu=nt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):Yw(e,r,n)}:Yw,fb=function(t,e){var r=Un(t,e);return r>0?wu(t,e+4,e+4+r-1):""},db=fb,mb=function(t,e){var r=Un(t,e);return r>0?wu(t,e+4,e+4+r-1):""},pb=mb,gb=function(t,e){var r=2*Un(t,e);return r>0?wu(t,e+4,e+4+r-1):""},xb=gb,vb=function(e,r){var n=Un(e,r);return n>0?Ox(e,r+4,r+4+n):""},yb=vb,wb=function(t,e){var r=Un(t,e);return r>0?wu(t,e+4,e+4+r):""},_b=wb,Eb=function(t,e){return $L(t,e)},Of=Eb,Mx=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};nt&&(db=function(e,r){if(!Buffer.isBuffer(e))return fb(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},pb=function(e,r){if(!Buffer.isBuffer(e))return mb(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},xb=function(e,r){if(!Buffer.isBuffer(e))return gb(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},yb=function(e,r){if(!Buffer.isBuffer(e))return vb(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},_b=function(e,r){if(!Buffer.isBuffer(e))return wb(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Of=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):Eb(e,r)},Mx=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var rl=function(t,e){return t[e]},_i=function(t,e){return t[e+1]*256+t[e]},zL=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Un=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Xa=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},HL=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function s0(t,e){var r="",n,s,i=[],a,o,l,u;switch(e){case"dbcs":if(u=this.l,nt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(_i(this,u)),u+=2;t*=2;break;case"utf8":r=wu(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Ox(this,this.l,this.l+t);break;case"wstr":return s0.call(this,t,"dbcs");case"lpstr-ansi":r=db(this,this.l),t=4+Un(this,this.l);break;case"lpstr-cp":r=pb(this,this.l),t=4+Un(this,this.l);break;case"lpwstr":r=xb(this,this.l),t=4+2*Un(this,this.l);break;case"lpp4":t=4+Un(this,this.l),r=yb(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Un(this,this.l),r=_b(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=rl(this,this.l+t++))!==0;)i.push(oh(a));r=i.join("");break;case"_wstr":for(t=0,r="";(a=_i(this,this.l+t))!==0;)i.push(oh(a)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=rl(this,u),this.l=u+1,o=s0.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(oh(_i(this,u))),u+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=rl(this,u),this.l=u+1,o=s0.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(oh(rl(this,u))),u+=1}r=i.join("");break;default:switch(t){case 1:return n=rl(this,this.l),this.l++,n;case 2:return n=(e==="i"?zL:_i)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Xa:HL)(this,this.l),this.l+=4,n):(s=Un(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=Of(this,this.l):s=Of([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=hb(this,this.l,t);break}}return this.l+=t,r}var GL=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},KL=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},qL=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function XL(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)qL(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var a=e.charCodeAt(s);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,GL(this,e,this.l);break;case 8:if(n=8,r==="f"){WL(this,e,this.l);break}case 16:break;case-4:n=4,KL(this,e,this.l);break}return this.l+=n,this}function kb(t,e){var r=hb(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Hr(t,e){t.l=e,t.read_shift=s0,t.chk=kb,t.write_shift=XL}function xn(t,e){t.l+=e}function le(t){var e=ba(t);return Hr(e,0),e}function Bi(t,e,r){if(t){var n,s,i;Hr(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var u=Q0[o]||Q0[65535];for(n=t.read_shift(1),i=n&127,s=1;s<4&&n&128;++s)i+=((n=t.read_shift(1))&127)<<7*s;l=t.l+i;var h=u.f&&u.f(t,i,r);if(t.l=l,e(h,u,o))return}}}function jn(){var t=[],e=nt?256:2048,r=function(u){var h=le(u);return Hr(h,0),h},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},i=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,e)))},a=function(){return s(),Lr(t)},o=function(u){s(),n=u,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:o,end:a,_bufs:t}}function pe(t,e,r,n){var s=+e,i;if(!isNaN(s)){n||(n=Q0[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var a=t.next(i);s<=127?a.write_shift(1,s):(a.write_shift(1,(s&127)+128),a.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&Mx(r)&&t.push(r)}}function i0(t,e,r){var n=Ht(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Jw(t,e,r){var n=Ht(t);return n.s=i0(n.s,e.s,r),n.e=i0(n.e,e.s,r),n}function a0(t,e){if(t.cRel&&t.c<0)for(t=Ht(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Ht(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Ge(t);return!t.cRel&&t.cRel!=null&&(r=JL(r)),!t.rRel&&t.rRel!=null&&(r=QL(r)),r}function Mm(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Xt(t.s.c)+":"+(t.e.cRel?"":"$")+Xt(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+fr(t.s.r)+":"+(t.e.rRel?"":"$")+fr(t.e.r):a0(t.s,e.biff)+":"+a0(t.e,e.biff)}function Bx(t){return parseInt(YL(t),10)-1}function fr(t){return""+(t+1)}function QL(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function YL(t){return t.replace(/\$(\d+)$/,"$1")}function Vx(t){for(var e=ZL(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Xt(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function JL(t){return t.replace(/^([A-Z])/,"$$$1")}function ZL(t){return t.replace(/^\$([A-Z])/,"$1")}function eD(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Qt(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function Ge(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function On(t){var e=t.indexOf(":");return e==-1?{s:Qt(t),e:Qt(t)}:{s:Qt(t.slice(0,e)),e:Qt(t.slice(e+1))}}function tt(t,e){return typeof e>"u"||typeof e=="number"?tt(t.s,t.e):(typeof t!="string"&&(t=Ge(t)),typeof e!="string"&&(e=Ge(e)),t==e?t:t+":"+e)}function gt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=t.length;for(r=0;n<i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===i||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function Zw(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=ps(t.z,r?Ar(e):e)}catch{}try{return t.w=ps((t.XF||{}).numFmtId||(r?14:0),r?Ar(e):e)}catch{return""+e}}function Di(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Vi[t.v]||t.v:e==null?Zw(t,t.v):Zw(t,e))}function Ma(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function Tb(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,i=t||(s?[]:{}),a=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Qt(n.origin):n.origin;a=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var h=gt(i["!ref"]);u.s.c=h.s.c,u.s.r=h.s.r,u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),a==-1&&(u.e.r=a=h.e.r+1)}for(var d=0;d!=e.length;++d)if(e[d]){if(!Array.isArray(e[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=e[d].length;++m)if(!(typeof e[d][m]>"u")){var p={v:e[d][m]},x=a+d,g=o+m;if(u.s.r>x&&(u.s.r=x),u.s.c>g&&(u.s.c=g),u.e.r<x&&(u.e.r=x),u.e.c<g&&(u.e.c=g),e[d][m]&&typeof e[d][m]=="object"&&!Array.isArray(e[d][m])&&!(e[d][m]instanceof Date))p=e[d][m];else if(Array.isArray(p.v)&&(p.f=e[d][m][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||He[14],n.cellDates?(p.t="d",p.w=ps(p.z,Ar(p.v))):(p.t="n",p.v=Ar(p.v),p.w=ps(p.z,p.v))):p.t="s";if(s)i[x]||(i[x]=[]),i[x][g]&&i[x][g].z&&(p.z=i[x][g].z),i[x][g]=p;else{var y=Ge({c:g,r:x});i[y]&&i[y].z&&(p.z=i[y].z),i[y]=p}}}return u.s.c<1e7&&(i["!ref"]=tt(u)),i}function cc(t,e){return Tb(null,t,e)}function tD(t){return t.read_shift(4,"i")}function Fs(t,e){return e||(e=le(4)),e.write_shift(4,t),e}function mn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Dr(t,e){var r=!1;return e==null&&(r=!0,e=le(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function rD(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function nD(t,e){return e||(e=le(4)),e.write_shift(2,t.ich||0),e.write_shift(2,t.ifnt||0),e}function Ux(t,e){var r=t.l,n=t.read_shift(1),s=mn(t),i=[],a={t:s,h:s};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)i.push(rD(t));a.r=i}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function sD(t,e){var r=!1;return e==null&&(r=!0,e=le(15+4*t.t.length)),e.write_shift(1,0),Dr(t.t,e),r?e.slice(0,e.l):e}var iD=Ux;function aD(t,e){var r=!1;return e==null&&(r=!0,e=le(23+4*t.t.length)),e.write_shift(1,1),Dr(t.t,e),e.write_shift(4,1),nD({ich:0,ifnt:0},e),r?e.slice(0,e.l):e}function gs(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Mo(t,e){return e==null&&(e=le(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Bo(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Vo(t,e){return e==null&&(e=le(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var oD=mn,Sb=Dr;function $x(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Mf(t,e){var r=!1;return e==null&&(r=!0,e=le(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var lD=mn,vg=$x,Wx=Mf;function zx(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?Of([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Xa(e,0)>>2;return r?s/100:s}function bb(t,e){e==null&&(e=le(4));var r=0,n=0,s=t*100;if(t==(t|0)&&t>=-(1<<29)&&t<1<<29?n=1:s==(s|0)&&s>=-(1<<29)&&s<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?s:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function Cb(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function cD(t,e){return e||(e=le(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Uo=Cb,uc=cD;function dn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function So(t,e){return(e||le(8)).write_shift(8,t,"f")}function uD(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),i=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var u=ao[s];u&&(e.rgb=G0(u));break;case 2:e.rgb=G0([a,o,l]);break;case 3:e.theme=s;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function Bf(t,e){if(e||(e=le(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function hD(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function fD(t,e){e||(e=le(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function Nb(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function dD(t){return Nb(t,1)}function mD(t){return Nb(t,2)}var Hx=2,An=3,ch=11,e_=12,Vf=19,uh=64,pD=65,gD=71,xD=4108,vD=4126,Pr=80,Ab=81,yD=[Pr,Ab],yg={1:{n:"CodePage",t:Hx},2:{n:"Category",t:Pr},3:{n:"PresentationFormat",t:Pr},4:{n:"ByteCount",t:An},5:{n:"LineCount",t:An},6:{n:"ParagraphCount",t:An},7:{n:"SlideCount",t:An},8:{n:"NoteCount",t:An},9:{n:"HiddenCount",t:An},10:{n:"MultimediaClipCount",t:An},11:{n:"ScaleCrop",t:ch},12:{n:"HeadingPairs",t:xD},13:{n:"TitlesOfParts",t:vD},14:{n:"Manager",t:Pr},15:{n:"Company",t:Pr},16:{n:"LinksUpToDate",t:ch},17:{n:"CharacterCount",t:An},19:{n:"SharedDoc",t:ch},22:{n:"HyperlinksChanged",t:ch},23:{n:"AppVersion",t:An,p:"version"},24:{n:"DigSig",t:pD},26:{n:"ContentType",t:Pr},27:{n:"ContentStatus",t:Pr},28:{n:"Language",t:Pr},29:{n:"Version",t:Pr},255:{},2147483648:{n:"Locale",t:Vf},2147483651:{n:"Behavior",t:Vf},1919054434:{}},wg={1:{n:"CodePage",t:Hx},2:{n:"Title",t:Pr},3:{n:"Subject",t:Pr},4:{n:"Author",t:Pr},5:{n:"Keywords",t:Pr},6:{n:"Comments",t:Pr},7:{n:"Template",t:Pr},8:{n:"LastAuthor",t:Pr},9:{n:"RevNumber",t:Pr},10:{n:"EditTime",t:uh},11:{n:"LastPrinted",t:uh},12:{n:"CreatedDate",t:uh},13:{n:"ModifiedDate",t:uh},14:{n:"PageCount",t:An},15:{n:"WordCount",t:An},16:{n:"CharCount",t:An},17:{n:"Thumbnail",t:gD},18:{n:"Application",t:Pr},19:{n:"DocSecurity",t:An},255:{},2147483648:{n:"Locale",t:Vf},2147483651:{n:"Behavior",t:Vf},1919054434:{}},t_={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},wD=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function _D(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var ED=_D([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ao=Ht(ED),Vi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Ib={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},_g={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},hh={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Gx(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function kD(t){var e=Gx();if(!t||!t.match)return e;var r={};if((t.match(yn)||[]).forEach(function(n){var s=Ke(n);switch(s[0].replace(FL,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[_g[s.ContentType]]!==void 0&&e[_g[s.ContentType]].push(s.PartName);break}}),e.xmlns!==br.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function Rb(t,e){var r=TL(_g),n=[],s;n[n.length]=dr,n[n.length]=be("Types",null,{xmlns:br.CT,"xmlns:xsd":br.xsd,"xmlns:xsi":br.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return be("Default",null,{Extension:l[0],ContentType:l[1]})}));var i=function(l){t[l]&&t[l].length>0&&(s=t[l][0],n[n.length]=be("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:hh[l][e.bookType]||hh[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(u){n[n.length]=be("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:hh[l][e.bookType]||hh[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(u){n[n.length]=be("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return i("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var it={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function H0(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function o0(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(yn)||[]).forEach(function(s){var i=Ke(s);if(i[0]==="<Relationship"){var a={};a.Type=i.Type,a.Target=i.Target,a.Id=i.Id,i.TargetMode&&(a.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:$c(i.Target,e);r[o]=a,n[i.Id]=a}}),r["!id"]=n,r}function Nl(t){var e=[dr,be("Relationships",null,{xmlns:br.RELS})];return ar(t["!id"]).forEach(function(r){e[e.length]=be("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function It(t,e,r,n,s,i){if(s||(s={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,s.Id="rId"+e,s.Type=n,s.Target=r,i?s.TargetMode=i:[it.HLINK,it.XPATH,it.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),t["!id"][s.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][s.Id]=s,t[("/"+s.Target).replace("//","/")]=s,e}var TD="application/vnd.oasis.opendocument.spreadsheet";function SD(t,e){for(var r=jx(t),n,s;n=z0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Ke(n[0],!1),s.path=="/"&&s.type!==TD)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function bD(t){var e=[dr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function r_(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function CD(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function ND(t){var e=[dr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(r_(t[r][0],t[r][1])),e.push(CD("",t[r][0]));return e.push(r_("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function Pb(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Pf.version+"</meta:generator></office:meta></office:document-meta>"}var hs=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],AD=function(){for(var t=new Array(hs.length),e=0;e<hs.length;++e){var r=hs[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function Fb(t){var e={};t=Dt(t);for(var r=0;r<hs.length;++r){var n=hs[r],s=t.match(AD[r]);s!=null&&s.length>0&&(e[n[1]]=pt(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=zt(e[n[1]]))}return e}function Bm(t,e,r,n,s){s[t]!=null||e==null||e===""||(s[t]=e,e=Pt(e),n[n.length]=r?be(t,e,r):Kr(t,e))}function Lb(t,e){var r=e||{},n=[dr,be("cp:coreProperties",null,{"xmlns:cp":br.CORE_PROPS,"xmlns:dc":br.dc,"xmlns:dcterms":br.dcterms,"xmlns:dcmitype":br.dcmitype,"xmlns:xsi":br.xsi})],s={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Bm("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:xg(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),t.ModifiedDate!=null&&Bm("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:xg(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var i=0;i!=hs.length;++i){var a=hs[i],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Bm(a[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var oo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Db=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function jb(t,e,r,n){var s=[];if(typeof t=="string")s=Gw(t,n);else for(var i=0;i<t.length;++i)s=s.concat(t[i].map(function(h){return{v:h}}));var a=typeof e=="string"?Gw(e,n).map(function(h){return h.v}):e,o=0,l=0;if(a.length>0)for(var u=0;u!==s.length;u+=2){switch(l=+s[u+1].v,s[u].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function ID(t,e,r){var n={};return e||(e={}),t=Dt(t),oo.forEach(function(s){var i=(t.match($0(s[0]))||[])[1];switch(s[2]){case"string":i&&(e[s[1]]=pt(i));break;case"bool":e[s[1]]=i==="true";break;case"raw":var a=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));a&&a.length>0&&(n[s[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&jb(n.HeadingPairs,n.TitlesOfParts,e,r),e}function Ob(t){var e=[],r=be;return t||(t={}),t.Application="SheetJS",e[e.length]=dr,e[e.length]=be("Properties",null,{xmlns:br.EXT_PROPS,"xmlns:vt":br.vt}),oo.forEach(function(n){if(t[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Pt(String(t[n[1]]));break;case"bool":s=t[n[1]]?"true":"false";break}s!==void 0&&(e[e.length]=r(n[0],s))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Pt(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var RD=/<[^>]+>[^<]*/g;function PD(t,e){var r={},n="",s=t.match(RD);if(s)for(var i=0;i!=s.length;++i){var a=s[i],o=Ke(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=pt(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),u=l[0].slice(4),h=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=pt(h);break;case"bool":r[n]=Ut(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=zt(h);break;case"cy":case"error":r[n]=pt(h);break;default:if(u.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,u,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}function Mb(t){var e=[dr,be("Properties",null,{xmlns:br.CUST_PROPS,"xmlns:vt":br.vt})];if(!t)return e.join("");var r=1;return ar(t).forEach(function(s){++r,e[e.length]=be("property",UL(t[s],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Pt(s)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Eg={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Vm;function FD(t,e,r){Vm||(Vm=Dd(Eg)),e=Vm[e]||e,t[e]=r}function LD(t,e){var r=[];return ar(Eg).map(function(n){for(var s=0;s<hs.length;++s)if(hs[s][1]==n)return hs[s];for(s=0;s<oo.length;++s)if(oo[s][1]==n)return oo[s];throw n}).forEach(function(n){if(t[n[1]]!=null){var s=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Kr(Eg[n[1]]||n[1],s))}}),be("DocumentProperties",r.join(""),{xmlns:Vn.o})}function DD(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return t&&ar(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)){for(var a=0;a<hs.length;++a)if(i==hs[a][1])return;for(a=0;a<oo.length;++a)if(i==oo[a][1])return;for(a=0;a<r.length;++a)if(i==r[a])return;var o=t[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),s.push(be($w(i),o,{"dt:dt":l}))}}),e&&ar(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)&&!(t&&Object.prototype.hasOwnProperty.call(t,i))){var a=e[i],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),s.push(be($w(i),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Vn.o+'">'+s.join("")+"</"+n+">"}function Kx(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function jD(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),s+=i);var a=le(8);return a.write_shift(4,n),a.write_shift(4,s),a}function Bb(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function Vb(t,e,r){var n=t.read_shift(0,"lpwstr");return r&&(t.l+=4-(n.length+1&3)&3),n}function Ub(t,e,r){return e===31?Vb(t):Bb(t,e,r)}function kg(t,e,r){return Ub(t,e,r===!1?0:4)}function OD(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return Ub(t,e,0)}function MD(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Sn,""),t.l-s&2&&(t.l+=2)}return r}function BD(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Sn,"");return r}function VD(t){var e=t.l,r=Uf(t,Ab);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Uf(t,An);return[r,n]}function UD(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(VD(t));return r}function n_(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var i=t.read_shift(4),a=t.read_shift(4);n[i]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(Sn,"").replace(Uc,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>2+1<<2),n}function $b(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function $D(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Uf(t,e,r){var n=t.read_shift(2),s,i=r||{};if(t.l+=2,e!==e_&&n!==e&&yD.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===e_?n:e){case 2:return s=t.read_shift(2,"i"),i.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return Bb(t,n,4).replace(Sn,"");case 31:return Vb(t);case 64:return Kx(t);case 65:return $b(t);case 71:return $D(t);case 80:return kg(t,n,!i.raw).replace(Sn,"");case 81:return OD(t,n).replace(Sn,"");case 4108:return UD(t);case 4126:case 4127:return n==4127?MD(t):BD(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function s_(t,e){var r=le(4),n=le(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=le(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=jD(e);break;case 31:case 80:for(n=le(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Lr([r,n])}function i_(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0,o=0,l=-1,u={};for(a=0;a!=s;++a){var h=t.read_shift(4),d=t.read_shift(4);i[a]=[h,d+r]}i.sort(function(E,_){return E[1]-_[1]});var m={};for(a=0;a!=s;++a){if(t.l!==i[a][1]){var p=!0;if(a>0&&e)switch(e[i[a-1][0]].t){case 2:t.l+2===i[a][1]&&(t.l+=2,p=!1);break;case 80:t.l<=i[a][1]&&(t.l=i[a][1],p=!1);break;case 4108:t.l<=i[a][1]&&(t.l=i[a][1],p=!1);break}if((!e||a==0)&&t.l<=i[a][1]&&(p=!1,t.l=i[a][1]),p)throw new Error("Read Error: Expected address "+i[a][1]+" at "+t.l+" :"+a)}if(e){var x=e[i[a][0]];if(m[x.n]=Uf(t,x.t,{raw:!0}),x.p==="version"&&(m[x.n]=String(m[x.n]>>16)+"."+("0000"+String(m[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(m[x.n]){case 0:m[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Cs(o=m[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[x.n])}}else if(i[a][0]===1){if(o=m.CodePage=Uf(t,Hx),Cs(o),l!==-1){var g=t.l;t.l=i[l][1],u=n_(t,o),t.l=g}}else if(i[a][0]===0){if(o===0){l=a,t.l=i[a+1][1];continue}u=n_(t,o)}else{var y=u[i[a][0]],w;switch(t[t.l]){case 65:t.l+=4,w=$b(t);break;case 30:t.l+=4,w=kg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,w=kg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,w=t.read_shift(4,"i");break;case 19:t.l+=4,w=t.read_shift(4);break;case 5:t.l+=4,w=t.read_shift(8,"f");break;case 11:t.l+=4,w=or(t,4);break;case 64:t.l+=4,w=zt(Kx(t));break;default:throw new Error("unparsed value: "+t[t.l])}m[y]=w}}return t.l=r+n,m}var Wb=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function WD(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function a_(t,e,r){var n=le(8),s=[],i=[],a=8,o=0,l=le(8),u=le(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),i.push(l),s.push(u),a+=8+l.length,!e){u=le(8),u.write_shift(4,0),s.unshift(u);var h=[le(4)];for(h[0].write_shift(4,t.length),o=0;o<t.length;++o){var d=t[o][0];for(l=le(4+4+2*(d.length+1)+(d.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);h.push(l)}l=Lr(h),i.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(Wb.indexOf(t[o][0])>-1||Db.indexOf(t[o][0])>-1)&&t[o][1]!=null){var m=t[o][1],p=0;if(e){p=+e[t[o][0]];var x=r[p];if(x.p=="version"&&typeof m=="string"){var g=m.split(".");m=(+g[0]<<16)+(+g[1]||0)}l=s_(x.t,m)}else{var y=WD(m);y==-1&&(y=31,m=String(m)),l=s_(y,m)}i.push(l),u=le(8),u.write_shift(4,e?p:2+o),s.push(u),a+=8+l.length}var w=8*(i.length+1);for(o=0;o<i.length;++o)s[o].write_shift(4,w),w+=i[o].length;return n.write_shift(4,a),n.write_shift(4,i.length),Lr([n].concat(s).concat(i))}function o_(t,e,r){var n=t.content;if(!n)return{};Hr(n,0);var s,i,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),h=n.read_shift(16);if(h!==Me.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(a=n.read_shift(16),l=n.read_shift(4));var d=i_(n,e),m={SystemIdentifier:u};for(var p in d)m[p]=d[p];if(m.FMTID=i,s===1)return m;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var x;try{x=i_(n,null)}catch{}for(p in x)m[p]=x[p];return m.FMTID=[i,a],m}function l_(t,e,r,n,s,i){var a=le(s?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Me.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,s?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,s?68:48);var l=a_(t,r,n);if(o.push(l),s){var u=a_(s,null,null);a.write_shift(16,i,"hex"),a.write_shift(4,68+l.length),o.push(u)}return Lr(o)}function Ki(t,e){return t.read_shift(e),null}function zD(t,e){e||(e=le(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function HD(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function or(t,e){return t.read_shift(e)===1}function En(t,e){return e||(e=le(2)),e.write_shift(2,+!!t),e}function xr(t){return t.read_shift(2,"u")}function ss(t,e){return e||(e=le(2)),e.write_shift(2,t),e}function zb(t,e){return HD(t,e,xr)}function GD(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function Hb(t,e,r){return r||(r=le(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function _u(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var a=n?t.read_shift(n,s):"";return a}function KD(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,i=1+(r&1),a=0,o,l={};s&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var u=i==2?"dbcs-cont":"sbcs-cont",h=e===0?"":t.read_shift(e,u);return s&&(t.l+=4*a),n&&(t.l+=o),l.t=h,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function qD(t){var e=t.t||"",r=le(3+0);r.write_shift(2,e.length),r.write_shift(1,1);var n=le(2*e.length);n.write_shift(2*e.length,e,"utf16le");var s=[r,n];return Lr(s)}function bo(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Eu(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):bo(t,n,r)}function $o(t,e,r){if(r.biff>5)return Eu(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function Gb(t,e,r){return r||(r=le(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function XD(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function QD(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Sn,"");return n&&(t.l+=24),s}function YD(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(i>>1,"utf16le").replace(Sn,"");return r+a}function JD(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return QD(t);case"0303000000000000c000000000000046":return YD(t);default:throw new Error("Unsupported Moniker "+r)}}function fh(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Sn,""):"";return r}function c_(t,e){e||(e=le(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function ZD(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var i,a,o,l,u="",h,d;s&16&&(i=fh(t,r-t.l)),s&128&&(a=fh(t,r-t.l)),(s&257)===257&&(o=fh(t,r-t.l)),(s&257)===1&&(l=JD(t,r-t.l)),s&8&&(u=fh(t,r-t.l)),s&32&&(h=t.read_shift(16)),s&64&&(d=Kx(t)),t.l=r;var m=a||o||l||"";m&&u&&(m+="#"+u),m||(m="#"+u),s&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var p={Target:m};return h&&(p.guid=h),d&&(p.time=d),i&&(p.Tooltip=i),p}function ej(t){var e=le(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),i=s>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}e.write_shift(4,2),e.write_shift(4,i);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(i==28)n=n.slice(1),c_(n,e);else if(i&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=s>-1?n.slice(0,s):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),i&8&&c_(s>-1?n.slice(s+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function Kb(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function qb(t,e){var r=Kb(t);return r[3]=0,r}function ci(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Co(t,e,r,n){return n||(n=le(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function tj(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function rj(t,e,r){return e===0?"":$o(t,e,r)}function nj(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),i=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[s,i,a]}function Xb(t){var e=t.read_shift(2),r=zx(t);return[e,r]}function sj(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=_u(t,e,r),i=t.read_shift(2);if(n-=t.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return t.l+=i,s}function Md(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function Qb(t,e){return e||(e=le(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function Yb(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var ij=Yb;function Jb(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function aj(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function oj(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function an(t){t.l+=2,t.l+=t.read_shift(2)}var lj={0:an,4:an,5:an,6:an,7:oj,8:an,9:an,10:an,11:an,12:an,13:aj,14:an,15:an,16:an,17:an,18:an,19:an,20:an,21:Jb};function cj(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(lj[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function dh(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function qx(t,e,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=le(s);return i.write_shift(2,n),i.write_shift(2,e),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function uj(t,e){return e===0||t.read_shift(2),1200}function hj(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=$o(t,0,r);return t.read_shift(e+n-t.l),s}function fj(t,e){var r=!e||e.biff==8,n=le(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function dj(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function mj(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var a=_u(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:s,dt:i,name:a}}function pj(t,e){var r=!e||e.biff>=8?2:1,n=le(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function gj(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0;a!=s&&t.l<r;++a)i.push(KD(t));return i.Count=n,i.Unique=s,i}function xj(t,e){var r=le(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],s=0;s<t.length;++s)n[s]=qD(t[s]);var i=Lr([r].concat(n));return i.parts=[r.length].concat(n.map(function(a){return a.length})),i}function vj(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function yj(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function wj(t){var e=tj(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function _j(t){return t.read_shift(2),t.read_shift(4)}function u_(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,s]}function Ej(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:i,CurTab:a,FirstTab:o,Selected:l,TabRatio:u}}function kj(){var t=le(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function Tj(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function Sj(t){var e=le(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function bj(){}function Cj(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=_u(t,0,r),n}function Nj(t,e){var r=t.name||"Arial",n=e&&e.biff==5,s=n?15+r.length:16+2*r.length,i=le(s);return i.write_shift(2,(t.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function Aj(t){var e=ci(t);return e.isst=t.read_shift(4),e}function Ij(t,e,r,n){var s=le(10);return Co(t,e,n,s),s.write_shift(4,r),s}function Rj(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=ci(t);r.biff==2&&t.l++;var i=Eu(t,n-t.l,r);return s.val=i,s}function Pj(t,e,r,n,s){var i=!s||s.biff==8,a=le(6+2+ +i+(1+i)*r.length);return Co(t,e,n,a),a.write_shift(2,r.length),i&&a.write_shift(1,1),a.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),a}function Fj(t,e,r){var n=t.read_shift(2),s=$o(t,0,r);return[n,s]}function Lj(t,e,r,n){var s=r&&r.biff==5;n||(n=le(s?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(s?1:2,e.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var Dj=$o;function h_(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,i=t.read_shift(s),a=t.read_shift(s),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:i,c:o},e:{r:a,c:l}}}function jj(t,e){var r=e.biff==8||!e.biff?4:2,n=le(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function Oj(t){var e=t.read_shift(2),r=t.read_shift(2),n=Xb(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function Mj(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(Xb(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:a,rkrec:i}}function Bj(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:a,ixfe:i}}function Vj(t,e,r,n){var s={},i=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return s.patternType=wD[o>>26],n.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=a&15,s.dgRight=a>>4&15,s.dgTop=a>>8&15,s.dgBottom=a>>12&15,s.icvLeft=a>>16&127,s.icvRight=a>>23&127,s.grbitDiag=a>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function Uj(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=Vj(t,e,n.fStyle,r),n}function f_(t,e,r,n){var s=r&&r.biff==5;n||(n=le(s?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var i=0;return t.numFmtId>0&&s&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function $j(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function Wj(t){var e=le(8);return e.write_shift(4,0),e.write_shift(2,t[0]?t[0]+1:0),e.write_shift(2,t[1]?t[1]+1:0),e}function d_(t,e,r){var n=ci(t);(r.biff==2||e==9)&&++t.l;var s=GD(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function zj(t,e,r,n,s,i){var a=le(8);return Co(t,e,n,a),Hb(r,i,a),a}function Hj(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ci(t),s=dn(t);return n.val=s,n}function Gj(t,e,r,n){var s=le(14);return Co(t,e,n,s),So(r,s),s}var m_=rj;function Kj(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var a=bo(t,i),o=[];n>t.l;)o.push(Eu(t));return[i,s,a,o]}function p_(t,e,r){var n=t.read_shift(2),s,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=sj(t,e-2,r)),i.body=s||t.read_shift(e-2),typeof s=="string"&&(i.Name=s),i}var qj=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function g_(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var u=bo(t,a,r);s&32&&(u=qj[u.charCodeAt(0)]);var h=n-t.l;r&&r.biff==2&&--h;var d=n==t.l||o===0||!(h>0)?[]:cU(t,h,r,o);return{chKey:i,Name:u,itab:l,rgce:d}}function Zb(t,e,r){if(r.biff<8)return Xj(t,e,r);for(var n=[],s=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)n.push(nj(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function Xj(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=_u(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function Qj(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),i=bo(t,n,r),a=bo(t,s,r);return[i,a]}function Yj(t,e,r){var n=Yb(t);t.l++;var s=t.read_shift(1);return e-=8,[uU(t,e,r),s,n]}function x_(t,e,r){var n=ij(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,oU(t,e,r)]}function Jj(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function Zj(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=$o(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},o,a,i]}}function eO(t,e,r){return Zj(t,e,r)}function tO(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Md(t));return r}function rO(t){var e=le(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)Qb(t[r],e);return e}function nO(t,e,r){if(r&&r.biff<8)return iO(t,e,r);var n=Jb(t),s=cj(t,e-22,n[1]);return{cmo:n,ft:s}}var sO={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function iO(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((sO[n]||xn)(t,e,r)),{cmo:[s,n,i],ft:a}}function aO(t,e,r){var n=t.l,s="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:a=XD(t,6,r);var o=t.read_shift(2);t.read_shift(2),xr(t,2);var l=t.read_shift(2);t.l+=l;for(var u=1;u<t.lens.length-1;++u){if(t.l-n!=t.lens[u])throw new Error("TxO: bad continue record");var h=t[t.l],d=bo(t,t.lens[u+1]-t.lens[u]-1);if(s+=d,s.length>=(h?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function oO(t,e){var r=Md(t);t.l+=16;var n=ZD(t,e-24);return[r,n]}function lO(t){var e=le(24),r=Qt(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)e.write_shift(1,parseInt(n[s],16));return Lr([e,ej(t[1])])}function cO(t,e){t.read_shift(2);var r=Md(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Sn,""),[r,n]}function uO(t){var e=t[1].Tooltip,r=le(10+2*(e.length+1));r.write_shift(2,2048);var n=Qt(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<e.length;++s)r.write_shift(2,e.charCodeAt(s));return r.write_shift(2,0),r}function hO(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=t_[r]||r,r=t.read_shift(2),e[1]=t_[r]||r,e}function fO(t){return t||(t=le(4)),t.write_shift(2,1),t.write_shift(2,1),t}function dO(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(qb(t));return r}function mO(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(qb(t));return r}function pO(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function e3(t,e,r){if(!r.cellStyles)return xn(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),i=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var u={s,e:i,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function gO(t,e){var r=le(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function xO(t,e){var r={};return e<32||(t.l+=16,r.header=dn(t),r.footer=dn(t),t.l+=2),r}function vO(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}function yO(t){for(var e=le(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var wO=ci,_O=zb,EO=Eu;function kO(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function TO(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ci(t);++t.l;var s=$o(t,e-7,r);return n.t="str",n.val=s,n}function SO(t){var e=ci(t);++t.l;var r=dn(t);return e.t="n",e.val=r,e}function bO(t,e,r){var n=le(15);return bu(n,t,e),n.write_shift(8,r,"f"),n}function CO(t){var e=ci(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function NO(t,e,r){var n=le(9);return bu(n,t,e),n.write_shift(2,r),n}function AO(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function IO(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function RO(t,e,r){var n=t.l+e,s=ci(t),i=t.read_shift(2),a=bo(t,i,r);return t.l=n,s.t="str",s.val=a,s}var PO=[2,3,48,49,131,139,140,245],Tg=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Dd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],h=ba(1);switch(l.type){case"base64":h=$n(qn(o));break;case"binary":h=$n(o);break;case"buffer":case"array":h=o;break}Hr(h,0);var d=h.read_shift(1),m=!!(d&136),p=!1,x=!1;switch(d){case 2:break;case 3:break;case 48:p=!0,m=!0;break;case 49:p=!0,m=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var g=0,y=521;d==2&&(g=h.read_shift(2)),h.l+=3,d!=2&&(g=h.read_shift(4)),g>1048576&&(g=1e6),d!=2&&(y=h.read_shift(2));var w=h.read_shift(2),E=l.codepage||1252;d!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(E=t[h[h.l]]),h.l+=1,h.l+=2),x&&(h.l+=36);for(var _=[],N={},j=Math.min(h.length,d==2?521:y-10-(p?264:0)),D=x?32:11;h.l<j&&h[h.l]!=13;)switch(N={},N.name=ta.utils.decode(E,h.slice(h.l,h.l+D)).replace(/[\u0000\r\n].*$/g,""),h.l+=D,N.type=String.fromCharCode(h.read_shift(1)),d!=2&&!x&&(N.offset=h.read_shift(4)),N.len=h.read_shift(1),d==2&&(N.offset=h.read_shift(2)),N.dec=h.read_shift(1),N.name.length&&_.push(N),d!=2&&(h.l+=x?13:14),N.type){case"B":(!p||N.len!=8)&&l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(h[h.l]!==13&&(h.l=y-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=y;var k=0,S=0;for(u[0]=[],S=0;S!=_.length;++S)u[0][S]=_[S].name;for(;g-- >0;){if(h[h.l]===42){h.l+=w;continue}for(++h.l,u[++k]=[],S=0,S=0;S!=_.length;++S){var b=h.slice(h.l,h.l+_[S].len);h.l+=_[S].len,Hr(b,0);var C=ta.utils.decode(E,b);switch(_[S].type){case"C":C.trim().length&&(u[k][S]=C.replace(/\s+$/,""));break;case"D":C.length===8?u[k][S]=new Date(+C.slice(0,4),+C.slice(4,6)-1,+C.slice(6,8)):u[k][S]=C;break;case"F":u[k][S]=parseFloat(C.trim());break;case"+":case"I":u[k][S]=x?b.read_shift(-4,"i")^2147483648:b.read_shift(4,"i");break;case"L":switch(C.trim().toUpperCase()){case"Y":case"T":u[k][S]=!0;break;case"N":case"F":u[k][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+C+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));u[k][S]="##MEMO##"+(x?parseInt(C.trim(),10):b.read_shift(4));break;case"N":C=C.replace(/\u0000/g,"").trim(),C&&C!="."&&(u[k][S]=+C||0);break;case"@":u[k][S]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":u[k][S]=new Date((b.read_shift(4)-2440588)*864e5+b.read_shift(4));break;case"Y":u[k][S]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[k][S]=-b.read_shift(-8,"f");break;case"B":if(p&&_[S].len==8){u[k][S]=b.read_shift(8,"f");break}case"G":case"P":b.l+=_[S].len;break;case"0":if(_[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[S].type)}}}if(d!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=_,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var h=cc(r(o,u),u);return h["!cols"]=u.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete u.DBF,h}function s(o,l){try{return Ma(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var u=l||{};if(+u.codepage>=0&&Cs(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var h=jn(),d=zf(o,{header:1,raw:!0,cellDates:!0}),m=d[0],p=d.slice(1),x=o["!cols"]||[],g=0,y=0,w=0,E=1;for(g=0;g<m.length;++g){if(((x[g]||{}).DBF||{}).name){m[g]=x[g].DBF.name,++w;continue}if(m[g]!=null){if(++w,typeof m[g]=="number"&&(m[g]=m[g].toString(10)),typeof m[g]!="string")throw new Error("DBF Invalid column name "+m[g]+" |"+typeof m[g]+"|");if(m.indexOf(m[g])!==g){for(y=0;y<1024;++y)if(m.indexOf(m[g]+"_"+y)==-1){m[g]+="_"+y;break}}}}var _=gt(o["!ref"]),N=[],j=[],D=[];for(g=0;g<=_.e.c-_.s.c;++g){var k="",S="",b=0,C=[];for(y=0;y<p.length;++y)p[y][g]!=null&&C.push(p[y][g]);if(C.length==0||m[g]==null){N[g]="?";continue}for(y=0;y<C.length;++y){switch(typeof C[y]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=C[y]instanceof Date?"D":"C";break;default:S="C"}b=Math.max(b,String(C[y]).length),k=k&&k!=S?"C":S}b>250&&(b=250),S=((x[g]||{}).DBF||{}).type,S=="C"&&x[g].DBF.len>b&&(b=x[g].DBF.len),k=="B"&&S=="N"&&(k="N",D[g]=x[g].DBF.dec,b=x[g].DBF.len),j[g]=k=="C"||S=="N"?b:i[k]||0,E+=j[g],N[g]=k}var A=h.next(32);for(A.write_shift(4,318902576),A.write_shift(4,p.length),A.write_shift(2,296+32*w),A.write_shift(2,E),g=0;g<4;++g)A.write_shift(4,0);for(A.write_shift(4,0|(+e[$S]||3)<<8),g=0,y=0;g<m.length;++g)if(m[g]!=null){var I=h.next(32),P=(m[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);I.write_shift(1,P,"sbcs"),I.write_shift(1,N[g]=="?"?"C":N[g],"sbcs"),I.write_shift(4,y),I.write_shift(1,j[g]||i[N[g]]||0),I.write_shift(1,D[g]||0),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(1,0),I.write_shift(4,0),I.write_shift(4,0),y+=j[g]||i[N[g]]||0}var ue=h.next(264);for(ue.write_shift(4,13),g=0;g<65;++g)ue.write_shift(4,0);for(g=0;g<p.length;++g){var de=h.next(E);for(de.write_shift(1,0),y=0;y<m.length;++y)if(m[y]!=null)switch(N[y]){case"L":de.write_shift(1,p[g][y]==null?63:p[g][y]?84:70);break;case"B":de.write_shift(8,p[g][y]||0,"f");break;case"N":var ie="0";for(typeof p[g][y]=="number"&&(ie=p[g][y].toFixed(D[y]||0)),w=0;w<j[y]-ie.length;++w)de.write_shift(1,32);de.write_shift(1,ie,"sbcs");break;case"D":p[g][y]?(de.write_shift(4,("0000"+p[g][y].getFullYear()).slice(-4),"sbcs"),de.write_shift(2,("00"+(p[g][y].getMonth()+1)).slice(-2),"sbcs"),de.write_shift(2,("00"+p[g][y].getDate()).slice(-2),"sbcs")):de.write_shift(8,"00000000","sbcs");break;case"C":var ge=String(p[g][y]!=null?p[g][y]:"").slice(0,j[y]);for(de.write_shift(1,ge,"sbcs"),w=0;w<j[y]-ge.length;++w)de.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:s,to_sheet:n,from_sheet:a}}(),t3=function(){var t={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+ar(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,p){var x=t[p];return typeof x=="number"?Nw(x):x},n=function(m,p,x){var g=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return g==59?m:Nw(g)};t["|"]=254;function s(m,p){switch(p.type){case"base64":return i(qn(m),p);case"binary":return i(m,p);case"buffer":return i(nt&&Buffer.isBuffer(m)?m.toString("binary"):Oa(m),p);case"array":return i(To(m),p)}throw new Error("Unrecognized type "+p.type)}function i(m,p){var x=m.split(/[\n\r]+/),g=-1,y=-1,w=0,E=0,_=[],N=[],j=null,D={},k=[],S=[],b=[],C=0,A;for(+p.codepage>=0&&Cs(+p.codepage);w!==x.length;++w){C=0;var I=x[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),P=I.replace(/;;/g,"\0").split(";").map(function(G){return G.replace(/\u0000/g,";")}),ue=P[0],de;if(I.length>0)switch(ue){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":P[1].charAt(0)=="P"&&N.push(I.slice(3).replace(/;;/g,";"));break;case"C":var ie=!1,ge=!1,ne=!1,K=!1,fe=-1,_e=-1;for(E=1;E<P.length;++E)switch(P[E].charAt(0)){case"A":break;case"X":y=parseInt(P[E].slice(1))-1,ge=!0;break;case"Y":for(g=parseInt(P[E].slice(1))-1,ge||(y=0),A=_.length;A<=g;++A)_[A]=[];break;case"K":de=P[E].slice(1),de.charAt(0)==='"'?de=de.slice(1,de.length-1):de==="TRUE"?de=!0:de==="FALSE"?de=!1:isNaN(Ps(de))?isNaN(Kl(de).getDate())||(de=zt(de)):(de=Ps(de),j!==null&&oc(j)&&(de=Od(de))),ie=!0;break;case"E":K=!0;var B=Al(P[E].slice(1),{r:g,c:y});_[g][y]=[_[g][y],B];break;case"S":ne=!0,_[g][y]=[_[g][y],"S5S"];break;case"G":break;case"R":fe=parseInt(P[E].slice(1))-1;break;case"C":_e=parseInt(P[E].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+I)}if(ie&&(_[g][y]&&_[g][y].length==2?_[g][y][0]=de:_[g][y]=de,j=null),ne){if(K)throw new Error("SYLK shared formula cannot have own formula");var q=fe>-1&&_[fe][_e];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");_[g][y][1]=y3(q[1],{r:g-fe,c:y-_e})}break;case"F":var H=0;for(E=1;E<P.length;++E)switch(P[E].charAt(0)){case"X":y=parseInt(P[E].slice(1))-1,++H;break;case"Y":for(g=parseInt(P[E].slice(1))-1,A=_.length;A<=g;++A)_[A]=[];break;case"M":C=parseInt(P[E].slice(1))/20;break;case"F":break;case"G":break;case"P":j=N[parseInt(P[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(b=P[E].slice(1).split(" "),A=parseInt(b[0],10);A<=parseInt(b[1],10);++A)C=parseInt(b[2],10),S[A-1]=C===0?{hidden:!0}:{wch:C},Ca(S[A-1]);break;case"C":y=parseInt(P[E].slice(1))-1,S[y]||(S[y]={});break;case"R":g=parseInt(P[E].slice(1))-1,k[g]||(k[g]={}),C>0?(k[g].hpt=C,k[g].hpx=Xl(C)):C===0&&(k[g].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+I)}H<1&&(j=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+I)}}return k.length>0&&(D["!rows"]=k),S.length>0&&(D["!cols"]=S),p&&p.sheetRows&&(_=_.slice(0,p.sheetRows)),[_,D]}function a(m,p){var x=s(m,p),g=x[0],y=x[1],w=cc(g,p);return ar(y).forEach(function(E){w[E]=y[E]}),w}function o(m,p){return Ma(a(m,p),p)}function l(m,p,x,g){var y="C;Y"+(x+1)+";X"+(g+1)+";K";switch(m.t){case"n":y+=m.v||0,m.f&&!m.F&&(y+=";E"+ev(m.f,{r:x,c:g}));break;case"b":y+=m.v?"TRUE":"FALSE";break;case"e":y+=m.w||m.v;break;case"d":y+='"'+(m.w||m.v)+'"';break;case"s":y+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(m,p){p.forEach(function(x,g){var y="F;W"+(g+1)+" "+(g+1)+" ";x.hidden?y+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=K0(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=q0(x.wpx)),typeof x.wch=="number"&&(y+=Math.round(x.wch))),y.charAt(y.length-1)!=" "&&m.push(y)})}function h(m,p){p.forEach(function(x,g){var y="F;";x.hidden?y+="M0;":x.hpt?y+="M"+20*x.hpt+";":x.hpx&&(y+="M"+20*X0(x.hpx)+";"),y.length>2&&m.push(y+"R"+(g+1))})}function d(m,p){var x=["ID;PWXL;N;E"],g=[],y=gt(m["!ref"]),w,E=Array.isArray(m),_=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),m["!cols"]&&u(x,m["!cols"]),m["!rows"]&&h(x,m["!rows"]),x.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var N=y.s.r;N<=y.e.r;++N)for(var j=y.s.c;j<=y.e.c;++j){var D=Ge({r:N,c:j});w=E?(m[N]||[])[j]:m[D],!(!w||w.v==null&&(!w.f||w.F))&&g.push(l(w,m,N,j))}return x.join(_)+_+g.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:a,from_sheet:d}}(),r3=function(){function t(i,a){switch(a.type){case"base64":return e(qn(i),a);case"binary":return e(i,a);case"buffer":return e(nt&&Buffer.isBuffer(i)?i.toString("binary"):Oa(i),a);case"array":return e(To(i),a)}throw new Error("Unrecognized type "+a.type)}function e(i,a){for(var o=i.split(`
`),l=-1,u=-1,h=0,d=[];h!==o.length;++h){if(o[h].trim()==="BOT"){d[++l]=[],u=0;continue}if(!(l<0)){var m=o[h].trim().split(","),p=m[0],x=m[1];++h;for(var g=o[h]||"";(g.match(/["]/g)||[]).length&1&&h<o.length-1;)g+=`
`+o[++h];switch(g=g.trim(),+p){case-1:if(g==="BOT"){d[++l]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?d[l][u]=!0:g==="FALSE"?d[l][u]=!1:isNaN(Ps(x))?isNaN(Kl(x).getDate())?d[l][u]=x:d[l][u]=zt(x):d[l][u]=Ps(x),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),d[l][u++]=g!==""?g:null;break}if(g==="EOD")break}}return a&&a.sheetRows&&(d=d.slice(0,a.sheetRows)),d}function r(i,a){return cc(t(i,a),a)}function n(i,a){return Ma(r(i,a),a)}var s=function(){var i=function(l,u,h,d,m){l.push(u),l.push(h+","+d),l.push('"'+m.replace(/"/g,'""')+'"')},a=function(l,u,h,d){l.push(u+","+h),l.push(u==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var u=[],h=gt(l["!ref"]),d,m=Array.isArray(l);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,h.e.r-h.s.r+1,""),i(u,"TUPLES",0,h.e.c-h.s.c+1,""),i(u,"DATA",0,0,"");for(var p=h.s.r;p<=h.e.r;++p){a(u,-1,0,"BOT");for(var x=h.s.c;x<=h.e.c;++x){var g=Ge({r:p,c:x});if(d=m?(l[p]||[])[x]:l[g],!d){a(u,1,0,"");continue}switch(d.t){case"n":var y=d.w;!y&&d.v!=null&&(y=d.v),y==null?d.f&&!d.F?a(u,1,0,"="+d.f):a(u,1,0,""):a(u,0,y,"V");break;case"b":a(u,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=ps(d.z||He[14],Ar(zt(d.v)))),a(u,0,d.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var w=`\r
`,E=u.join(w);return E}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),n3=function(){function t(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,m){for(var p=d.split(`
`),x=-1,g=-1,y=0,w=[];y!==p.length;++y){var E=p[y].trim().split(":");if(E[0]==="cell"){var _=Qt(E[1]);if(w.length<=_.r)for(x=w.length;x<=_.r;++x)w[x]||(w[x]=[]);switch(x=_.r,g=_.c,E[2]){case"t":w[x][g]=t(E[3]);break;case"v":w[x][g]=+E[3];break;case"vtf":var N=E[E.length-1];case"vtc":switch(E[3]){case"nl":w[x][g]=!!+E[4];break;default:w[x][g]=+E[4];break}E[2]=="vtf"&&(w[x][g]=[w[x][g],N])}}}return m&&m.sheetRows&&(w=w.slice(0,m.sheetRows)),w}function n(d,m){return cc(r(d,m),m)}function s(d,m){return Ma(n(d,m),m)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(d){if(!d||!d["!ref"])return"";for(var m=[],p=[],x,g="",y=On(d["!ref"]),w=Array.isArray(d),E=y.s.r;E<=y.e.r;++E)for(var _=y.s.c;_<=y.e.c;++_)if(g=Ge({r:E,c:_}),x=w?(d[E]||[])[_]:d[g],!(!x||x.v==null||x.t==="z")){switch(p=["cell",g,"t"],x.t){case"s":case"str":p.push(e(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=e(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=e(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var N=Ar(zt(x.v));p[2]="vtc",p[3]="nd",p[4]=""+N,p[5]=x.w||ps(x.z||He[14],N);break;case"e":continue}m.push(p.join(":"))}return m.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function h(d){return[i,a,o,a,u(d),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:h}}(),ql=function(){function t(h,d,m,p,x){x.raw?d[m][p]=h:h===""||(h==="TRUE"?d[m][p]=!0:h==="FALSE"?d[m][p]=!1:isNaN(Ps(h))?isNaN(Kl(h).getDate())?d[m][p]=h:d[m][p]=zt(h):d[m][p]=Ps(h))}function e(h,d){var m=d||{},p=[];if(!h||h.length===0)return p;for(var x=h.split(/[\r\n]/),g=x.length-1;g>=0&&x[g].length===0;)--g;for(var y=10,w=0,E=0;E<=g;++E)w=x[E].indexOf(" "),w==-1?w=x[E].length:w++,y=Math.max(y,w);for(E=0;E<=g;++E){p[E]=[];var _=0;for(t(x[E].slice(0,y).trim(),p,E,_,m),_=1;_<=(x[E].length-y)/10+1;++_)t(x[E].slice(y+(_-1)*10,y+_*10).trim(),p,E,_,m)}return m.sheetRows&&(p=p.slice(0,m.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(h){for(var d={},m=!1,p=0,x=0;p<h.length;++p)(x=h.charCodeAt(p))==34?m=!m:!m&&x in r&&(d[x]=(d[x]||0)+1);x=[];for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&x.push([d[p],p]);if(!x.length){d=n;for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&x.push([d[p],p])}return x.sort(function(g,y){return g[0]-y[0]||n[g[1]]-n[y[1]]}),r[x.pop()[1]]||44}function i(h,d){var m=d||{},p="",x=m.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(p=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(p=h.charAt(4),h=h.slice(6)):p=s(h.slice(0,1024)):m&&m.FS?p=m.FS:p=s(h.slice(0,1024));var y=0,w=0,E=0,_=0,N=0,j=p.charCodeAt(0),D=!1,k=0,S=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var b=m.dateNF!=null?yL(m.dateNF):null;function C(){var A=h.slice(_,N),I={};if(A.charAt(0)=='"'&&A.charAt(A.length-1)=='"'&&(A=A.slice(1,-1).replace(/""/g,'"')),A.length===0)I.t="z";else if(m.raw)I.t="s",I.v=A;else if(A.trim().length===0)I.t="s",I.v=A;else if(A.charCodeAt(0)==61)A.charCodeAt(1)==34&&A.charCodeAt(A.length-1)==34?(I.t="s",I.v=A.slice(2,-1).replace(/""/g,'"')):KB(A)?(I.t="n",I.f=A.slice(1)):(I.t="s",I.v=A);else if(A=="TRUE")I.t="b",I.v=!0;else if(A=="FALSE")I.t="b",I.v=!1;else if(!isNaN(E=Ps(A)))I.t="n",m.cellText!==!1&&(I.w=A),I.v=E;else if(!isNaN(Kl(A).getDate())||b&&A.match(b)){I.z=m.dateNF||He[14];var P=0;b&&A.match(b)&&(A=wL(A,m.dateNF,A.match(b)||[]),P=1),m.cellDates?(I.t="d",I.v=zt(A,P)):(I.t="n",I.v=Ar(zt(A,P))),m.cellText!==!1&&(I.w=ps(I.z,I.v instanceof Date?Ar(I.v):I.v)),m.cellNF||delete I.z}else I.t="s",I.v=A;if(I.t=="z"||(m.dense?(x[y]||(x[y]=[]),x[y][w]=I):x[Ge({c:w,r:y})]=I),_=N+1,S=h.charCodeAt(_),g.e.c<w&&(g.e.c=w),g.e.r<y&&(g.e.r=y),k==j)++w;else if(w=0,++y,m.sheetRows&&m.sheetRows<=y)return!0}e:for(;N<h.length;++N)switch(k=h.charCodeAt(N)){case 34:S===34&&(D=!D);break;case j:case 10:case 13:if(!D&&C())break e;break}return N-_>0&&C(),x["!ref"]=tt(g),x}function a(h,d){return!(d&&d.PRN)||d.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?i(h,d):cc(e(h,d),d)}function o(h,d){var m="",p=d.type=="string"?[0,0,0,0]:lv(h,d);switch(d.type){case"base64":m=qn(h);break;case"binary":m=h;break;case"buffer":d.codepage==65001?m=h.toString("utf8"):d.codepage&&typeof ta<"u"?m=ta.utils.decode(d.codepage,h):m=nt&&Buffer.isBuffer(h)?h.toString("binary"):Oa(h);break;case"array":m=To(h);break;case"string":m=h;break;default:throw new Error("Unrecognized type "+d.type)}return p[0]==239&&p[1]==187&&p[2]==191?m=Dt(m.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?m=Dt(m):d.type=="binary"&&typeof ta<"u"&&d.codepage&&(m=ta.utils.decode(d.codepage,ta.utils.encode(28591,m))),m.slice(0,19)=="socialcalc:version:"?n3.to_sheet(d.type=="string"?m:Dt(m),d):a(m,d)}function l(h,d){return Ma(o(h,d),d)}function u(h){for(var d=[],m=gt(h["!ref"]),p,x=Array.isArray(h),g=m.s.r;g<=m.e.r;++g){for(var y=[],w=m.s.c;w<=m.e.c;++w){var E=Ge({r:g,c:w});if(p=x?(h[g]||[])[w]:h[E],!p||p.v==null){y.push("          ");continue}for(var _=(p.w||(Di(p),p.w)||"").slice(0,10);_.length<10;)_+=" ";y.push(_+(w===0?" ":""))}d.push(y.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}();function FO(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=t3.to_workbook(t,r);return r.WTF=n,s}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return ql.to_workbook(t,e)}}var lo=function(){function t(B,q,H){if(B){Hr(B,B.l||0);for(var G=H.Enum||fe;B.l<B.length;){var J=B.read_shift(2),ae=G[J]||G[65535],re=B.read_shift(2),he=B.l+re,oe=ae.f&&ae.f(B,re,H);if(B.l=he,q(oe,ae,J))return}}}function e(B,q){switch(q.type){case"base64":return r($n(qn(B)),q);case"binary":return r($n(B),q);case"buffer":case"array":return r(B,q)}throw"Unsupported type "+q.type}function r(B,q){if(!B)return B;var H=q||{},G=H.dense?[]:{},J="Sheet1",ae="",re=0,he={},oe=[],Pe=[],W={s:{r:0,c:0},e:{r:0,c:0}},$e=H.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)H.Enum=fe,t(B,function(Te,Ae,ye){switch(ye){case 0:H.vers=Te,Te>=4096&&(H.qpro=!0);break;case 6:W=Te;break;case 204:Te&&(ae=Te);break;case 222:ae=Te;break;case 15:case 51:H.qpro||(Te[1].v=Te[1].v.slice(1));case 13:case 14:case 16:ye==14&&(Te[2]&112)==112&&(Te[2]&15)>1&&(Te[2]&15)<15&&(Te[1].z=H.dateNF||He[14],H.cellDates&&(Te[1].t="d",Te[1].v=Od(Te[1].v))),H.qpro&&Te[3]>re&&(G["!ref"]=tt(W),he[J]=G,oe.push(J),G=H.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},re=Te[3],J=ae||"Sheet"+(re+1),ae="");var De=H.dense?(G[Te[0].r]||[])[Te[0].c]:G[Ge(Te[0])];if(De){De.t=Te[1].t,De.v=Te[1].v,Te[1].z!=null&&(De.z=Te[1].z),Te[1].f!=null&&(De.f=Te[1].f);break}H.dense?(G[Te[0].r]||(G[Te[0].r]=[]),G[Te[0].r][Te[0].c]=Te[1]):G[Ge(Te[0])]=Te[1];break}},H);else if(B[2]==26||B[2]==14)H.Enum=_e,B[2]==14&&(H.qpro=!0,B.l=0),t(B,function(Te,Ae,ye){switch(ye){case 204:J=Te;break;case 22:Te[1].v=Te[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Te[3]>re&&(G["!ref"]=tt(W),he[J]=G,oe.push(J),G=H.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},re=Te[3],J="Sheet"+(re+1)),$e>0&&Te[0].r>=$e)break;H.dense?(G[Te[0].r]||(G[Te[0].r]=[]),G[Te[0].r][Te[0].c]=Te[1]):G[Ge(Te[0])]=Te[1],W.e.c<Te[0].c&&(W.e.c=Te[0].c),W.e.r<Te[0].r&&(W.e.r=Te[0].r);break;case 27:Te[14e3]&&(Pe[Te[14e3][0]]=Te[14e3][1]);break;case 1537:Pe[Te[0]]=Te[1],Te[0]==re&&(J=Te[1]);break}},H);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(G["!ref"]=tt(W),he[ae||J]=G,oe.push(ae||J),!Pe.length)return{SheetNames:oe,Sheets:he};for(var Oe={},We=[],Ue=0;Ue<Pe.length;++Ue)he[oe[Ue]]?(We.push(Pe[Ue]||oe[Ue]),Oe[Pe[Ue]]=he[Pe[Ue]]||he[oe[Ue]]):(We.push(Pe[Ue]),Oe[Pe[Ue]]={"!ref":"A1"});return{SheetNames:We,Sheets:Oe}}function n(B,q){var H=q||{};if(+H.codepage>=0&&Cs(+H.codepage),H.type=="string")throw new Error("Cannot write WK1 to JS string");var G=jn(),J=gt(B["!ref"]),ae=Array.isArray(B),re=[];Ce(G,0,i(1030)),Ce(G,6,l(J));for(var he=Math.min(J.e.r,8191),oe=J.s.r;oe<=he;++oe)for(var Pe=fr(oe),W=J.s.c;W<=J.e.c;++W){oe===J.s.r&&(re[W]=Xt(W));var $e=re[W]+Pe,Oe=ae?(B[oe]||[])[W]:B[$e];if(!(!Oe||Oe.t=="z"))if(Oe.t=="n")(Oe.v|0)==Oe.v&&Oe.v>=-32768&&Oe.v<=32767?Ce(G,13,p(oe,W,Oe.v)):Ce(G,14,g(oe,W,Oe.v));else{var We=Di(Oe);Ce(G,15,d(oe,W,We.slice(0,239)))}}return Ce(G,1),G.end()}function s(B,q){var H=q||{};if(+H.codepage>=0&&Cs(+H.codepage),H.type=="string")throw new Error("Cannot write WK3 to JS string");var G=jn();Ce(G,0,a(B));for(var J=0,ae=0;J<B.SheetNames.length;++J)(B.Sheets[B.SheetNames[J]]||{})["!ref"]&&Ce(G,27,K(B.SheetNames[J],ae++));var re=0;for(J=0;J<B.SheetNames.length;++J){var he=B.Sheets[B.SheetNames[J]];if(!(!he||!he["!ref"])){for(var oe=gt(he["!ref"]),Pe=Array.isArray(he),W=[],$e=Math.min(oe.e.r,8191),Oe=oe.s.r;Oe<=$e;++Oe)for(var We=fr(Oe),Ue=oe.s.c;Ue<=oe.e.c;++Ue){Oe===oe.s.r&&(W[Ue]=Xt(Ue));var Te=W[Ue]+We,Ae=Pe?(he[Oe]||[])[Ue]:he[Te];if(!(!Ae||Ae.t=="z"))if(Ae.t=="n")Ce(G,23,C(Oe,Ue,re,Ae.v));else{var ye=Di(Ae);Ce(G,22,k(Oe,Ue,re,ye.slice(0,239)))}}++re}}return Ce(G,1),G.end()}function i(B){var q=le(2);return q.write_shift(2,B),q}function a(B){var q=le(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var H=0,G=0,J=0,ae=0;ae<B.SheetNames.length;++ae){var re=B.SheetNames[ae],he=B.Sheets[re];if(!(!he||!he["!ref"])){++J;var oe=On(he["!ref"]);H<oe.e.r&&(H=oe.e.r),G<oe.e.c&&(G=oe.e.c)}}return H>8191&&(H=8191),q.write_shift(2,H),q.write_shift(1,J),q.write_shift(1,G),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function o(B,q,H){var G={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&H.qpro?(G.s.c=B.read_shift(1),B.l++,G.s.r=B.read_shift(2),G.e.c=B.read_shift(1),B.l++,G.e.r=B.read_shift(2),G):(G.s.c=B.read_shift(2),G.s.r=B.read_shift(2),q==12&&H.qpro&&(B.l+=2),G.e.c=B.read_shift(2),G.e.r=B.read_shift(2),q==12&&H.qpro&&(B.l+=2),G.s.c==65535&&(G.s.c=G.e.c=G.s.r=G.e.r=0),G)}function l(B){var q=le(8);return q.write_shift(2,B.s.c),q.write_shift(2,B.s.r),q.write_shift(2,B.e.c),q.write_shift(2,B.e.r),q}function u(B,q,H){var G=[{c:0,r:0},{t:"n",v:0},0,0];return H.qpro&&H.vers!=20768?(G[0].c=B.read_shift(1),G[3]=B.read_shift(1),G[0].r=B.read_shift(2),B.l+=2):(G[2]=B.read_shift(1),G[0].c=B.read_shift(2),G[0].r=B.read_shift(2)),G}function h(B,q,H){var G=B.l+q,J=u(B,q,H);if(J[1].t="s",H.vers==20768){B.l++;var ae=B.read_shift(1);return J[1].v=B.read_shift(ae,"utf8"),J}return H.qpro&&B.l++,J[1].v=B.read_shift(G-B.l,"cstr"),J}function d(B,q,H){var G=le(7+H.length);G.write_shift(1,255),G.write_shift(2,q),G.write_shift(2,B),G.write_shift(1,39);for(var J=0;J<G.length;++J){var ae=H.charCodeAt(J);G.write_shift(1,ae>=128?95:ae)}return G.write_shift(1,0),G}function m(B,q,H){var G=u(B,q,H);return G[1].v=B.read_shift(2,"i"),G}function p(B,q,H){var G=le(7);return G.write_shift(1,255),G.write_shift(2,q),G.write_shift(2,B),G.write_shift(2,H,"i"),G}function x(B,q,H){var G=u(B,q,H);return G[1].v=B.read_shift(8,"f"),G}function g(B,q,H){var G=le(13);return G.write_shift(1,255),G.write_shift(2,q),G.write_shift(2,B),G.write_shift(8,H,"f"),G}function y(B,q,H){var G=B.l+q,J=u(B,q,H);if(J[1].v=B.read_shift(8,"f"),H.qpro)B.l=G;else{var ae=B.read_shift(2);N(B.slice(B.l,B.l+ae),J),B.l+=ae}return J}function w(B,q,H){var G=q&32768;return q&=-32769,q=(G?B:0)+(q>=8192?q-16384:q),(G?"":"$")+(H?Xt(q):fr(q))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(B,q){Hr(B,0);for(var H=[],G=0,J="",ae="",re="",he="";B.l<B.length;){var oe=B[B.l++];switch(oe){case 0:H.push(B.read_shift(8,"f"));break;case 1:ae=w(q[0].c,B.read_shift(2),!0),J=w(q[0].r,B.read_shift(2),!1),H.push(ae+J);break;case 2:{var Pe=w(q[0].c,B.read_shift(2),!0),W=w(q[0].r,B.read_shift(2),!1);ae=w(q[0].c,B.read_shift(2),!0),J=w(q[0].r,B.read_shift(2),!1),H.push(Pe+W+":"+ae+J)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:H.push("("+H.pop()+")");break;case 5:H.push(B.read_shift(2));break;case 6:{for(var $e="";oe=B[B.l++];)$e+=String.fromCharCode(oe);H.push('"'+$e.replace(/"/g,'""')+'"')}break;case 8:H.push("-"+H.pop());break;case 23:H.push("+"+H.pop());break;case 22:H.push("NOT("+H.pop()+")");break;case 20:case 21:he=H.pop(),re=H.pop(),H.push(["AND","OR"][oe-20]+"("+re+","+he+")");break;default:if(oe<32&&_[oe])he=H.pop(),re=H.pop(),H.push(re+_[oe]+he);else if(E[oe]){if(G=E[oe][1],G==69&&(G=B[B.l++]),G>H.length){console.error("WK1 bad formula parse 0x"+oe.toString(16)+":|"+H.join("|")+"|");return}var Oe=H.slice(-G);H.length-=G,H.push(E[oe][0]+"("+Oe.join(",")+")")}else return oe<=7?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=24?console.error("WK1 unsupported op "+oe.toString(16)):oe<=30?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=115?console.error("WK1 unsupported function opcode "+oe.toString(16)):console.error("WK1 unrecognized opcode "+oe.toString(16))}}H.length==1?q[1].f=""+H[0]:console.error("WK1 bad formula parse |"+H.join("|")+"|")}function j(B){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=B.read_shift(2),q[3]=B[B.l++],q[0].c=B[B.l++],q}function D(B,q){var H=j(B);return H[1].t="s",H[1].v=B.read_shift(q-4,"cstr"),H}function k(B,q,H,G){var J=le(6+G.length);J.write_shift(2,B),J.write_shift(1,H),J.write_shift(1,q),J.write_shift(1,39);for(var ae=0;ae<G.length;++ae){var re=G.charCodeAt(ae);J.write_shift(1,re>=128?95:re)}return J.write_shift(1,0),J}function S(B,q){var H=j(B);H[1].v=B.read_shift(2);var G=H[1].v>>1;if(H[1].v&1)switch(G&7){case 0:G=(G>>3)*5e3;break;case 1:G=(G>>3)*500;break;case 2:G=(G>>3)/20;break;case 3:G=(G>>3)/200;break;case 4:G=(G>>3)/2e3;break;case 5:G=(G>>3)/2e4;break;case 6:G=(G>>3)/16;break;case 7:G=(G>>3)/64;break}return H[1].v=G,H}function b(B,q){var H=j(B),G=B.read_shift(4),J=B.read_shift(4),ae=B.read_shift(2);if(ae==65535)return G===0&&J===3221225472?(H[1].t="e",H[1].v=15):G===0&&J===3489660928?(H[1].t="e",H[1].v=42):H[1].v=0,H;var re=ae&32768;return ae=(ae&32767)-16446,H[1].v=(1-re*2)*(J*Math.pow(2,ae+32)+G*Math.pow(2,ae)),H}function C(B,q,H,G){var J=le(14);if(J.write_shift(2,B),J.write_shift(1,H),J.write_shift(1,q),G==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var ae=0,re=0,he=0,oe=0;return G<0&&(ae=1,G=-G),re=Math.log2(G)|0,G/=Math.pow(2,re-31),oe=G>>>0,oe&2147483648||(G/=2,++re,oe=G>>>0),G-=oe,oe|=2147483648,oe>>>=0,G*=Math.pow(2,32),he=G>>>0,J.write_shift(4,he),J.write_shift(4,oe),re+=16383+(ae?32768:0),J.write_shift(2,re),J}function A(B,q){var H=b(B);return B.l+=q-14,H}function I(B,q){var H=j(B),G=B.read_shift(4);return H[1].v=G>>6,H}function P(B,q){var H=j(B),G=B.read_shift(8,"f");return H[1].v=G,H}function ue(B,q){var H=P(B);return B.l+=q-10,H}function de(B,q){return B[B.l+q-1]==0?B.read_shift(q,"cstr"):""}function ie(B,q){var H=B[B.l++];H>q-1&&(H=q-1);for(var G="";G.length<H;)G+=String.fromCharCode(B[B.l++]);return G}function ge(B,q,H){if(!(!H.qpro||q<21)){var G=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var J=B.read_shift(q-21,"cstr");return[G,J]}}function ne(B,q){for(var H={},G=B.l+q;B.l<G;){var J=B.read_shift(2);if(J==14e3){for(H[J]=[0,""],H[J][0]=B.read_shift(2);B[B.l];)H[J][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return H}function K(B,q){var H=le(5+B.length);H.write_shift(2,14e3),H.write_shift(2,q);for(var G=0;G<B.length;++G){var J=B.charCodeAt(G);H[H.l++]=J>127?95:J}return H[H.l++]=0,H}var fe={0:{n:"BOF",f:xr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:de},222:{n:"SHEETNAMELP",f:ie},65535:{n:""}},_e={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:b},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:A},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ne},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:I},38:{n:"??"},39:{n:"NUMBER27",f:P},40:{n:"FORMULA28",f:ue},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:de},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ge},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}();function LO(t){var e={},r=t.match(yn),n=0,s=!1;if(r)for(;n!=r.length;++n){var i=Ke(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=Sx[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return e}var DO=function(){var t=$0("t"),e=$0("rPr");function r(i){var a=i.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:pt(a[1])},l=i.match(e);return l&&(o.s=LO(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),jO=function(){var e=/(\r\n|\n)/g;function r(s,i,a){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),s.b&&(i.push("<b>"),a.push("</b>")),s.i&&(i.push("<i>"),a.push("</i>")),s.strike&&(i.push("<s>"),a.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(i.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),s}function n(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),OO=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,MO=/<(?:\w+:)?r>/,BO=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Xx(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=pt(Dt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Dt(t),r&&(n.h=Dx(n.t))):t.match(MO)&&(n.r=Dt(t),n.t=pt(Dt((t.replace(BO,"").match(OO)||[]).join("").replace(yn,""))),r&&(n.h=jO(DO(n.r)))),n):{t:""}}var VO=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,UO=/<(?:\w+:)?(?:si|sstItem)>/g,$O=/<\/(?:\w+:)?(?:si|sstItem)>/;function WO(t,e){var r=[],n="";if(!t)return r;var s=t.match(VO);if(s){n=s[2].replace(UO,"").split($O);for(var i=0;i!=n.length;++i){var a=Xx(n[i].trim(),e);a!=null&&(r[r.length]=a)}s=Ke(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var zO=/^\s|\s$|[\t\n\r]/;function s3(t,e){if(!e.bookSST)return"";var r=[dr];r[r.length]=be("sst",null,{xmlns:Oo[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var s=t[n],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(zO)&&(i+=' xml:space="preserve"'),i+=">"+Pt(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function HO(t){return[t.read_shift(4),t.read_shift(4)]}function GO(t,e){var r=[],n=!1;return Bi(t,function(i,a,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function KO(t,e){return e||(e=le(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var qO=sD;function XO(t){var e=jn();pe(e,159,KO(t));for(var r=0;r<t.length;++r)pe(e,19,qO(t[r]));return pe(e,160),e.end()}function i3(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function bi(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function QO(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=bi(t,4),e.U=bi(t,4),e.W=bi(t,4),e}function YO(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),i=[];s-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function JO(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(YO(t));return e}function ZO(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function eM(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=bi(t,4),e.U=bi(t,4),e.W=bi(t,4),e}function tM(t){var e=eM(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function a3(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function o3(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function rM(t){var e=bi(t);switch(e.Minor){case 2:return[e.Minor,nM(t)];case 3:return[e.Minor,sM()];case 4:return[e.Minor,iM(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function nM(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=a3(t,r),s=o3(t,t.length-t.l);return{t:"Std",h:n,v:s}}function sM(){throw new Error("File is password-protected: ECMA-376 Extensible")}function iM(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(yn,function(i){var a=Ke(i);switch(li(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function aM(t,e){var r={},n=r.EncryptionVersionInfo=bi(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=a3(t,s),e-=s,r.EncryptionVerifier=o3(t,e),r}function oM(t){var e={},r=e.EncryptionVersionInfo=bi(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function Qx(t){var e=0,r,n=i3(t),s=n.length+1,i,a,o,l,u;for(r=ba(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)a=r[i],o=e&16384?1:0,l=e<<1&32767,u=o|l,e=u^a;return e^52811}var l3=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},s=function(a,o){return n(a^o)},i=function(a){for(var o=e[a.length-1],l=104,u=a.length-1;u>=0;--u)for(var h=a[u],d=0;d!=7;++d)h&64&&(o^=r[l]),h*=2,--l;return o};return function(a){for(var o=i3(a),l=i(o),u=o.length,h=ba(16),d=0;d!=16;++d)h[d]=0;var m,p,x;for((u&1)===1&&(m=l>>8,h[u]=s(t[0],m),--u,m=l&255,p=o[o.length-1],h[u]=s(p,m));u>0;)--u,m=l>>8,h[u]=s(o[u],m),--u,m=l&255,h[u]=s(o[u],m);for(u=15,x=15-o.length;x>0;)m=l>>8,h[u]=s(t[x],m),--u,--x,m=l&255,h[u]=s(o[u],m),--u,--x;return h}}(),lM=function(t,e,r,n,s){s||(s=e),n||(n=l3(t));var i,a;for(i=0;i!=e.length;++i)a=e[i],a^=n[r],a=(a>>5|a<<3)&255,s[i]=a,++r;return[s,r,n]},cM=function(t){var e=0,r=l3(t);return function(n){var s=lM("",n,e,r);return e=s[1],s[0]}};function uM(t,e,r,n){var s={key:xr(t),verificationBytes:xr(t)};return r.password&&(s.verifier=Qx(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=cM(r.password)),s}function hM(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=oM(t):n.Data=aM(t,e),n}function fM(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?hM(t,e-2,n):uM(t,r.biff>=8?e:e-2,r,n),n}var c3=function(){function t(s,i){switch(i.type){case"base64":return e(qn(s),i);case"binary":return e(s,i);case"buffer":return e(nt&&Buffer.isBuffer(s)?s.toString("binary"):Oa(s),i);case"array":return e(To(s),i)}throw new Error("Unrecognized type "+i.type)}function e(s,i){var a=i||{},o=a.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(h,d){Array.isArray(o)&&(o[d]=[]);for(var m=/\\\w+\b/g,p=0,x,g=-1;x=m.exec(h);){switch(x[0]){case"\\cell":var y=h.slice(p,m.lastIndex-x[0].length);if(y[0]==" "&&(y=y.slice(1)),++g,y.length){var w={v:y,t:"s"};Array.isArray(o)?o[d][g]=w:o[Ge({r:d,c:g})]=w}break}p=m.lastIndex}g>u.e.c&&(u.e.c=g)}),o["!ref"]=tt(u),o}function r(s,i){return Ma(t(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],a=gt(s["!ref"]),o,l=Array.isArray(s),u=a.s.r;u<=a.e.r;++u){i.push("\\trowd\\trautofit1");for(var h=a.s.c;h<=a.e.c;++h)i.push("\\cellx"+(h+1));for(i.push("\\pard\\intbl"),h=a.s.c;h<=a.e.c;++h){var d=Ge({r:u,c:h});o=l?(s[u]||[])[h]:s[d],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Di(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function dM(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function G0(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function mM(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),i=Math.min(e,r,n),a=s-i;if(a===0)return[0,0,e];var o=0,l=0,u=s+i;switch(l=a/(u>1?2-u:u),s){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,u/2]}function pM(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),i=n-s/2,a=[i,i,i],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,a[0]+=s,a[1]+=l;break;case 1:l=s*(2-o),a[0]+=l,a[1]+=s;break;case 2:l=s*(o-2),a[1]+=s,a[2]+=l;break;case 3:l=s*(4-o),a[1]+=l,a[2]+=s;break;case 4:l=s*(o-4),a[2]+=s,a[0]+=l;break;case 5:l=s*(6-o),a[2]+=l,a[0]+=s;break}for(var u=0;u!=3;++u)a[u]=Math.round(a[u]*255);return a}function $f(t,e){if(e===0)return t;var r=mM(dM(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),G0(pM(r))}var u3=6,gM=15,xM=1,fn=u3;function K0(t){return Math.floor((t+Math.round(128/fn)/256)*fn)}function q0(t){return Math.floor((t-5)/fn*100+.5)/100}function Wf(t){return Math.round((t*fn+5)/fn*256)/256}function Um(t){return Wf(q0(K0(t)))}function Yx(t){var e=Math.abs(t-Um(t)),r=fn;if(e>.005)for(fn=xM;fn<gM;++fn)Math.abs(t-Um(t))<=e&&(e=Math.abs(t-Um(t)),r=fn);fn=r}function Ca(t){t.width?(t.wpx=K0(t.width),t.wch=q0(t.wpx),t.MDW=fn):t.wpx?(t.wch=q0(t.wpx),t.width=Wf(t.wch),t.MDW=fn):typeof t.wch=="number"&&(t.width=Wf(t.wch),t.wpx=K0(t.width),t.MDW=fn),t.customWidth&&delete t.customWidth}var vM=96,h3=vM;function X0(t){return t*96/h3}function Xl(t){return t*h3/96}var yM={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function wM(t,e,r,n){e.Borders=[];var s={},i=!1;(t[0].match(yn)||[]).forEach(function(a){var o=Ke(a);switch(li(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Ut(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Ut(o.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function _M(t,e,r,n){e.Fills=[];var s={},i=!1;(t[0].match(yn)||[]).forEach(function(a){var o=Ke(a);switch(li(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function EM(t,e,r,n){e.Fonts=[];var s={},i=!1;(t[0].match(yn)||[]).forEach(function(a){var o=Ke(a);switch(li(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=Dt(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Ut(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Ut(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Ut(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Ut(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Ut(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Ut(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Ut(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Sx[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Ut(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=ao[s.color.index];s.color.index==81&&(l=ao[1]),l||(l=ao[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=$f(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function kM(t,e,r){e.NumberFmt=[];for(var n=ar(He),s=0;s<n.length;++s)e.NumberFmt[n[s]]=He[n[s]];var i=t[0].match(yn);if(i)for(s=0;s<i.length;++s){var a=Ke(i[s]);switch(li(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=pt(Dt(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}Si(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function TM(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=be("numFmt",null,{numFmtId:n,formatCode:Pt(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=be("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var mh=["numFmtId","fillId","fontId","borderId","xfId"],ph=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function SM(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(yn)||[]).forEach(function(i){var a=Ke(i),o=0;switch(li(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<mh.length;++o)n[mh[o]]&&(n[mh[o]]=parseInt(n[mh[o]],10));for(o=0;o<ph.length;++o)n[ph[o]]&&(n[ph[o]]=Ut(n[ph[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=Ut(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function bM(t){var e=[];return e[e.length]=be("cellXfs",null),t.forEach(function(r){e[e.length]=be("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=be("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var CM=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,u){var h={};if(!o)return h;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(e))&&kM(d,h,u),(d=o.match(s))&&EM(d,h,l,u),(d=o.match(n))&&_M(d,h,l,u),(d=o.match(i))&&wM(d,h,l,u),(d=o.match(r))&&SM(d,h,u),h}}();function f3(t,e){var r=[dr,be("styleSheet",null,{xmlns:Oo[0],"xmlns:vt":br.vt})],n;return t.SSF&&(n=TM(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=bM(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function NM(t,e){var r=t.read_shift(2),n=mn(t);return[r,n]}function AM(t,e,r){r||(r=le(6+4*e.length)),r.write_shift(2,t),Dr(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function IM(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=hD(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=t.read_shift(2);switch(i===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=uD(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=mn(t),n}function RM(t,e){e||(e=le(25+4*32)),e.write_shift(2,t.sz*20),fD(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Bf(t.color,e);var n=0;return t.scheme=="major"&&(n=1),t.scheme=="minor"&&(n=2),e.write_shift(1,n),Dr(t.name,e),e.length>e.l?e.slice(0,e.l):e}var PM=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],$m,FM=xn;function v_(t,e){e||(e=le(4*3+8*7+16*1)),$m||($m=Dd(PM));var r=$m[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Bf({auto:1},e),Bf({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function LM(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}function d3(t,e,r){r||(r=le(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Ac(t,e){return e||(e=le(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var DM=xn;function jM(t,e){return e||(e=le(51)),e.write_shift(1,0),Ac(null,e),Ac(null,e),Ac(null,e),Ac(null,e),Ac(null,e),e.length>e.l?e.slice(0,e.l):e}function OM(t,e){return e||(e=le(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,+t.builtinId),e.write_shift(1,0),Mf(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function MM(t,e,r){var n=le(2052);return n.write_shift(4,t),Mf(e,n),Mf(r,n),n.length>n.l?n.slice(0,n.l):n}function BM(t,e,r){var n={};n.NumberFmt=[];for(var s in He)n.NumberFmt[s]=He[s];n.CellXf=[],n.Fonts=[];var i=[],a=!1;return Bi(t,function(l,u,h){switch(h){case 44:n.NumberFmt[l[0]]=l[1],Si(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=$f(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:i.push(h),a=!0;break;case 38:i.pop(),a=!1;break;default:if(u.T>0)i.push(h);else if(u.T<0)i.pop();else if(!a||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}function VM(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&++r}),r!=0&&(pe(t,615,Fs(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&pe(t,44,AM(s,e[s]))}),pe(t,616))}}function UM(t){var e=1;pe(t,611,Fs(e)),pe(t,43,RM({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),pe(t,612)}function $M(t){var e=2;pe(t,603,Fs(e)),pe(t,45,v_({patternType:"none"})),pe(t,45,v_({patternType:"gray125"})),pe(t,604)}function WM(t){var e=1;pe(t,613,Fs(e)),pe(t,46,jM()),pe(t,614)}function zM(t){var e=1;pe(t,626,Fs(e)),pe(t,47,d3({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),pe(t,627)}function HM(t,e){pe(t,617,Fs(e.length)),e.forEach(function(r){pe(t,47,d3(r,0))}),pe(t,618)}function GM(t){var e=1;pe(t,619,Fs(e)),pe(t,48,OM({xfId:0,builtinId:0,name:"Normal"})),pe(t,620)}function KM(t){var e=0;pe(t,505,Fs(e)),pe(t,506)}function qM(t){var e=0;pe(t,508,MM(e,"TableStyleMedium9","PivotStyleMedium4")),pe(t,509)}function XM(t,e){var r=jn();return pe(r,278),VM(r,t.SSF),UM(r),$M(r),WM(r),zM(r),HM(r,e.cellXfs),GM(r),KM(r),qM(r),pe(r,279),r.end()}var QM=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function YM(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(yn)||[]).forEach(function(s){var i=Ke(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[QM.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function JM(){}function ZM(){}var eB=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,tB=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,rB=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function nB(t,e,r){e.themeElements={};var n;[["clrScheme",eB,YM],["fontScheme",tB,JM],["fmtScheme",rB,ZM]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var sB=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function m3(t,e){(!t||t.length===0)&&(t=Jx());var r,n={};if(!(r=t.match(sB)))throw new Error("themeElements not found in theme");return nB(r[0],n,e),n.raw=t,n}function Jx(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[dr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function iB(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var i=t.slice(t.l);t.l=n;var a;try{a=ab(i,{type:"array"})}catch{return}var o=Wn(a,"theme/theme/theme1.xml",!0);if(o)return m3(o,r)}}function aB(t){return t.read_shift(4)}function oB(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=lB(t,4);break;case 2:e.xclrValue=Kb(t);break;case 3:e.xclrValue=aB(t);break;case 4:t.l+=4;break}return t.l+=8,e}function lB(t,e){return xn(t,e)}function cB(t,e){return xn(t,e)}function uB(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=oB(t);break;case 6:n[1]=cB(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function hB(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),i=[];s-- >0;)i.push(uB(t,r-t.l));return{ixfe:n,ext:i}}function fB(t,e){e.forEach(function(r){switch(r[0]){}})}function dB(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:mn(t)}}function mB(t){var e=le(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Dr(t.name,e),e.slice(0,e.l)}function pB(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function gB(t){var e=le(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function xB(t,e){var r=le(8+2*e.length);return r.write_shift(4,t),Dr(e,r),r.slice(0,r.l)}function vB(t){return t.l+=4,t.read_shift(4)!=0}function yB(t,e){var r=le(8);return r.write_shift(4,t),r.write_shift(4,e?1:0),r}function wB(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},i=[],a=!1,o=2;return Bi(t,function(l,u,h){switch(h){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:i.push(h),a=!0;break;case 36:i.pop(),a=!1;break;default:if(!u.T){if(!a||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function _B(){var t=jn();return pe(t,332),pe(t,334,Fs(1)),pe(t,335,mB({name:"XLDAPR",version:12e4,flags:3496657072})),pe(t,336),pe(t,339,xB(1,"XLDAPR")),pe(t,52),pe(t,35,Fs(514)),pe(t,4096,Fs(0)),pe(t,4097,ss(1)),pe(t,36),pe(t,53),pe(t,340),pe(t,337,yB(1,!0)),pe(t,51,gB([[1,0]])),pe(t,338),pe(t,333),t.end()}function EB(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,i=2,a;return t.replace(yn,function(o){var l=Ke(o);switch(li(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(a=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):i==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function p3(){var t=[dr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function kB(t){var e=[];if(!t)return e;var r=1;return(t.match(yn)||[]).forEach(function(n){var s=Ke(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function TB(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Ge(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function SB(t,e,r){var n=[];return Bi(t,function(i,a,o){switch(o){case 63:n.push(i);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function bB(t,e,r,n){if(!t)return t;var s=n||{},i=!1;Bi(t,function(o,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function CB(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var gl=1024;function g3(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[be("xml",null,{"xmlns:v":Vn.v,"xmlns:o":Vn.o,"xmlns:x":Vn.x,"xmlns:mv":Vn.mv}).replace(/\/>/,">"),be("o:shapelayout",be("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),be("v:shapetype",[be("v:stroke",null,{joinstyle:"miter"}),be("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];gl<t*1e3;)gl+=1e3;return e.forEach(function(i){var a=Qt(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?be("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=be("v:fill",l,o),h={on:"t",obscured:"t"};++gl,s=s.concat(["<v:shape"+W0({id:"_x0000_s"+gl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,be("v:shadow",null,h),be("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Kr("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Kr("x:AutoFill","False"),Kr("x:Row",String(a.r)),Kr("x:Column",String(a.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function y_(t,e,r,n){var s=Array.isArray(t),i;e.forEach(function(a){var o=Qt(a.ref);if(s?(t[o.r]||(t[o.r]=[]),i=t[o.r][o.c]):i=t[a.ref],!i){i={t:"z"},s?t[o.r][o.c]=i:t[a.ref]=i;var l=gt(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var u=tt(l);u!==t["!ref"]&&(t["!ref"]=u)}i.c||(i.c=[]);var h={a:a.author,t:a.t,r:a.r,T:r};a.h&&(h.h=a.h);for(var d=i.c.length-1;d>=0;--d){if(!r&&i.c[d].T)return;r&&!i.c[d].T&&i.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(h.a==n[d].id){h.a=n[d].name||h.a;break}}i.c.push(h)})}function NB(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Ke(o[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},h=Qt(l.ref);if(!(e.sheetRows&&e.sheetRows<=h.r)){var d=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!d&&!!d[1]&&Xx(d[1])||{r:"",t:"",h:""};u.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),u.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(u.h=m.h),n.push(u)}}}}),n}function x3(t){var e=[dr,be("comments",null,{xmlns:Oo[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(s){var i=Pt(s.a);r.indexOf(i)==-1&&(r.push(i),e.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),e.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var s=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(s=r.indexOf(Pt(l.a))),i.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),i.length<=1)e.push(Kr("t",Pt(i[0]||"")));else{for(var a=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)a+=`Reply:
    `+i[o]+`
`;e.push(Kr("t",Pt(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function AB(t,e){var r=[],n=!1,s={},i=0;return t.replace(yn,function(o,l){var u=Ke(o);switch(li(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=l+o.length;break;case"</text>":s.t=t.slice(i,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function IB(t,e,r){var n=[dr,be("ThreadedComments",null,{xmlns:br.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(s){var i="";(s[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=l.id:l.parentId=i,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(be("threadedComment",Kr("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function RB(t,e){var r=[],n=!1;return t.replace(yn,function(i){var a=Ke(i);switch(li(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return i}),r}function PB(t){var e=[dr,be("personList",null,{xmlns:br.TCMNT,"xmlns:x":Oo[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(be("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function FB(t){var e={};e.iauthor=t.read_shift(4);var r=Uo(t);return e.rfx=r.s,e.ref=Ge(r.s),t.l+=16,e}function LB(t,e){return e==null&&(e=le(36)),e.write_shift(4,t[1].iauthor),uc(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var DB=mn;function jB(t){return Dr(t.slice(0,54))}function OB(t,e){var r=[],n=[],s={},i=!1;return Bi(t,function(o,l,u){switch(u){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function MB(t){var e=jn(),r=[];return pe(e,628),pe(e,630),t.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),pe(e,632,jB(s.a)))})}),pe(e,631),pe(e,633),t.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:Qt(n[0]),e:Qt(n[0])};pe(e,635,LB([i,s])),s.t&&s.t.length>0&&pe(e,637,aD(s)),pe(e,636),delete s.iauthor})}),pe(e,634),pe(e,629),e.end()}var BB="application/vnd.ms-office.vbaProject";function VB(t){var e=Me.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Me.utils.cfb_add(e,s,t.FileIndex[n].content)}}),Me.write(e)}function UB(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Me.utils.cfb_add(t,s,e.FileIndex[n].content)}})}var v3=["xlsb","xlsm","xlam","biff8","xla"];function $B(){return{"!type":"dialog"}}function WB(){return{"!type":"dialog"}}function zB(){return{"!type":"macro"}}function HB(){return{"!type":"macro"}}var Al=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,i,a){var o=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,h=a.length>0?parseInt(a,10)|0:0;return o?h+=e.c:--h,l?u+=e.r:--u,s+(o?"":"$")+Xt(h)+(l?"":"$")+fr(u)}return function(s,i){return e=i,s.replace(t,r)}}(),Zx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ev=function(){return function(e,r){return e.replace(Zx,function(n,s,i,a,o,l){var u=Vx(a)-(i?0:r.c),h=Bx(l)-(o?0:r.r),d=h==0?"":o?h+1:"["+h+"]",m=u==0?"":i?u+1:"["+u+"]";return s+"R"+d+"C"+m})}}();function y3(t,e){return t.replace(Zx,function(r,n,s,i,a,o){return n+(s=="$"?s+i:Xt(Vx(i)+e.c))+(a=="$"?a+o:fr(Bx(o)+e.r))})}function GB(t,e,r){var n=On(e),s=n.s,i=Qt(r),a={r:i.r-s.r,c:i.c-s.c};return y3(t,a)}function KB(t){return t.length!=1}function w_(t){return t.replace(/_xlfn\./g,"")}function mr(t){t.l+=1}function Na(t,e){var r=t.read_shift(e==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function w3(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return _3(t);r.biff==12&&(n=4)}var s=t.read_shift(n),i=t.read_shift(n),a=Na(t,2),o=Na(t,2);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function _3(t){var e=Na(t,2),r=Na(t,2),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function qB(t,e,r){if(r.biff<8)return _3(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),i=Na(t,2),a=Na(t,2);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function E3(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return XB(t);var n=t.read_shift(r&&r.biff==12?4:2),s=Na(t,2);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function XB(t){var e=Na(t,2),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function QB(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function YB(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return JB(t);var s=t.read_shift(n>=12?4:2),i=t.read_shift(2),a=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;s>524287;)s-=1048576;if(a==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:a,rRel:o}}function JB(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function ZB(t,e,r){var n=(t[t.l++]&96)>>5,s=w3(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function eV(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var a=w3(t,i,r);return[n,s,a]}function tV(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function rV(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[n,s]}function nV(t,e,r){var n=(t[t.l++]&96)>>5,s=qB(t,e-1,r);return[n,s]}function sV(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function __(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function iV(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function aV(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function oV(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function lV(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function cV(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function k3(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function uV(t){return t.read_shift(2),k3(t)}function hV(t){return t.read_shift(2),k3(t)}function fV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=E3(t,0,r);return[n,s]}function dV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=YB(t,0,r);return[n,s]}function mV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=E3(t,0,r);return[n,s,i]}function pV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[vU[s],b3[s],n]}function gV(t,e,r){var n=t[t.l++],s=t.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:xV(t);return[s,(i[0]===0?b3:xU)[i[1]]]}function xV(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function vV(t,e,r){t.l+=r&&r.biff==2?3:4}function yV(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function wV(t){return t.l++,Vi[t.read_shift(1)]}function _V(t){return t.l++,t.read_shift(2)}function EV(t){return t.l++,t.read_shift(1)!==0}function kV(t){return t.l++,dn(t)}function TV(t,e,r){return t.l++,_u(t,e-1,r)}function SV(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=or(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Vi[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=dn(t);break;case 2:r[1]=$o(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function bV(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?Uo:Md)(t));return s}function CV(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,a=[];i!=n&&(a[i]=[]);++i)for(var o=0;o!=s;++o)a[i][o]=SV(t,r.biff);return a}function NV(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,i]}function AV(t,e,r){if(r.biff==5)return IV(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),i=t.read_shift(4);return[n,s,i]}function IV(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function RV(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function PV(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function FV(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function LV(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[n,s]}var DV=xn,jV=xn,OV=xn;function ku(t,e,r){return t.l+=2,[QB(t)]}function tv(t){return t.l+=6,[]}var MV=ku,BV=tv,VV=tv,UV=ku;function T3(t){return t.l+=2,[xr(t),t.read_shift(2)&1]}var $V=ku,WV=T3,zV=tv,HV=ku,GV=ku,KV=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function qV(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),i=t.read_shift(2),a=KV[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:s,C:i}}function XV(t){return t.l+=2,[t.read_shift(4)]}function QV(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function YV(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function JV(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function ZV(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function eU(t){return t.l+=4,[0,0]}var E_={1:{n:"PtgExp",f:yV},2:{n:"PtgTbl",f:OV},3:{n:"PtgAdd",f:mr},4:{n:"PtgSub",f:mr},5:{n:"PtgMul",f:mr},6:{n:"PtgDiv",f:mr},7:{n:"PtgPower",f:mr},8:{n:"PtgConcat",f:mr},9:{n:"PtgLt",f:mr},10:{n:"PtgLe",f:mr},11:{n:"PtgEq",f:mr},12:{n:"PtgGe",f:mr},13:{n:"PtgGt",f:mr},14:{n:"PtgNe",f:mr},15:{n:"PtgIsect",f:mr},16:{n:"PtgUnion",f:mr},17:{n:"PtgRange",f:mr},18:{n:"PtgUplus",f:mr},19:{n:"PtgUminus",f:mr},20:{n:"PtgPercent",f:mr},21:{n:"PtgParen",f:mr},22:{n:"PtgMissArg",f:mr},23:{n:"PtgStr",f:TV},26:{n:"PtgSheet",f:QV},27:{n:"PtgEndSheet",f:YV},28:{n:"PtgErr",f:wV},29:{n:"PtgBool",f:EV},30:{n:"PtgInt",f:_V},31:{n:"PtgNum",f:kV},32:{n:"PtgArray",f:sV},33:{n:"PtgFunc",f:pV},34:{n:"PtgFuncVar",f:gV},35:{n:"PtgName",f:NV},36:{n:"PtgRef",f:fV},37:{n:"PtgArea",f:ZB},38:{n:"PtgMemArea",f:RV},39:{n:"PtgMemErr",f:DV},40:{n:"PtgMemNoMem",f:jV},41:{n:"PtgMemFunc",f:PV},42:{n:"PtgRefErr",f:FV},43:{n:"PtgAreaErr",f:tV},44:{n:"PtgRefN",f:dV},45:{n:"PtgAreaN",f:nV},46:{n:"PtgMemAreaN",f:JV},47:{n:"PtgMemNoMemN",f:ZV},57:{n:"PtgNameX",f:AV},58:{n:"PtgRef3d",f:mV},59:{n:"PtgArea3d",f:eV},60:{n:"PtgRefErr3d",f:LV},61:{n:"PtgAreaErr3d",f:rV},255:{}},tU={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},rU={1:{n:"PtgElfLel",f:T3},2:{n:"PtgElfRw",f:HV},3:{n:"PtgElfCol",f:MV},6:{n:"PtgElfRwV",f:GV},7:{n:"PtgElfColV",f:UV},10:{n:"PtgElfRadical",f:$V},11:{n:"PtgElfRadicalS",f:zV},13:{n:"PtgElfColS",f:BV},15:{n:"PtgElfColSV",f:VV},16:{n:"PtgElfRadicalLel",f:WV},25:{n:"PtgList",f:qV},29:{n:"PtgSxName",f:XV},255:{}},nU={0:{n:"PtgAttrNoop",f:eU},1:{n:"PtgAttrSemi",f:cV},2:{n:"PtgAttrIf",f:oV},4:{n:"PtgAttrChoose",f:iV},8:{n:"PtgAttrGoto",f:aV},16:{n:"PtgAttrSum",f:vV},32:{n:"PtgAttrBaxcel",f:__},33:{n:"PtgAttrBaxcel",f:__},64:{n:"PtgAttrSpace",f:uV},65:{n:"PtgAttrSpaceSemi",f:hV},128:{n:"PtgAttrIfError",f:lV},255:{}};function Tu(t,e,r,n){if(n.biff<8)return xn(t,e);for(var s=t.l+e,i=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=CV(t,0,n),i.push(r[a][1]);break;case"PtgMemArea":r[a][2]=bV(t,r[a][1],n),i.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),i.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=s-t.l,e!==0&&i.push(xn(t,e)),i}function Su(t,e,r){for(var n=t.l+e,s,i,a=[];n!=t.l;)e=n-t.l,i=t[t.l],s=E_[i]||E_[tU[i]],(i===24||i===25)&&(s=(i===24?rU:nU)[t[t.l+1]]),!s||!s.f?xn(t,e):a.push([s.n,s.f(t,e,r)]);return a}function sU(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],i=0;i<n.length;++i){var a=n[i];if(a)switch(a[0]){case 2:s.push('"'+a[1].replace(/"/g,'""')+'"');break;default:s.push(a[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var iU={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function aU(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function S3(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function k_(t,e,r){var n=S3(t,e,r);return n=="#REF"?n:aU(n,r)}function cn(t,e,r,n,s){var i=s&&s.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,u,h,d=0,m=0,p,x="";if(!t[0]||!t[0][0])return"";for(var g=-1,y="",w=0,E=t[0].length;w<E;++w){var _=t[0][w];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),g>=0){switch(t[0][g][1][0]){case 0:y=nr(" ",t[0][g][1][1]);break;case 1:y=nr("\r",t[0][g][1][1]);break;default:if(y="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}u=u+y,g=-1}o.push(u+iU[_[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=i0(_[1][1],a,s),o.push(a0(h,i));break;case"PtgRefN":h=r?i0(_[1][1],r,s):_[1][1],o.push(a0(h,i));break;case"PtgRef3d":d=_[1][1],h=i0(_[1][2],a,s),x=k_(n,d,s),o.push(x+"!"+a0(h,i));break;case"PtgFunc":case"PtgFuncVar":var N=_[1][0],j=_[1][1];N||(N=0),N&=127;var D=N==0?[]:o.slice(-N);o.length-=N,j==="User"&&(j=D.shift()),o.push(j+"("+D.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":p=Jw(_[1][1],r?{s:r}:a,s),o.push(Mm(p,s));break;case"PtgArea":p=Jw(_[1][1],a,s),o.push(Mm(p,s));break;case"PtgArea3d":d=_[1][1],p=_[1][2],x=k_(n,d,s),o.push(x+"!"+Mm(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=_[1][2];var k=(n.names||[])[m-1]||(n[0]||[])[m],S=k?k.Name:"SH33TJSNAME"+String(m);S&&S.slice(0,6)=="_xlfn."&&!s.xlfn&&(S=S.slice(6)),o.push(S);break;case"PtgNameX":var b=_[1][1];m=_[1][2];var C;if(s.biff<=5)b<0&&(b=-b),n[b]&&(C=n[b][m]);else{var A="";if(((n[b]||[])[0]||[])[0]==14849||(((n[b]||[])[0]||[])[0]==1025?n[b][m]&&n[b][m].itab>0&&(A=n.SheetNames[n[b][m].itab-1]+"!"):A=n.SheetNames[m-1]+"!"),n[b]&&n[b][m])A+=n[b][m].Name;else if(n[0]&&n[0][m])A+=n[0][m].Name;else{var I=(S3(n,b,s)||"").split(";;");I[m-1]?A=I[m-1]:A+="SH33TJSERRX"}o.push(A);break}C||(C={Name:"SH33TJSERRY"}),o.push(C.Name);break;case"PtgParen":var P="(",ue=")";if(g>=0){switch(y="",t[0][g][1][0]){case 2:P=nr(" ",t[0][g][1][1])+P;break;case 3:P=nr("\r",t[0][g][1][1])+P;break;case 4:ue=nr(" ",t[0][g][1][1])+ue;break;case 5:ue=nr("\r",t[0][g][1][1])+ue;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}g=-1}o.push(P+o.pop()+ue);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:_[1][1],r:_[1][0]};var de={c:r.c,r:r.r};if(n.sharedf[Ge(h)]){var ie=n.sharedf[Ge(h)];o.push(cn(ie,a,de,n,s))}else{var ge=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(h.c<u[0].s.c||h.c>u[0].e.c)&&!(h.r<u[0].s.r||h.r>u[0].e.r)){o.push(cn(u[1],a,de,n,s)),ge=!0;break}ge||o.push(_[1])}break;case"PtgArray":o.push("{"+sU(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var ne=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&g>=0&&ne.indexOf(t[0][w][0])==-1){_=t[0][g];var K=!0;switch(_[1][0]){case 4:K=!1;case 0:y=nr(" ",_[1][1]);break;case 5:K=!1;case 1:y=nr("\r",_[1][1]);break;default:if(y="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((K?y:"")+o.pop()+(K?"":y)),g=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function oU(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],xn(t,e-2)];var o=Su(t,a,r);return e!==a+s&&(i=Tu(t,e-a-s,o,r)),t.l=n,[o,i]}function lU(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],xn(t,e-2)];var o=Su(t,a,r);return e!==a+s&&(i=Tu(t,e-a-s,o,r)),t.l=n,[o,i]}function cU(t,e,r,n){var s=t.l+e,i=Su(t,n,r),a;return s!==t.l&&(a=Tu(t,s-t.l,i,r)),[i,a]}function uU(t,e,r){var n=t.l+e,s,i=t.read_shift(2),a=Su(t,i,r);return i==65535?[[],xn(t,e-2)]:(e!==i+2&&(s=Tu(t,n-i-2,a,r)),[a,s])}function hU(t){var e;if(_i(t,t.l+6)!==65535)return[dn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function fU(t){if(t==null){var e=le(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return So(t);return So(0)}function Wm(t,e,r){var n=t.l+e,s=ci(t);r.biff==2&&++t.l;var i=hU(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=lU(t,n-t.l,r);return{cell:s,val:i[0],formula:o,shared:a>>3&1,tt:i[1]}}function dU(t,e,r,n,s){var i=Co(e,r,s),a=fU(t.v),o=le(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=le(t.bf.length),h=0;h<t.bf.length;++h)u[h]=t.bf[h];var d=Lr([i,a,o,u]);return d}function Bd(t,e,r){var n=t.read_shift(4),s=Su(t,n,r),i=t.read_shift(4),a=i>0?Tu(t,i,s,r):null;return[s,a]}var mU=Bd,Vd=Bd,pU=Bd,gU=Bd,xU={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},b3={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},vU={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function T_(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function yU(t){var e="of:="+t.replace(Zx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function zm(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function wU(t){return t.replace(/\./,"!")}var l0={},Il={},c0=typeof Map<"u";function rv(t,e,r){var n=0,s=t.length;if(r){if(c0?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var i=c0?r.get(e):r[e];n<i.length;++n)if(t[i[n]].t===e)return t.Count++,i[n]}}else for(;n<s;++n)if(t[n].t===e)return t.Count++,n;return t[s]={t:e},t.Count++,t.Unique++,r&&(c0?(r.has(e)||r.set(e,[]),r.get(e).push(s)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(s))),s}function Ud(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(fn=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=q0(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Wf(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function co(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Ba(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],s=60,i=t.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){Si(e.z,s),r.ssf[s]=e.z,r.revssf[e.z]=n=s;break}}for(s=0;s!=i;++s)if(t[s].numFmtId===n)return s;return t[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function C3(t,e,r,n,s,i){try{n.cellNF&&(t.z=He[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=zt(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(He[e]==null&&Si(vL[e]||"General",e),t.t==="e")t.w=t.w||Vi[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=U0(t.v);else if(t.t==="d"){var a=Ar(t.v);(a|0)===a?t.w=a.toString(10):t.w=U0(a)}else{if(t.v===void 0)return"";t.w=ko(t.v,Il)}else t.t==="d"?t.w=ps(e,Ar(t.v),Il):t.w=ps(e,t.v,Il)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=$f(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=$f(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function _U(t,e,r){if(t&&t["!ref"]){var n=gt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function EU(t,e){var r=gt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=tt(r))}var kU=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,TU=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,SU=/<(?:\w:)?hyperlink [^>]*>/mg,bU=/"(\w*:\w*)"/,CU=/<(?:\w:)?col\b[^>]*[\/]?>/g,NU=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,AU=/<(?:\w:)?pageMargins[^>]*\/>/g,N3=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,IU=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,RU=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function PU(t,e,r,n,s,i,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",h="",d=t.match(TU);d?(u=t.slice(0,d.index),h=t.slice(d.index+d[0].length)):u=h=t;var m=u.match(N3);m?nv(m[0],o,s,r):(m=u.match(IU))&&LU(m[0],m[1]||"",o,s,r);var p=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=u.slice(p,p+50).match(bU);x&&EU(o,x[1])}var g=u.match(RU);g&&g[1]&&KU(g[1],s);var y=[];if(e.cellStyles){var w=u.match(CU);w&&$U(y,w)}d&&QU(d[1],o,e,l,i,a);var E=h.match(NU);E&&(o["!autofilter"]=zU(E[0]));var _=[],N=h.match(kU);if(N)for(p=0;p!=N.length;++p)_[p]=gt(N[p].slice(N[p].indexOf('"')+1));var j=h.match(SU);j&&BU(o,j,n);var D=h.match(AU);if(D&&(o["!margins"]=VU(Ke(D[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=tt(l)),e.sheetRows>0&&o["!ref"]){var k=gt(o["!ref"]);e.sheetRows<=+k.e.r&&(k.e.r=e.sheetRows-1,k.e.r>l.e.r&&(k.e.r=l.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>l.e.c&&(k.e.c=l.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),o["!fullref"]=o["!ref"],o["!ref"]=tt(k))}return y.length>0&&(o["!cols"]=y),_.length>0&&(o["!merges"]=_),o}function FU(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+tt(t[r])+'"/>';return e+"</mergeCells>"}function nv(t,e,r,n){var s=Ke(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=pt(Dt(s.codeName)))}function LU(t,e,r,n,s){nv(t.slice(0,t.indexOf(">")),r,n,s)}function DU(t,e,r,n,s){var i=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}i=!0,a.codeName=Ks(Pt(l))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),o=(o||"")+be("outlinePr",null,u)}!i&&!o||(s[s.length]=be("sheetPr",o,a))}var jU=["objects","scenarios","selectLockedCells","selectUnlockedCells"],OU=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function MU(t){var e={sheet:1};return jU.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),OU.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=Qx(t.password).toString(16).toUpperCase()),be("sheetProtection",null,e)}function BU(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var i=Ke(Dt(e[s]),!0);if(!i.ref)return;var a=((r||{})["!id"]||[])[i.id];a?(i.Target=a.Target,i.location&&(i.Target+="#"+pt(i.location))):(i.Target="#"+pt(i.location),a={Target:i.Target,TargetMode:"Internal"}),i.Rel=a,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=gt(i.ref),l=o.s.r;l<=o.e.r;++l)for(var u=o.s.c;u<=o.e.c;++u){var h=Ge({c:u,r:l});n?(t[l]||(t[l]=[]),t[l][u]||(t[l][u]={t:"z",v:void 0}),t[l][u].l=i):(t[h]||(t[h]={t:"z",v:void 0}),t[h].l=i)}}}function VU(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function UU(t){return co(t),be("pageMargins",null,t)}function $U(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=Ke(e[n],!0);s.hidden&&(s.hidden=Ut(s.hidden));var i=parseInt(s.min,10)-1,a=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,Yx(s.width)),Ca(s);i<=a;)t[i++]=Ht(s)}}function WU(t,e){for(var r=["<cols>"],n,s=0;s!=e.length;++s)(n=e[s])&&(r[r.length]=be("col",null,Ud(s,n)));return r[r.length]="</cols>",r.join("")}function zU(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function HU(t,e,r,n){var s=typeof t.ref=="string"?t.ref:tt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,a=On(s);a.s.r==a.e.r&&(a.e.r=On(e["!ref"]).e.r,s=tt(a));for(var o=0;o<i.length;++o){var l=i[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),be("autoFilter",null,{ref:s})}var GU=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function KU(t,e){e.Views||(e.Views=[{}]),(t.match(GU)||[]).forEach(function(r,n){var s=Ke(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),Ut(s.rightToLeft)&&(e.Views[n].RTL=!0)})}function qU(t,e,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),be("sheetViews",be("sheetView",null,s),{})}function XU(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var s="",i=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":s=t.v?"1":"0";break;case"n":s=""+t.v;break;case"e":s=Vi[t.v];break;case"d":n&&n.cellDates?s=zt(t.v,-1).toISOString():(t=Ht(t),t.t="n",s=""+(t.v=Ar(zt(t.v)))),typeof t.z>"u"&&(t.z=He[14]);break;default:s=t.v;break}var o=Kr("v",Pt(s)),l={r:e},u=Ba(n.cellXfs,t,n);switch(u!==0&&(l.s=u),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Kr("v",""+rv(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=i&&(t.t=i,t.v=a),typeof t.f=="string"&&t.f){var h=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=be("f",Pt(t.f),h)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),be("c",o,l)}var QU=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=$0("v"),a=$0("f");return function(l,u,h,d,m,p){for(var x=0,g="",y=[],w=[],E=0,_=0,N=0,j="",D,k,S=0,b=0,C,A,I=0,P=0,ue=Array.isArray(p.CellXf),de,ie=[],ge=[],ne=Array.isArray(u),K=[],fe={},_e=!1,B=!!h.sheetStubs,q=l.split(e),H=0,G=q.length;H!=G;++H){g=q[H].trim();var J=g.length;if(J!==0){var ae=0;e:for(x=0;x<J;++x)switch(g[x]){case">":if(g[x-1]!="/"){++x;break e}if(h&&h.cellStyles){if(k=Ke(g.slice(ae,x),!0),S=k.r!=null?parseInt(k.r,10):S+1,b=-1,h.sheetRows&&h.sheetRows<S)continue;fe={},_e=!1,k.ht&&(_e=!0,fe.hpt=parseFloat(k.ht),fe.hpx=Xl(fe.hpt)),k.hidden=="1"&&(_e=!0,fe.hidden=!0),k.outlineLevel!=null&&(_e=!0,fe.level=+k.outlineLevel),_e&&(K[S-1]=fe)}break;case"<":ae=x;break}if(ae>=x)break;if(k=Ke(g.slice(ae,x),!0),S=k.r!=null?parseInt(k.r,10):S+1,b=-1,!(h.sheetRows&&h.sheetRows<S)){d.s.r>S-1&&(d.s.r=S-1),d.e.r<S-1&&(d.e.r=S-1),h&&h.cellStyles&&(fe={},_e=!1,k.ht&&(_e=!0,fe.hpt=parseFloat(k.ht),fe.hpx=Xl(fe.hpt)),k.hidden=="1"&&(_e=!0,fe.hidden=!0),k.outlineLevel!=null&&(_e=!0,fe.level=+k.outlineLevel),_e&&(K[S-1]=fe)),y=g.slice(x).split(t);for(var re=0;re!=y.length&&y[re].trim().charAt(0)=="<";++re);for(y=y.slice(re),x=0;x!=y.length;++x)if(g=y[x].trim(),g.length!==0){if(w=g.match(r),E=x,_=0,N=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,w!=null&&w.length===2){for(E=0,j=w[1],_=0;_!=j.length&&!((N=j.charCodeAt(_)-64)<1||N>26);++_)E=26*E+N;--E,b=E}else++b;for(_=0;_!=g.length&&g.charCodeAt(_)!==62;++_);if(++_,k=Ke(g.slice(0,_),!0),k.r||(k.r=Ge({r:S-1,c:b})),j=g.slice(_),D={t:""},(w=j.match(i))!=null&&w[1]!==""&&(D.v=pt(w[1])),h.cellFormula){if((w=j.match(a))!=null&&w[1]!==""){if(D.f=pt(Dt(w[1])).replace(/\r\n/g,`
`),h.xlfn||(D.f=w_(D.f)),w[0].indexOf('t="array"')>-1)D.F=(j.match(s)||[])[1],D.F.indexOf(":")>-1&&ie.push([gt(D.F),D.F]);else if(w[0].indexOf('t="shared"')>-1){A=Ke(w[0]);var he=pt(Dt(w[1]));h.xlfn||(he=w_(he)),ge[parseInt(A.si,10)]=[A,he,k.r]}}else(w=j.match(/<f[^>]*\/>/))&&(A=Ke(w[0]),ge[A.si]&&(D.f=GB(ge[A.si][1],ge[A.si][2],k.r)));var oe=Qt(k.r);for(_=0;_<ie.length;++_)oe.r>=ie[_][0].s.r&&oe.r<=ie[_][0].e.r&&oe.c>=ie[_][0].s.c&&oe.c<=ie[_][0].e.c&&(D.F=ie[_][1])}if(k.t==null&&D.v===void 0)if(D.f||D.F)D.v=0,D.t="n";else if(B)D.t="z";else continue;else D.t=k.t||"n";switch(d.s.c>b&&(d.s.c=b),d.e.c<b&&(d.e.c=b),D.t){case"n":if(D.v==""||D.v==null){if(!B)continue;D.t="z"}else D.v=parseFloat(D.v);break;case"s":if(typeof D.v>"u"){if(!B)continue;D.t="z"}else C=l0[parseInt(D.v,10)],D.v=C.t,D.r=C.r,h.cellHTML&&(D.h=C.h);break;case"str":D.t="s",D.v=D.v!=null?Dt(D.v):"",h.cellHTML&&(D.h=Dx(D.v));break;case"inlineStr":w=j.match(n),D.t="s",w!=null&&(C=Xx(w[1]))?(D.v=C.t,h.cellHTML&&(D.h=C.h)):D.v="";break;case"b":D.v=Ut(D.v);break;case"d":h.cellDates?D.v=zt(D.v,1):(D.v=Ar(zt(D.v,1)),D.t="n");break;case"e":(!h||h.cellText!==!1)&&(D.w=D.v),D.v=Ib[D.v];break}if(I=P=0,de=null,ue&&k.s!==void 0&&(de=p.CellXf[k.s],de!=null&&(de.numFmtId!=null&&(I=de.numFmtId),h.cellStyles&&de.fillId!=null&&(P=de.fillId))),C3(D,I,P,h,m,p),h.cellDates&&ue&&D.t=="n"&&oc(He[I])&&(D.t="d",D.v=Od(D.v)),k.cm&&h.xlmeta){var Pe=(h.xlmeta.Cell||[])[+k.cm-1];Pe&&Pe.type=="XLDAPR"&&(D.D=!0)}if(ne){var W=Qt(k.r);u[W.r]||(u[W.r]=[]),u[W.r][W.c]=D}else u[k.r]=D}}}}K.length>0&&(u["!rows"]=K)}}();function YU(t,e,r,n){var s=[],i=[],a=gt(t["!ref"]),o="",l,u="",h=[],d=0,m=0,p=t["!rows"],x=Array.isArray(t),g={r:u},y,w=-1;for(m=a.s.c;m<=a.e.c;++m)h[m]=Xt(m);for(d=a.s.r;d<=a.e.r;++d){for(i=[],u=fr(d),m=a.s.c;m<=a.e.c;++m){l=h[m]+u;var E=x?(t[d]||[])[m]:t[l];E!==void 0&&(o=XU(E,l,t,e))!=null&&i.push(o)}(i.length>0||p&&p[d])&&(g={r:u},p&&p[d]&&(y=p[d],y.hidden&&(g.hidden=1),w=-1,y.hpx?w=X0(y.hpx):y.hpt&&(w=y.hpt),w>-1&&(g.ht=w,g.customHeight=1),y.level&&(g.outlineLevel=y.level)),s[s.length]=be("row",i.join(""),g))}if(p)for(;d<p.length;++d)p&&p[d]&&(g={r:d+1},y=p[d],y.hidden&&(g.hidden=1),w=-1,y.hpx?w=X0(y.hpx):y.hpt&&(w=y.hpt),w>-1&&(g.ht=w,g.customHeight=1),y.level&&(g.outlineLevel=y.level),s[s.length]=be("row","",g));return s.join("")}function A3(t,e,r,n){var s=[dr,be("worksheet",null,{xmlns:Oo[0],"xmlns:r":br.r})],i=r.SheetNames[t],a=0,o="",l=r.Sheets[i];l==null&&(l={});var u=l["!ref"]||"A1",h=gt(u);if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),u=tt(h)}n||(n={}),l["!comments"]=[];var d=[];DU(l,r,t,e,s),s[s.length]=be("dimension",null,{ref:u}),s[s.length]=qU(l,e,t,r),e.sheetFormat&&(s[s.length]=be("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(s[s.length]=WU(l,l["!cols"])),s[a=s.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=YU(l,e),o.length>0&&(s[s.length]=o)),s.length>a+1&&(s[s.length]="</sheetData>",s[a]=s[a].replace("/>",">")),l["!protect"]&&(s[s.length]=MU(l["!protect"])),l["!autofilter"]!=null&&(s[s.length]=HU(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(s[s.length]=FU(l["!merges"]));var m=-1,p,x=-1;return l["!links"].length>0&&(s[s.length]="<hyperlinks>",l["!links"].forEach(function(g){g[1].Target&&(p={ref:g[0]},g[1].Target.charAt(0)!="#"&&(x=It(n,-1,Pt(g[1].Target).replace(/#.*$/,""),it.HLINK),p["r:id"]="rId"+x),(m=g[1].Target.indexOf("#"))>-1&&(p.location=Pt(g[1].Target.slice(m+1))),g[1].Tooltip&&(p.tooltip=Pt(g[1].Tooltip)),s[s.length]=be("hyperlink",null,p))}),s[s.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(s[s.length]=UU(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(s[s.length]=Kr("ignoredErrors",be("ignoredError",null,{numberStoredAsText:1,sqref:u}))),d.length>0&&(x=It(n,-1,"../drawings/drawing"+(t+1)+".xml",it.DRAW),s[s.length]=be("drawing",null,{"r:id":"rId"+x}),l["!drawing"]=d),l["!comments"].length>0&&(x=It(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",it.VML),s[s.length]=be("legacyDrawing",null,{"r:id":"rId"+x}),l["!legacy"]=x),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function JU(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function ZU(t,e,r){var n=le(145),s=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var i=320;s.hpx?i=X0(s.hpx)*20:s.hpt&&(i=s.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var a=0;s.level&&(a|=s.level),s.hidden&&(a|=16),(s.hpx||s.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:t,c:0},h=0;h<16;++h)if(!(e.s.c>h+1<<10||e.e.c<h<<10)){for(var d=-1,m=-1,p=h<<10;p<h+1<<10;++p){u.c=p;var x=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Ge(u)];x&&(d<0&&(d=p),m=p)}d<0||(++o,n.write_shift(4,d),n.write_shift(4,m))}var g=n.l;return n.l=l,n.write_shift(4,o),n.l=g,n.length>n.l?n.slice(0,n.l):n}function e$(t,e,r,n){var s=ZU(n,r,e);(s.length>17||(e["!rows"]||[])[n])&&pe(t,0,s)}var t$=Uo,r$=uc;function n$(){}function s$(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=oD(t),r}function i$(t,e,r){r==null&&(r=le(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return Bf({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Sb(t,r),r.slice(0,r.l)}function a$(t){var e=gs(t);return[e]}function o$(t,e,r){return r==null&&(r=le(8)),Mo(e,r)}function l$(t){var e=Bo(t);return[e]}function c$(t,e,r){return r==null&&(r=le(4)),Vo(e,r)}function u$(t){var e=gs(t),r=t.read_shift(1);return[e,r,"b"]}function h$(t,e,r){return r==null&&(r=le(9)),Mo(e,r),r.write_shift(1,t.v?1:0),r}function f$(t){var e=Bo(t),r=t.read_shift(1);return[e,r,"b"]}function d$(t,e,r){return r==null&&(r=le(5)),Vo(e,r),r.write_shift(1,t.v?1:0),r}function m$(t){var e=gs(t),r=t.read_shift(1);return[e,r,"e"]}function p$(t,e,r){return r==null&&(r=le(9)),Mo(e,r),r.write_shift(1,t.v),r}function g$(t){var e=Bo(t),r=t.read_shift(1);return[e,r,"e"]}function x$(t,e,r){return r==null&&(r=le(8)),Vo(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function v$(t){var e=gs(t),r=t.read_shift(4);return[e,r,"s"]}function y$(t,e,r){return r==null&&(r=le(12)),Mo(e,r),r.write_shift(4,e.v),r}function w$(t){var e=Bo(t),r=t.read_shift(4);return[e,r,"s"]}function _$(t,e,r){return r==null&&(r=le(8)),Vo(e,r),r.write_shift(4,e.v),r}function E$(t){var e=gs(t),r=dn(t);return[e,r,"n"]}function k$(t,e,r){return r==null&&(r=le(16)),Mo(e,r),So(t.v,r),r}function I3(t){var e=Bo(t),r=dn(t);return[e,r,"n"]}function T$(t,e,r){return r==null&&(r=le(12)),Vo(e,r),So(t.v,r),r}function S$(t){var e=gs(t),r=zx(t);return[e,r,"n"]}function b$(t,e,r){return r==null&&(r=le(12)),Mo(e,r),bb(t.v,r),r}function C$(t){var e=Bo(t),r=zx(t);return[e,r,"n"]}function N$(t,e,r){return r==null&&(r=le(8)),Vo(e,r),bb(t.v,r),r}function A$(t){var e=gs(t),r=Ux(t);return[e,r,"is"]}function I$(t){var e=gs(t),r=mn(t);return[e,r,"str"]}function R$(t,e,r){return r==null&&(r=le(12+4*t.v.length)),Mo(e,r),Dr(t.v,r),r.length>r.l?r.slice(0,r.l):r}function P$(t){var e=Bo(t),r=mn(t);return[e,r,"str"]}function F$(t,e,r){return r==null&&(r=le(8+4*t.v.length)),Vo(e,r),Dr(t.v,r),r.length>r.l?r.slice(0,r.l):r}function L$(t,e,r){var n=t.l+e,s=gs(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"b"];if(r.cellFormula){t.l+=2;var o=Vd(t,n-t.l,r);a[3]=cn(o,null,s,r.supbooks,r)}else t.l=n;return a}function D$(t,e,r){var n=t.l+e,s=gs(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"e"];if(r.cellFormula){t.l+=2;var o=Vd(t,n-t.l,r);a[3]=cn(o,null,s,r.supbooks,r)}else t.l=n;return a}function j$(t,e,r){var n=t.l+e,s=gs(t);s.r=r["!row"];var i=dn(t),a=[s,i,"n"];if(r.cellFormula){t.l+=2;var o=Vd(t,n-t.l,r);a[3]=cn(o,null,s,r.supbooks,r)}else t.l=n;return a}function O$(t,e,r){var n=t.l+e,s=gs(t);s.r=r["!row"];var i=mn(t),a=[s,i,"str"];if(r.cellFormula){t.l+=2;var o=Vd(t,n-t.l,r);a[3]=cn(o,null,s,r.supbooks,r)}else t.l=n;return a}var M$=Uo,B$=uc;function V$(t,e){return e==null&&(e=le(4)),e.write_shift(4,t),e}function U$(t,e){var r=t.l+e,n=Uo(t),s=$x(t),i=mn(t),a=mn(t),o=mn(t);t.l=r;var l={rfx:n,relId:s,loc:i,display:o};return a&&(l.Tooltip=a),l}function $$(t,e){var r=le(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));uc({s:Qt(t[0]),e:Qt(t[0])},r),Wx("rId"+e,r);var n=t[1].Target.indexOf("#"),s=n==-1?"":t[1].Target.slice(n+1);return Dr(s||"",r),Dr(t[1].Tooltip||"",r),Dr("",r),r.slice(0,r.l)}function W$(){}function z$(t,e,r){var n=t.l+e,s=Cb(t),i=t.read_shift(1),a=[s];if(a[2]=i,r.cellFormula){var o=mU(t,n-t.l,r);a[1]=o}else t.l=n;return a}function H$(t,e,r){var n=t.l+e,s=Uo(t),i=[s];if(r.cellFormula){var a=gU(t,n-t.l,r);i[1]=a,t.l=n}else t.l=n;return i}function G$(t,e,r){r==null&&(r=le(18));var n=Ud(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return e.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),e.level&&(s|=e.level<<8),r.write_shift(2,s),r}var R3=["left","right","top","bottom","header","footer"];function K$(t){var e={};return R3.forEach(function(r){e[r]=dn(t)}),e}function q$(t,e){return e==null&&(e=le(6*8)),co(t),R3.forEach(function(r){So(t[r],e)}),e}function X$(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function Q$(t,e,r){r==null&&(r=le(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Y$(t){var e=le(24);return e.write_shift(4,4),e.write_shift(4,1),uc(t,e),e}function J$(t,e){return e==null&&(e=le(16*4+2)),e.write_shift(2,t.password?Qx(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function Z$(){}function eW(){}function tW(t,e,r,n,s,i,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},u,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,m=!1,p,x,g,y,w,E,_,N,j,D=[];o.biff=12,o["!row"]=0;var k=0,S=!1,b=[],C={},A=o.supbooks||s.supbooks||[[]];if(A.sharedf=C,A.arrayf=b,A.SheetNames=s.SheetNames||s.Sheets.map(function(ne){return ne.name}),!o.supbooks&&(o.supbooks=A,s.Names))for(var I=0;I<s.Names.length;++I)A[0][I+1]=s.Names[I];var P=[],ue=[],de=!1;Q0[16]={n:"BrtShortReal",f:I3};var ie;if(Bi(t,function(K,fe,_e){if(!m)switch(_e){case 148:u=K;break;case 0:p=K,o.sheetRows&&o.sheetRows<=p.r&&(m=!0),N=fr(y=p.r),o["!row"]=p.r,(K.hidden||K.hpt||K.level!=null)&&(K.hpt&&(K.hpx=Xl(K.hpt)),ue[K.r]=K);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:K[2]},K[2]){case"n":x.v=K[1];break;case"s":_=l0[K[1]],x.v=_.t,x.r=_.r;break;case"b":x.v=!!K[1];break;case"e":x.v=K[1],o.cellText!==!1&&(x.w=Vi[x.v]);break;case"str":x.t="s",x.v=K[1];break;case"is":x.t="s",x.v=K[1].t;break}if((g=a.CellXf[K[0].iStyleRef])&&C3(x,g.numFmtId,null,o,i,a),w=K[0].c==-1?w+1:K[0].c,o.dense?(l[y]||(l[y]=[]),l[y][w]=x):l[Xt(w)+N]=x,o.cellFormula){for(S=!1,k=0;k<b.length;++k){var B=b[k];p.r>=B[0].s.r&&p.r<=B[0].e.r&&w>=B[0].s.c&&w<=B[0].e.c&&(x.F=tt(B[0]),S=!0)}!S&&K.length>3&&(x.f=K[3])}if(h.s.r>p.r&&(h.s.r=p.r),h.s.c>w&&(h.s.c=w),h.e.r<p.r&&(h.e.r=p.r),h.e.c<w&&(h.e.c=w),o.cellDates&&g&&x.t=="n"&&oc(He[g.numFmtId])){var q=to(x.v);q&&(x.t="d",x.v=new Date(q.y,q.m-1,q.d,q.H,q.M,q.S,q.u))}ie&&(ie.type=="XLDAPR"&&(x.D=!0),ie=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;x={t:"z",v:void 0},w=K[0].c==-1?w+1:K[0].c,o.dense?(l[y]||(l[y]=[]),l[y][w]=x):l[Xt(w)+N]=x,h.s.r>p.r&&(h.s.r=p.r),h.s.c>w&&(h.s.c=w),h.e.r<p.r&&(h.e.r=p.r),h.e.c<w&&(h.e.c=w),ie&&(ie.type=="XLDAPR"&&(x.D=!0),ie=void 0);break;case 176:D.push(K);break;case 49:ie=((o.xlmeta||{}).Cell||[])[K-1];break;case 494:var H=n["!id"][K.relId];for(H?(K.Target=H.Target,K.loc&&(K.Target+="#"+K.loc),K.Rel=H):K.relId==""&&(K.Target="#"+K.loc),y=K.rfx.s.r;y<=K.rfx.e.r;++y)for(w=K.rfx.s.c;w<=K.rfx.e.c;++w)o.dense?(l[y]||(l[y]=[]),l[y][w]||(l[y][w]={t:"z",v:void 0}),l[y][w].l=K):(E=Ge({c:w,r:y}),l[E]||(l[E]={t:"z",v:void 0}),l[E].l=K);break;case 426:if(!o.cellFormula)break;b.push(K),j=o.dense?l[y][w]:l[Xt(w)+N],j.f=cn(K[1],h,{r:p.r,c:w},A,o),j.F=tt(K[0]);break;case 427:if(!o.cellFormula)break;C[Ge(K[0].s)]=K[1],j=o.dense?l[y][w]:l[Xt(w)+N],j.f=cn(K[1],h,{r:p.r,c:w},A,o);break;case 60:if(!o.cellStyles)break;for(;K.e>=K.s;)P[K.e--]={width:K.w/256,hidden:!!(K.flags&1),level:K.level},de||(de=!0,Yx(K.w/256)),Ca(P[K.e+1]);break;case 161:l["!autofilter"]={ref:tt(K)};break;case 476:l["!margins"]=K;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),K.name&&(s.Sheets[r].CodeName=K.name),(K.above||K.left)&&(l["!outline"]={above:K.above,left:K.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),K.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!fe.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+_e.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(h.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=tt(u||h)),o.sheetRows&&l["!ref"]){var ge=gt(l["!ref"]);o.sheetRows<=+ge.e.r&&(ge.e.r=o.sheetRows-1,ge.e.r>h.e.r&&(ge.e.r=h.e.r),ge.e.r<ge.s.r&&(ge.s.r=ge.e.r),ge.e.c>h.e.c&&(ge.e.c=h.e.c),ge.e.c<ge.s.c&&(ge.s.c=ge.e.c),l["!fullref"]=l["!ref"],l["!ref"]=tt(ge))}return D.length>0&&(l["!merges"]=D),P.length>0&&(l["!cols"]=P),ue.length>0&&(l["!rows"]=ue),l}function rW(t,e,r,n,s,i,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Ht(e),e.z=e.z||He[14],e.v=Ar(zt(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=Ba(s.cellXfs,e,s),e.l&&i["!links"].push([Ge(l),e.l]),e.c&&i["!comments"].push([Ge(l),e.c]),e.t){case"s":case"str":return s.bookSST?(o=rv(s.Strings,e.v,s.revStrings),l.t="s",l.v=o,a?pe(t,18,_$(e,l)):pe(t,7,y$(e,l))):(l.t="str",a?pe(t,17,F$(e,l)):pe(t,6,R$(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?pe(t,13,N$(e,l)):pe(t,2,b$(e,l)):a?pe(t,16,T$(e,l)):pe(t,5,k$(e,l)),!0;case"b":return l.t="b",a?pe(t,15,d$(e,l)):pe(t,4,h$(e,l)),!0;case"e":return l.t="e",a?pe(t,14,x$(e,l)):pe(t,3,p$(e,l)),!0}return a?pe(t,12,c$(e,l)):pe(t,1,o$(e,l)),!0}function nW(t,e,r,n){var s=gt(e["!ref"]||"A1"),i,a="",o=[];pe(t,145);var l=Array.isArray(e),u=s.e.r;e["!rows"]&&(u=Math.max(s.e.r,e["!rows"].length-1));for(var h=s.s.r;h<=u;++h){a=fr(h),e$(t,e,s,h);var d=!1;if(h<=s.e.r)for(var m=s.s.c;m<=s.e.c;++m){h===s.s.r&&(o[m]=Xt(m)),i=o[m]+a;var p=l?(e[h]||[])[m]:e[i];if(!p){d=!1;continue}d=rW(t,p,h,m,n,e,d)}}pe(t,146)}function sW(t,e){!e||!e["!merges"]||(pe(t,177,V$(e["!merges"].length)),e["!merges"].forEach(function(r){pe(t,176,B$(r))}),pe(t,178))}function iW(t,e){!e||!e["!cols"]||(pe(t,390),e["!cols"].forEach(function(r,n){r&&pe(t,60,G$(n,r))}),pe(t,391))}function aW(t,e){!e||!e["!ref"]||(pe(t,648),pe(t,649,Y$(gt(e["!ref"]))),pe(t,650))}function oW(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var s=It(r,-1,n[1].Target.replace(/#.*$/,""),it.HLINK);pe(t,494,$$(n,s))}}),delete e["!links"]}function lW(t,e,r,n){if(e["!comments"].length>0){var s=It(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",it.VML);pe(t,551,Wx("rId"+s)),e["!legacy"]=s}}function cW(t,e,r,n){if(e["!autofilter"]){var s=e["!autofilter"],i=typeof s.ref=="string"?s.ref:tt(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=On(i);o.s.r==o.e.r&&(o.e.r=On(e["!ref"]).e.r,i=tt(o));for(var l=0;l<a.length;++l){var u=a[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+i;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),pe(t,161,uc(gt(i))),pe(t,162)}}function uW(t,e,r){pe(t,133),pe(t,137,Q$(e,r)),pe(t,138),pe(t,134)}function hW(t,e){e["!protect"]&&pe(t,535,J$(e["!protect"]))}function fW(t,e,r,n){var s=jn(),i=r.SheetNames[t],a=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=gt(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],pe(s,129),(r.vbaraw||a["!outline"])&&pe(s,147,i$(o,a["!outline"])),pe(s,148,r$(l)),uW(s,a,r.Workbook),iW(s,a),nW(s,a,t,e),hW(s,a),cW(s,a,r,t),sW(s,a),oW(s,a,n),a["!margins"]&&pe(s,476,q$(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&aW(s,a),lW(s,a,t,n),pe(s,130),s.end()}function dW(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var a=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var s=pt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[e,s,n]}function mW(t,e,r,n,s,i){var a=i||{"!type":"chart"};if(!t)return i;var o=0,l=0,u="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var m=dW(d);h.s.r=h.s.c=0,h.e.c=o,u=Xt(o),m[0].forEach(function(p,x){a[u+fr(x)]={t:"n",v:p,z:m[1]},l=x}),h.e.r<l&&(h.e.r=l),++o}),o>0&&(a["!ref"]=tt(h)),a}function pW(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(N3);return o&&nv(o[0],i,s,r),(a=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=a[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function gW(t,e){t.l+=10;var r=mn(t);return{name:r}}function xW(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a=!1;return Bi(t,function(l,u,h){switch(h){case 550:i["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},e),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var sv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],vW=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],yW=[],wW=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function S_(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var i=e[s];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Ut(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function b_(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Ut(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function P3(t){b_(t.WBProps,sv),b_(t.CalcPr,wW),S_(t.WBView,vW),S_(t.Sheets,yW),Il.date1904=Ut(t.WBProps.date1904)}function _W(t){return!t.Workbook||!t.Workbook.WBProps?"false":Ut(t.Workbook.WBProps.date1904)?"true":"false"}var EW="][*?/\\".split("");function F3(t,e){if(t.length>31){if(e)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return EW.forEach(function(n){if(t.indexOf(n)!=-1){if(!e)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function kW(t,e,r){t.forEach(function(n,s){F3(n);for(var i=0;i<s;++i)if(n==t[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[s]&&e[s].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function TW(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];kW(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)_U(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var SW=/<\w+:workbook/;function bW(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",i={},a=0;if(t.replace(yn,function(l,u){var h=Ke(l);switch(li(h[0])){case"<?xml":break;case"<workbook":l.match(SW)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=h[s];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":sv.forEach(function(d){if(h[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=Ut(h[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(h[d[0]],10);break;default:r.WBProps[d[0]]=h[d[0]]}}),h.codeName&&(r.WBProps.CodeName=Dt(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=pt(Dt(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Dt(h.name),h.comment&&(i.Comment=h.comment),h.localSheetId&&(i.Sheet=+h.localSheetId),Ut(h.hidden||"0")&&(i.Hidden=!0),a=u+l.length;break;case"</definedName>":i.Ref=pt(Dt(t.slice(a,u))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return l}),Oo.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return P3(r),r}function L3(t){var e=[dr];e[e.length]=be("workbook",null,{xmlns:Oo[0],"xmlns:r":br.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(sv.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=be("workbookPr",null,n);var s=t.Workbook&&t.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(e[e.length]="<bookViews>",i=0;i!=t.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==t.SheetNames.length&&(i=0),e[e.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",i=0;i!=t.SheetNames.length;++i){var a={name:Pt(t.SheetNames[i].slice(0,31))};if(a.sheetId=""+(i+1),a["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=be("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=be("definedName",Pt(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function CW(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=vg(t),r.name=mn(t),r}function NW(t,e){return e||(e=le(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Wx(t.strRelID,e),Dr(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function AW(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?mn(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function IW(t,e){e||(e=le(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),Sb(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function RW(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function PW(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),i=lD(t),a=pU(t,0,r),o=$x(t);t.l=n;var l={Name:i,Ptg:a};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function FW(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var i=[],a=[[]];return a.SheetNames=[],a.XTI=[],Q0[16]={n:"BrtFRTArchID$",f:RW},Bi(t,function(l,u,h){switch(h){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=cn(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,i.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([h,l]):a[0]=[h,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(h),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},e),P3(r),r.Names=i,r.supbooks=a,r}function LW(t,e){pe(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};pe(t,156,NW(s))}pe(t,144)}function DW(t,e){e||(e=le(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Dr("SheetJS",e),Dr(Pf.version,e),Dr(Pf.version,e),Dr("7262",e),e.length>e.l?e.slice(0,e.l):e}function jW(t,e){e||(e=le(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function OW(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,s=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&i==-1&&(i=n);i>s||(pe(t,135),pe(t,158,jW(s)),pe(t,136))}}function MW(t,e){var r=jn();return pe(r,131),pe(r,128,DW()),pe(r,153,IW(t.Workbook&&t.Workbook.WBProps||null)),OW(r,t),LW(r,t),pe(r,132),r.end()}function BW(t,e,r){return e.slice(-4)===".bin"?FW(t,r):bW(t,r)}function VW(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?tW(t,n,r,s,i,a,o):PU(t,n,r,s,i,a,o)}function UW(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?xW(t,n,r,s,i):pW(t,n,r,s,i)}function $W(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?zB():HB()}function WW(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?$B():WB()}function zW(t,e,r,n){return e.slice(-4)===".bin"?BM(t,r,n):CM(t,r,n)}function HW(t,e,r){return m3(t,r)}function GW(t,e,r){return e.slice(-4)===".bin"?GO(t,r):WO(t,r)}function KW(t,e,r){return e.slice(-4)===".bin"?OB(t,r):NB(t,r)}function qW(t,e,r){return e.slice(-4)===".bin"?SB(t):kB(t)}function XW(t,e,r,n){return r.slice(-4)===".bin"?bB(t,e,r,n):void 0}function QW(t,e,r){return e.slice(-4)===".bin"?wB(t,e,r):EB(t,e,r)}function YW(t,e,r){return(e.slice(-4)===".bin"?MW:L3)(t)}function JW(t,e,r,n,s){return(e.slice(-4)===".bin"?fW:A3)(t,r,n,s)}function ZW(t,e,r){return(e.slice(-4)===".bin"?XM:f3)(t,r)}function ez(t,e,r){return(e.slice(-4)===".bin"?XO:s3)(t,r)}function tz(t,e,r){return(e.slice(-4)===".bin"?MB:x3)(t)}function rz(t){return(t.slice(-4)===".bin"?_B:p3)()}var D3=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,j3=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function _s(t,e){var r=t.split(/\s+/),n=[];if(e||(n[0]=r[0]),r.length===1)return n;var s=t.match(D3),i,a,o,l;if(s)for(l=0;l!=s.length;++l)i=s[l].match(j3),(a=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),n[o]=i[2].slice(1,i[2].length-1));return n}function nz(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(D3),s,i,a,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(j3),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?a="xmlns"+s[1].slice(6):a=s[1].slice(i+1),r[a]=s[2].slice(1,s[2].length-1));return r}var u0;function sz(t,e){var r=u0[t]||pt(t);return r==="General"?ko(e):ps(r,e)}function iz(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Ut(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=zt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[pt(e)]=s}function az(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Vi[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=U0(t.v):t.w=ko(t.v):t.w=sz(e||"General",t.v)}catch(i){if(r.WTF)throw i}try{var n=u0[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&oc(n)){var s=to(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function oz(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=yM[n.Pattern]||n.Pattern)}t[e.ID]=e}function lz(t,e,r,n,s,i,a,o,l,u){var h="General",d=n.StyleID,m={};u=u||{};var p=[],x=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&a&&(d=a.StyleID);i[d]!==void 0&&(i[d].nf&&(h=i[d].nf),i[d].Interior&&p.push(i[d].Interior),!!i[d].Parent);)d=i[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Ut(t);break;case"String":n.t="s",n.r=Ww(pt(t)),n.v=t.indexOf("<")>-1?pt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(zt(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=pt(t):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Ib[t],u.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=Ww(e||t));break}if(az(n,h,u),u.cellFormula!==!1)if(n.Formula){var g=pt(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=Al(g,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Al("RC:RC",s):n.ArrayRange&&(n.F=Al(n.ArrayRange,s),l.push([gt(n.F),n.F]))}else for(x=0;x<l.length;++x)s.r>=l[x][0].s.r&&s.r<=l[x][0].e.r&&s.c>=l[x][0].s.c&&s.c<=l[x][0].e.c&&(n.F=l[x][1]);u.cellStyles&&(p.forEach(function(y){!m.patternType&&y.patternType&&(m.patternType=y.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function cz(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Hm(t,e){var r=e||{};lc();var n=Vc(jx(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Dt(n));var s=n.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var a=Ht(r);return a.type="string",ql.to_workbook(n,a)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ae){s.indexOf("<"+Ae)>=0&&(i=!0)}),i)return qz(n,r);u0={"General Number":"General","General Date":He[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":He[15],"Short Date":He[14],"Long Time":He[19],"Medium Time":He[18],"Short Time":He[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:He[2],Standard:He[4],Percent:He[10],Scientific:He[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],u,h={},d=[],m=r.dense?[]:{},p="",x={},g={},y=_s('<Data ss:Type="String">'),w=0,E=0,_=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},j={},D={},k="",S=0,b=[],C={},A={},I=0,P=[],ue=[],de={},ie=[],ge,ne=!1,K=[],fe=[],_e={},B=0,q=0,H={Sheets:[],WBProps:{date1904:!1}},G={};z0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var J="";o=z0.exec(n);)switch(o[3]=(J=o[3]).toLowerCase()){case"data":if(J=="data"){if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?lz(n.slice(w,o.index),k,y,l[l.length-1][0]=="comment"?de:x,{c:E,r:_},j,ie[E],g,K,r):(k="",y=_s(o[0]),w=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ue.length>0&&(x.c=ue),(!r.sheetRows||r.sheetRows>_)&&x.v!==void 0&&(r.dense?(m[_]||(m[_]=[]),m[_][E]=x):m[Xt(E)+fr(_)]=x),x.HRef&&(x.l={Target:pt(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(B=E+(parseInt(x.MergeAcross,10)|0),q=_+(parseInt(x.MergeDown,10)|0),b.push({s:{c:E,r:_},e:{c:B,r:q}})),!r.sheetStubs)x.MergeAcross?E=B+1:++E;else if(x.MergeAcross||x.MergeDown){for(var ae=E;ae<=B;++ae)for(var re=_;re<=q;++re)(ae>E||re>_)&&(r.dense?(m[re]||(m[re]=[]),m[re][ae]={t:"z"}):m[Xt(ae)+fr(re)]={t:"z"});E=B+1}else++E;else x=nz(o[0]),x.Index&&(E=+x.Index-1),E<N.s.c&&(N.s.c=E),E>N.e.c&&(N.e.c=E),o[0].slice(-2)==="/>"&&++E,ue=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<N.s.r&&(N.s.r=_),_>N.e.r&&(N.e.r=_),o[0].slice(-2)==="/>"&&(g=_s(o[0]),g.Index&&(_=+g.Index-1)),E=0,++_):(g=_s(o[0]),g.Index&&(_=+g.Index-1),_e={},(g.AutoFitHeight=="0"||g.Height)&&(_e.hpx=parseInt(g.Height,10),_e.hpt=X0(_e.hpx),fe[_]=_e),g.Hidden=="1"&&(_e.hidden=!0,fe[_]=_e));break;case"worksheet":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));d.push(p),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(m["!ref"]=tt(N),r.sheetRows&&r.sheetRows<=N.e.r&&(m["!fullref"]=m["!ref"],N.e.r=r.sheetRows-1,m["!ref"]=tt(N))),b.length&&(m["!merges"]=b),ie.length>0&&(m["!cols"]=ie),fe.length>0&&(m["!rows"]=fe),h[p]=m}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=E=0,l.push([o[3],!1]),u=_s(o[0]),p=pt(u.Name),m=r.dense?[]:{},b=[],K=[],fe=[],G={name:p,Hidden:0},H.Sheets.push(G);break;case"table":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),ie=[],ne=!1}break;case"style":o[1]==="/"?oz(j,D,r):D=_s(o[0]);break;case"numberformat":D.nf=pt(_s(o[0]).Format||"General"),u0[D.nf]&&(D.nf=u0[D.nf]);for(var he=0;he!=392&&He[he]!=D.nf;++he);if(he==392){for(he=57;he!=392;++he)if(He[he]==null){Si(D.nf,he);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(ge=_s(o[0]),ge.Hidden&&(ge.hidden=!0,delete ge.Hidden),ge.Width&&(ge.wpx=parseInt(ge.Width,10)),!ne&&ge.wpx>10){ne=!0,fn=u3;for(var oe=0;oe<ie.length;++oe)ie[oe]&&Ca(ie[oe])}ne&&Ca(ge),ie[ge.Index-1||ie.length]=ge;for(var Pe=0;Pe<+ge.Span;++Pe)ie[ie.length]=Ht(ge);break;case"namedrange":if(o[1]==="/")break;H.Names||(H.Names=[]);var W=Ke(o[0]),$e={Name:W.Name,Ref:Al(W.RefersTo.slice(1),{r:0,c:0})};H.Sheets.length>0&&($e.Sheet=H.Sheets.length-1),H.Names.push($e);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?k+=n.slice(S,o.index):S=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;D.Interior=_s(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?FD(C,J,n.slice(I,o.index)):I=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));cz(de),ue.push(de)}else l.push([o[3],!1]),u=_s(o[0]),de={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Oe=_s(o[0]);m["!autofilter"]={ref:Al(Oe.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return R_(n,r);var We=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:We=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:We=!1}break;case"excelworkbook":switch(o[3]){case"date1904":H.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:We=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:We=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(I,o.index)){case"SheetHidden":G.Hidden=1;break;case"SheetVeryHidden":G.Hidden=2;break}else I=o.index+o[0].length;break;case"header":m["!margins"]||co(m["!margins"]={},"xlml"),isNaN(+Ke(o[0]).Margin)||(m["!margins"].header=+Ke(o[0]).Margin);break;case"footer":m["!margins"]||co(m["!margins"]={},"xlml"),isNaN(+Ke(o[0]).Margin)||(m["!margins"].footer=+Ke(o[0]).Margin);break;case"pagemargins":var Ue=Ke(o[0]);m["!margins"]||co(m["!margins"]={},"xlml"),isNaN(+Ue.Top)||(m["!margins"].top=+Ue.Top),isNaN(+Ue.Left)||(m["!margins"].left=+Ue.Left),isNaN(+Ue.Right)||(m["!margins"].right=+Ue.Right),isNaN(+Ue.Bottom)||(m["!margins"].bottom=+Ue.Bottom);break;case"displayrighttoleft":H.Views||(H.Views=[]),H.Views[0]||(H.Views[0]={}),H.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:We=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:We=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:We=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:We=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:We=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:We=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:We=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:We=!1}break;case"smarttags":break;default:We=!1;break}if(We||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?iz(A,J,P,n.slice(I,o.index)):(P=o,I=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Te={};return!r.bookSheets&&!r.bookProps&&(Te.Sheets=h),Te.SheetNames=d,Te.Workbook=H,Te.SSF=Ht(He),Te.Props=C,Te.Custprops=A,Te}function Sg(t,e){switch(av(e=e||{}),e.type||"base64"){case"base64":return Hm(qn(t),e);case"binary":case"buffer":case"file":return Hm(t,e);case"array":return Hm(Oa(t),e)}}function uz(t,e){var r=[];return t.Props&&r.push(LD(t.Props,e)),t.Custprops&&r.push(DD(t.Props,t.Custprops)),r.join("")}function hz(){return""}function fz(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,s){var i=[];i.push(be("NumberFormat",null,{"ss:Format":Pt(He[n.numFmtId])}));var a={"ss:ID":"s"+(21+s)};r.push(be("Style",i.join(""),a))}),be("Styles",r.join(""))}function O3(t){return be("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+ev(t.Ref,{r:0,c:0})})}function dz(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var s=e[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(O3(s)))}return be("Names",r.join(""))}function mz(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,i=[],a=0;a<s.length;++a){var o=s[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(O3(o)))}return i.join("")}function pz(t,e,r,n){if(!t)return"";var s=[];if(t["!margins"]&&(s.push("<PageSetup>"),t["!margins"].header&&s.push(be("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&s.push(be("Footer",null,{"x:Margin":t["!margins"].footer})),s.push(be("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(be("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),t["!protect"]&&(s.push(Kr("ProtectContents","True")),t["!protect"].objects&&s.push(Kr("ProtectObjects","True")),t["!protect"].scenarios&&s.push(Kr("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?s.push(Kr("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&s.push(Kr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&s.push("<"+a[1]+"/>")})),s.length==0?"":be("WorksheetOptions",s.join(""),{xmlns:Vn.x})}function gz(t){return t.map(function(e){var r=OL(e.t||""),n=be("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return be("Comment",n,{"ss:Author":e.a})}).join("")}function xz(t,e,r,n,s,i,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+Pt(ev(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=Qt(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=Pt(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=Pt(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],h=0;h!=u.length;++h)u[h].s.c!=a.c||u[h].s.r!=a.r||(u[h].e.c>u[h].s.c&&(o["ss:MergeAcross"]=u[h].e.c-u[h].s.c),u[h].e.r>u[h].s.r&&(o["ss:MergeDown"]=u[h].e.r-u[h].s.r));var d="",m="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",m=String(t.v);break;case"b":d="Boolean",m=t.v?"1":"0";break;case"e":d="Error",m=Vi[t.v];break;case"d":d="DateTime",m=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||He[14]);break;case"s":d="String",m=jL(t.v||"");break}var p=Ba(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=a.c+1;var x=t.v!=null?m:"",g=t.t=="z"?"":'<Data ss:Type="'+d+'">'+x+"</Data>";return(t.c||[]).length>0&&(g+=gz(t.c)),be("Cell",g,o)}function vz(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Xl(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function yz(t,e,r,n){if(!t["!ref"])return"";var s=gt(t["!ref"]),i=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(y,w){Ca(y);var E=!!y.width,_=Ud(w,y),N={"ss:Index":w+1};E&&(N["ss:Width"]=K0(_.width)),y.hidden&&(N["ss:Hidden"]="1"),o.push(be("Column",null,N))});for(var l=Array.isArray(t),u=s.s.r;u<=s.e.r;++u){for(var h=[vz(u,(t["!rows"]||[])[u])],d=s.s.c;d<=s.e.c;++d){var m=!1;for(a=0;a!=i.length;++a)if(!(i[a].s.c>d)&&!(i[a].s.r>u)&&!(i[a].e.c<d)&&!(i[a].e.r<u)){(i[a].s.c!=d||i[a].s.r!=u)&&(m=!0);break}if(!m){var p={r:u,c:d},x=Ge(p),g=l?(t[u]||[])[d]:t[x];h.push(xz(g,x,t,e,r,n,p))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function wz(t,e,r){var n=[],s=r.SheetNames[t],i=r.Sheets[s],a=i?mz(i,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=i?yz(i,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(pz(i,e,t,r)),n.join("")}function _z(t,e){e||(e={}),t.SSF||(t.SSF=Ht(He)),t.SSF&&(lc(),Ld(t.SSF),e.revssf=jd(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Ba(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(uz(t,e)),r.push(hz()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(be("Worksheet",wz(n,e,t),{"ss:Name":Pt(t.SheetNames[n])}));return r[2]=fz(t,e),r[3]=dz(t),dr+be("Workbook",r.join(""),{xmlns:Vn.ss,"xmlns:o":Vn.o,"xmlns:x":Vn.x,"xmlns:ss":Vn.ss,"xmlns:dt":Vn.dt,"xmlns:html":Vn.html})}function Ez(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=dD(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=mD(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var kz=[60,1084,2066,2165,2175];function Tz(t,e,r,n,s){var i=n,a=[],o=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}a.push(o),r.l+=i;for(var l=_i(r,r.l),u=bg[l],h=0;u!=null&&kz.indexOf(l)>-1;)i=_i(r,r.l+2),h=r.l+4,l==2066?h+=4:(l==2165||l==2175)&&(h+=12),o=r.slice(h,r.l+4+i),a.push(o),r.l+=4+i,u=bg[l=_i(r,r.l)];var d=Lr(a);Hr(d,0);var m=0;d.lens=[];for(var p=0;p<a.length;++p)d.lens.push(m),m+=a[p].length;if(d.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+d.length+" < "+n;return e.f(d,d.length,s)}function Us(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=He[n])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Vi[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=U0(t.v):t.w=ko(t.v):t.w=ps(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&n&&t.t=="n"&&oc(He[n]||String(n))){var s=to(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function gh(t,e,r){return{v:t,ixfe:e,t:r}}function Sz(t,e){var r={opts:{}},n={},s=e.dense?[]:{},i={},a={},o=null,l=[],u="",h={},d,m="",p,x,g,y,w={},E=[],_,N,j=[],D=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},b=function(ze){return ze<8?ao[ze]:ze<64&&D[ze-8]||ao[ze]},C=function(ze,xt,Tt){var Se=xt.XF.data;if(!(!Se||!Se.patternType||!Tt||!Tt.cellStyles)){xt.s={},xt.s.patternType=Se.patternType;var Ze;(Ze=G0(b(Se.icvFore)))&&(xt.s.fgColor={rgb:Ze}),(Ze=G0(b(Se.icvBack)))&&(xt.s.bgColor={rgb:Ze})}},A=function(ze,xt,Tt){if(!(_e>1)&&!(Tt.sheetRows&&ze.r>=Tt.sheetRows)){if(Tt.cellStyles&&xt.XF&&xt.XF.data&&C(ze,xt,Tt),delete xt.ixfe,delete xt.XF,d=ze,m=Ge(ze),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),ze.r<a.s.r&&(a.s.r=ze.r),ze.c<a.s.c&&(a.s.c=ze.c),ze.r+1>a.e.r&&(a.e.r=ze.r+1),ze.c+1>a.e.c&&(a.e.c=ze.c+1),Tt.cellFormula&&xt.f){for(var Se=0;Se<E.length;++Se)if(!(E[Se][0].s.c>ze.c||E[Se][0].s.r>ze.r)&&!(E[Se][0].e.c<ze.c||E[Se][0].e.r<ze.r)){xt.F=tt(E[Se][0]),(E[Se][0].s.c!=ze.c||E[Se][0].s.r!=ze.r)&&delete xt.f,xt.f&&(xt.f=""+cn(E[Se][1],a,ze,K,I));break}}Tt.dense?(s[ze.r]||(s[ze.r]=[]),s[ze.r][ze.c]=xt):s[m]=xt}},I={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(I.password=e.password);var P,ue=[],de=[],ie=[],ge=[],ne=!1,K=[];K.SheetNames=I.snames,K.sharedf=I.sharedf,K.arrayf=I.arrayf,K.names=[],K.XTI=[];var fe=0,_e=0,B=0,q=[],H=[],G;I.codepage=1200,Cs(1200);for(var J=!1;t.l<t.length-1;){var ae=t.l,re=t.read_shift(2);if(re===0&&fe===10)break;var he=t.l===t.length?0:t.read_shift(2),oe=bg[re];if(oe&&oe.f){if(e.bookSheets&&fe===133&&re!==133)break;if(fe=re,oe.r===2||oe.r==12){var Pe=t.read_shift(2);if(he-=2,!I.enc&&Pe!==re&&((Pe&255)<<8|Pe>>8)!==re)throw new Error("rt mismatch: "+Pe+"!="+re);oe.r==12&&(t.l+=10,he-=10)}var W={};if(re===10?W=oe.f(t,he,I):W=Tz(re,oe,t,he,I),_e==0&&[9,521,1033,2057].indexOf(fe)===-1)continue;switch(re){case 34:r.opts.Date1904=k.WBProps.date1904=W;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(I.enc||(t.l=0),I.enc=W,!e.password)throw new Error("File is password-protected");if(W.valid==null)throw new Error("Encryption scheme unsupported");if(!W.valid)throw new Error("Password is incorrect");break;case 92:I.lastuser=W;break;case 66:var $e=Number(W);switch($e){case 21010:$e=1200;break;case 32768:$e=1e4;break;case 32769:$e=1252;break}Cs(I.codepage=$e),J=!0;break;case 317:I.rrtabid=W;break;case 25:I.winlocked=W;break;case 439:r.opts.RefreshAll=W;break;case 12:r.opts.CalcCount=W;break;case 16:r.opts.CalcDelta=W;break;case 17:r.opts.CalcIter=W;break;case 13:r.opts.CalcMode=W;break;case 14:r.opts.CalcPrecision=W;break;case 95:r.opts.CalcSaveRecalc=W;break;case 15:I.CalcRefMode=W;break;case 2211:r.opts.FullCalc=W;break;case 129:W.fDialog&&(s["!type"]="dialog"),W.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),W.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:j.push(W);break;case 430:K.push([W]),K[K.length-1].XTI=[];break;case 35:case 547:K[K.length-1].push(W);break;case 24:case 536:G={Name:W.Name,Ref:cn(W.rgce,a,null,K,I)},W.itab>0&&(G.Sheet=W.itab-1),K.names.push(G),K[0]||(K[0]=[],K[0].XTI=[]),K[K.length-1].push(W),W.Name=="_xlnm._FilterDatabase"&&W.itab>0&&W.rgce&&W.rgce[0]&&W.rgce[0][0]&&W.rgce[0][0][0]=="PtgArea3d"&&(H[W.itab-1]={ref:tt(W.rgce[0][0][1][2])});break;case 22:I.ExternCount=W;break;case 23:K.length==0&&(K[0]=[],K[0].XTI=[]),K[K.length-1].XTI=K[K.length-1].XTI.concat(W),K.XTI=K.XTI.concat(W);break;case 2196:if(I.biff<8)break;G!=null&&(G.Comment=W[1]);break;case 18:s["!protect"]=W;break;case 19:W!==0&&I.WTF&&console.error("Password verifier: "+W);break;case 133:i[W.pos]=W,I.snames.push(W.name);break;case 10:{if(--_e)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,s["!ref"]=tt(a),e.sheetRows&&e.sheetRows<=a.e.r){var Oe=a.e.r;a.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=tt(a),a.e.r=Oe}a.e.r++,a.e.c++}ue.length>0&&(s["!merges"]=ue),de.length>0&&(s["!objects"]=de),ie.length>0&&(s["!cols"]=ie),ge.length>0&&(s["!rows"]=ge),k.Sheets.push(S)}u===""?h=s:n[u]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(I.biff===8&&(I.biff={9:2,521:3,1033:4}[re]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[W.BIFFVer]||8),I.biffguess=W.BIFFVer==0,W.BIFFVer==0&&W.dt==4096&&(I.biff=5,J=!0,Cs(I.codepage=28591)),I.biff==8&&W.BIFFVer==0&&W.dt==16&&(I.biff=2),_e++)break;if(s=e.dense?[]:{},I.biff<8&&!J&&(J=!0,Cs(I.codepage=e.codepage||1252)),I.biff<5||W.BIFFVer==0&&W.dt==4096){u===""&&(u="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var We={pos:t.l-he,name:u};i[We.pos]=We,I.snames.push(u)}else u=(i[ae]||{name:""}).name;W.dt==32&&(s["!type"]="chart"),W.dt==64&&(s["!type"]="macro"),ue=[],de=[],I.arrayf=E=[],ie=[],ge=[],ne=!1,S={Hidden:(i[ae]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[W.r]||[])[W.c]:s[Ge({c:W.c,r:W.r})])&&++W.c,_={ixfe:W.ixfe,XF:j[W.ixfe]||{},v:W.val,t:"n"},B>0&&(_.z=q[_.ixfe>>8&63]),Us(_,e,r.opts.Date1904),A({c:W.c,r:W.r},_,e);break;case 5:case 517:_={ixfe:W.ixfe,XF:j[W.ixfe],v:W.val,t:W.t},B>0&&(_.z=q[_.ixfe>>8&63]),Us(_,e,r.opts.Date1904),A({c:W.c,r:W.r},_,e);break;case 638:_={ixfe:W.ixfe,XF:j[W.ixfe],v:W.rknum,t:"n"},B>0&&(_.z=q[_.ixfe>>8&63]),Us(_,e,r.opts.Date1904),A({c:W.c,r:W.r},_,e);break;case 189:for(var Ue=W.c;Ue<=W.C;++Ue){var Te=W.rkrec[Ue-W.c][0];_={ixfe:Te,XF:j[Te],v:W.rkrec[Ue-W.c][1],t:"n"},B>0&&(_.z=q[_.ixfe>>8&63]),Us(_,e,r.opts.Date1904),A({c:Ue,r:W.r},_,e)}break;case 6:case 518:case 1030:{if(W.val=="String"){o=W;break}if(_=gh(W.val,W.cell.ixfe,W.tt),_.XF=j[_.ixfe],e.cellFormula){var Ae=W.formula;if(Ae&&Ae[0]&&Ae[0][0]&&Ae[0][0][0]=="PtgExp"){var ye=Ae[0][0][1][0],De=Ae[0][0][1][1],st=Ge({r:ye,c:De});w[st]?_.f=""+cn(W.formula,a,W.cell,K,I):_.F=((e.dense?(s[ye]||[])[De]:s[st])||{}).F}else _.f=""+cn(W.formula,a,W.cell,K,I)}B>0&&(_.z=q[_.ixfe>>8&63]),Us(_,e,r.opts.Date1904),A(W.cell,_,e),o=W}break;case 7:case 519:if(o)o.val=W,_=gh(W,o.cell.ixfe,"s"),_.XF=j[_.ixfe],e.cellFormula&&(_.f=""+cn(o.formula,a,o.cell,K,I)),B>0&&(_.z=q[_.ixfe>>8&63]),Us(_,e,r.opts.Date1904),A(o.cell,_,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{E.push(W);var bt=Ge(W[0].s);if(p=e.dense?(s[W[0].s.r]||[])[W[0].s.c]:s[bt],e.cellFormula&&p){if(!o||!bt||!p)break;p.f=""+cn(W[1],a,W[0],K,I),p.F=tt(W[0])}}break;case 1212:{if(!e.cellFormula)break;if(m){if(!o)break;w[Ge(o.cell)]=W[0],p=e.dense?(s[o.cell.r]||[])[o.cell.c]:s[Ge(o.cell)],(p||{}).f=""+cn(W[0],a,d,K,I)}}break;case 253:_=gh(l[W.isst].t,W.ixfe,"s"),l[W.isst].h&&(_.h=l[W.isst].h),_.XF=j[_.ixfe],B>0&&(_.z=q[_.ixfe>>8&63]),Us(_,e,r.opts.Date1904),A({c:W.c,r:W.r},_,e);break;case 513:e.sheetStubs&&(_={ixfe:W.ixfe,XF:j[W.ixfe],t:"z"},B>0&&(_.z=q[_.ixfe>>8&63]),Us(_,e,r.opts.Date1904),A({c:W.c,r:W.r},_,e));break;case 190:if(e.sheetStubs)for(var Mt=W.c;Mt<=W.C;++Mt){var _t=W.ixfe[Mt-W.c];_={ixfe:_t,XF:j[_t],t:"z"},B>0&&(_.z=q[_.ixfe>>8&63]),Us(_,e,r.opts.Date1904),A({c:Mt,r:W.r},_,e)}break;case 214:case 516:case 4:_=gh(W.val,W.ixfe,"s"),_.XF=j[_.ixfe],B>0&&(_.z=q[_.ixfe>>8&63]),Us(_,e,r.opts.Date1904),A({c:W.c,r:W.r},_,e);break;case 0:case 512:_e===1&&(a=W);break;case 252:l=W;break;case 1054:if(I.biff==4){q[B++]=W[1];for(var er=0;er<B+163&&He[er]!=W[1];++er);er>=163&&Si(W[1],B+163)}else Si(W[1],W[0]);break;case 30:{q[B++]=W;for(var Et=0;Et<B+163&&He[Et]!=W;++Et);Et>=163&&Si(W,B+163)}break;case 229:ue=ue.concat(W);break;case 93:de[W.cmo[0]]=I.lastobj=W;break;case 438:I.lastobj.TxO=W;break;case 127:I.lastobj.ImData=W;break;case 440:for(y=W[0].s.r;y<=W[0].e.r;++y)for(g=W[0].s.c;g<=W[0].e.c;++g)p=e.dense?(s[y]||[])[g]:s[Ge({c:g,r:y})],p&&(p.l=W[1]);break;case 2048:for(y=W[0].s.r;y<=W[0].e.r;++y)for(g=W[0].s.c;g<=W[0].e.c;++g)p=e.dense?(s[y]||[])[g]:s[Ge({c:g,r:y})],p&&p.l&&(p.l.Tooltip=W[1]);break;case 28:{if(I.biff<=5&&I.biff>=2)break;p=e.dense?(s[W[0].r]||[])[W[0].c]:s[Ge(W[0])];var kt=de[W[2]];p||(e.dense?(s[W[0].r]||(s[W[0].r]=[]),p=s[W[0].r][W[0].c]={t:"z"}):p=s[Ge(W[0])]={t:"z"},a.e.r=Math.max(a.e.r,W[0].r),a.s.r=Math.min(a.s.r,W[0].r),a.e.c=Math.max(a.e.c,W[0].c),a.s.c=Math.min(a.s.c,W[0].c)),p.c||(p.c=[]),x={a:W[1],t:kt.TxO.t},p.c.push(x)}break;case 2173:fB(j[W.ixfe],W.ext);break;case 125:{if(!I.cellStyles)break;for(;W.e>=W.s;)ie[W.e--]={width:W.w/256,level:W.level||0,hidden:!!(W.flags&1)},ne||(ne=!0,Yx(W.w/256)),Ca(ie[W.e+1])}break;case 520:{var Xe={};W.level!=null&&(ge[W.r]=Xe,Xe.level=W.level),W.hidden&&(ge[W.r]=Xe,Xe.hidden=!0),W.hpt&&(ge[W.r]=Xe,Xe.hpt=W.hpt,Xe.hpx=Xl(W.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||co(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[re]]=W;break;case 161:s["!margins"]||co(s["!margins"]={}),s["!margins"].header=W.header,s["!margins"].footer=W.footer;break;case 574:W.RTL&&(k.Views[0].RTL=!0);break;case 146:D=W;break;case 2198:P=W;break;case 140:N=W;break;case 442:u?S.CodeName=W||S.name:k.WBProps.CodeName=W||"ThisWorkbook";break}}else oe||console.error("Missing Info for XLS Record 0x"+re.toString(16)),t.l+=he}return r.SheetNames=ar(i).sort(function(Gt,ze){return Number(Gt)-Number(ze)}).map(function(Gt){return i[Gt].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&H.forEach(function(Gt,ze){r.Sheets[r.SheetNames[ze]]["!autofilter"]=Gt}),r.Strings=l,r.SSF=Ht(He),I.enc&&(r.Encryption=I.enc),P&&(r.Themes=P),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),K.names.length>0&&(k.Names=K.names),r.Workbook=k,r}var h0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function bz(t,e,r){var n=Me.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=o_(n,yg,h0.DSI);for(var i in s)e[i]=s[i]}catch(u){if(r.WTF)throw u}var a=Me.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=o_(a,wg,h0.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(u){if(r.WTF)throw u}e.HeadingPairs&&e.TitlesOfParts&&(jb(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function Cz(t,e){var r=[],n=[],s=[],i=0,a,o=Ow(yg,"n"),l=Ow(wg,"n");if(t.Props)for(a=ar(t.Props),i=0;i<a.length;++i)(Object.prototype.hasOwnProperty.call(o,a[i])?r:Object.prototype.hasOwnProperty.call(l,a[i])?n:s).push([a[i],t.Props[a[i]]]);if(t.Custprops)for(a=ar(t.Custprops),i=0;i<a.length;++i)Object.prototype.hasOwnProperty.call(t.Props||{},a[i])||(Object.prototype.hasOwnProperty.call(o,a[i])?r:Object.prototype.hasOwnProperty.call(l,a[i])?n:s).push([a[i],t.Custprops[a[i]]]);var u=[];for(i=0;i<s.length;++i)Wb.indexOf(s[i][0])>-1||Db.indexOf(s[i][0])>-1||s[i][1]!=null&&u.push(s[i]);n.length&&Me.utils.cfb_add(e,"/SummaryInformation",l_(n,h0.SI,l,wg)),(r.length||u.length)&&Me.utils.cfb_add(e,"/DocumentSummaryInformation",l_(r,h0.DSI,o,yg,u.length?u:null,h0.UDI))}function M3(t,e){e||(e={}),av(e),Cx(),e.codepage&&bx(e.codepage);var r,n;if(t.FullPaths){if(Me.find(t,"/encryption"))throw new Error("File is password-protected");r=Me.find(t,"!CompObj"),n=Me.find(t,"/Workbook")||Me.find(t,"/Book")}else{switch(e.type){case"base64":t=$n(qn(t));break;case"binary":t=$n(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Hr(t,0),n={content:t}}var s,i;if(r&&Ez(r),e.bookProps&&!e.bookSheets)s={};else{var a=nt?"buffer":"array";if(n&&n.content)s=Sz(n.content,e);else if((i=Me.find(t,"PerfectOffice_MAIN"))&&i.content)s=lo.to_workbook(i.content,(e.type=a,e));else if((i=Me.find(t,"NativeContent_MAIN"))&&i.content)s=lo.to_workbook(i.content,(e.type=a,e));else throw(i=Me.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Me.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=VB(t))}var o={};return t.FullPaths&&bz(t,o,e),s.Props=s.Custprops=o,e.bookFiles&&(s.cfb=t),s}function Nz(t,e){var r=e||{},n=Me.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Me.utils.cfb_add(n,s,B3(t,r)),r.biff==8&&(t.Props||t.Custprops)&&Cz(t,n),r.biff==8&&t.vbaraw&&UB(n,Me.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var Q0={0:{f:JU},1:{f:a$},2:{f:S$},3:{f:m$},4:{f:u$},5:{f:E$},6:{f:I$},7:{f:v$},8:{f:O$},9:{f:j$},10:{f:L$},11:{f:D$},12:{f:l$},13:{f:C$},14:{f:g$},15:{f:f$},16:{f:I3},17:{f:P$},18:{f:w$},19:{f:Ux},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:PW},40:{},42:{},43:{f:IM},44:{f:NM},45:{f:FM},46:{f:DM},47:{f:LM},48:{},49:{f:tD},50:{},51:{f:pB},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:e3},62:{f:A$},63:{f:TB},64:{f:Z$},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:xn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:X$},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:s$},148:{f:t$,p:16},151:{f:W$},152:{},153:{f:AW},154:{},155:{},156:{f:CW},157:{},158:{},159:{T:1,f:HO},160:{T:-1},161:{T:1,f:Uo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:M$},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:dB},336:{T:-1},337:{f:vB,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:vg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Zb},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:z$},427:{f:H$},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:K$},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:n$},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:U$},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:vg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:DB},633:{T:1},634:{T:-1},635:{T:1,f:FB},636:{T:-1},637:{f:iD},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:gW},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:eW},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},bg={6:{f:Wm},10:{f:Ki},12:{f:xr},13:{f:xr},14:{f:or},15:{f:or},16:{f:dn},17:{f:or},18:{f:or},19:{f:xr},20:{f:m_},21:{f:m_},23:{f:Zb},24:{f:g_},25:{f:or},26:{},27:{},28:{f:eO},29:{},34:{f:or},35:{f:p_},38:{f:dn},39:{f:dn},40:{f:dn},41:{f:dn},42:{f:or},43:{f:or},47:{f:fM},49:{f:Cj},51:{f:xr},60:{},61:{f:Ej},64:{f:or},65:{f:bj},66:{f:xr},77:{},80:{},81:{},82:{},85:{f:xr},89:{},90:{},91:{},92:{f:hj},93:{f:nO},94:{},95:{f:or},96:{},97:{},99:{f:or},125:{f:e3},128:{f:$j},129:{f:dj},130:{f:xr},131:{f:or},132:{f:or},133:{f:mj},134:{},140:{f:hO},141:{f:xr},144:{},146:{f:mO},151:{},152:{},153:{},154:{},155:{},156:{f:xr},157:{},158:{},160:{f:_O},161:{f:xO},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Mj},190:{f:Bj},193:{f:Ki},197:{},198:{},199:{},200:{},201:{},202:{f:or},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:xr},220:{},221:{f:or},222:{},224:{f:Uj},225:{f:uj},226:{f:Ki},227:{},229:{f:tO},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:gj},253:{f:Aj},255:{f:vj},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:zb},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:or},353:{f:Ki},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Kj},431:{f:or},432:{},433:{},434:{},437:{},438:{f:aO},439:{f:or},440:{f:oO},441:{},442:{f:Eu},443:{},444:{f:xr},445:{},446:{},448:{f:Ki},449:{f:_j,r:2},450:{f:Ki},512:{f:h_},513:{f:wO},515:{f:Hj},516:{f:Rj},517:{f:d_},519:{f:EO},520:{f:yj},523:{},545:{f:x_},549:{f:u_},566:{},574:{f:Tj},638:{f:Oj},659:{},1048:{},1054:{f:Fj},1084:{},1212:{f:Yj},2048:{f:cO},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:dh},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ki},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:pO,r:12},2173:{f:hB,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:or,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Qj,r:12},2197:{},2198:{f:iB,r:12},2199:{},2200:{},2201:{},2202:{f:Jj,r:12},2203:{f:Ki},2204:{},2205:{},2206:{},2207:{},2211:{f:wj},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:xr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:vO},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:dO},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:h_},1:{},2:{f:CO},3:{f:SO},4:{f:TO},5:{f:d_},7:{f:AO},8:{},9:{f:dh},11:{},22:{f:xr},30:{f:Dj},31:{},32:{},33:{f:x_},36:{},37:{f:u_},50:{f:IO},62:{},52:{},67:{},68:{f:xr},69:{},86:{},126:{},127:{f:kO},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:RO},223:{},234:{},354:{},421:{},518:{f:Wm},521:{f:dh},536:{f:g_},547:{f:p_},561:{},579:{},1030:{f:Wm},1033:{f:dh},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ce(t,e,r,n){var s=e;if(!isNaN(s)){var i=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,s),a.write_shift(2,i),i>0&&Mx(r)&&t.push(r)}}function Az(t,e,r,n){var s=n||(r||[]).length||0;if(s<=8224)return Ce(t,e,r,s);var i=e;if(!isNaN(i)){for(var a=r.parts||[],o=0,l=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var h=t.next(4);for(h.write_shift(2,i),h.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u;l<s;){for(h=t.next(4),h.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;h.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u}}}function bu(t,e,r){return t||(t=le(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function Iz(t,e,r,n){var s=le(9);return bu(s,t,e),Hb(r,n||"b",s),s}function Rz(t,e,r){var n=le(8+2*r.length);return bu(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Pz(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var s=e.t=="d"?Ar(zt(e.v)):e.v;s==(s|0)&&s>=0&&s<65536?Ce(t,2,NO(r,n,s)):Ce(t,3,bO(r,n,s));return;case"b":case"e":Ce(t,5,Iz(r,n,e.v,e.t));return;case"s":case"str":Ce(t,4,Rz(r,n,(e.v||"").slice(0,255)));return}Ce(t,1,bu(null,r,n))}function Fz(t,e,r,n){var s=Array.isArray(e),i=gt(e["!ref"]||"A1"),a,o="",l=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),a=tt(i)}for(var u=i.s.r;u<=i.e.r;++u){o=fr(u);for(var h=i.s.c;h<=i.e.c;++h){u===i.s.r&&(l[h]=Xt(h)),a=l[h]+o;var d=s?(e[u]||[])[h]:e[a];d&&Pz(t,d,u,h)}}}function Lz(t,e){for(var r=e||{},n=jn(),s=0,i=0;i<t.SheetNames.length;++i)t.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ce(n,r.biff==4?1033:r.biff==3?521:9,qx(t,16,r)),Fz(n,t.Sheets[t.SheetNames[s]],s,r),Ce(n,10),n.end()}function Dz(t,e,r){Ce(t,49,Nj({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function jz(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&Ce(t,1054,Lj(s,e[s],r))})}function Oz(t,e){var r=le(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ce(t,2151,r),r=le(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Qb(gt(e["!ref"]||"A1"),r),r.write_shift(4,4),Ce(t,2152,r)}function Mz(t,e){for(var r=0;r<16;++r)Ce(t,224,f_({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Ce(t,224,f_(n,0,e))})}function Bz(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Ce(t,440,lO(n)),n[1].Tooltip&&Ce(t,2048,uO(n))}delete e["!links"]}function Vz(t,e){if(e){var r=0;e.forEach(function(n,s){++r<=256&&n&&Ce(t,125,gO(Ud(s,n),s))})}}function Uz(t,e,r,n,s){var i=16+Ba(s.cellXfs,e,s);if(e.v==null&&!e.bf){Ce(t,513,Co(r,n,i));return}if(e.bf)Ce(t,6,dU(e,r,n,s,i));else switch(e.t){case"d":case"n":var a=e.t=="d"?Ar(zt(e.v)):e.v;Ce(t,515,Gj(r,n,a,i));break;case"b":case"e":Ce(t,517,zj(r,n,e.v,i,s,e.t));break;case"s":case"str":if(s.bookSST){var o=rv(s.Strings,e.v,s.revStrings);Ce(t,253,Ij(r,n,o,i))}else Ce(t,516,Pj(r,n,(e.v||"").slice(0,255),i,s));break;default:Ce(t,513,Co(r,n,i))}}function $z(t,e,r){var n=jn(),s=r.SheetNames[t],i=r.Sheets[s]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=Array.isArray(i),u=e.biff==8,h,d="",m=[],p=gt(i["!ref"]||"A1"),x=u?65536:16384;if(p.e.c>255||p.e.r>=x){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,x-1)}Ce(n,2057,qx(r,16,e)),Ce(n,13,ss(1)),Ce(n,12,ss(100)),Ce(n,15,En(!0)),Ce(n,17,En(!1)),Ce(n,16,So(.001)),Ce(n,95,En(!0)),Ce(n,42,En(!1)),Ce(n,43,En(!1)),Ce(n,130,ss(1)),Ce(n,128,Wj([0,0])),Ce(n,131,En(!1)),Ce(n,132,En(!1)),u&&Vz(n,i["!cols"]),Ce(n,512,jj(p,e)),u&&(i["!links"]=[]);for(var g=p.s.r;g<=p.e.r;++g){d=fr(g);for(var y=p.s.c;y<=p.e.c;++y){g===p.s.r&&(m[y]=Xt(y)),h=m[y]+d;var w=l?(i[g]||[])[y]:i[h];w&&(Uz(n,w,g,y,e),u&&w.l&&i["!links"].push([h,w.l]))}}var E=o.CodeName||o.name||s;return u&&Ce(n,574,Sj((a.Views||[])[0])),u&&(i["!merges"]||[]).length&&Ce(n,229,rO(i["!merges"])),u&&Bz(n,i),Ce(n,442,Gb(E)),u&&Oz(n,i),Ce(n,10),n.end()}function Wz(t,e,r){var n=jn(),s=(t||{}).Workbook||{},i=s.Sheets||[],a=s.WBProps||{},o=r.biff==8,l=r.biff==5;if(Ce(n,2057,qx(t,5,r)),r.bookType=="xla"&&Ce(n,135),Ce(n,225,o?ss(1200):null),Ce(n,193,zD(2)),l&&Ce(n,191),l&&Ce(n,192),Ce(n,226),Ce(n,92,fj("SheetJS",r)),Ce(n,66,ss(o?1200:1252)),o&&Ce(n,353,ss(0)),o&&Ce(n,448),Ce(n,317,yO(t.SheetNames.length)),o&&t.vbaraw&&Ce(n,211),o&&t.vbaraw){var u=a.CodeName||"ThisWorkbook";Ce(n,442,Gb(u))}Ce(n,156,ss(17)),Ce(n,25,En(!1)),Ce(n,18,En(!1)),Ce(n,19,ss(0)),o&&Ce(n,431,En(!1)),o&&Ce(n,444,ss(0)),Ce(n,61,kj()),Ce(n,64,En(!1)),Ce(n,141,ss(0)),Ce(n,34,En(_W(t)=="true")),Ce(n,14,En(!0)),o&&Ce(n,439,En(!1)),Ce(n,218,ss(0)),Dz(n,t,r),jz(n,t.SSF,r),Mz(n,r),o&&Ce(n,352,En(!1));var h=n.end(),d=jn();o&&Ce(d,140,fO()),o&&r.Strings&&Az(d,252,xj(r.Strings)),Ce(d,10);var m=d.end(),p=jn(),x=0,g=0;for(g=0;g<t.SheetNames.length;++g)x+=(o?12:11)+(o?2:1)*t.SheetNames[g].length;var y=h.length+x+m.length;for(g=0;g<t.SheetNames.length;++g){var w=i[g]||{};Ce(p,133,pj({pos:y,hs:w.Hidden||0,dt:0,name:t.SheetNames[g]},r)),y+=e[g].length}var E=p.end();if(x!=E.length)throw new Error("BS8 "+x+" != "+E.length);var _=[];return h.length&&_.push(h),E.length&&_.push(E),m.length&&_.push(m),Lr(_)}function zz(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Ht(He)),t&&t.SSF&&(lc(),Ld(t.SSF),r.revssf=jd(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,ov(r),r.cellXfs=[],Ba(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var s=0;s<t.SheetNames.length;++s)n[n.length]=$z(s,r,t);return n.unshift(Wz(t,n,r)),Lr(n)}function B3(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var s=On(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=e||{};switch(i.biff||2){case 8:case 5:return zz(t,e);case 4:case 3:case 2:return Lz(t,e)}throw new Error("invalid type "+i.bookType+" for BIFF")}function C_(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),a=s.index,o=i&&i.index||t.length,l=AL(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,h=0,d=0,m=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(a=0;a<l.length;++a){var g=l[a].trim(),y=g.slice(0,3).toLowerCase();if(y=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}h=0;continue}if(!(y!="<td"&&y!="<th")){var w=g.split(/<\/t[dh]>/i);for(o=0;o<w.length;++o){var E=w[o].trim();if(E.match(/<t[dh]/i)){for(var _=E,N=0;_.charAt(0)=="<"&&(N=_.indexOf(">"))>-1;)_=_.slice(N+1);for(var j=0;j<x.length;++j){var D=x[j];D.s.c==h&&D.s.r<u&&u<=D.e.r&&(h=D.e.c+1,j=-1)}var k=Ke(E.slice(0,E.indexOf(">")));m=k.colspan?+k.colspan:1,((d=+k.rowspan)>1||m>1)&&x.push({s:{r:u,c:h},e:{r:u+(d||1)-1,c:h+m-1}});var S=k.t||k["data-t"]||"";if(!_.length){h+=m;continue}if(_=cb(_),p.s.r>u&&(p.s.r=u),p.e.r<u&&(p.e.r=u),p.s.c>h&&(p.s.c=h),p.e.c<h&&(p.e.c=h),!_.length){h+=m;continue}var b={t:"s",v:_};r.raw||!_.trim().length||S=="s"||(_==="TRUE"?b={t:"b",v:!0}:_==="FALSE"?b={t:"b",v:!1}:isNaN(Ps(_))?isNaN(Kl(_).getDate())||(b={t:"d",v:zt(_)},r.cellDates||(b={t:"n",v:Ar(b.v)}),b.z=r.dateNF||He[14]):b={t:"n",v:Ps(_)}),r.dense?(n[u]||(n[u]=[]),n[u][h]=b):n[Ge({r:u,c:h})]=b,h+=m}}}}return n["!ref"]=tt(p),x.length&&(n["!merges"]=x),n}function Hz(t,e,r,n){for(var s=t["!merges"]||[],i=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>a)&&!(s[u].e.r<r||s[u].e.c<a)){if(s[u].s.r<r||s[u].s.c<a){o=-1;break}o=s[u].e.r-s[u].s.r+1,l=s[u].e.c-s[u].s.c+1;break}if(!(o<0)){var h=Ge({r,c:a}),d=n.dense?(t[r]||[])[a]:t[h],m=d&&d.v!=null&&(d.h||Dx(d.w||(Di(d),d.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?m='<span contenteditable="true">'+m+"</span>":d&&(p["data-t"]=d&&d.t||"z",d.v!=null&&(p["data-v"]=d.v),d.z!=null&&(p["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+d.l.Target+'">'+m+"</a>")),p.id=(n.id||"sjs")+"-"+h,i.push(be("td",m,p))}}var x="<tr>";return x+i.join("")+"</tr>"}var Gz='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Kz="</body></html>";function qz(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ma(C_(r[0],e),e);var n=uv();return r.forEach(function(s,i){hv(n,C_(s,e),"Sheet"+(i+1))}),n}function Xz(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function V3(t,e){var r=e||{},n=r.header!=null?r.header:Gz,s=r.footer!=null?r.footer:Kz,i=[n],a=On(t["!ref"]);r.dense=Array.isArray(t),i.push(Xz(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)i.push(Hz(t,a,o,r));return i.push("</table>"+s),i.join("")}function U3(t,e,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var a=typeof n.origin=="string"?Qt(n.origin):n.origin;s=a.r,i=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:s,c:i}};if(t["!ref"]){var h=On(t["!ref"]);u.s.r=Math.min(u.s.r,h.s.r),u.s.c=Math.min(u.s.c,h.s.c),u.e.r=Math.max(u.e.r,h.e.r),u.e.c=Math.max(u.e.c,h.e.c),s==-1&&(u.e.r=s=h.e.r+1)}var d=[],m=0,p=t["!rows"]||(t["!rows"]=[]),x=0,g=0,y=0,w=0,E=0,_=0;for(t["!cols"]||(t["!cols"]=[]);x<o.length&&g<l;++x){var N=o[x];if(N_(N)){if(n.display)continue;p[g]={hidden:!0}}var j=N.children;for(y=w=0;y<j.length;++y){var D=j[y];if(!(n.display&&N_(D))){var k=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):cb(D.innerHTML),S=D.getAttribute("data-z")||D.getAttribute("z");for(m=0;m<d.length;++m){var b=d[m];b.s.c==w+i&&b.s.r<g+s&&g+s<=b.e.r&&(w=b.e.c+1-i,m=-1)}_=+D.getAttribute("colspan")||1,((E=+D.getAttribute("rowspan")||1)>1||_>1)&&d.push({s:{r:g+s,c:w+i},e:{r:g+s+(E||1)-1,c:w+i+(_||1)-1}});var C={t:"s",v:k},A=D.getAttribute("data-t")||D.getAttribute("t")||"";k!=null&&(k.length==0?C.t=A||"z":n.raw||k.trim().length==0||A=="s"||(k==="TRUE"?C={t:"b",v:!0}:k==="FALSE"?C={t:"b",v:!1}:isNaN(Ps(k))?isNaN(Kl(k).getDate())||(C={t:"d",v:zt(k)},n.cellDates||(C={t:"n",v:Ar(C.v)}),C.z=n.dateNF||He[14]):C={t:"n",v:Ps(k)})),C.z===void 0&&S!=null&&(C.z=S);var I="",P=D.getElementsByTagName("A");if(P&&P.length)for(var ue=0;ue<P.length&&!(P[ue].hasAttribute("href")&&(I=P[ue].getAttribute("href"),I.charAt(0)!="#"));++ue);I&&I.charAt(0)!="#"&&(C.l={Target:I}),n.dense?(t[g+s]||(t[g+s]=[]),t[g+s][w+i]=C):t[Ge({c:w+i,r:g+s})]=C,u.e.c<w+i&&(u.e.c=w+i),w+=_}}++g}return d.length&&(t["!merges"]=(t["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,g-1+s),t["!ref"]=tt(u),g>=l&&(t["!fullref"]=tt((u.e.r=o.length-x+g-1+s,u))),t}function $3(t,e){var r=e||{},n=r.dense?[]:{};return U3(n,t,e)}function Qz(t,e){return Ma($3(t,e),e)}function N_(t){var e="",r=Yz(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Yz(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Jz(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=pt(e.replace(/<[^>]*>/g,""));return[r]}var A_={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function W3(t,e){var r=e||{},n=jx(t),s=[],i,a,o={name:""},l="",u=0,h,d,m={},p=[],x=r.dense?[]:{},g,y,w={value:""},E="",_=0,N=[],j=-1,D=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,b={},C=[],A={},I=0,P=0,ue=[],de=1,ie=1,ge=[],ne={Names:[]},K={},fe=["",""],_e=[],B={},q="",H=0,G=!1,J=!1,ae=0;for(z0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=z0.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"工作表":g[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?x["!ref"]=tt(k):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(x["!fullref"]=x["!ref"],k.e.r=r.sheetRows-1,x["!ref"]=tt(k)),C.length&&(x["!merges"]=C),ue.length&&(x["!rows"]=ue),h.name=h.名称||h.name,typeof JSON<"u"&&JSON.stringify(h),p.push(h.name),m[h.name]=x,J=!1):g[0].charAt(g[0].length-2)!=="/"&&(h=Ke(g[0],!1),j=D=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,x=r.dense?[]:{},C=[],ue=[],J=!0);break;case"table-row-group":g[1]==="/"?--S:++S;break;case"table-row":case"行":if(g[1]==="/"){j+=de,de=1;break}if(d=Ke(g[0],!1),d.行号?j=d.行号-1:j==-1&&(j=0),de=+d["number-rows-repeated"]||1,de<10)for(ae=0;ae<de;++ae)S>0&&(ue[j+ae]={level:S});D=-1;break;case"covered-table-cell":g[1]!=="/"&&++D,r.sheetStubs&&(r.dense?(x[j]||(x[j]=[]),x[j][D]={t:"z"}):x[Ge({r:j,c:D})]={t:"z"}),E="",N=[];break;case"table-cell":case"数据":if(g[0].charAt(g[0].length-2)==="/")++D,w=Ke(g[0],!1),ie=parseInt(w["number-columns-repeated"]||"1",10),y={t:"z",v:null},w.formula&&r.cellFormula!=!1&&(y.f=T_(pt(w.formula))),(w.数据类型||w["value-type"])=="string"&&(y.t="s",y.v=pt(w["string-value"]||""),r.dense?(x[j]||(x[j]=[]),x[j][D]=y):x[Ge({r:j,c:D})]=y),D+=ie-1;else if(g[1]!=="/"){++D,E="",_=0,N=[],ie=1;var re=de?j+de-1:j;if(D>k.e.c&&(k.e.c=D),D<k.s.c&&(k.s.c=D),j<k.s.r&&(k.s.r=j),re>k.e.r&&(k.e.r=re),w=Ke(g[0],!1),_e=[],B={},y={t:w.数据类型||w["value-type"],v:null},r.cellFormula)if(w.formula&&(w.formula=pt(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(I=parseInt(w["number-matrix-rows-spanned"],10)||0,P=parseInt(w["number-matrix-columns-spanned"],10)||0,A={s:{r:j,c:D},e:{r:j+I-1,c:D+P-1}},y.F=tt(A),ge.push([A,y.F])),w.formula)y.f=T_(w.formula);else for(ae=0;ae<ge.length;++ae)j>=ge[ae][0].s.r&&j<=ge[ae][0].e.r&&D>=ge[ae][0].s.c&&D<=ge[ae][0].e.c&&(y.F=ge[ae][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(I=parseInt(w["number-rows-spanned"],10)||0,P=parseInt(w["number-columns-spanned"],10)||0,A={s:{r:j,c:D},e:{r:j+I-1,c:D+P-1}},C.push(A)),w["number-columns-repeated"]&&(ie=parseInt(w["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=Ut(w["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(w.value);break;case"percentage":y.t="n",y.v=parseFloat(w.value);break;case"currency":y.t="n",y.v=parseFloat(w.value);break;case"date":y.t="d",y.v=zt(w["date-value"]),r.cellDates||(y.t="n",y.v=Ar(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=bL(w["time-value"])/86400,r.cellDates&&(y.t="d",y.v=Od(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(w.数据数值);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",w["string-value"]!=null&&(E=pt(w["string-value"]),N=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(G=!1,y.t==="s"&&(y.v=E||"",N.length&&(y.R=N),G=_==0),K.Target&&(y.l=K),_e.length>0&&(y.c=_e,_e=[]),E&&r.cellText!==!1&&(y.w=E),G&&(y.t="z",delete y.v),(!G||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=j))for(var he=0;he<de;++he){if(ie=parseInt(w["number-columns-repeated"]||"1",10),r.dense)for(x[j+he]||(x[j+he]=[]),x[j+he][D]=he==0?y:Ht(y);--ie>0;)x[j+he][D+ie]=Ht(y);else for(x[Ge({r:j+he,c:D})]=y;--ie>0;)x[Ge({r:j+he,c:D+ie})]=Ht(y);k.e.c<=D&&(k.e.c=D)}ie=parseInt(w["number-columns-repeated"]||"1",10),D+=ie-1,ie=0,y={},E="",N=[]}K={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((i=s.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((i=s.pop())[0]!==g[3])throw"Bad state: "+i;B.t=E,N.length&&(B.R=N),B.a=q,_e.push(B)}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);q="",H=0,E="",_=0,N=[];break;case"creator":g[1]==="/"?q=n.slice(H,g.index):H=g.index+g[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((i=s.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);E="",_=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(b[o.name]=l,(i=s.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&(l="",o=Ke(g[0],!1),s.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":a=Ke(g[0],!1),l+=A_[g[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":a=Ke(g[0],!1),l+=A_[g[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,g.index);break}else u=g.index+g[0].length;break;case"named-range":a=Ke(g[0],!1),fe=zm(a["cell-range-address"]);var oe={Name:a.name,Ref:fe[0]+"!"+fe[1]};J&&(oe.Sheet=p.length),ne.Names.push(oe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(g[1]==="/"&&(!w||!w["string-value"])){var Pe=Jz(n.slice(_,g.index));E=(E.length>0?E+`
`:"")+Pe[0]}else Ke(g[0],!1),_=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{fe=zm(Ke(g[0])["target-range-address"]),m[fe[0]]["!autofilter"]={ref:fe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(K=Ke(g[0],!1),!K.href)break;K.Target=pt(K.href),delete K.href,K.Target.charAt(0)=="#"&&K.Target.indexOf(".")>-1?(fe=zm(K.Target.slice(1)),K.Target="#"+fe[0]+"!"+fe[1]):K.Target.match(/^\.\.[\\\/]/)&&(K.Target=K.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(g)}}var W={Sheets:m,SheetNames:p,Workbook:ne};return r.bookSheets&&delete W.Sheets,W}function I_(t,e){e=e||{},ns(t,"META-INF/manifest.xml")&&SD(gr(t,"META-INF/manifest.xml"),e);var r=Wn(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=W3(Dt(r),e);return ns(t,"meta.xml")&&(n.Props=Fb(gr(t,"meta.xml"))),n}function R_(t,e){return W3(t,e)}var Zz=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+W0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return dr+e}}(),P_=function(){var t=function(i){return Pt(i).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,a,o){var l=[];l.push('      <table:table table:name="'+Pt(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,h=0,d=On(i["!ref"]||"A1"),m=i["!merges"]||[],p=0,x=Array.isArray(i);if(i["!cols"])for(h=0;h<=d.e.c;++h)l.push("        <table:table-column"+(i["!cols"][h]?' table:style-name="co'+i["!cols"][h].ods+'"':"")+`></table:table-column>
`);var g="",y=i["!rows"]||[];for(u=0;u<d.s.r;++u)g=y[u]?' table:style-name="ro'+y[u].ods+'"':"",l.push("        <table:table-row"+g+`></table:table-row>
`);for(;u<=d.e.r;++u){for(g=y[u]?' table:style-name="ro'+y[u].ods+'"':"",l.push("        <table:table-row"+g+`>
`),h=0;h<d.s.c;++h)l.push(e);for(;h<=d.e.c;++h){var w=!1,E={},_="";for(p=0;p!=m.length;++p)if(!(m[p].s.c>h)&&!(m[p].s.r>u)&&!(m[p].e.c<h)&&!(m[p].e.r<u)){(m[p].s.c!=h||m[p].s.r!=u)&&(w=!0),E["table:number-columns-spanned"]=m[p].e.c-m[p].s.c+1,E["table:number-rows-spanned"]=m[p].e.r-m[p].s.r+1;break}if(w){l.push(r);continue}var N=Ge({r:u,c:h}),j=x?(i[u]||[])[h]:i[N];if(j&&j.f&&(E["table:formula"]=Pt(yU(j.f)),j.F&&j.F.slice(0,N.length)==N)){var D=On(j.F);E["table:number-matrix-columns-spanned"]=D.e.c-D.s.c+1,E["table:number-matrix-rows-spanned"]=D.e.r-D.s.r+1}if(!j){l.push(e);continue}switch(j.t){case"b":_=j.v?"TRUE":"FALSE",E["office:value-type"]="boolean",E["office:boolean-value"]=j.v?"true":"false";break;case"n":_=j.w||String(j.v||0),E["office:value-type"]="float",E["office:value"]=j.v||0;break;case"s":case"str":_=j.v==null?"":j.v,E["office:value-type"]="string";break;case"d":_=j.w||zt(j.v).toISOString(),E["office:value-type"]="date",E["office:date-value"]=zt(j.v).toISOString(),E["table:style-name"]="ce1";break;default:l.push(e);continue}var k=t(_);if(j.l&&j.l.Target){var S=j.l.Target;S=S.charAt(0)=="#"?"#"+wU(S.slice(1)):S,S.charAt(0)!="#"&&!S.match(/^\w+:/)&&(S="../"+S),k=be("text:a",k,{"xlink:href":S.replace(/&/g,"&amp;")})}l.push("          "+be("table:table-cell",be("text:p",k,{}),E)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},s=function(i,a){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var h=0;h<u["!cols"].length;++h)if(u["!cols"][h]){var d=u["!cols"][h];if(d.width==null&&d.wpx==null&&d.wch==null)continue;Ca(d),d.ods=o;var m=u["!cols"][h].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),i.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var h=0;h<u["!rows"].length;++h)if(u["!rows"][h]){u["!rows"][h].ods=l;var d=u["!rows"][h].hpx+"px";i.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),i.push(`  </style:style>
`),++l}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(a,o){var l=[dr],u=W0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=W0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+h+`>
`),l.push(Pb().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),s(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var d=0;d!=a.SheetNames.length;++d)l.push(n(a.Sheets[a.SheetNames[d]],a,d));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function z3(t,e){if(e.bookType=="fods")return P_(t,e);var r=Px(),n="",s=[],i=[];return n="mimetype",rt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",rt(r,n,P_(t,e)),s.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",rt(r,n,Zz(t,e)),s.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",rt(r,n,dr+Pb()),s.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",rt(r,n,ND(i)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",rt(r,n,bD(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function No(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Cg(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Dt(Oa(t))}function eH(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):$n(Ks(t))}function tH(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Aa(t){var e=t.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function F_(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function rH(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function nH(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var i=0;s>=1;++i,s/=256)t[e+i]=s&255;t[e+15]|=r>=0?0:128}function Y0(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function At(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function sr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function yt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=Y0(t,r),i=s&7;s=Math.floor(s/8);var a=0,o;if(s==0)break;switch(i){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Y0(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var u={data:o,type:i};e[s]==null?e[s]=[u]:e[s].push(u)}return e}function $r(t){var e=[];return t.forEach(function(r,n){r.forEach(function(s){s.data&&(e.push(At(n*8+s.type)),s.type==2&&e.push(At(s.data.length)),e.push(s.data))})}),Aa(e)}function iv(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function ts(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=Y0(t,n),i=yt(t.slice(n[0],n[0]+s));n[0]+=s;var a={id:sr(i[1][0].data),messages:[]};i[2].forEach(function(o){var l=yt(o.data),u=sr(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=i[3])!=null&&e[0]&&(a.merge=sr(i[3][0].data)>>>0>0),r.push(a)}return r}function Yo(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:At(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:At(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(a){s.push(a.data),a.meta[3]=[{type:0,data:At(a.data.length)}],n[2].push({data:$r(a.meta),type:2})});var i=$r(n);e.push(At(i.length)),e.push(i),s.forEach(function(a){return e.push(a)})}),Aa(e)}function sH(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Y0(e,r),s=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}s.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,u=0;if(i==1?(u=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,i==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Aa(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(s.push(s[0].slice(-l)),u-=l;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-l,-l+u))}}var h=Aa(s);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function rs(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(sH(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Aa(e)}function Jo(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),s=new Uint8Array(4);e.push(s);var i=At(n),a=i.length;e.push(i),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,s[0]=0,s[1]=a&255,s[2]=a>>8&255,s[3]=a>>16&255,r+=n}return Aa(e)}function iH(t,e,r,n){var s=No(t),i=s.getUint32(4,!0),a=(n>1?12:8)+F_(i&(n>1?3470:398))*4,o=-1,l=-1,u=NaN,h=new Date(2001,0,1);i&512&&(o=s.getUint32(a,!0),a+=4),a+=F_(i&(n>1?12288:4096))*4,i&16&&(l=s.getUint32(a,!0),a+=4),i&32&&(u=s.getFloat64(a,!0),a+=8),i&64&&(h.setTime(h.getTime()+s.getFloat64(a,!0)*1e3),a+=8);var d;switch(t[2]){case 0:break;case 2:d={t:"n",v:u};break;case 3:d={t:"s",v:e[l]};break;case 5:d={t:"d",v:h};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(l>-1)d={t:"s",v:e[l]};else if(!isNaN(u))d={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return d}function aH(t,e,r){var n=No(t),s=n.getUint32(8,!0),i=12,a=-1,o=-1,l=NaN,u=NaN,h=new Date(2001,0,1);s&1&&(l=rH(t,i),i+=16),s&2&&(u=n.getFloat64(i,!0),i+=8),s&4&&(h.setTime(h.getTime()+n.getFloat64(i,!0)*1e3),i+=8),s&8&&(o=n.getUint32(i,!0),i+=4),s&16&&(a=n.getUint32(i,!0),i+=4);var d;switch(t[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:e[o]};break;case 5:d={t:"d",v:h};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(a>-1)d={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return d}function Gm(t,e){var r=new Uint8Array(32),n=No(r),s=12,i=0;switch(r[0]=5,t.t){case"n":r[1]=2,nH(r,s,t.v),i|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,t.v?1:0,!0),i|=2,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(s,e.indexOf(t.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,i,!0),r.slice(0,s)}function Km(t,e){var r=new Uint8Array(32),n=No(r),s=12,i=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(s,t.v,!0),i|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,t.v?1:0,!0),i|=32,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(s,e.indexOf(t.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,i,!0),r.slice(0,s)}function oH(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return iH(t,e,r,t[0]);case 5:return aH(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function ln(t){var e=yt(t);return Y0(e[1][0].data)}function L_(t,e){var r=yt(e.data),n=sr(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(a){var o=yt(a.data),l=sr(o[1][0].data)>>>0;switch(n){case 1:i[l]=Cg(o[3][0].data);break;case 8:{var u=t[ln(o[9][0].data)][0],h=yt(u.data),d=t[ln(h[1][0].data)][0],m=sr(d.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var p=yt(d.data);i[l]=p[3].map(function(x){return Cg(x.data)}).join("")}break}}),i}function lH(t,e){var r,n,s,i,a,o,l,u,h,d,m,p,x,g,y=yt(t),w=sr(y[1][0].data)>>>0,E=sr(y[2][0].data)>>>0,_=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&sr(y[8][0].data)>0||!1,N,j;if((i=(s=y[7])==null?void 0:s[0])!=null&&i.data&&e!=0)N=(o=(a=y[7])==null?void 0:a[0])==null?void 0:o.data,j=(u=(l=y[6])==null?void 0:l[0])==null?void 0:u.data;else if((d=(h=y[4])==null?void 0:h[0])!=null&&d.data&&e!=1)N=(p=(m=y[4])==null?void 0:m[0])==null?void 0:p.data,j=(g=(x=y[3])==null?void 0:x[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var D=_?4:1,k=No(N),S=[],b=0;b<N.length/2;++b){var C=k.getUint16(b*2,!0);C<65535&&S.push([b,C])}if(S.length!=E)throw"Expected ".concat(E," cells, found ").concat(S.length);var A=[];for(b=0;b<S.length-1;++b)A[S[b][0]]=j.subarray(S[b][1]*D,S[b+1][1]*D);return S.length>=1&&(A[S[S.length-1][0]]=j.subarray(S[S.length-1][1]*D)),{R:w,cells:A}}function cH(t,e){var r,n=yt(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?sr(n[7][0].data)>>>0>0?1:0:-1,i=iv(n[5],function(a){return lH(a,s)});return{nrows:sr(n[4][0].data)>>>0,data:i.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,u){if(a[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));a[o.R][u]=l}),a},[])}}function uH(t,e,r){var n,s=yt(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(sr(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(sr(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=tt(i);var a=yt(s[4][0].data),o=L_(t,t[ln(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?L_(t,t[ln(a[17][0].data)][0]):[],u=yt(a[3][0].data),h=0;u[1].forEach(function(d){var m=yt(d.data),p=t[ln(m[2][0].data)][0],x=sr(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var g=cH(t,p);g.data.forEach(function(y,w){y.forEach(function(E,_){var N=Ge({r:h+w,c:_}),j=oH(E,o,l);j&&(r[N]=j)})}),h+=g.nrows})}function hH(t,e){var r=yt(e.data),n={"!ref":"A1"},s=t[ln(r[2][0].data)],i=sr(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return uH(t,s[0],n),n}function fH(t,e){var r,n=yt(e.data),s={name:(r=n[1])!=null&&r[0]?Cg(n[1][0].data):"",sheets:[]},i=iv(n[2],ln);return i.forEach(function(a){t[a].forEach(function(o){var l=sr(o.meta[1][0].data);l==6e3&&s.sheets.push(hH(t,o))})}),s}function dH(t,e){var r=uv(),n=yt(e.data),s=iv(n[1],ln);if(s.forEach(function(i){t[i].forEach(function(a){var o=sr(a.meta[1][0].data);if(o==2){var l=fH(t,a);l.sheets.forEach(function(u,h){hv(r,u,h==0?l.name:l.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function qm(t){var e,r,n,s,i={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=rs(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var h;try{h=ts(u)}catch(d){return console.log("## "+(d.message||d))}h.forEach(function(d){i[d.id]=d.messages,a.push(d.id)})}}),!a.length)throw new Error("File has no messages");var o=((s=(n=(r=(e=i==null?void 0:i[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&sr(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||a.forEach(function(l){i[l].forEach(function(u){var h=sr(u.meta[1][0].data)>>>0;if(h==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return dH(i,o)}function mH(t,e,r){var n,s,i,a;if(!((n=t[6])!=null&&n[0])||!((s=t[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(i=t[8])==null?void 0:i[0])==null?void 0:a.data)&&sr(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=No(t[7][0].data),h=0,d=[],m=No(t[4][0].data),p=0,x=[],g=0;g<e.length;++g){if(e[g]==null){u.setUint16(g*2,65535,!0),m.setUint16(g*2,65535);continue}u.setUint16(g*2,h,!0),m.setUint16(g*2,p,!0);var y,w;switch(typeof e[g]){case"string":y=Gm({t:"s",v:e[g]},r),w=Km({t:"s",v:e[g]},r);break;case"number":y=Gm({t:"n",v:e[g]},r),w=Km({t:"n",v:e[g]},r);break;case"boolean":y=Gm({t:"b",v:e[g]},r),w=Km({t:"b",v:e[g]},r);break;default:throw new Error("Unsupported value "+e[g])}d.push(y),h+=y.length,x.push(w),p+=w.length,++l}for(t[2][0].data=At(l);g<t[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),m.setUint16(g*2,65535,!0);return t[6][0].data=Aa(d),t[3][0].data=Aa(x),l}function pH(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=On(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(tt(n)));var i=zf(r,{range:n,header:1}),a=["~Sh33tJ5~"];i.forEach(function(q){return q.forEach(function(H){typeof H=="string"&&a.push(H)})});var o={},l=[],u=Me.read(e.numbers,{type:"base64"});u.FileIndex.map(function(q,H){return[q,u.FullPaths[H]]}).forEach(function(q){var H=q[0],G=q[1];if(H.type==2&&H.name.match(/\.iwa/)){var J=H.content,ae=rs(J),re=ts(ae);re.forEach(function(he){l.push(he.id),o[he.id]={deps:[],location:G,type:sr(he.messages[0].meta[1][0].data)}})}}),l.sort(function(q,H){return q-H});var h=l.filter(function(q){return q>1}).map(function(q){return[q,At(q)]});u.FileIndex.map(function(q,H){return[q,u.FullPaths[H]]}).forEach(function(q){var H=q[0];if(q[1],!!H.name.match(/\.iwa/)){var G=ts(rs(H.content));G.forEach(function(J){J.messages.forEach(function(ae){h.forEach(function(re){J.messages.some(function(he){return sr(he.meta[1][0].data)!=11006&&tH(he.data,re[1])})&&o[re[0]].deps.push(J.id)})})})}});for(var d=Me.find(u,o[1].location),m=ts(rs(d.content)),p,x=0;x<m.length;++x){var g=m[x];g.id==1&&(p=g)}var y=ln(yt(p.messages[0].data)[1][0].data);for(d=Me.find(u,o[y].location),m=ts(rs(d.content)),x=0;x<m.length;++x)g=m[x],g.id==y&&(p=g);for(y=ln(yt(p.messages[0].data)[2][0].data),d=Me.find(u,o[y].location),m=ts(rs(d.content)),x=0;x<m.length;++x)g=m[x],g.id==y&&(p=g);for(y=ln(yt(p.messages[0].data)[2][0].data),d=Me.find(u,o[y].location),m=ts(rs(d.content)),x=0;x<m.length;++x)g=m[x],g.id==y&&(p=g);var w=yt(p.messages[0].data);{w[6][0].data=At(n.e.r+1),w[7][0].data=At(n.e.c+1);var E=ln(w[46][0].data),_=Me.find(u,o[E].location),N=ts(rs(_.content));{for(var j=0;j<N.length&&N[j].id!=E;++j);if(N[j].id!=E)throw"Bad ColumnRowUIDMapArchive";var D=yt(N[j].messages[0].data);D[1]=[],D[2]=[],D[3]=[];for(var k=0;k<=n.e.c;++k){var S=[];S[1]=S[2]=[{type:0,data:At(k+420690)}],D[1].push({type:2,data:$r(S)}),D[2].push({type:0,data:At(k)}),D[3].push({type:0,data:At(k)})}D[4]=[],D[5]=[],D[6]=[];for(var b=0;b<=n.e.r;++b)S=[],S[1]=S[2]=[{type:0,data:At(b+726270)}],D[4].push({type:2,data:$r(S)}),D[5].push({type:0,data:At(b)}),D[6].push({type:0,data:At(b)});N[j].messages[0].data=$r(D)}_.content=Jo(Yo(N)),_.size=_.content.length,delete w[46];var C=yt(w[4][0].data);{C[7][0].data=At(n.e.r+1);var A=yt(C[1][0].data),I=ln(A[2][0].data);_=Me.find(u,o[I].location),N=ts(rs(_.content));{if(N[0].id!=I)throw"Bad HeaderStorageBucket";var P=yt(N[0].messages[0].data);for(b=0;b<i.length;++b){var ue=yt(P[2][0].data);ue[1][0].data=At(b),ue[4][0].data=At(i[b].length),P[2][b]={type:P[2][0].type,data:$r(ue)}}N[0].messages[0].data=$r(P)}_.content=Jo(Yo(N)),_.size=_.content.length;var de=ln(C[2][0].data);_=Me.find(u,o[de].location),N=ts(rs(_.content));{if(N[0].id!=de)throw"Bad HeaderStorageBucket";for(P=yt(N[0].messages[0].data),k=0;k<=n.e.c;++k)ue=yt(P[2][0].data),ue[1][0].data=At(k),ue[4][0].data=At(n.e.r+1),P[2][k]={type:P[2][0].type,data:$r(ue)};N[0].messages[0].data=$r(P)}_.content=Jo(Yo(N)),_.size=_.content.length;var ie=ln(C[4][0].data);(function(){for(var q=Me.find(u,o[ie].location),H=ts(rs(q.content)),G,J=0;J<H.length;++J){var ae=H[J];ae.id==ie&&(G=ae)}var re=yt(G.messages[0].data);{re[3]=[];var he=[];a.forEach(function(W,$e){he[1]=[{type:0,data:At($e)}],he[2]=[{type:0,data:At(1)}],he[3]=[{type:2,data:eH(W)}],re[3].push({type:2,data:$r(he)})})}G.messages[0].data=$r(re);var oe=Yo(H),Pe=Jo(oe);q.content=Pe,q.size=q.content.length})();var ge=yt(C[3][0].data);{var ne=ge[1][0];delete ge[2];var K=yt(ne.data);{var fe=ln(K[2][0].data);(function(){for(var q=Me.find(u,o[fe].location),H=ts(rs(q.content)),G,J=0;J<H.length;++J){var ae=H[J];ae.id==fe&&(G=ae)}var re=yt(G.messages[0].data);{delete re[6],delete ge[7];var he=new Uint8Array(re[5][0].data);re[5]=[];for(var oe=0,Pe=0;Pe<=n.e.r;++Pe){var W=yt(he);oe+=mH(W,i[Pe],a),W[1][0].data=At(Pe),re[5].push({data:$r(W),type:2})}re[1]=[{type:0,data:At(n.e.c+1)}],re[2]=[{type:0,data:At(n.e.r+1)}],re[3]=[{type:0,data:At(oe)}],re[4]=[{type:0,data:At(n.e.r+1)}]}G.messages[0].data=$r(re);var $e=Yo(H),Oe=Jo($e);q.content=Oe,q.size=q.content.length})()}ne.data=$r(K)}C[3][0].data=$r(ge)}w[4][0].data=$r(C)}p.messages[0].data=$r(w);var _e=Yo(m),B=Jo(_e);return d.content=B,d.size=d.content.length,u}function H3(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function av(t){H3([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function ov(t){H3([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function gH(t){return it.WS.indexOf(t)>-1?"sheet":t==it.CS?"chart":t==it.DS?"dialog":t==it.MS?"macro":t&&t.length?t:"sheet"}function xH(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,gH(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function vH(t,e,r,n,s,i,a,o,l,u,h,d){try{i[n]=o0(Wn(t,r,!0),e);var m=gr(t,e),p;switch(o){case"sheet":p=VW(m,e,s,l,i[n],u,h,d);break;case"chart":if(p=UW(m,e,s,l,i[n],u,h,d),!p||!p["!drawel"])break;var x=$c(p["!drawel"].Target,e),g=H0(x),y=CB(Wn(t,x,!0),o0(Wn(t,g,!0),x)),w=$c(y,x),E=H0(w);p=mW(Wn(t,w,!0),w,l,o0(Wn(t,E,!0),w),u,p);break;case"macro":p=$W(m,e,s,l,i[n],u,h,d);break;case"dialog":p=WW(m,e,s,l,i[n],u,h,d);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=p;var _=[];i&&i[n]&&ar(i[n]).forEach(function(N){var j="";if(i[n][N].Type==it.CMNT){j=$c(i[n][N].Target,e);var D=KW(gr(t,j,!0),j,l);if(!D||!D.length)return;y_(p,D,!1)}i[n][N].Type==it.TCMNT&&(j=$c(i[n][N].Target,e),_=_.concat(AB(gr(t,j,!0),l)))}),_&&_.length&&y_(p,_,!0,l.people||[])}catch(N){if(l.WTF)throw N}}function Zn(t){return t.charAt(0)=="/"?t.slice(1):t}function yH(t,e){if(lc(),e=e||{},av(e),ns(t,"META-INF/manifest.xml")||ns(t,"objectdata.xml"))return I_(t,e);if(ns(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof qm<"u"){if(t.FileIndex)return qm(t);var r=Me.utils.cfb_new();return Vw(t).forEach(function(ue){rt(r,ue,ib(t,ue))}),qm(r)}throw new Error("Unsupported NUMBERS file")}if(!ns(t,"[Content_Types].xml"))throw ns(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ns(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Vw(t),s=kD(Wn(t,"[Content_Types].xml")),i=!1,a,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",gr(t,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!gr(t,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var l={},u={};if(!e.bookSheets&&!e.bookProps){if(l0=[],s.sst)try{l0=GW(gr(t,Zn(s.sst)),s.sst,e)}catch(ue){if(e.WTF)throw ue}e.cellStyles&&s.themes.length&&(l=HW(Wn(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(u=zW(gr(t,Zn(s.style)),s.style,l,e))}s.links.map(function(ue){try{var de=o0(Wn(t,H0(Zn(ue))),ue);return XW(gr(t,Zn(ue)),de,ue,e)}catch{}});var h=BW(gr(t,Zn(s.workbooks[0])),s.workbooks[0],e),d={},m="";s.coreprops.length&&(m=gr(t,Zn(s.coreprops[0]),!0),m&&(d=Fb(m)),s.extprops.length!==0&&(m=gr(t,Zn(s.extprops[0]),!0),m&&ID(m,d,e)));var p={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(m=Wn(t,Zn(s.custprops[0]),!0),m&&(p=PD(m,e)));var x={};if((e.bookSheets||e.bookProps)&&(h.Sheets?a=h.Sheets.map(function(de){return de.name}):d.Worksheets&&d.SheetNames.length>0&&(a=d.SheetNames),e.bookProps&&(x.Props=d,x.Custprops=p),e.bookSheets&&typeof a<"u"&&(x.SheetNames=a),e.bookSheets?x.SheetNames:e.bookProps))return x;a={};var g={};e.bookDeps&&s.calcchain&&(g=qW(gr(t,Zn(s.calcchain)),s.calcchain));var y=0,w={},E,_;{var N=h.Sheets;d.Worksheets=N.length,d.SheetNames=[];for(var j=0;j!=N.length;++j)d.SheetNames[j]=N[j].name}var D=i?"bin":"xml",k=s.workbooks[0].lastIndexOf("/"),S=(s.workbooks[0].slice(0,k+1)+"_rels/"+s.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");ns(t,S)||(S="xl/_rels/workbook."+D+".rels");var b=o0(Wn(t,S,!0),S.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=QW(gr(t,Zn(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=RB(gr(t,Zn(s.people[0])),e)),b&&(b=xH(b,h.Sheets));var C=gr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=d.Worksheets;++y){var A="sheet";if(b&&b[y]?(E="xl/"+b[y][1].replace(/[\/]?xl\//,""),ns(t,E)||(E=b[y][1]),ns(t,E)||(E=S.replace(/_rels\/.*$/,"")+b[y][1]),A=b[y][2]):(E="xl/worksheets/sheet"+(y+1-C)+"."+D,E=E.replace(/sheet0\./,"sheet.")),_=E.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(y!=e.sheets)continue e;break;case"string":if(d.SheetNames[y].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var I=!1,P=0;P!=e.sheets.length;++P)typeof e.sheets[P]=="number"&&e.sheets[P]==y&&(I=1),typeof e.sheets[P]=="string"&&e.sheets[P].toLowerCase()==d.SheetNames[y].toLowerCase()&&(I=1);if(!I)continue e}}vH(t,E,_,d.SheetNames[y],y,w,a,A,e,h,l,u)}return x={Directory:s,Workbook:h,Props:d,Custprops:p,Deps:g,Sheets:a,SheetNames:d.SheetNames,Strings:l0,Styles:u,Themes:l,SSF:Ht(He)},e&&e.bookFiles&&(t.files?(x.keys=n,x.files=t.files):(x.keys=[],x.files={},t.FullPaths.forEach(function(ue,de){ue=ue.replace(/^Root Entry[\/]/,""),x.keys.push(ue),x.files[ue]=t.FileIndex[de]}))),e&&e.bookVBA&&(s.vba.length>0?x.vbaraw=gr(t,Zn(s.vba[0]),!0):s.defaults&&s.defaults.bin===BB&&(x.vbaraw=gr(t,"xl/vbaProject.bin",!0))),x}function wH(t,e){var r=e||{},n="Workbook",s=Me.find(t,n);try{if(n="/!DataSpaces/Version",s=Me.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(QO(s.content),n="/!DataSpaces/DataSpaceMap",s=Me.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=JO(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Me.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=ZO(s.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Me.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);tM(s.content)}catch{}if(n="/EncryptionInfo",s=Me.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=rM(s.content);if(n="/EncryptedPackage",s=Me.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function _H(t,e){return e.bookType=="ods"?z3(t,e):e.bookType=="numbers"?pH(t,e):e.bookType=="xlsb"?EH(t,e):kH(t,e)}function EH(t,e){gl=1024,t&&!t.SSF&&(t.SSF=Ht(He)),t&&t.SSF&&(lc(),Ld(t.SSF),e.revssf=jd(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,c0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=v3.indexOf(e.bookType)>-1,s=Gx();ov(e=e||{});var i=Px(),a="",o=0;if(e.cellXfs=[],Ba(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",rt(i,a,Lb(t.Props,e)),s.coreprops.push(a),It(e.rels,2,a,it.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,rt(i,a,Ob(t.Props)),s.extprops.push(a),It(e.rels,3,a,it.EXT_PROPS),t.Custprops!==t.Props&&ar(t.Custprops||{}).length>0&&(a="docProps/custom.xml",rt(i,a,Mb(t.Custprops)),s.custprops.push(a),It(e.rels,4,a,it.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},d=t.Sheets[t.SheetNames[o-1]],m=(d||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,rt(i,a,JW(o-1,a,e,t,h)),s.sheets.push(a),It(e.wbrels,-1,"worksheets/sheet"+o+"."+r,it.WS[0])}if(d){var p=d["!comments"],x=!1,g="";p&&p.length>0&&(g="xl/comments"+o+"."+r,rt(i,g,tz(p,g)),s.comments.push(g),It(h,-1,"../comments"+o+"."+r,it.CMNT),x=!0),d["!legacy"]&&x&&rt(i,"xl/drawings/vmlDrawing"+o+".vml",g3(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&rt(i,H0(a),Nl(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,rt(i,a,ez(e.Strings,a,e)),s.strs.push(a),It(e.wbrels,-1,"sharedStrings."+r,it.SST)),a="xl/workbook."+r,rt(i,a,YW(t,a)),s.workbooks.push(a),It(e.rels,1,a,it.WB),a="xl/theme/theme1.xml",rt(i,a,Jx(t.Themes,e)),s.themes.push(a),It(e.wbrels,-1,"theme/theme1.xml",it.THEME),a="xl/styles."+r,rt(i,a,ZW(t,a,e)),s.styles.push(a),It(e.wbrels,-1,"styles."+r,it.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",rt(i,a,t.vbaraw),s.vba.push(a),It(e.wbrels,-1,"vbaProject.bin",it.VBA)),a="xl/metadata."+r,rt(i,a,rz(a)),s.metadata.push(a),It(e.wbrels,-1,"metadata."+r,it.XLMETA),rt(i,"[Content_Types].xml",Rb(s,e)),rt(i,"_rels/.rels",Nl(e.rels)),rt(i,"xl/_rels/workbook."+r+".rels",Nl(e.wbrels)),delete e.revssf,delete e.ssf,i}function kH(t,e){gl=1024,t&&!t.SSF&&(t.SSF=Ht(He)),t&&t.SSF&&(lc(),Ld(t.SSF),e.revssf=jd(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,c0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=v3.indexOf(e.bookType)>-1,s=Gx();ov(e=e||{});var i=Px(),a="",o=0;if(e.cellXfs=[],Ba(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",rt(i,a,Lb(t.Props,e)),s.coreprops.push(a),It(e.rels,2,a,it.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,rt(i,a,Ob(t.Props)),s.extprops.push(a),It(e.rels,3,a,it.EXT_PROPS),t.Custprops!==t.Props&&ar(t.Custprops||{}).length>0&&(a="docProps/custom.xml",rt(i,a,Mb(t.Custprops)),s.custprops.push(a),It(e.rels,4,a,it.CUST_PROPS));var h=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var d={"!id":{}},m=t.Sheets[t.SheetNames[o-1]],p=(m||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,rt(i,a,A3(o-1,e,t,d)),s.sheets.push(a),It(e.wbrels,-1,"worksheets/sheet"+o+"."+r,it.WS[0])}if(m){var x=m["!comments"],g=!1,y="";if(x&&x.length>0){var w=!1;x.forEach(function(E){E[1].forEach(function(_){_.T==!0&&(w=!0)})}),w&&(y="xl/threadedComments/threadedComment"+o+"."+r,rt(i,y,IB(x,h,e)),s.threadedcomments.push(y),It(d,-1,"../threadedComments/threadedComment"+o+"."+r,it.TCMNT)),y="xl/comments"+o+"."+r,rt(i,y,x3(x)),s.comments.push(y),It(d,-1,"../comments"+o+"."+r,it.CMNT),g=!0}m["!legacy"]&&g&&rt(i,"xl/drawings/vmlDrawing"+o+".vml",g3(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}d["!id"].rId1&&rt(i,H0(a),Nl(d))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,rt(i,a,s3(e.Strings,e)),s.strs.push(a),It(e.wbrels,-1,"sharedStrings."+r,it.SST)),a="xl/workbook."+r,rt(i,a,L3(t)),s.workbooks.push(a),It(e.rels,1,a,it.WB),a="xl/theme/theme1.xml",rt(i,a,Jx(t.Themes,e)),s.themes.push(a),It(e.wbrels,-1,"theme/theme1.xml",it.THEME),a="xl/styles."+r,rt(i,a,f3(t,e)),s.styles.push(a),It(e.wbrels,-1,"styles."+r,it.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",rt(i,a,t.vbaraw),s.vba.push(a),It(e.wbrels,-1,"vbaProject.bin",it.VBA)),a="xl/metadata."+r,rt(i,a,p3()),s.metadata.push(a),It(e.wbrels,-1,"metadata."+r,it.XLMETA),h.length>1&&(a="xl/persons/person.xml",rt(i,a,PB(h)),s.people.push(a),It(e.wbrels,-1,"persons/person.xml",it.PEOPLE)),rt(i,"[Content_Types].xml",Rb(s,e)),rt(i,"_rels/.rels",Nl(e.rels)),rt(i,"xl/_rels/workbook."+r+".rels",Nl(e.wbrels)),delete e.revssf,delete e.ssf,i}function lv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=qn(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function TH(t,e){return Me.find(t,"EncryptedPackage")?wH(t,e):M3(t,e)}function SH(t,e){var r,n=t,s=e||{};return s.type||(s.type=nt&&Buffer.isBuffer(t)?"buffer":"base64"),r=ab(n,s),yH(r,s)}function G3(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Sg(t.slice(r),e);default:break e}return ql.to_workbook(t,e)}function bH(t,e){var r="",n=lv(t,e);switch(e.type){case"base64":r=qn(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=To(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Dt(r)),e.type="binary",G3(r,e)}function CH(t,e){var r=t;return e.type=="base64"&&(r=qn(r)),r=ta.utils.decode(1200,r.slice(2),"str"),e.type="binary",G3(r,e)}function NH(t){return t.match(/[^\x00-\x7F]/)?Ks(t):t}function Xm(t,e,r,n){return n?(r.type="string",ql.to_workbook(t,r)):ql.to_workbook(e,r)}function Ng(t,e){Cx();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Ng(new Uint8Array(t),(r=Ht(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Il={},r.dateNF&&(Il.dateNF=r.dateNF),r.type||(r.type=nt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=nt?"buffer":"binary",n=kL(t),typeof Uint8Array<"u"&&!nt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=NH(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=Ht(r),r.type="array",Ng(Nx(n),r)}switch((s=lv(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return TH(Me.read(n,r),r);break;case 9:if(s[1]<=8)return M3(n,r);break;case 60:return Sg(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return FO(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return r3.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?SH(n,r):Xm(t,n,r,i);case 239:return s[3]===60?Sg(n,r):Xm(t,n,r,i);case 255:if(s[1]===254)return CH(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return lo.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return lo.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Tg.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return c3.to_workbook(n,r);break;case 10:case 13:case 32:return bH(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return PO.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Tg.to_workbook(n,r):Xm(t,n,r,i)}function K3(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return yu(e.file,Me.write(t,{type:nt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Me.write(t,e)}function AH(t,e){var r=Ht(e||{}),n=_H(t,r);return IH(n,r)}function IH(t,e){var r={},n=nt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var s=t.FullPaths?Me.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(e.type=="binary"||e.type=="base64")return s;s=new Uint8Array(Fd(s))}return e.password&&typeof encrypt_agile<"u"?K3(encrypt_agile(s,e.password),e):e.type==="file"?yu(e.file,s):e.type=="string"?Dt(s):s}function RH(t,e){var r=e||{},n=Nz(t,r);return K3(n,r)}function Ws(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return V0(Ks(n));case"binary":return Ks(n);case"string":return t;case"file":return yu(e.file,n,"utf8");case"buffer":return nt?Mi(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ws(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function PH(t,e){switch(e.type){case"base64":return V0(t);case"binary":return t;case"string":return t;case"file":return yu(e.file,t,"binary");case"buffer":return nt?Mi(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function xh(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?V0(r):e.type=="string"?Dt(r):r;case"file":return yu(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function q3(t,e){Cx(),TW(t);var r=Ht(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=q3(t,r);return r.type="array",Fd(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=t.SheetNames.indexOf(r.sheet),!t.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ws(_z(t,r),r);case"slk":case"sylk":return Ws(t3.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"htm":case"html":return Ws(V3(t.Sheets[t.SheetNames[s]],r),r);case"txt":return PH(X3(t.Sheets[t.SheetNames[s]],r),r);case"csv":return Ws(cv(t.Sheets[t.SheetNames[s]],r),r,"\uFEFF");case"dif":return Ws(r3.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"dbf":return xh(Tg.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"prn":return Ws(ql.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"rtf":return Ws(c3.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"eth":return Ws(n3.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"fods":return Ws(z3(t,r),r);case"wk1":return xh(lo.sheet_to_wk1(t.Sheets[t.SheetNames[s]],r),r);case"wk3":return xh(lo.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),xh(B3(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),RH(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return AH(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function FH(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function LH(t,e,r){var n=r||{};return n.type="file",n.file=e,FH(n),q3(t,n)}function DH(t,e,r,n,s,i,a,o){var l=fr(r),u=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,m=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!a||t[r])for(var p=e.s.c;p<=e.e.c;++p){var x=a?t[r][p]:t[n[p]+l];if(x===void 0||x.t===void 0){if(u===void 0)continue;i[p]!=null&&(m[i[p]]=u);continue}var g=x.v;switch(x.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[p]!=null){if(g==null)if(x.t=="e"&&g===null)m[i[p]]=null;else if(u!==void 0)m[i[p]]=u;else if(h&&g===null)m[i[p]]=null;else continue;else m[i[p]]=h&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?g:Di(x,g,o);g!=null&&(d=!1)}}return{row:m,isempty:d}}function zf(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},h=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof h){case"string":l=gt(h);break;case"number":l=gt(t["!ref"]),l.s.r=h;break;default:l=h}n>0&&(s=0);var d=fr(l.s.r),m=[],p=[],x=0,g=0,y=Array.isArray(t),w=l.s.r,E=0,_={};y&&!t[w]&&(t[w]=[]);var N=u.skipHidden&&t["!cols"]||[],j=u.skipHidden&&t["!rows"]||[];for(E=l.s.c;E<=l.e.c;++E)if(!(N[E]||{}).hidden)switch(m[E]=Xt(E),r=y?t[w][E]:t[m[E]+d],n){case 1:i[E]=E-l.s.c;break;case 2:i[E]=m[E];break;case 3:i[E]=u.header[E-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Di(r,null,u),g=_[a]||0,!g)_[a]=1;else{do o=a+"_"+g++;while(_[o]);_[a]=g,_[o]=1}i[E]=o}for(w=l.s.r+s;w<=l.e.r;++w)if(!(j[w]||{}).hidden){var D=DH(t,l,w,m,n,i,y,u);(D.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[x++]=D.row)}return p.length=x,p}var D_=/"/g;function jH(t,e,r,n,s,i,a,o){for(var l=!0,u=[],h="",d=fr(r),m=e.s.c;m<=e.e.c;++m)if(n[m]){var p=o.dense?(t[r]||[])[m]:t[n[m]+d];if(p==null)h="";else if(p.v!=null){l=!1,h=""+(o.rawNumbers&&p.t=="n"?p.v:Di(p,null,o));for(var x=0,g=0;x!==h.length;++x)if((g=h.charCodeAt(x))===s||g===i||g===34||o.forceQuotes){h='"'+h.replace(D_,'""')+'"';break}h=="ID"&&(h='"ID"')}else p.f!=null&&!p.F?(l=!1,h="="+p.f,h.indexOf(",")>=0&&(h='"'+h.replace(D_,'""')+'"')):h="";u.push(h)}return o.blankrows===!1&&l?null:u.join(a)}function cv(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=gt(t["!ref"]),i=n.FS!==void 0?n.FS:",",a=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),h="",d=[];n.dense=Array.isArray(t);for(var m=n.skipHidden&&t["!cols"]||[],p=n.skipHidden&&t["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(m[x]||{}).hidden||(d[x]=Xt(x));for(var g=0,y=s.s.r;y<=s.e.r;++y)(p[y]||{}).hidden||(h=jH(t,s,y,d,a,l,i,n),h!=null&&(n.strip&&(h=h.replace(u,"")),(h||n.blankrows!==!1)&&r.push((g++?o:"")+h)));return delete n.dense,r.join("")}function X3(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=cv(t,e);return r}function OH(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=gt(t["!ref"]),i="",a=[],o,l=[],u=Array.isArray(t);for(o=s.s.c;o<=s.e.c;++o)a[o]=Xt(o);for(var h=s.s.r;h<=s.e.r;++h)for(i=fr(h),o=s.s.c;o<=s.e.c;++o)if(e=a[o]+i,r=u?(t[h]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function Q3(t,e,r){var n=r||{},s=+!n.skipHeader,i=t||{},a=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Qt(n.origin):n.origin;a=l.r,o=l.c}var u,h={s:{c:0,r:0},e:{c:o,r:a+e.length-1+s}};if(i["!ref"]){var d=gt(i["!ref"]);h.e.c=Math.max(h.e.c,d.e.c),h.e.r=Math.max(h.e.r,d.e.r),a==-1&&(a=d.e.r+1,h.e.r=a+e.length-1+s)}else a==-1&&(a=0,h.e.r=e.length-1+s);var m=n.header||[],p=0;e.forEach(function(g,y){ar(g).forEach(function(w){(p=m.indexOf(w))==-1&&(m[p=m.length]=w);var E=g[w],_="z",N="",j=Ge({c:o+p,r:a+y+s});u=J0(i,j),E&&typeof E=="object"&&!(E instanceof Date)?i[j]=E:(typeof E=="number"?_="n":typeof E=="boolean"?_="b":typeof E=="string"?_="s":E instanceof Date?(_="d",n.cellDates||(_="n",E=Ar(E)),N=n.dateNF||He[14]):E===null&&n.nullError&&(_="e",E=0),u?(u.t=_,u.v=E,delete u.w,delete u.R,N&&(u.z=N)):i[j]=u={t:_,v:E},N&&(u.z=N))})}),h.e.c=Math.max(h.e.c,o+m.length-1);var x=fr(a);if(s)for(p=0;p<m.length;++p)i[Xt(p+o)+x]={t:"s",v:m[p]};return i["!ref"]=tt(h),i}function MH(t,e){return Q3(null,t,e)}function J0(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Qt(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?J0(t,Ge(e)):J0(t,Ge({r:e,c:r||0}))}function BH(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function uv(){return{SheetNames:[],Sheets:{}}}function hv(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var a=i&&i[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=a+s)!=-1;++s);}if(F3(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function VH(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=BH(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function UH(t,e){return t.z=e,t}function Y3(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function $H(t,e,r){return Y3(t,"#"+e,r)}function WH(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function zH(t,e,r,n){for(var s=typeof e!="string"?e:gt(e),i=typeof e=="string"?e:tt(e),a=s.s.r;a<=s.e.r;++a)for(var o=s.s.c;o<=s.e.c;++o){var l=J0(t,a,o);l.t="n",l.F=i,delete l.v,a==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Bh={encode_col:Xt,encode_row:fr,encode_cell:Ge,encode_range:tt,decode_col:Vx,decode_row:Bx,split_cell:eD,decode_cell:Qt,decode_range:On,format_cell:Di,sheet_add_aoa:Tb,sheet_add_json:Q3,sheet_add_dom:U3,aoa_to_sheet:cc,json_to_sheet:MH,table_to_sheet:$3,table_to_book:Qz,sheet_to_csv:cv,sheet_to_txt:X3,sheet_to_json:zf,sheet_to_html:V3,sheet_to_formulae:OH,sheet_to_row_object_array:zf,sheet_get_cell:J0,book_new:uv,book_append_sheet:hv,book_set_sheet_visibility:VH,cell_set_number_format:UH,cell_set_hyperlink:Y3,cell_set_internal_link:$H,cell_add_comment:WH,sheet_set_array_formula:zH,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const HH=async()=>{try{const t=new Gs;t.setCustomParameters({prompt:"select_account"});const r=(await ES(St,t)).user;return r&&(await Gl(r.uid,{displayName:r.displayName,email:r.email,phoneNumber:r.phoneNumber||"",photoURL:r.photoURL,role:"fuser",emailVerified:r.emailVerified,lastLogin:new Date}),await Pd(r.uid,{isLoggedIn:!0,lastLogin:new Date})),{success:!0,user:r}}catch(t){console.error("Google login error:",t);let e="Đăng nhập bằng Google thất bại. Vui lòng thử lại.";return t.code==="auth/popup-blocked"?e="Popup đăng nhập bị chặn. Vui lòng cho phép popup và thử lại.":t.code==="auth/popup-closed-by-user"?e="Cửa sổ đăng nhập đã đóng. Vui lòng thử lại.":t.code==="auth/cancelled-popup-request"?e="Yêu cầu đăng nhập đã bị hủy. Vui lòng thử lại.":t.code==="auth/internal-error"&&(e="Có lỗi xảy ra trong quá trình đăng nhập. Vui lòng thử lại sau."),{success:!1,error:e}}},GH=async(t,e)=>{try{const n=(await AF(St,t,e)).user;return n&&await Pd(n.uid,{isLoggedIn:!0,lastLogin:new Date}),{success:!0,user:n}}catch(r){console.error("Email login error:",r);let n="Đăng nhập thất bại. Vui lòng kiểm tra email và mật khẩu.";return r.code==="auth/user-not-found"||r.code==="auth/wrong-password"?n="Email hoặc mật khẩu không chính xác.":r.code==="auth/too-many-requests"&&(n="Quá nhiều yêu cầu đăng nhập. Vui lòng thử lại sau."),{success:!1,error:n}}},KH=async()=>{try{const t=St.currentUser;return t&&await Pd(t.uid,{isLoggedIn:!1,lastLogout:new Date}),await fS(St),{success:!0}}catch(t){return console.error("Logout error:",t),{success:!1,error:t.message||"Có lỗi khi đăng xuất"}}},Wo=({title:t})=>{const{isDarkMode:e,toggleDarkMode:r}=Mr();Yn();const n=Or(),[s]=vn(St),[i,a]=F.useState(!1),[o,l]=F.useState(!1),u=F.useRef(null),h=async()=>{try{a(!1),await KH()}catch(m){console.error("Error during logout:",m)}},d=()=>{a(!1),n("/profile")};return F.useEffect(()=>{const m=p=>{u.current&&!u.current.contains(p.target)&&a(!1)};return document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[]),c.jsxs("header",{className:`${e?"bg-gray-900 border-gray-700 text-white":"bg-slate-50 border-gray-200 text-gray-900"} px-6 py-3 flex items-center justify-between border-b sticky top-0 z-10 shadow-md border-l-0`,children:[c.jsx("div",{className:"flex items-center",children:c.jsx("h1",{className:`text-xl font-bold ${e?"text-white":"text-gray-900"}`,children:t||"Tài liệu HOU"})}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{onClick:()=>l(!0),className:`p-2 rounded-full ${e?"hover:bg-gray-700 text-gray-300":"hover:bg-gray-100 text-gray-900"} transition-colors`,"aria-label":"Tùy chỉnh giao diện",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})})}),s?c.jsxs("div",{className:"relative",ref:u,children:[c.jsxs("button",{onClick:()=>a(!i),className:`flex items-center gap-2 px-3 py-2 rounded-md transition-colors ${e?"hover:bg-gray-700 text-white":"hover:bg-gray-100 text-gray-900"}`,children:[c.jsx("div",{className:`w-8 h-8 rounded-full ${e?"bg-gray-700 text-gray-300":"bg-gray-200 text-gray-600"} flex items-center justify-center`,children:s.photoURL?c.jsx("img",{src:s.photoURL,className:"w-8 h-8 rounded-full",alt:s.displayName||"Ảnh đại diện"}):c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})}),c.jsx("span",{className:"font-medium",children:s.displayName?s.displayName.split(" ")[0]:"Tài khoản"}),c.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),i&&c.jsxs("div",{className:`absolute right-0 mt-2 w-48 py-1 rounded-md shadow-lg z-10 border-2 ${e?"bg-gray-800 border-gray-700":"bg-white border-gray-300"}`,style:{backdropFilter:"blur(0px)",backgroundColor:e?"#1f2937":"#ffffff"},children:[c.jsxs("button",{onClick:d,className:`block w-full text-left px-4 py-2 text-sm ${e?"text-gray-300 hover:bg-gray-700":"text-gray-700 hover:bg-gray-100"}`,children:[c.jsx("svg",{className:"w-4 h-4 inline mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Tài khoản của tôi"]}),c.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 my-1"}),c.jsxs("button",{onClick:h,className:`block w-full text-left px-4 py-2 text-sm ${e?"text-gray-300 hover:bg-gray-700":"text-gray-700 hover:bg-gray-100"}`,children:[c.jsx("svg",{className:"w-4 h-4 inline mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Đăng xuất"]})]})]}):c.jsxs("button",{onClick:()=>n("/login"),className:`px-2 py-1 rounded-full transition-colors flex items-center gap-1 ${e?"hover:bg-gray-700 text-white":"hover:bg-gray-100 text-gray-900"}`,children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-6-3a2 2 0 11-4 0 2 2 0 014 0zm-2 4a5 5 0 00-4.546 2.916A5.986 5.986 0 0010 16a5.986 5.986 0 004.546-2.084A5 5 0 0010 11z",clipRule:"evenodd"})}),c.jsx("span",{className:"text-sm",children:"Đăng nhập"})]})]}),c.jsx(ja,{isOpen:o,onClose:()=>l(!1)})]})},J3=({isOpen:t,onClose:e,onSubmit:r,formData:n,formErrors:s,loading:i,onChange:a})=>{const o=F.useRef(null);if(F.useEffect(()=>{if(!t)return;const u=h=>{o.current&&!o.current.contains(h.target)&&e()};return document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[t,e]),!t)return null;const l="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500";return c.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-80",children:c.jsxs("div",{ref:o,className:"bg-white text-gray-800 rounded-lg shadow-xl p-6 w-[95%] mx-auto border-2 border-gray-300 md:w-[80%]",style:{background:"#ffffff"},children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h3",{className:"text-lg font-medium",children:"Thêm tài khoản mới"}),c.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("form",{onSubmit:r,className:"space-y-4",children:[c.jsxs("div",{className:"md:flex md:space-x-4 md:space-y-0 space-y-4",children:[c.jsxs("div",{className:"md:w-1/2",children:[c.jsx("label",{className:"block text-sm font-medium mb-1 text-gray-700",children:"Họ và tên"}),c.jsx("input",{type:"text",name:"fullName",value:n.fullName,onChange:a,className:`${l} ${s.fullName?"border-red-500":""}`,placeholder:"Nhập họ và tên"}),s.fullName&&c.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.fullName})]}),c.jsxs("div",{className:"md:w-1/2",children:[c.jsx("label",{className:"block text-sm font-medium mb-1 text-gray-700",children:"Email"}),c.jsx("input",{type:"email",name:"email",value:n.email,onChange:a,className:`${l} ${s.email?"border-red-500":""}`,placeholder:"Nhập địa chỉ email"}),s.email&&c.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.email})]})]}),c.jsxs("div",{className:"md:flex md:space-x-4 md:space-y-0 space-y-4",children:[c.jsxs("div",{className:"md:w-1/2",children:[c.jsx("label",{className:"block text-sm font-medium mb-1 text-gray-700",children:"Số điện thoại"}),c.jsx("input",{type:"text",name:"phone",value:n.phone,onChange:a,className:`${l} ${s.phone?"border-red-500":""}`,placeholder:"Nhập số điện thoại"}),s.phone&&c.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.phone})]}),c.jsxs("div",{className:"md:w-1/2",children:[c.jsx("label",{className:"block text-sm font-medium mb-1 text-gray-700",children:"Vai trò"}),c.jsxs("select",{name:"role",value:n.role,onChange:a,className:l,children:[c.jsx("option",{value:"fuser",children:"Người dùng miễn phí"}),c.jsx("option",{value:"puser",children:"Người dùng trả phí"}),c.jsx("option",{value:"admin",children:"Quản trị viên"})]})]})]}),c.jsxs("div",{className:"md:flex md:space-x-4 md:space-y-0 space-y-4",children:[c.jsxs("div",{className:"md:w-1/2",children:[c.jsx("label",{className:"block text-sm font-medium mb-1 text-gray-700",children:"Mật khẩu"}),c.jsx("input",{type:"password",name:"password",value:n.password,onChange:a,className:`${l} ${s.password?"border-red-500":""}`,placeholder:"Nhập mật khẩu"}),s.password&&c.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.password})]}),c.jsxs("div",{className:"md:w-1/2",children:[c.jsx("label",{className:"block text-sm font-medium mb-1 text-gray-700",children:"Xác nhận mật khẩu"}),c.jsx("input",{type:"password",name:"confirmPassword",value:n.confirmPassword,onChange:a,className:`${l} ${s.confirmPassword?"border-red-500":""}`,placeholder:"Nhập lại mật khẩu"}),s.confirmPassword&&c.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.confirmPassword})]})]}),c.jsxs("div",{className:"flex justify-end gap-3 pt-4 mt-4 border-t border-gray-200",children:[c.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 rounded-md text-sm font-medium bg-gray-200 hover:bg-gray-300 text-gray-800 transition-colors",disabled:i,children:"Hủy"}),c.jsx("button",{type:"submit",className:"px-4 py-2 rounded-md text-sm font-medium bg-green-600 hover:bg-green-700 text-white transition-colors",disabled:i,children:i?c.jsxs("span",{className:"flex items-center",children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Đang tạo..."]}):"Tạo tài khoản"})]})]})]})})},qH=()=>{Or();const[t,e]=F.useState([]),[r,n]=F.useState(!0),[s,i]=F.useState(""),[a,o]=F.useState(""),{isDarkMode:l}=Mr();Yn();const[u]=vn(St),[h,d]=F.useState(!1),[m,p]=F.useState(!1),[x,g]=F.useState(null),[y,w]=F.useState(!1),[E,_]=F.useState(""),[N,j]=F.useState(""),[D,k]=F.useState({email:"",password:"",confirmPassword:"",fullName:"",phone:"",role:"fuser"}),[S,b]=F.useState({}),[C,A]=F.useState(!1),[I,P]=F.useState([]),[ue,de]=F.useState({}),[ie,ge]=F.useState(null),[ne,K]=F.useState(null),[fe,_e]=F.useState(0),[B,q]=F.useState(!1),[H,G]=F.useState(""),[J,ae]=F.useState(typeof window<"u"?window.innerWidth:0),[re,he]=F.useState(!1);F.useEffect(()=>{if(typeof window>"u")return;const ye=()=>{ae(window.innerWidth)};return window.addEventListener("resize",ye),ye(),()=>{window.removeEventListener("resize",ye)}},[]),F.useEffect(()=>{(async()=>{try{n(!0);const De=await PS();e(De)}catch(De){console.error("Lỗi khi lấy danh sách người dùng:",De),i("Không thể tải danh sách người dùng. Vui lòng thử lại sau.")}finally{n(!1)}})()},[]);const oe=async(ye,De)=>{try{o(""),i(""),await FS(ye,De),e(st=>st.map(bt=>bt.id===ye?{...bt,role:De}:bt)),o("Cập nhật vai trò người dùng thành công!"),setTimeout(()=>o(""),3e3)}catch(st){console.error("Lỗi khi cập nhật vai trò người dùng:",st),i("Không thể cập nhật vai trò người dùng. Vui lòng thử lại sau."),setTimeout(()=>i(""),3e3)}},Pe=ye=>{switch(ye){case"admin":return"Quản trị viên";case"puser":return"Người dùng trả phí";case"fuser":return"Người dùng miễn phí";default:return"Không xác định"}},W=ye=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(ye),$e=ye=>/^[0-9]{10}$/.test(ye),Oe=ye=>{const{name:De,value:st}=ye.target;k({...D,[De]:st}),S[De]&&b({...S,[De]:""})},We=async ye=>{ye.preventDefault(),b({}),i("");const De={};if(D.fullName.trim()||(De.fullName="Vui lòng nhập họ và tên"),D.phone.trim()?$e(D.phone)||(De.phone="Số điện thoại phải có đúng 10 chữ số"):De.phone="Vui lòng nhập số điện thoại",D.email.trim()?W(D.email)||(De.email="Định dạng email không hợp lệ"):De.email="Vui lòng nhập email",D.password?D.password.length<6&&(De.password="Mật khẩu phải có ít nhất 6 ký tự"):De.password="Vui lòng nhập mật khẩu",D.password!==D.confirmPassword&&(De.confirmPassword="Mật khẩu xác nhận không khớp"),Object.keys(De).length>0){b(De);return}A(!0);try{const st=await yx(St,D.email,D.password);await Ad(st.user,{displayName:D.fullName}),await Gl(st.user.uid,{email:D.email,displayName:D.fullName,phoneNumber:D.phone,role:D.role,photoURL:null}),e([...t,{id:st.user.uid,email:D.email,displayName:D.fullName,phoneNumber:D.phone,role:D.role,photoURL:null}]),k({email:"",password:"",confirmPassword:"",fullName:"",phone:"",role:"fuser"}),d(!1),o("Thêm người dùng thành công!"),setTimeout(()=>o(""),3e3)}catch(st){console.error("Lỗi khi tạo tài khoản:",st),st.code==="auth/email-already-in-use"?i("Email đã được sử dụng. Vui lòng dùng email khác."):i("Không thể tạo tài khoản. Vui lòng thử lại sau."),setTimeout(()=>i(""),3e3)}finally{A(!1)}},Ue=async ye=>{try{w(!0),await LS(ye),e(t.filter(De=>De.id!==ye)),_("Xóa người dùng thành công!"),setTimeout(()=>{g(null),p(!1),_("")},1500)}catch(De){console.error("Lỗi khi xóa người dùng:",De),j("Không thể xóa người dùng. Vui lòng thử lại sau.")}finally{w(!1)}},Te=ye=>{g(ye),p(!0),_(""),j("")},Ae=`block w-full px-3 py-2 border ${l?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"} rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500`;return r?c.jsx("div",{className:`min-h-screen flex items-center justify-center ${l?"bg-gray-900 text-white":"bg-slate-50 text-gray-800"}`,children:c.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-green-500"})}):c.jsxs("div",{className:`flex flex-col min-h-screen ${l?"bg-gray-900":"bg-slate-100"}`,children:[J<770&&c.jsx(ac,{selectedCategory:{title:"Quản trị"},selectedDocument:{title:"Quản lý người dùng"},setIsSidebarOpen:q,isDarkMode:l}),c.jsxs("div",{className:"flex min-h-screen relative",children:[c.jsx(ic,{sidebarData:I,documents:ue,openMain:fe,setOpenMain:_e,selectedCategory:ie,selectedDocument:ne,setSelectedDocument:K,setSearch:G,setDocuments:de,isOpen:B,setIsOpen:q}),c.jsxs("div",{className:`flex flex-col flex-1 ${l?"bg-gray-900":"bg-slate-50"}`,children:[J>=770&&c.jsx(Wo,{title:"Quản lý người dùng"}),c.jsxs("div",{className:"flex flex-col flex-1 p-6",children:[c.jsx("div",{className:"mb-6",children:c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[c.jsxs("div",{children:[c.jsx("nav",{className:"text-sm mb-2",children:c.jsxs("ol",{className:"list-none p-0 inline-flex",children:[c.jsxs("li",{className:"flex items-center",children:[c.jsx("span",{className:l?"text-gray-400":"text-gray-500",children:"Quản trị"}),c.jsx("svg",{className:"h-4 w-4 mx-2 fill-current",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})]}),c.jsx("li",{children:c.jsx("span",{className:`font-medium ${l?"text-white":"text-gray-800"}`,children:"Quản lý người dùng"})})]})}),c.jsx("h1",{className:`text-2xl font-bold ${l?"text-white":"text-gray-900"}`,children:"Quản lý người dùng"}),c.jsx("p",{className:`mt-1 text-sm ${l?"text-gray-400":"text-gray-500"}`,children:"Quản lý vai trò và thông tin của người dùng trong hệ thống"})]}),c.jsx("div",{children:c.jsxs("button",{onClick:()=>d(!0),className:`inline-flex items-center px-4 py-2 rounded-md text-sm font-medium ${l?"bg-green-700 hover:bg-green-600 text-white":"bg-green-600 hover:bg-green-700 text-white"} transition-colors shadow-sm`,children:[c.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Thêm tài khoản mới"]})})]})}),s&&c.jsx("div",{className:`px-4 py-3 rounded-md border ${l?"bg-red-900/30 border-red-800 text-red-300":"bg-red-100 border-red-400 text-red-700"} mb-4`,children:c.jsx("span",{children:s})}),a&&c.jsx("div",{className:`px-4 py-3 rounded-md border ${l?"bg-green-900/30 border-green-800 text-green-300":"bg-green-100 border-green-400 text-green-700"} mb-4`,children:c.jsx("span",{children:a})}),c.jsx(J3,{isOpen:h,onClose:()=>d(!1),onSubmit:We,formData:D,formErrors:S,loading:C,onChange:Oe}),c.jsxs("div",{className:`rounded-lg shadow-md overflow-hidden ${l?"bg-gray-800 border border-gray-700":"bg-white"}`,children:[c.jsxs("div",{className:`px-6 py-4 ${l?"bg-gray-700/50 border-b border-gray-700":"bg-gray-50 border-b border-gray-200"}`,children:[c.jsx("h3",{className:`text-lg font-medium ${l?"text-gray-100":"text-gray-900"}`,children:"Danh sách người dùng"}),c.jsxs("p",{className:`mt-1 text-sm ${l?"text-gray-400":"text-gray-500"}`,children:["Hiển thị ",t.length," người dùng trong hệ thống"]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:`min-w-full divide-y ${l?"divide-gray-700":"divide-gray-200"}`,children:[c.jsx("thead",{children:c.jsxs("tr",{className:l?"bg-gray-700/30":"bg-gray-50",children:[c.jsx("th",{scope:"col",className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${l?"text-gray-300":"text-gray-500"}`,children:"Người dùng"}),c.jsx("th",{scope:"col",className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${l?"text-gray-300":"text-gray-500"}`,children:"Email"}),c.jsx("th",{scope:"col",className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${l?"text-gray-300":"text-gray-500"}`,children:"Vai trò"}),c.jsx("th",{scope:"col",className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${l?"text-gray-300":"text-gray-500"}`,children:"Thao tác"}),c.jsx("th",{scope:"col",className:`px-6 py-3 text-center text-xs font-medium uppercase tracking-wider ${l?"text-gray-300":"text-gray-500"}`,children:"Xóa"})]})}),c.jsx("tbody",{className:`divide-y ${l?"divide-gray-700":"divide-gray-200"}`,children:t.length>0?t.map(ye=>c.jsxs("tr",{className:l?"hover:bg-gray-700/30":"hover:bg-gray-50",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex items-center",children:[ye.photoURL?c.jsx("img",{className:"h-10 w-10 rounded-full mr-3",src:ye.photoURL,alt:""}):c.jsx("div",{className:`h-10 w-10 rounded-full flex items-center justify-center mr-3 ${l?"bg-gray-700":"bg-gray-200"}`,children:c.jsx("span",{className:`text-lg font-medium ${l?"text-gray-200":"text-gray-600"}`,children:ye.displayName?ye.displayName.charAt(0).toUpperCase():"?"})}),c.jsxs("div",{children:[c.jsx("div",{className:`text-sm font-medium ${l?"text-white":"text-gray-900"}`,children:ye.displayName||"Không có tên"}),c.jsx("div",{className:`text-sm ${l?"text-gray-400":"text-gray-500"}`,children:ye.phoneNumber||"Chưa cập nhật SĐT"})]})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("div",{className:`text-sm ${l?"text-gray-200":"text-gray-900"}`,children:ye.email})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${ye.role==="admin"?`${l?"bg-purple-900 text-purple-200":"bg-purple-100 text-purple-800"}`:ye.role==="puser"?`${l?"bg-green-900 text-green-200":"bg-green-100 text-green-800"}`:`${l?"bg-blue-900 text-blue-200":"bg-blue-100 text-blue-800"}`}`,children:Pe(ye.role)})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:c.jsxs("select",{value:ye.role||"fuser",onChange:De=>oe(ye.id,De.target.value),className:`${Ae} text-sm py-1`,children:[c.jsx("option",{value:"fuser",children:"Người dùng miễn phí"}),c.jsx("option",{value:"puser",children:"Người dùng trả phí"}),c.jsx("option",{value:"admin",children:"Quản trị viên"})]})}),"                          ",c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-center",children:c.jsxs("button",{onClick:()=>Te(ye),disabled:ye.id===(u==null?void 0:u.uid),className:`inline-flex items-center p-1.5 rounded-md ${ye.id===(u==null?void 0:u.uid)?`${l?"text-gray-600 cursor-not-allowed":"text-gray-400 cursor-not-allowed"}`:`${l?"text-red-400 hover:bg-gray-700 hover:text-red-300":"text-red-600 hover:bg-gray-100 hover:text-red-700"}`}`,title:ye.id===(u==null?void 0:u.uid)?"Không thể xóa tài khoản đang đăng nhập":"Xóa người dùng",children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})]})})]},ye.id)):c.jsx("tr",{children:c.jsxs("td",{colSpan:"5",className:`px-6 py-10 text-center ${l?"text-gray-400":"text-gray-500"}`,children:[c.jsx("svg",{className:"mx-auto h-12 w-12 mb-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),c.jsx("span",{className:"block font-medium text-sm mb-1",children:"Không có dữ liệu người dùng"}),c.jsx("span",{className:"text-xs",children:"Chưa có người dùng nào trong hệ thống"})]})})})]})})]})]})]})]}),c.jsx(ja,{isOpen:re,onClose:()=>he(!1)}),m&&c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:c.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-70"})}),c.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),c.jsxs("div",{className:`inline-block align-bottom rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full ${l?"bg-gray-700 border border-gray-600":"bg-gray-50 border border-gray-200"}`,children:[c.jsx("div",{className:`px-6 py-4 border-b ${l?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h3",{className:`text-lg font-medium ${l?"text-white":"text-gray-900"}`,children:"Xác nhận xóa người dùng"}),c.jsx("button",{type:"button",className:`rounded-md p-1 focus:outline-none ${l?"text-gray-400 hover:text-gray-200":"text-gray-500 hover:text-gray-700"}`,onClick:()=>p(!1),children:c.jsx("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),c.jsx("div",{className:`px-6 py-5 ${l?"bg-gray-700 text-gray-200":"bg-gray-50 text-gray-800"}`,children:E?c.jsx("div",{className:`p-3 mb-4 text-sm rounded-md ${l?"bg-green-900/30 text-green-300 border border-green-800":"bg-green-50 text-green-700 border border-green-200"}`,children:c.jsxs("div",{className:"flex",children:[c.jsx("svg",{className:"h-5 w-5 mr-2 text-green-400 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),c.jsx("span",{children:E})]})}):c.jsxs("form",{children:[c.jsxs("div",{className:"mb-5",children:[c.jsx("label",{htmlFor:"delete-name",className:`block text-sm font-medium mb-1 ${l?"text-gray-300":"text-gray-700"}`,children:"Tên người dùng"}),c.jsx("input",{type:"text",id:"delete-name",value:(x==null?void 0:x.displayName)||"Không có tên",readOnly:!0,className:`w-full px-3 py-2 border rounded-md shadow-sm ${l?"bg-gray-600 border-gray-500 text-white":"bg-gray-100 border-gray-300 text-gray-700"}`})]}),c.jsxs("div",{className:"mb-5",children:[c.jsx("label",{htmlFor:"delete-email",className:`block text-sm font-medium mb-1 ${l?"text-gray-300":"text-gray-700"}`,children:"Email"}),c.jsx("input",{type:"text",id:"delete-email",value:(x==null?void 0:x.email)||"",readOnly:!0,className:`w-full px-3 py-2 border rounded-md shadow-sm ${l?"bg-gray-600 border-gray-500 text-white":"bg-gray-100 border-gray-300 text-gray-700"}`})]}),c.jsx("div",{className:`p-3 mb-5 text-sm rounded-md border ${l?"bg-red-900/30 text-red-300 border-red-800":"bg-red-50 text-red-700 border-red-200"}`,children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("svg",{className:"h-5 w-5 mr-2 text-red-400 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v3a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),c.jsx("span",{className:"font-medium",children:"Cảnh báo: "}),c.jsx("span",{className:"ml-1",children:"Thao tác này sẽ xóa vĩnh viễn tài khoản người dùng khỏi hệ thống!"})]})}),N&&c.jsx("div",{className:`p-3 mb-4 text-sm rounded-md ${l?"bg-red-900/30 text-red-300 border border-red-800":"bg-red-50 text-red-700 border border-red-200"}`,children:c.jsxs("div",{className:"flex",children:[c.jsx("svg",{className:"h-5 w-5 mr-2 text-red-400 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),c.jsx("span",{children:N})]})})]})}),c.jsx("div",{className:`px-6 py-4 sm:flex ${E?"justify-center":"sm:flex-row-reverse"} ${l?"bg-gray-700 border-t border-gray-600":"bg-gray-50 border-t border-gray-200"}`,children:E?c.jsx("button",{type:"button",onClick:()=>p(!1),className:`w-full inline-flex justify-center rounded-md border shadow-sm px-4 py-2 text-base font-medium sm:w-auto sm:text-sm ${l?"bg-gray-700 hover:bg-gray-600 text-gray-300 border-gray-600":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:"Đóng"}):c.jsxs(c.Fragment,{children:[c.jsx("button",{type:"button",onClick:()=>Ue(x.id),disabled:y,className:`w-full inline-flex justify-center items-center rounded-md border border-transparent shadow-sm px-4 py-2 text-base font-medium text-white sm:ml-3 sm:w-auto sm:text-sm ${y?"bg-red-500 cursor-not-allowed":l?"bg-red-700 hover:bg-red-600 focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-red-500":"bg-red-600 hover:bg-red-700 focus:ring-2 focus:ring-offset-2 focus:ring-red-500"}`,children:y?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Đang xử lý..."]}):c.jsxs(c.Fragment,{children:[c.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Xác nhận xóa"]})}),c.jsx("button",{type:"button",onClick:()=>p(!1),className:`mt-3 w-full inline-flex justify-center rounded-md border shadow-sm px-4 py-2 text-base font-medium sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm ${l?"bg-gray-700 hover:bg-gray-600 text-gray-300 border-gray-600":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:"Hủy bỏ"})]})})]})]})})]})},XH=({isOpen:t,onClose:e,isDarkMode:r,toggleDarkMode:n})=>{const{themeColor:s,changeThemeColor:i,THEME_COLORS:a}=Mr(),o=F.useRef(null);return F.useEffect(()=>{if(!t)return;const l=u=>{o.current&&!o.current.contains(u.target)&&e()};return document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[t,e]),t?c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:c.jsxs("div",{ref:o,className:`${r?"bg-gray-800 text-white":"bg-white text-gray-800"} rounded-lg shadow-xl p-4 max-w-sm w-[90%] mx-auto`,children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h3",{className:"text-lg font-medium",children:"Tùy chỉnh giao diện"}),c.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:`flex items-center justify-between p-3 mb-4 rounded-md ${r?"bg-gray-700":"bg-gray-100"}`,children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:`mr-2 ${r?"text-gray-300":"text-gray-700"}`,children:r?c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{d:"M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"})}):c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z",clipRule:"evenodd"})})}),c.jsxs("span",{className:`${r?"text-gray-300":"text-gray-700"}`,children:["Chế độ ",r?"tối":"sáng"]})]}),c.jsx("button",{onClick:n,className:`relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none ${r?"bg-blue-600":"bg-gray-300"}`,children:c.jsx("span",{className:`inline-block w-4 h-4 transform transition-transform bg-white rounded-full ${r?"translate-x-6":"translate-x-1"}`})})]}),c.jsx("p",{className:`mb-4 text-sm ${r?"text-gray-400":"text-gray-600"}`,children:"Chọn màu chủ đề cho ứng dụng"}),c.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-3 mb-4",children:[c.jsx("div",{className:`theme-color-option theme-color-default ${s===a.DEFAULT?"active":""}`,onClick:()=>i(a.DEFAULT),title:"Mặc định"}),c.jsx("div",{className:`theme-color-option theme-color-blue ${s===a.BLUE?"active":""}`,onClick:()=>i(a.BLUE),title:"Xanh dương"}),c.jsx("div",{className:`theme-color-option theme-color-red ${s===a.RED?"active":""}`,onClick:()=>i(a.RED),title:"Đỏ"}),c.jsx("div",{className:`theme-color-option theme-color-purple ${s===a.PURPLE?"active":""}`,onClick:()=>i(a.PURPLE),title:"Tím"}),c.jsx("div",{className:`theme-color-option theme-color-yellow ${s===a.YELLOW?"active":""}`,onClick:()=>i(a.YELLOW),title:"Vàng"}),c.jsx("div",{className:`theme-color-option theme-color-brown ${s===a.BROWN?"active":""}`,onClick:()=>i(a.BROWN),title:"Nâu"}),c.jsx("div",{className:`theme-color-option theme-color-black ${s===a.BLACK?"active":""}`,onClick:()=>i(a.BLACK),title:"Đen"}),c.jsx("div",{className:`theme-color-option theme-color-white ${s===a.WHITE?"active":""}`,onClick:()=>i(a.WHITE),title:"Trắng"})]}),c.jsx("div",{className:`p-3 rounded-md text-sm ${r?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-700"}`,children:c.jsxs("p",{className:"mb-2",children:[c.jsx("strong",{children:"Lưu ý:"})," Thay đổi màu chủ đề sẽ chỉ có hiệu lực khi ở chế độ sáng."]})})]})}):null},QH={userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",WebkitTouchCallout:"none"};function YH(){const t=wI(),e=t.categorySlug,r=t.documentSlug;Or();const{isDarkMode:n,toggleDarkMode:s}=Mr(),[i]=vn(St),[a,o]=F.useState(!1),l=F.useRef(null),{isAdmin:u,isPremium:h}=Yn(),[d,m]=F.useState(!1),p=G=>(G.preventDefault(),!1),[x,g]=F.useState([]),[y,w]=F.useState(null),[E,_]=F.useState({}),[N,j]=F.useState(null),[D,k]=F.useState([]),[S,b]=F.useState(!0),[C,A]=F.useState(null),[I,P]=F.useState(-1),[ue,de]=F.useState(""),[ie,ge]=F.useState(!1),[ne,K]=F.useState(typeof window<"u"?window.innerWidth:1024),[fe,_e]=F.useState(!1);F.useEffect(()=>{const G=J=>{l.current&&!l.current.contains(J.target)&&o(!1)};return document.addEventListener("mousedown",G),()=>{document.removeEventListener("mousedown",G)}},[]),F.useEffect(()=>{if(typeof window>"u")return;const G=()=>{var J,ae,re,he;K(window.innerWidth),window.innerWidth>=770&&window.innerWidth<1280?ie&&((J=document.querySelector(".sidebar-container"))==null||J.classList.add("sidebar-compact"),(ae=document.querySelector(".content-container"))==null||ae.classList.add("content-with-compact-sidebar")):window.innerWidth>=1280&&((re=document.querySelector(".sidebar-container"))==null||re.classList.remove("sidebar-compact"),(he=document.querySelector(".content-container"))==null||he.classList.remove("content-with-compact-sidebar"))};try{return window.addEventListener("resize",G),G(),()=>{window.removeEventListener("resize",G)}}catch(J){console.error("Lỗi khi theo dõi kích thước màn hình:",J)}},[ie]);const B=()=>{ge(!ie),setTimeout(()=>{var G,J,ae,re;ne>=770&&ne<1280&&(ie?((ae=document.querySelector(".sidebar-container"))==null||ae.classList.add("sidebar-compact"),(re=document.querySelector(".content-container"))==null||re.classList.add("content-with-compact-sidebar")):((G=document.querySelector(".sidebar-container"))==null||G.classList.remove("sidebar-compact"),(J=document.querySelector(".content-container"))==null||J.classList.remove("content-with-compact-sidebar")))},0)};F.useEffect(()=>{(async()=>{try{b(!0),A(null);const J=await kx();if(!J||J.length===0)throw new Error("Không thể tải danh mục");g(J);const ae=J.find(re=>!re||!re.title?!1:re.title.toLowerCase().replace(/\s+/g,"_").replace(/[^\w-]+/g,"").replace(/--+/g,"_")===e);if(!ae)throw new Error("Không tìm thấy danh mục này");w(ae),P(J.indexOf(ae));try{const re=await RS(ae.id);if(!re||re.length===0)throw new Error("Danh mục này không có tài liệu");_({[ae.id]:re});const he=re.find(oe=>oe&&oe.slug===r);if(!he)throw new Error("Không tìm thấy tài liệu");j(he);try{const oe=await N9(he.id);let Pe=oe;if(!u&&!h){const W=Math.ceil(oe.length/2);Pe=oe.slice(0,W),m(!0)}else m(!1);k(Pe)}catch(oe){console.error("Lỗi khi tải câu hỏi:",oe),k([])}}catch(re){throw console.error("Lỗi khi tải tài liệu:",re),re}}catch(J){console.error("Lỗi khi tải dữ liệu:",J),A(J.message||"Không thể tải dữ liệu. Vui lòng thử lại sau.")}finally{b(!1)}})()},[e,r,u,h]);const q=D.filter(G=>G.question&&G.question.toLowerCase().includes((ue||"").toLowerCase())||G.answer&&G.answer.toLowerCase().includes((ue||"").toLowerCase())),H=()=>{try{const G=q.map(oe=>({STT:oe.stt,"Câu hỏi":oe.question,"Trả lời":oe.answer})),J=Bh.book_new(),ae=Bh.json_to_sheet(G),re=(N==null?void 0:N.title)||"Document";Bh.book_append_sheet(J,ae,re.substring(0,30));const he=`${(y==null?void 0:y.title)||"Category"} - ${re}.xlsx`;LH(J,he)}catch(G){console.error("Lỗi khi xuất file Excel:",G),alert("Có lỗi xảy ra khi tạo file Excel. Vui lòng thử lại sau.")}};return F.useEffect(()=>{const G=re=>{if(!u&&!h)return re.preventDefault(),!1},J=re=>{if(!u&&!h&&(re.ctrlKey||re.metaKey)&&(re.key==="c"||re.key==="C"||re.keyCode===67))return re.preventDefault(),!1},ae=re=>{if(!u&&!h)return re.preventDefault(),!1};return document.addEventListener("contextmenu",G),document.addEventListener("keydown",J),document.addEventListener("copy",ae),()=>{document.removeEventListener("contextmenu",G),document.removeEventListener("keydown",J),document.removeEventListener("copy",ae)}},[u,h]),S?c.jsx("div",{className:`min-h-screen ${n?"bg-gray-900 text-white":"bg-gray-100 text-gray-800"} flex items-center justify-center`,children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-green-500"}),c.jsx("p",{className:"mt-3",children:"Đang tải dữ liệu..."})]})}):C?c.jsx("div",{className:`min-h-screen ${n?"bg-gray-900 text-white":"bg-gray-100 text-gray-800"} flex items-center justify-center`,children:c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:`${n?"bg-red-900/30 border-red-700":"bg-red-100 border-red-400"} border text-red-500 px-4 py-3 rounded relative`,role:"alert",children:[c.jsx("strong",{className:"font-bold",children:"Lỗi!"}),c.jsxs("span",{className:"block sm:inline",children:[" ",C]})]}),c.jsxs("div",{className:"mt-4 flex flex-col md:flex-row gap-3 justify-center",children:[c.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md",children:"Tải lại trang"}),c.jsx(qa,{to:"/",className:"bg-green-700 hover:bg-green-800 text-white px-4 py-2 rounded-md text-center",children:"Quay về trang chủ"})]})]})}):c.jsxs("div",{className:`flex flex-col min-h-screen ${n?"bg-gray-900":"bg-slate-100"}`,style:!u&&!h?QH:{},onCopy:!u&&!h?p:void 0,onCut:!u&&!h?p:void 0,onDragStart:!u&&!h?p:void 0,children:[ne<770&&c.jsx(ac,{selectedCategory:y,selectedDocument:N,setIsSidebarOpen:B,isDarkMode:n}),c.jsxs("div",{className:"flex min-h-screen relative",children:[c.jsx("div",{className:`${ne<770?`fixed inset-y-0 left-0 z-20 transition-all duration-300 transform mobile-sidebar ${ie?"translate-x-0":"-translate-x-full"}`:"relative sidebar-container"} ${ne>=770&&ne<1280?"sidebar-compact":""}`,children:c.jsx(ic,{sidebarData:x,documents:E,openMain:I,setOpenMain:P,selectedCategory:y,selectedDocument:N,setSelectedDocument:j,setSearch:de,setDocuments:_,isOpen:ie,setIsOpen:ge})}),ie&&ne<770&&c.jsx("div",{className:"fixed inset-0 z-10 bg-black/50",onClick:()=>ge(!1)}),c.jsxs("div",{className:`flex-1 overflow-hidden content-container ${ne>=770&&ne<1280&&!ie?"content-with-compact-sidebar":""}`,children:[ne>=770&&c.jsx(Wo,{title:y!=null&&y.title?`${y.title} - ${N==null?void 0:N.title}`:"Tài liệu NEU"}),c.jsxs("div",{className:"flex flex-col flex-1",children:[!(e==="admin"&&r==="users")&&c.jsxs("div",{className:"p-6 pb-0",children:[ne>=770&&c.jsxs("h1",{className:`text-xl font-medium mb-2 ${n?"text-gray-200":"text-slate-800"}`,children:[y==null?void 0:y.title," - ",N==null?void 0:N.title]}),c.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-3 mb-4",children:[c.jsxs("p",{className:`text-sm ${n?"text-gray-400":"text-slate-500"}`,children:["Hiển thị từ 1 đến ",q.length," trong tổng số ",q.length," câu hỏi"]}),c.jsxs("div",{className:"flex gap-2",children:["          ",i&&c.jsxs("button",{onClick:H,className:"flex items-center gap-1 px-3 py-2 rounded-md text-white bg-green-600 hover:bg-green-700 transition-colors",title:!u&&!h?"Tính năng này chỉ dành cho thành viên Premium":"Tải xuống danh sách câu hỏi dưới dạng Excel",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),c.jsx("span",{children:"Excel"})]}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"text",placeholder:"Tìm kiếm câu hỏi",value:ue,onChange:G=>de(G.target.value),className:`pl-3 pr-10 py-2 border rounded-md w-full md:w-64 focus:outline-none focus:ring-1 focus:ring-blue-500 ${n?"bg-gray-800 border-gray-700 text-gray-200 placeholder-gray-500":"bg-white border-gray-300 text-gray-800"}`}),c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 absolute right-3 top-2.5 ${n?"text-gray-500":"text-gray-400"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})]})]})]}),c.jsx("div",{className:"mx-auto max-w-4xl px-4 pb-12",children:ue&&q.length===0&&d&&c.jsxs("div",{className:`mt-4 p-4 rounded-md ${n?"bg-gray-800 border border-gray-700":"bg-white border border-gray-200"} text-center shadow-sm`,children:[c.jsx("p",{className:"mb-2",children:"Không tìm thấy kết quả phù hợp với tìm kiếm của bạn."}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Lưu ý: Bạn đang xem phiên bản giới hạn. Kết quả tìm kiếm có thể nằm trong phần nội dung chỉ dành cho tài khoản premium."})]})}),d&&c.jsx("div",{className:`mx-auto max-w-4xl px-4 mb-6 ${n?"bg-yellow-900/30 border border-yellow-700":"bg-yellow-50 border border-yellow-200"} rounded-lg py-3`,children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 mr-2 ${n?"text-yellow-500":"text-yellow-400"}`,viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zm-1 8a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),c.jsxs("p",{className:`text-sm ${n?"text-yellow-200":"text-yellow-700"}`,children:["Bạn đang xem bản giới hạn (50% câu hỏi).",c.jsx("a",{href:"/pricing",className:`font-medium underline ml-1 ${n?"text-yellow-300 hover:text-yellow-400":"text-yellow-800 hover:text-yellow-900"}`,children:"Nâng cấp tài khoản"})," để truy cập đầy đủ."]})]})}),e==="admin"&&r==="users"?c.jsx(qH,{}):c.jsx(U9,{filteredQuestions:q})]})]})]}),c.jsx(XH,{isOpen:fe,onClose:()=>_e(!1),isDarkMode:n,toggleDarkMode:s})]})}const JH=()=>{const[t,e]=F.useState(""),[r,n]=F.useState(""),[s,i]=F.useState(""),[a,o]=F.useState(!1),[l,u]=F.useState(!1),[h]=vn(St),d=Or(),{isDarkMode:m}=Mr();F.useEffect(()=>{h&&d("/")},[h,d]);const p=async w=>{if(w.preventDefault(),!t||!r){i("Vui lòng nhập đầy đủ email và mật khẩu");return}try{o(!0),i("");const E=await GH(t,r);E.success||i(E.error)}catch(E){console.error("Login error:",E),i(E.message||"Đăng nhập thất bại. Vui lòng thử lại.")}finally{o(!1)}},x=async()=>{o(!0),i("");try{const w=await HH();w.success?console.log("Google login successful"):i(w.error)}catch(w){console.error("Unexpected error during Google login:",w),i("Có lỗi xảy ra. Vui lòng thử lại sau.")}finally{o(!1)}},g=()=>{u(!l)},y=`appearance-none rounded-md relative block w-full px-3 py-2 border ${m?"border-gray-700 bg-gray-700 text-white placeholder-gray-400 focus:ring-green-500 focus:border-green-500":"border-gray-300 placeholder-gray-500 focus:ring-green-600 focus:border-green-600"} focus:outline-none focus:ring-2 focus:z-10 sm:text-sm transition-colors`;return c.jsx("div",{className:`min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 ${m?"bg-gray-900 text-gray-100":"bg-gray-100 text-gray-900"}`,children:c.jsxs("div",{className:`max-w-md w-full space-y-6 p-8 rounded-lg shadow-md ${m?"bg-gray-800 shadow-gray-900/50":"bg-white shadow-gray-200/50"}`,children:[c.jsxs("div",{children:[c.jsx("div",{className:"flex justify-center",children:c.jsxs("svg",{className:`w-12 h-12 ${m?"text-green-500":"text-green-600"}`,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:[c.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),c.jsx("path",{d:"M4 11.5l8 4 8-4M4 15l8 4 8-4"})]})}),c.jsx("h2",{className:`mt-6 text-center text-3xl font-extrabold ${m?"text-gray-100":"text-gray-900"}`,children:"Đăng nhập vào tài khoản"}),c.jsxs("p",{className:`mt-2 text-center text-sm ${m?"text-gray-400":"text-gray-600"}`,children:["Chưa có tài khoản?"," ",c.jsx("button",{onClick:()=>d("/register"),className:`font-medium transition-colors ${m?"text-green-500 hover:text-green-400":"text-green-600 hover:text-green-500"}`,children:"Đăng ký ngay"})]})]}),s&&c.jsx("div",{className:`px-4 py-3 rounded border ${m?"bg-red-900/30 border-red-800 text-red-300":"bg-red-100 border-red-400 text-red-700"}`,children:c.jsx("span",{children:s})}),c.jsxs("form",{className:"mt-4 space-y-4",onSubmit:p,children:[c.jsxs("div",{className:"rounded-md space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"email-address",className:"sr-only",children:"E-mail"}),c.jsx("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,value:t,onChange:w=>e(w.target.value),className:y,placeholder:"E-mail"})]}),c.jsxs("div",{className:"relative",children:[c.jsx("label",{htmlFor:"password",className:"sr-only",children:"Mật khẩu"}),c.jsx("input",{id:"password",name:"password",type:l?"text":"password",autoComplete:"current-password",required:!0,value:r,onChange:w=>n(w.target.value),className:y,placeholder:"Mật khẩu"}),c.jsx("button",{type:"button",className:`absolute inset-y-0 right-0 pr-3 flex items-center ${m?"text-gray-400 hover:text-gray-300":"text-gray-600 hover:text-gray-500"}`,onClick:g,children:l?c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),c.jsx("div",{className:"pt-2",children:c.jsx("button",{type:"submit",disabled:a,className:`group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white transition-colors ${m?"bg-green-600 hover:bg-green-700 focus:ring-green-500":"bg-green-700 hover:bg-green-800 focus:ring-green-600"} focus:outline-none focus:ring-2 focus:ring-offset-2 ${a?"opacity-70 cursor-not-allowed":""}`,children:a?"Đang xử lý...":"Đăng nhập"})})]}),c.jsxs("div",{className:"mt-4",children:[c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-0 flex items-center",children:c.jsx("div",{className:`w-full border-t ${m?"border-gray-700":"border-gray-300"}`})}),c.jsx("div",{className:"relative flex justify-center text-sm",children:c.jsx("span",{className:`px-2 ${m?"bg-gray-800 text-gray-400":"bg-white text-gray-600"}`,children:"Hoặc tiếp tục với"})})]}),c.jsx("div",{className:"mt-4",children:c.jsxs("button",{type:"button",onClick:x,disabled:a,className:`w-full flex items-center justify-center gap-2 py-2 px-4 rounded-md ${m?"bg-gray-700 hover:bg-gray-600 text-white border border-gray-600":"bg-white hover:bg-gray-50 text-gray-800 border border-gray-300"} transition-colors mb-4`,children:[c.jsx("svg",{viewBox:"0 0 24 24",width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",children:c.jsxs("g",{transform:"matrix(1, 0, 0, 1, 27.009001, -39.238998)",children:[c.jsx("path",{fill:"#4285F4",d:"M -3.264 51.509 C -3.264 50.719 -3.334 49.969 -3.454 49.239 L -14.754 49.239 L -14.754 53.749 L -8.284 53.749 C -8.574 55.229 -9.424 56.479 -10.684 57.329 L -10.684 60.329 L -6.824 60.329 C -4.564 58.239 -3.264 55.159 -3.264 51.509 Z"}),c.jsx("path",{fill:"#34A853",d:"M -14.754 63.239 C -11.514 63.239 -8.804 62.159 -6.824 60.329 L -10.684 57.329 C -11.764 58.049 -13.134 58.489 -14.754 58.489 C -17.884 58.489 -20.534 56.379 -21.484 53.529 L -25.464 53.529 L -25.464 56.619 C -23.494 60.539 -19.444 63.239 -14.754 63.239 Z"}),c.jsx("path",{fill:"#FBBC05",d:"M -21.484 53.529 C -21.734 52.809 -21.864 52.039 -21.864 51.239 C -21.864 50.439 -21.724 49.669 -21.484 48.949 L -21.484 45.859 L -25.464 45.859 C -26.284 47.479 -26.754 49.299 -26.754 51.239 C -26.754 53.179 -26.284 54.999 -25.464 56.619 L -21.484 53.529 Z"}),c.jsx("path",{fill:"#EA4335",d:"M -14.754 43.989 C -12.984 43.989 -11.404 44.599 -10.154 45.789 L -6.734 42.369 C -8.804 40.429 -11.514 39.239 -14.754 39.239 C -19.444 39.239 -23.494 41.939 -25.464 45.859 L -21.484 48.949 C -20.534 46.099 -17.884 43.989 -14.754 43.989 Z"})]})}),c.jsx("span",{children:"Google"})]})})]}),c.jsx("div",{className:"flex justify-center",children:c.jsx("button",{onClick:()=>d("/"),className:`flex items-center text-sm transition-colors 
                ${m?"text-gray-400 hover:text-gray-300":"text-gray-600 hover:text-gray-800"}`,children:"Quay lại trang chủ"})})]})})},ZH=({isDarkMode:t})=>{const[e,r]=F.useState(!1),[n,s]=F.useState(""),i=Or();F.useEffect(()=>{(async()=>{try{const l=await l7(St);if(l){r(!0);const u=l.user;await Gl(u.uid,{displayName:u.displayName,email:u.email,phoneNumber:u.phoneNumber||"",photoURL:u.photoURL,role:"fuser",emailVerified:u.emailVerified,lastLogin:new Date}),i("/")}}catch(l){console.error("Lỗi khi xử lý kết quả chuyển hướng:",l),s("Đăng nhập Google thất bại. Vui lòng thử lại.")}finally{r(!1)}})()},[i]);const a=async()=>{s(""),r(!0);try{const o=new Gs;o.setCustomParameters({prompt:"select_account"});try{const u=(await ES(St,o)).user;await Gl(u.uid,{displayName:u.displayName,email:u.email,phoneNumber:u.phoneNumber||"",photoURL:u.photoURL,role:"fuser",emailVerified:u.emailVerified,lastLogin:new Date}),i("/")}catch(l){console.warn("Popup bị chặn hoặc lỗi, chuyển sang phương thức redirect:",l),await a7(St,o)}}catch(o){console.error("Lỗi đăng nhập Google:",o),s("Đăng nhập Google thất bại. Vui lòng thử lại.")}finally{r(!1)}};return c.jsxs(c.Fragment,{children:[n&&c.jsx("div",{className:`px-4 py-2 rounded border mb-3 text-sm ${t?"bg-red-900/30 border-red-800 text-red-300":"bg-red-100 border-red-400 text-red-700"}`,children:c.jsx("span",{children:n})}),c.jsxs("button",{onClick:a,disabled:e,className:`w-full flex items-center justify-center px-4 py-2 border rounded-md shadow-sm text-sm font-medium transition-colors ${t?"bg-gray-700 border-gray-600 text-white hover:bg-gray-600":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"} ${e?"opacity-70 cursor-not-allowed":""}`,children:[c.jsx("svg",{className:"h-5 w-5 mr-2",viewBox:"0 0 24 24",children:c.jsxs("g",{transform:"matrix(1, 0, 0, 1, 27.009001, -39.238998)",children:[c.jsx("path",{fill:"#4285F4",d:"M -3.264 51.509 C -3.264 50.719 -3.334 49.969 -3.454 49.239 L -14.754 49.239 L -14.754 53.749 L -8.284 53.749 C -8.574 55.229 -9.424 56.479 -10.684 57.329 L -10.684 60.329 L -6.824 60.329 C -4.564 58.239 -3.264 55.159 -3.264 51.509 Z"}),c.jsx("path",{fill:"#34A853",d:"M -14.754 63.239 C -11.514 63.239 -8.804 62.159 -6.824 60.329 L -10.684 57.329 C -11.764 58.049 -13.134 58.489 -14.754 58.489 C -17.884 58.489 -20.534 56.379 -21.484 53.529 L -25.464 53.529 L -25.464 56.619 C -23.494 60.539 -19.444 63.239 -14.754 63.239 Z"}),c.jsx("path",{fill:"#FBBC05",d:"M -21.484 53.529 C -21.734 52.809 -21.864 52.039 -21.864 51.239 C -21.864 50.439 -21.724 49.669 -21.484 48.949 L -21.484 45.859 L -25.464 45.859 C -26.284 47.479 -26.754 49.299 -26.754 51.239 C -26.754 53.179 -26.284 54.999 -25.464 56.619 L -21.484 53.529 Z"}),c.jsx("path",{fill:"#EA4335",d:"M -14.754 43.989 C -12.984 43.989 -11.404 44.599 -10.154 45.789 L -6.734 42.369 C -8.804 40.429 -11.514 39.239 -14.754 39.239 C -19.444 39.239 -23.494 41.939 -25.464 45.859 L -21.484 48.949 C -20.534 46.099 -17.884 43.989 -14.754 43.989 Z"})]})}),"Google"]})]})},eG=()=>{const[t,e]=F.useState(""),[r,n]=F.useState(""),[s,i]=F.useState(""),[a,o]=F.useState(""),[l,u]=F.useState(""),[h,d]=F.useState(""),[m,p]=F.useState(!1),[x,g]=F.useState(!1),[y,w]=F.useState(!1),[E,_]=F.useState(!1),N=Or(),{isDarkMode:j}=Mr(),D=C=>"/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+.[a-zA-Z]{2,}$/".test(C),k=C=>" /^[0-9]{10}$/".test(C),S=async C=>{C.preventDefault(),d(""),p(!0),g(!1);try{if(!a.trim())throw{code:"auth/invalid-name",message:"Vui lòng nhập họ và tên"};if(!l.trim())throw{code:"auth/invalid-phone",message:"Vui lòng nhập số điện thoại"};if(!k(l))throw{code:"auth/invalid-phone-format",message:"Số điện thoại phải có đúng 10 chữ số"};if(!D(t))throw{code:"auth/invalid-email-format",message:"Định dạng email không hợp lệ"};if(r.length<6||r.length>12)throw{code:"auth/invalid-password-length",message:"Mật khẩu phải có từ 6 đến 12 ký tự"};if(r!==s)throw{code:"auth/passwords-dont-match",message:"Mật khẩu xác nhận không khớp"};const A=await yx(St,t,r);await Ad(A.user,{displayName:a}),await Gl(A.user.uid,{displayName:a,email:t,phoneNumber:l,role:"fuser",emailVerified:A.user.emailVerified}),g(!0),setTimeout(()=>{N("/")},1500)}catch(A){console.error("Lỗi đăng ký:",A),d(A.code==="auth/email-already-in-use"?"Email đã được sử dụng":A.code==="auth/weak-password"?"Mật khẩu quá yếu":A.code==="auth/invalid-email"||A.code==="auth/invalid-email-format"?"Định dạng email không hợp lệ":A.code==="auth/passwords-dont-match"||A.code==="auth/invalid-name"||A.code==="auth/invalid-phone"||A.code==="auth/invalid-password-length"||A.code==="auth/invalid-phone-format"?A.message:"Đã có lỗi xảy ra, vui lòng thử lại")}finally{p(!1)}},b=`appearance-none rounded-md relative block w-full px-3 py-2 border ${j?"border-gray-700 bg-gray-700 text-white placeholder-gray-400 focus:ring-green-500 focus:border-green-500":"border-gray-300 placeholder-gray-500 focus:ring-green-600 focus:border-green-600"} focus:outline-none focus:ring-2 focus:z-10 sm:text-sm transition-colors`;return c.jsx("div",{className:`min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 ${j?"bg-gray-900 text-gray-100":"bg-gray-100 text-gray-900"}`,children:c.jsxs("div",{className:`max-w-md w-full space-y-6 p-8 rounded-lg shadow-md ${j?"bg-gray-800 shadow-gray-900/50":"bg-white shadow-gray-200/50"}`,children:[c.jsxs("div",{children:[c.jsx("div",{className:"flex justify-center",children:c.jsxs("svg",{className:`w-12 h-12 ${j?"text-green-500":"text-green-600"}`,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:[c.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),c.jsx("path",{d:"M4 11.5l8 4 8-4M4 15l8 4 8-4"})]})}),c.jsx("h2",{className:`mt-6 text-center text-3xl font-extrabold ${j?"text-gray-100":"text-gray-900"}`,children:"Tạo tài khoản mới"}),c.jsxs("p",{className:`mt-2 text-center text-sm ${j?"text-gray-400":"text-gray-600"}`,children:["Đã có tài khoản?"," ",c.jsx("button",{onClick:()=>N("/login"),className:`font-medium transition-colors ${j?"text-green-500 hover:text-green-400":"text-green-600 hover:text-green-500"}`,children:"Đăng nhập"})]})]}),h&&c.jsx("div",{className:`px-4 py-3 rounded border ${j?"bg-red-900/30 border-red-800 text-red-300":"bg-red-100 border-red-400 text-red-700"}`,children:c.jsx("span",{children:h})}),x&&c.jsx("div",{className:`px-4 py-3 rounded border ${j?"bg-green-900/30 border-green-800 text-green-300":"bg-green-100 border-green-400 text-green-700"}`,children:c.jsx("span",{children:"Đăng ký thành công! Đang chuyển hướng..."})}),c.jsxs("form",{className:"mt-4 space-y-4",onSubmit:S,children:[c.jsxs("div",{className:"rounded-md space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"full-name",className:"sr-only",children:"Họ và tên"}),c.jsx("input",{id:"full-name",name:"fullName",type:"text",required:!0,value:a,onChange:C=>o(C.target.value),className:b,placeholder:"Họ và tên"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"email-address",className:"sr-only",children:"E-mail"}),c.jsx("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,value:t,onChange:C=>e(C.target.value),className:b,placeholder:"E-mail"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"phone-number",className:"sr-only",children:"Số điện thoại"}),c.jsx("input",{id:"phone-number",name:"phone",type:"tel",required:!0,value:l,onChange:C=>u(C.target.value),className:b,placeholder:"Số điện thoại"})]}),c.jsxs("div",{className:"relative",children:[c.jsx("label",{htmlFor:"password",className:"sr-only",children:"Mật khẩu"}),c.jsx("input",{id:"password",name:"password",type:y?"text":"password",autoComplete:"new-password",required:!0,value:r,onChange:C=>n(C.target.value),className:b,placeholder:"Mật khẩu"}),c.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>w(!y),children:y?c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${j?"text-gray-400":"text-gray-500"}`,viewBox:"0 0 20 20",fill:"currentColor",children:[c.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),c.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}):c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${j?"text-gray-400":"text-gray-500"}`,viewBox:"0 0 20 20",fill:"currentColor",children:[c.jsx("path",{fillRule:"evenodd",d:"M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z",clipRule:"evenodd"}),c.jsx("path",{d:"M12.454 16.697L9.75 13.992a4 4 0 01-3.742-3.741L2.335 6.578A9.98 9.98 0 00.458 10c1.274 4.057 5.065 7 9.542 7 .847 0 1.669-.105 2.454-.303z"})]})})]}),c.jsxs("div",{className:"relative",children:[c.jsx("label",{htmlFor:"confirm-password",className:"sr-only",children:"Xác nhận mật khẩu"}),c.jsx("input",{id:"confirm-password",name:"confirmPassword",type:E?"text":"password",required:!0,value:s,onChange:C=>i(C.target.value),className:b,placeholder:"Xác nhận mật khẩu"}),c.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>_(!E),children:E?c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${j?"text-gray-400":"text-gray-500"}`,viewBox:"0 0 20 20",fill:"currentColor",children:[c.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),c.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}):c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 ${j?"text-gray-400":"text-gray-500"}`,viewBox:"0 0 20 20",fill:"currentColor",children:[c.jsx("path",{fillRule:"evenodd",d:"M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z",clipRule:"evenodd"}),c.jsx("path",{d:"M12.454 16.697L9.75 13.992a4 4 0 01-3.742-3.741L2.335 6.578A9.98 9.98 0 00.458 10c1.274 4.057 5.065 7 9.542 7 .847 0 1.669-.105 2.454-.303z"})]})})]})]}),c.jsx("div",{className:"pt-2",children:c.jsx("button",{type:"submit",disabled:m,className:`group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white transition-colors ${j?"bg-green-600 hover:bg-green-700 focus:ring-green-500":"bg-green-700 hover:bg-green-800 focus:ring-green-600"} focus:outline-none focus:ring-2 focus:ring-offset-2 ${m?"opacity-70 cursor-not-allowed":""}`,children:m?"Đang xử lý...":"Đăng ký"})})]}),c.jsxs("div",{className:"mt-4",children:[c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-0 flex items-center",children:c.jsx("div",{className:`w-full border-t ${j?"border-gray-700":"border-gray-300"}`})}),c.jsx("div",{className:"relative flex justify-center text-sm",children:c.jsx("span",{className:`px-2 ${j?"bg-gray-800 text-gray-400":"bg-white text-gray-600"}`,children:"Hoặc tiếp tục với"})})]}),c.jsx("div",{className:"mt-4",children:c.jsx(ZH,{isDarkMode:j})})]}),c.jsx("div",{className:"flex justify-center",children:c.jsx("button",{onClick:()=>N("/"),className:`flex items-center text-sm transition-colors 
                ${j?"text-gray-400 hover:text-gray-300":"text-gray-600 hover:text-gray-800"}`,children:"Quay lại trang chủ"})})]})})},tG=()=>{const[t,e]=vn(St),{isDarkMode:r,themeColor:n,changeThemeColor:s,THEME_COLORS:i}=Mr(),{userRole:a,isAdmin:o,isPaidUser:l,isFreeUser:u}=Yn(),h=Or(),[d,m]=F.useState(""),[p,x]=F.useState(""),[g,y]=F.useState(""),[w,E]=F.useState(!1),[_,N]=F.useState(""),[j,D]=F.useState(""),[k,S]=F.useState(""),[b,C]=F.useState(""),[A,I]=F.useState(""),[P,ue]=F.useState(!1),de=ne=>/^[0-9]{10}$/.test(ne),ie=ne=>{const K=ne.target.value;(K===""||/^[0-9]+$/.test(K))&&y(K)};F.useEffect(()=>{!e&&!t&&h("/login")},[t,e,h]),F.useEffect(()=>{(async()=>{if(t){x(t.email||""),m(t.displayName||"");try{const K=await Hl(hr(at,"users",t.uid));if(K.exists()){const fe=K.data();fe.displayName&&m(fe.displayName),fe.email&&x(fe.email),fe.phoneNumber&&y(fe.phoneNumber),console.log("Dữ liệu người dùng từ Firestore:",fe)}else console.log("Không tìm thấy dữ liệu người dùng trong Firestore"),await Tf(hr(at,"users",t.uid),{displayName:t.displayName||"",email:t.email||"",phoneNumber:"",createdAt:new Date().toISOString()})}catch(K){console.error("Lỗi khi lấy thông tin người dùng:",K)}}})()},[t]);const ge=async ne=>{ne.preventDefault(),I(""),C(""),ue(!0);try{if(g.trim()&&!de(g))throw new Error("Số điện thoại phải đúng định dạng , có đúng 10 chữ số");if(t.displayName!==d&&await Ad(t,{displayName:d}),await Tf(hr(at,"users",t.uid),{displayName:d,email:p,phoneNumber:g,updatedAt:new Date().toISOString()},{merge:!0}),w){if(j!==k)throw new Error("Mật khẩu xác nhận không khớp với mật khẩu mới");if(j.length<6||j.length>12)throw new Error("Mật khẩu phải có từ 6 đến 12 ký tự");const K=jo.credential(t.email,_);await NF(t,K),await RF(t,j),N(""),D(""),S(""),E(!1),C("Thông tin tài khoản và mật khẩu đã được cập nhật thành công!")}else C("Thông tin tài khoản đã được cập nhật thành công!")}catch(K){console.error("Lỗi khi cập nhật thông tin:",K),I(K.code==="auth/wrong-password"?"Mật khẩu hiện tại không đúng":K.code==="auth/weak-password"?"Mật khẩu mới quá yếu":K.message||"Đã xảy ra lỗi khi cập nhật. Vui lòng thử lại.")}finally{ue(!1)}};return e?c.jsx("div",{className:`min-h-screen ${r?"bg-gray-900 text-white":"bg-gray-100 text-gray-800"} flex items-center justify-center`,children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-green-500"}),c.jsx("p",{className:"mt-3",children:"Đang tải..."})]})}):c.jsx("div",{className:`min-h-screen py-12 px-4 sm:px-6 lg:px-8 ${r?"bg-gray-900 text-white":"bg-gray-100 text-gray-800"}`,children:c.jsxs("div",{className:"max-w-md mx-auto",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h2",{className:"text-3xl font-extrabold",children:"Thông tin tài khoản"}),c.jsx("p",{className:`mt-2 text-sm ${r?"text-gray-400":"text-gray-600"}`,children:"Chỉnh sửa thông tin cá nhân của bạn"})]}),b&&c.jsx("div",{className:`mb-4 p-3 rounded ${r?"bg-green-800 text-green-200":"bg-green-100 text-green-800"}`,children:b}),A&&c.jsx("div",{className:`mb-4 p-3 rounded ${r?"bg-red-900/30 border-red-800 text-red-300":"bg-red-100 border-red-400 text-red-700"}`,children:A}),c.jsxs("div",{className:`${r?"bg-gray-800":"bg-white"} rounded-lg shadow-md p-6 mb-6`,children:[c.jsxs("div",{className:"mb-6 pb-6 border-b border-opacity-20 border-gray-500",children:[c.jsx("h3",{className:`text-base font-medium mb-3 ${r?"text-gray-300":"text-gray-700"}`,children:"Thông tin vai trò"}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:`text-sm ${r?"text-gray-400":"text-gray-600"} mr-2`,children:"Loại tài khoản:"}),c.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${o?r?"bg-purple-900 text-purple-200":"bg-purple-100 text-purple-800":l?r?"bg-green-900 text-green-200":"bg-green-100 text-green-800":r?"bg-blue-900 text-blue-200":"bg-blue-100 text-blue-800"}`,children:o?"Quản trị viên":l?"Người dùng trả phí":"Người dùng miễn phí"})]}),c.jsx("p",{className:`mt-2 text-xs ${r?"text-gray-400":"text-gray-500"}`,children:o?"Bạn có quyền quản trị trang web và quản lý tài khoản người dùng.":l?"Bạn đang sử dụng tài khoản trả phí với đầy đủ tính năng.":"Bạn đang sử dụng tài khoản miễn phí với các tính năng cơ bản."})]}),c.jsxs("form",{onSubmit:ge,children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"email",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"}`,children:"E-mail"}),c.jsx("input",{type:"email",id:"email",value:p,readOnly:!0,className:`mt-1 block w-full px-3 py-2 border ${r?"border-gray-700 bg-gray-700/50 text-gray-300":"border-gray-300 bg-gray-100 text-gray-500"} rounded-md shadow-sm focus:outline-none sm:text-sm`}),c.jsx("p",{className:`mt-1 text-xs ${r?"text-gray-400":"text-gray-500"}`,children:"Email không thể thay đổi"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"displayName",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"}`,children:"Họ và tên"}),c.jsx("input",{type:"text",id:"displayName",value:d,onChange:ne=>m(ne.target.value),className:`mt-1 block w-full px-3 py-2 border ${r?"border-gray-700 bg-gray-700 text-white":"border-gray-300 text-gray-900"} rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm`})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"phoneNumber",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"}`,children:"Số điện thoại (10 chữ số)"}),c.jsx("input",{type:"tel",id:"phoneNumber",value:g,onChange:ie,maxLength:10,placeholder:"Nhập 10 chữ số",className:`mt-1 block w-full px-3 py-2 border ${r?"border-gray-700 bg-gray-700 text-white":"border-gray-300 text-gray-900"} rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm`}),c.jsx("p",{className:`mt-1 text-xs ${r?"text-gray-400":"text-gray-500"}`,children:"Vui lòng nhập đúng 10 chữ số"})]}),c.jsxs("div",{className:"flex items-center mt-4",children:[c.jsx("input",{type:"checkbox",id:"changePassword",checked:w,onChange:()=>E(!w),className:`h-4 w-4 text-green-600 focus:ring-green-500 ${r?"bg-gray-700 border-gray-600":"bg-gray-100 border-gray-300"} rounded`}),c.jsx("label",{htmlFor:"changePassword",className:`ml-2 block text-sm ${r?"text-gray-300":"text-gray-700"} font-medium`,children:"Đổi mật khẩu"})]}),w&&c.jsxs("div",{className:`space-y-4 mt-4 p-4 rounded-md ${r?"bg-gray-700/50":"bg-gray-50"}`,children:[c.jsx("h3",{className:`text-md font-medium mb-2 ${r?"text-gray-200":"text-gray-800"}`,children:"Thông tin mật khẩu"}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"currentPassword",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"}`,children:"Mật khẩu hiện tại"}),c.jsx("input",{type:"password",id:"currentPassword",value:_,onChange:ne=>N(ne.target.value),className:`mt-1 block w-full px-3 py-2 border ${r?"border-gray-700 bg-gray-700 text-white":"border-gray-300 text-gray-900"} rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm`,required:w})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"newPassword",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"}`,children:"Mật khẩu mới (6-12 ký tự)"}),c.jsx("input",{type:"password",id:"newPassword",value:j,onChange:ne=>D(ne.target.value),className:`mt-1 block w-full px-3 py-2 border ${r?"border-gray-700 bg-gray-700 text-white":"border-gray-300 text-gray-900"} rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm`,required:w})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"confirmPassword",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"}`,children:"Xác nhận mật khẩu mới"}),c.jsx("input",{type:"password",id:"confirmPassword",value:k,onChange:ne=>S(ne.target.value),className:`mt-1 block w-full px-3 py-2 border ${r?"border-gray-700 bg-gray-700 text-white":"border-gray-300 text-gray-900"} rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm`,required:w})]})]})]}),c.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[c.jsx("button",{type:"button",onClick:()=>h(-1),className:`px-4 py-2 border rounded-md shadow-sm text-sm font-medium ${r?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-100"} focus:outline-none`,children:"Quay lại"}),c.jsx("button",{type:"submit",disabled:P,className:`flex justify-center items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white ${r?"bg-green-600 hover:bg-green-700":"bg-green-700 hover:bg-green-800"} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 ${P?"opacity-70 cursor-not-allowed":""}`,children:P?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Đang xử lý..."]}):"Lưu thay đổi"})]})]})]})]})})},Z3=()=>{const[t,e]=F.useState([]),[r,n]=F.useState(!0),[s,i]=F.useState(null),[a,o]=F.useState(""),[l]=vn(St),{isAdmin:u}=Yn(),{isDarkMode:h}=Mr(),d=Or(),[m,p]=F.useState(!1),[x,g]=F.useState([]),[y,w]=F.useState({}),[E,_]=F.useState(null),[N,j]=F.useState(null),[D,k]=F.useState(0),[S,b]=F.useState(!1),[C,A]=F.useState(""),[I,P]=F.useState(window.innerWidth),[ue,de]=F.useState(!1),[ie,ge]=F.useState({email:"",password:"",confirmPassword:"",fullName:"",phone:"",role:"fuser"}),[ne,K]=F.useState({}),[fe,_e]=F.useState(!1),[B,q]=F.useState(!1),[H,G]=F.useState(null),[J,ae]=F.useState(!1);F.useEffect(()=>{const Ae=()=>{P(window.innerWidth)};return window.addEventListener("resize",Ae),()=>{window.removeEventListener("resize",Ae)}},[]),F.useEffect(()=>{(async()=>{if(u)try{n(!0);const ye=await PS();e(ye)}catch(ye){console.error("Error loading users:",ye),i("Không thể tải danh sách người dùng")}finally{n(!1)}})()},[u]),F.useEffect(()=>{!r&&!u&&d("/")},[u,r,d]);const re=()=>(window.location.hostname==="localhost","/admin/users"),he=async(Ae,ye)=>{try{await FS(Ae,ye),e(t.map(De=>De.id===Ae?{...De,role:ye}:De))}catch(De){console.error("Error updating user role:",De),alert("Lỗi khi cập nhật vai trò người dùng")}},oe=Ae=>{switch(Ae){case"admin":return"Quản trị viên";case"puser":return"Người dùng trả phí";case"fuser":return"Người dùng miễn phí";default:return"Không xác định"}},Pe=Ae=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(Ae),W=Ae=>/^[0-9]{10}$/.test(Ae),$e=Ae=>{const{name:ye,value:De}=Ae.target;ge({...ie,[ye]:De}),ne[ye]&&K({...ne,[ye]:""})},Oe=async Ae=>{Ae.preventDefault(),K({}),i(null);const ye={};if(ie.fullName.trim()||(ye.fullName="Vui lòng nhập họ và tên"),ie.phone.trim()?W(ie.phone)||(ye.phone="Số điện thoại phải có đúng 10 chữ số"):ye.phone="Vui lòng nhập số điện thoại",ie.email.trim()?Pe(ie.email)||(ye.email="Định dạng email không hợp lệ"):ye.email="Vui lòng nhập email",ie.password?ie.password.length<6&&(ye.password="Mật khẩu phải có ít nhất 6 ký tự"):ye.password="Vui lòng nhập mật khẩu",ie.password!==ie.confirmPassword&&(ye.confirmPassword="Mật khẩu xác nhận không khớp"),Object.keys(ye).length>0){K(ye);return}_e(!0);try{const De=St.currentUser,st=CS();try{const bt=await yx(st,ie.email,ie.password),Mt=bt.user.uid;await Ad(bt.user,{displayName:ie.fullName}),await Gl(Mt,{email:ie.email,displayName:ie.fullName,phoneNumber:ie.phone,role:ie.role,photoURL:null}),await fS(st),De&&await St.updateCurrentUser(De),e(_t=>[..._t,{id:Mt,email:ie.email,displayName:ie.fullName,phoneNumber:ie.phone,role:ie.role,photoURL:null}]),ge({email:"",password:"",confirmPassword:"",fullName:"",phone:"",role:"fuser"}),de(!1),o("Thêm người dùng thành công!"),d(re())}catch(bt){console.error("Lỗi khi tạo tài khoản:",bt),bt.code==="auth/email-already-in-use"?i("Email đã được sử dụng. Vui lòng dùng email khác."):i(`Không thể tạo tài khoản: ${bt.message}`)}}catch(De){console.error("Lỗi khi tạo tài khoản:",De),i("Không thể tạo tài khoản. Vui lòng thử lại sau.")}finally{_e(!1)}},We=Ae=>{G(Ae),q(!0)},Ue=async()=>{if(H)try{ae(!0),await LS(H.id),e(Ae=>Ae.filter(ye=>ye.id!==H.id)),o("Đã xóa người dùng khỏi Firestore thành công!"),i("Lưu ý: Người dùng chỉ bị xóa khỏi Firestore. Để xóa tài khoản khỏi Authentication, bạn cần đăng nhập vào Firebase Console và xóa tài khoản thủ công hoặc triển khai Firebase Cloud Functions."),setTimeout(()=>o(""),5e3),setTimeout(()=>i(""),15e3),q(!1),G(null)}catch(Ae){console.error("Lỗi khi xóa người dùng:",Ae),i(`Không thể xóa người dùng: ${Ae.message}`),setTimeout(()=>i(""),5e3)}finally{ae(!1)}},Te=()=>!B||!H?null:c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:c.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-70"})}),c.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),c.jsxs("div",{className:`inline-block align-bottom rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full ${h?"bg-gray-700 border border-gray-600":"bg-gray-50 border border-gray-200"}`,children:[c.jsx("div",{className:`px-6 py-4 border-b ${h?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h3",{className:`text-lg font-medium ${h?"text-white":"text-gray-900"}`,children:"Xác nhận xóa người dùng"}),c.jsx("button",{type:"button",className:`rounded-md p-1 focus:outline-none ${h?"text-gray-400 hover:text-gray-200":"text-gray-500 hover:text-gray-700"}`,onClick:()=>q(!1),children:c.jsx("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),c.jsx("div",{className:`px-6 py-5 ${h?"bg-gray-700 text-gray-200":"bg-gray-50 text-gray-800"}`,children:c.jsxs("div",{className:"mb-5",children:[c.jsx("p",{className:`text-sm ${h?"text-gray-300":"text-gray-700"} mb-4`,children:"Bạn có chắc chắn muốn xóa người dùng sau đây?"}),c.jsx("div",{className:"flex items-center p-4 rounded-md mb-4 border border-dashed bg-opacity-50\r\n                  ${isDarkMode ? 'bg-gray-600/50 border-gray-500' : 'bg-gray-100 border-gray-300'}",children:c.jsxs("div",{className:"flex items-center",children:[H!=null&&H.photoURL?c.jsx("img",{className:"h-10 w-10 rounded-full mr-3",src:H.photoURL,alt:""}):c.jsx("div",{className:`h-10 w-10 rounded-full flex items-center justify-center mr-3 ${h?"bg-gray-700":"bg-gray-200"}`,children:c.jsx("span",{className:`text-lg font-medium ${h?"text-gray-200":"text-gray-600"}`,children:H!=null&&H.displayName?H.displayName.charAt(0).toUpperCase():"?"})}),c.jsxs("div",{children:[c.jsx("div",{className:`text-sm font-medium ${h?"text-white":"text-gray-900"}`,children:(H==null?void 0:H.displayName)||"Không có tên"}),c.jsx("div",{className:`text-sm ${h?"text-gray-400":"text-gray-500"}`,children:H==null?void 0:H.email})]})]})}),c.jsx("div",{className:`p-3 rounded-md border ${h?"bg-red-900/30 text-red-300 border-red-800":"bg-red-50 text-red-700 border-red-200"}`,children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("svg",{className:"h-5 w-5 mr-2 text-red-400 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),c.jsxs("p",{className:"text-sm",children:[c.jsx("span",{className:"font-medium",children:"Cảnh báo: "}),c.jsx("span",{children:"Thao tác này chỉ xóa người dùng khỏi cơ sở dữ liệu, không xóa tài khoản xác thực."})]})]})})]})}),c.jsxs("div",{className:`px-6 py-4 flex sm:flex-row-reverse ${h?"bg-gray-700 border-t border-gray-600":"bg-gray-50 border-t border-gray-200"}`,children:[c.jsx("button",{type:"button",onClick:Ue,disabled:J,className:`w-full inline-flex justify-center items-center rounded-md border border-transparent shadow-sm px-4 py-2 text-base font-medium text-white sm:ml-3 sm:w-auto sm:text-sm ${J?"bg-red-500 cursor-not-allowed":h?"bg-red-700 hover:bg-red-600 focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-red-500":"bg-red-600 hover:bg-red-700 focus:ring-2 focus:ring-offset-2 focus:ring-red-500"}`,children:J?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Đang xử lý..."]}):c.jsxs(c.Fragment,{children:[c.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Xác nhận xóa"]})}),c.jsx("button",{type:"button",onClick:()=>q(!1),className:`mt-3 w-full inline-flex justify-center rounded-md border shadow-sm px-4 py-2 text-base font-medium sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm ${h?"bg-gray-700 hover:bg-gray-600 text-gray-300 border-gray-600":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:"Hủy bỏ"})]})]})]})});return c.jsxs("div",{className:`flex flex-col min-h-screen ${h?"bg-gray-900":"bg-slate-100"}`,children:[I<770&&c.jsx(ac,{setIsSidebarOpen:b,isDarkMode:h}),c.jsxs("div",{className:"flex min-h-screen",children:[c.jsx("div",{className:`${I<770?`fixed inset-y-0 left-0 z-20 transition-all duration-300 transform ${S?"translate-x-0":"-translate-x-full"}`:"sticky top-0 h-screen z-10"}`,children:c.jsx(ic,{sidebarData:x,documents:y,openMain:D,setOpenMain:k,selectedCategory:E,selectedDocument:N,setSelectedDocument:j,setSearch:A,setDocuments:w,isOpen:S,setIsOpen:b,hideDocumentTree:!0})}),S&&I<770&&c.jsx("div",{className:"fixed inset-0 z-10 bg-black/50",onClick:()=>b(!1)}),c.jsxs("div",{className:"flex-1 overflow-hidden",children:[I>=770&&c.jsx("div",{className:"sticky top-0 z-20 w-full",children:c.jsx(Wo,{user:l,isDarkMode:h,setIsThemePickerOpen:p,setIsSidebarOpen:b})}),c.jsx("main",{className:`p-4 md:p-6 ${h?"bg-gray-900 text-white":"bg-slate-100 text-gray-900"}`,children:c.jsxs("div",{className:"max-w-7xl mx-auto",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold",children:"Quản lý người dùng"}),c.jsx("button",{onClick:()=>de(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md",children:"Thêm người dùng"})]}),s&&c.jsx("div",{className:`px-4 py-3 rounded-md border ${h?"bg-red-900/30 border-red-800 text-red-300":"bg-red-100 border-red-400 text-red-700"} mb-4`,children:c.jsx("span",{children:s})}),a&&c.jsx("div",{className:`px-4 py-3 rounded-md border ${h?"bg-green-900/30 border-green-800 text-green-300":"bg-green-100 border-green-400 text-green-700"} mb-4`,children:c.jsx("span",{children:a})}),c.jsx(J3,{isOpen:ue,onClose:()=>de(!1),onSubmit:Oe,formData:ie,formErrors:ne,loading:fe,onChange:$e}),c.jsxs("div",{className:`rounded-lg shadow-md overflow-hidden ${h?"bg-gray-800 border border-gray-700":"bg-white"}`,children:[c.jsx("div",{className:`px-6 py-4 ${h?"bg-gray-700/50 border-b border-gray-700":"bg-gray-50 border-b border-gray-200"}`,children:c.jsxs("p",{className:`mt-1 text-sm ${h?"text-gray-400":"text-gray-500"}`,children:["Hiển thị ",t.length," người dùng trong hệ thống"]})}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:`min-w-full divide-y ${h?"divide-gray-700":"divide-gray-200"}`,children:[c.jsx("thead",{children:c.jsxs("tr",{className:h?"bg-gray-700/30":"bg-gray-50",children:[c.jsx("th",{scope:"col",className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${h?"text-gray-300":"text-gray-500"}`,children:"Người dùng"}),c.jsx("th",{scope:"col",className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${h?"text-gray-300":"text-gray-500"}`,children:"Email"}),c.jsx("th",{scope:"col",className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${h?"text-gray-300":"text-gray-500"}`,children:"Vai trò"}),c.jsx("th",{scope:"col",className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${h?"text-gray-300":"text-gray-500"}`,children:"Thao tác"}),c.jsx("th",{scope:"col",className:`px-6 py-3 text-center text-xs font-medium uppercase tracking-wider ${h?"text-gray-300":"text-gray-500"}`,children:"Xóa"})]})}),c.jsx("tbody",{className:`divide-y ${h?"divide-gray-700":"divide-gray-200"}`,children:t.map(Ae=>c.jsxs("tr",{className:h?"hover:bg-gray-700/30":"hover:bg-gray-50",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex items-center",children:[Ae.photoURL?c.jsx("img",{className:"h-10 w-10 rounded-full mr-3",src:Ae.photoURL,alt:""}):c.jsx("div",{className:`h-10 w-10 rounded-full flex items-center justify-center mr-3 ${h?"bg-gray-700":"bg-gray-200"}`,children:c.jsx("span",{className:`text-lg font-medium ${h?"text-gray-200":"text-gray-600"}`,children:Ae.displayName?Ae.displayName.charAt(0).toUpperCase():"?"})}),c.jsxs("div",{children:[c.jsx("div",{className:`text-sm font-medium ${h?"text-white":"text-gray-900"}`,children:Ae.displayName||"Không có tên"}),c.jsx("div",{className:`text-sm ${h?"text-gray-400":"text-gray-500"}`,children:Ae.phoneNumber||"Chưa cập nhật SĐT"})]})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("div",{className:`text-sm ${h?"text-gray-200":"text-gray-900"}`,children:Ae.email})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${Ae.role==="admin"?`${h?"bg-purple-900 text-purple-200":"bg-purple-100 text-purple-800"}`:Ae.role==="puser"?`${h?"bg-green-900 text-green-200":"bg-green-100 text-green-800"}`:`${h?"bg-blue-900 text-blue-200":"bg-blue-100 text-blue-800"}`}`,children:oe(Ae.role)})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:c.jsxs("select",{value:Ae.role||"fuser",onChange:ye=>he(Ae.id,ye.target.value),className:`block w-full px-3 py-2 border ${h?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"} rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm py-1`,children:[c.jsx("option",{value:"fuser",children:"Người dùng miễn phí"}),c.jsx("option",{value:"puser",children:"Người dùng trả phí"}),c.jsx("option",{value:"admin",children:"Quản trị viên"})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-center",children:c.jsx("button",{onClick:()=>We(Ae),disabled:Ae.id===(l==null?void 0:l.uid),className:`inline-flex items-center p-1.5 rounded-md ${Ae.id===(l==null?void 0:l.uid)?`${h?"text-gray-600 cursor-not-allowed":"text-gray-400 cursor-not-allowed"}`:`${h?"text-red-400 hover:bg-gray-700 hover:text-red-300":"text-red-600 hover:bg-gray-100 hover:text-red-700"}`}`,title:Ae.id===(l==null?void 0:l.uid)?"Không thể xóa tài khoản đang đăng nhập":"Xóa người dùng",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]},Ae.id))})]})})]})]})})]})]}),c.jsx(ja,{isOpen:m,onClose:()=>p(!1)}),c.jsx(Te,{})]})},Wc=({children:t})=>{const[e,r]=vn(St),{isAdmin:n,loading:s}=Yn();return r||s?c.jsx("div",{className:"min-h-screen flex items-center justify-center",children:c.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-green-500"})}):!e||!n?c.jsx(sk,{to:"/",replace:!0}):t},rG=()=>{var dt,Ct,Er,kr;const[t,e]=F.useState([]),[r,n]=F.useState(!0),[s,i]=F.useState(null),[a]=vn(St),{isAdmin:o}=Yn(),{isDarkMode:l}=Mr(),u=Or(),[h,d]=F.useState(!1),[m,p]=F.useState([]),[x,g]=F.useState({}),[y,w]=F.useState(null),[E,_]=F.useState(null),[N,j]=F.useState(0),[D,k]=F.useState(!1),[S,b]=F.useState(""),[C,A]=F.useState(window.innerWidth),[I,P]=F.useState(""),[ue,de]=F.useState(!1),[ie,ge]=F.useState({title:"",logo:""}),[ne,K]=F.useState(""),[fe,_e]=F.useState(""),[B,q]=F.useState(!1),[H,G]=F.useState(!1),[J,ae]=F.useState({id:"",title:"",logo:""}),[re,he]=F.useState(!1),[oe,Pe]=F.useState(!1),[W,$e]=F.useState(null),[Oe,We]=F.useState(!1),[Ue,Te]=F.useState(""),[Ae,ye]=F.useState(""),[De,st]=F.useState(!1),[bt,Mt]=F.useState(""),_t=[{id:"business",icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),name:"Kinh doanh"},{id:"economics",icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),name:"Kinh tế học"},{id:"accounting",icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),name:"Kế toán"},{id:"finance",icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),name:"Tài chính"},{id:"management",icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),name:"Quản trị"},{id:"marketing",icon:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"})]}),name:"Marketing"},{id:"law",icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"})}),name:"Luật"},{id:"technology",icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),name:"Công nghệ"},{id:"science",icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),name:"Khoa học"},{id:"education",icon:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[c.jsx("path",{d:"M12 14l9-5-9-5-9 5 9 5z"}),c.jsx("path",{d:"M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 14l9-5-9-5-9 5 9 5zm0 0l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14zm-4 6v-7.5l4-2.222"})]}),name:"Giáo dục"},{id:"language",icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"})}),name:"Ngôn ngữ"},{id:"statistics",icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"})}),name:"Thống kê"},{id:"mathematics",icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.871 4A17.926 17.926 0 003 12c0 2.874.673 5.59 1.871 8m14.13 0a17.926 17.926 0 001.87-8c0-2.874-.673-5.59-1.87-8M9 9h1.246a1 1 0 01.961.725l1.586 5.55a1 1 0 00.961.725H15m1-7h-.08a2 2 0 00-1.519.698L9.6 15.302A2 2 0 018.08 16H8"})}),name:"Toán học"},{id:"international",icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),name:"Quốc tế"},{id:"social",icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),name:"Xã hội học"},{id:"political",icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z"})}),name:"Chính trị"},{id:"history",icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),name:"Lịch sử"}],er=ke=>{ge({...ie,[ke.target.name]:ke.target.value})},Et=ke=>{ge({...ie,logo:ke})},kt=async ke=>{if(ke.preventDefault(),K(""),_e(""),!ie.title.trim()){K("Vui lòng nhập tên danh mục");return}if(!ie.logo){K("Vui lòng chọn biểu tượng cho danh mục");return}try{q(!0);const ut={title:ie.title.trim(),logo:ie.logo},Br=await S9(ut);e([...t,Br]),_e("Đã thêm danh mục thành công!"),setTimeout(()=>{ge({title:"",logo:""}),de(!1),_e("")},1500)}catch(ut){console.error("Error adding category:",ut),K("Đã xảy ra lỗi khi thêm danh mục. Vui lòng thử lại sau.")}finally{q(!1)}},Xe=ke=>{ae({id:ke.id,title:ke.title,logo:ke.logo||""}),G(!0)},Gt=ke=>{ae({...J,[ke.target.name]:ke.target.value})},ze=ke=>{ae({...J,logo:ke})},xt=async ke=>{if(ke.preventDefault(),K(""),_e(""),!J.title.trim()){K("Vui lòng nhập tên danh mục");return}if(!J.logo){K("Vui lòng chọn biểu tượng cho danh mục");return}try{he(!0);const ut={title:J.title.trim(),logo:J.logo},Br=await b9(J.id,ut);e(Ir=>Ir.map(Zr=>Zr.id===J.id?{...Zr,...ut}:Zr)),_e("Đã cập nhật danh mục thành công!"),setTimeout(()=>{G(!1),_e("")},1500)}catch(ut){console.error("Error updating category:",ut),K("Đã xảy ra lỗi khi cập nhật danh mục. Vui lòng thử lại sau.")}finally{he(!1)}},Tt=ke=>{if(ke.documentCount>0){Mt(`Không thể xóa danh mục "${ke.title}" vì còn chứa ${ke.documentCount} tài liệu. Vui lòng xóa tài liệu trước.`),setTimeout(()=>{Mt("")},3e3);return}$e(ke),Pe(!0),Te(""),ye(""),st(!1)},Se=async()=>{if(W){We(!0),Te(""),ye("");try{await C9(W.id),e(ke=>ke.filter(ut=>ut.id!==W.id)),ye(`Đã xóa danh mục "${W.title}" thành công!`),setTimeout(()=>{Pe(!1),$e(null),ye("")},1500)}catch(ke){console.error("Error deleting category:",ke),Te("Đã xảy ra lỗi khi xóa danh mục. Vui lòng thử lại sau.")}finally{We(!1)}}};F.useEffect(()=>{const ke=()=>{A(window.innerWidth)};return window.addEventListener("resize",ke),()=>{window.removeEventListener("resize",ke)}},[]),F.useEffect(()=>{(async()=>{if(o)try{n(!0);const ut=await kx();e(ut)}catch(ut){console.error("Error loading categories:",ut),i("Không thể tải danh sách danh mục")}finally{n(!1)}})()},[o]),F.useEffect(()=>{!r&&!o&&u("/")},[o,r,u]);const Ze=t.filter((ke,ut)=>{const Br=(ut+1).toString(),Ir=ke.title.toLowerCase(),Zr=I.toLowerCase();return Ir.includes(Zr)||Br.includes(Zr)}),_r=ke=>{const ut=_t.find(Br=>Br.id===ke);return ut?ut.icon:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})};return c.jsxs("div",{className:`flex flex-col min-h-screen ${l?"bg-gray-900":"bg-slate-100"}`,children:[C<770&&c.jsx(ac,{setIsSidebarOpen:k,isDarkMode:l}),c.jsxs("div",{className:"flex min-h-screen",children:[c.jsx("div",{className:`${C<770?`fixed inset-y-0 left-0 z-20 transition-all duration-300 transform ${D?"translate-x-0":"-translate-x-full"}`:"sticky top-0 left-0 h-screen z-10"}`,children:c.jsx(ic,{sidebarData:m,documents:x,openMain:N,setOpenMain:j,selectedCategory:y,selectedDocument:E,setSelectedDocument:_,setSearch:b,setDocuments:g,isOpen:D,setIsOpen:k,hideDocumentTree:!0})}),D&&C<770&&c.jsx("div",{className:"fixed inset-0 z-10 bg-black/50",onClick:()=>k(!1)}),c.jsxs("div",{className:"flex-1 overflow-hidden",children:[C>=770&&c.jsx("div",{className:"sticky top-0 z-20 w-full",children:c.jsx(Wo,{user:a,isDarkMode:l,setIsThemePickerOpen:d,setIsSidebarOpen:k})}),c.jsx("main",{className:`p-4 md:p-6 ${l?"bg-gray-900 text-white":"bg-slate-100 text-gray-900"}`,children:c.jsxs("div",{className:"max-w-7xl mx-auto",children:[c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:[c.jsx("h1",{className:"text-2xl font-bold mb-4 md:mb-0",children:"Quản lý Danh Mục"}),c.jsx("div",{children:c.jsxs("button",{onClick:()=>de(!0),className:`inline-flex items-center px-4 py-2 rounded-md text-sm font-medium ${l?"bg-blue-600 hover:bg-blue-700":"bg-blue-500 hover:bg-blue-600"} text-white transition-colors`,children:[c.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Thêm Danh Mục"]})})]}),c.jsx("div",{className:"w-full overflow-hidden rounded-lg shadow-md",children:c.jsxs("div",{className:`${l?"bg-gray-800 border border-gray-700":"bg-white"}`,children:[c.jsxs("div",{className:`px-6 py-4 ${l?"bg-gray-700/50 border-b border-gray-700":"bg-gray-50 border-b border-gray-200"}`,children:[c.jsx("h3",{className:`text-lg font-medium ${l?"text-gray-100":"text-gray-900"}`,children:"Danh sách danh mục"}),c.jsx("p",{className:`mt-1 text-sm ${l?"text-gray-400":"text-gray-500"}`,children:r?"Đang tải...":`Hiển thị ${Ze.length} / ${t.length} danh mục trong hệ thống`})]}),r?c.jsx("div",{className:"flex justify-center items-center py-12",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-green-500"})}):Ze.length===0?c.jsxs("div",{className:"text-center py-12",children:[c.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),c.jsx("p",{className:`mt-2 text-sm font-medium ${l?"text-gray-400":"text-gray-500"}`,children:"Không tìm thấy danh mục nào"}),c.jsx("p",{className:`text-sm ${l?"text-gray-500":"text-gray-400"}`,children:"Thử thay đổi bộ lọc hoặc thêm danh mục mới"})]}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"md:hidden",children:c.jsxs("table",{className:`min-w-full divide-y ${l?"divide-gray-700":"divide-gray-200"}`,children:[c.jsx("thead",{children:c.jsxs("tr",{className:l?"bg-gray-700/30":"bg-gray-50",children:[c.jsx("th",{scope:"col",className:`px-3 py-3 text-left text-xs font-medium uppercase tracking-wider ${l?"text-gray-300":"text-gray-500"}`,children:"STT"}),c.jsx("th",{scope:"col",className:`px-3 py-3 text-left text-xs font-medium uppercase tracking-wider ${l?"text-gray-300":"text-gray-500"}`,children:"Danh mục"}),c.jsx("th",{scope:"col",className:`px-3 py-3 text-right text-xs font-medium uppercase tracking-wider ${l?"text-gray-300":"text-gray-500"}`,children:c.jsx("span",{className:"sr-only",children:"Thao tác"})})]})}),c.jsx("tbody",{className:`divide-y ${l?"divide-gray-700":"divide-gray-200"}`,children:Ze.map((ke,ut)=>c.jsxs("tr",{className:l?"hover:bg-gray-700/30":"hover:bg-gray-50",children:[c.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-center",children:c.jsx("div",{className:`text-sm ${l?"text-gray-300":"text-gray-500"}`,children:ut+1})}),c.jsx("td",{className:"px-3 py-3",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:`w-8 h-8 flex-shrink-0 mr-2 flex items-center justify-center rounded-md ${l?"bg-gray-600":"bg-blue-100"}`,children:c.jsx("div",{className:`h-5 w-5 ${l?"text-blue-300":"text-blue-600"}`,children:_r(ke.logo)})}),c.jsxs("div",{children:[c.jsx("div",{className:`text-sm font-medium ${l?"text-white":"text-gray-900"}`,children:ke.title}),c.jsxs("div",{className:`text-xs ${l?"text-gray-400":"text-gray-500"}`,children:[ke.documentCount||0," tài liệu"]})]})]})}),c.jsx("td",{className:"px-3 py-3 whitespace-nowrap text-right text-sm",children:c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx("button",{onClick:()=>Xe(ke),className:`p-1.5 rounded-md ${l?"text-blue-400 hover:bg-gray-700 hover:text-blue-300":"text-blue-600 hover:bg-gray-100 hover:text-blue-700"}`,title:"Chỉnh sửa danh mục",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),c.jsx("button",{onClick:()=>Tt(ke),className:`p-1.5 rounded-md ${ke.documentCount>0?l?"text-gray-600 cursor-not-allowed":"text-gray-400 cursor-not-allowed":l?"text-red-400 hover:bg-gray-700 hover:text-red-300":"text-red-600 hover:bg-gray-100 hover:text-red-700"}`,title:ke.documentCount>0?"Không thể xóa danh mục có tài liệu":"Xóa danh mục",disabled:ke.documentCount>0,children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},ke.id))})]})}),c.jsx("div",{className:"hidden md:block w-full overflow-x-auto",style:{WebkitOverflowScrolling:"touch"},children:c.jsxs("table",{className:`min-w-full divide-y ${l?"divide-gray-700":"divide-gray-200"}`,children:[c.jsx("thead",{children:c.jsxs("tr",{className:l?"bg-gray-700/30":"bg-gray-50",children:[c.jsx("th",{scope:"col",className:`sticky top-0 px-4 sm:px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${l?"text-gray-300 bg-gray-700/50":"text-gray-500 bg-gray-50"}`,children:"STT"}),c.jsx("th",{scope:"col",className:`sticky top-0 px-4 sm:px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${l?"text-gray-300 bg-gray-700/50":"text-gray-500 bg-gray-50"}`,children:"Biểu tượng"}),c.jsx("th",{scope:"col",className:`sticky top-0 px-4 sm:px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${l?"text-gray-300 bg-gray-700/50":"text-gray-500 bg-gray-50"}`,children:"Tên danh mục"}),c.jsx("th",{scope:"col",className:`sticky top-0 px-4 sm:px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${l?"text-gray-300 bg-gray-700/50":"text-gray-500 bg-gray-50"}`,children:"Số tài liệu"}),c.jsx("th",{scope:"col",className:`sticky top-0 px-4 sm:px-6 py-3 text-right text-xs font-medium uppercase tracking-wider ${l?"text-gray-300 bg-gray-700/50":"text-gray-500 bg-gray-50"}`,children:c.jsx("span",{className:"sr-only",children:"Thao tác"})})]})}),c.jsx("tbody",{className:`divide-y ${l?"divide-gray-700":"divide-gray-200"}`,children:Ze.map((ke,ut)=>c.jsxs("tr",{className:l?"hover:bg-gray-700/30":"hover:bg-gray-50",children:[c.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:c.jsx("div",{className:`text-sm ${l?"text-gray-300":"text-gray-500"}`,children:ut+1})}),c.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:c.jsx("div",{className:"flex items-center justify-center",children:c.jsx("div",{className:`w-8 h-8 flex items-center justify-center rounded-md ${l?"bg-gray-600":"bg-blue-100"}`,children:c.jsx("div",{className:`h-5 w-5 ${l?"text-blue-300":"text-blue-600"}`,children:_r(ke.logo)})})})}),c.jsxs("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:[c.jsx("div",{className:`text-sm font-medium ${l?"text-white":"text-gray-900"}`,children:ke.title}),c.jsxs("div",{className:`text-xs mt-1 md:hidden ${l?"text-gray-400":"text-gray-500"}`,children:[ke.documentCount||0," tài liệu"]})]}),c.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap hidden md:table-cell",children:c.jsxs("div",{className:`text-sm ${l?"text-gray-300":"text-gray-500"}`,children:[ke.documentCount||0," tài liệu"]})}),c.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-right text-sm",children:c.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[c.jsx("button",{onClick:()=>Xe(ke),className:`inline-flex items-center p-1.5 rounded-md ${l?"text-blue-400 hover:bg-gray-700 hover:text-blue-300":"text-blue-600 hover:bg-gray-100 hover:text-blue-700"}`,title:"Chỉnh sửa danh mục",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),c.jsx("button",{onClick:()=>(ke.documentCount>0,Tt(ke)),className:`inline-flex items-center p-1.5 rounded-md ${l?"text-gray-600 cursor-not-allowed":"text-gray-400 cursor-not-allowed"}`,title:"Xóa danh mục",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},ke.id))})]})})]})]})})]})})]})]}),ue&&c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:c.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-70"})}),c.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),c.jsxs("div",{className:`inline-block align-bottom rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full ${l?"bg-gray-700 border border-gray-600":"bg-gray-50 border border-gray-200"}`,children:[c.jsx("div",{className:`px-6 py-4 border-b ${l?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h3",{className:`text-lg font-medium ${l?"text-white":"text-gray-900"}`,children:"Thêm danh mục mới"}),c.jsx("button",{type:"button",className:`rounded-md p-1 focus:outline-none ${l?"text-gray-400 hover:text-gray-200":"text-gray-500 hover:text-gray-700"}`,onClick:()=>de(!1),children:c.jsx("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),c.jsx("div",{className:`px-6 py-5 ${l?"bg-gray-700 text-gray-200":"bg-gray-50 text-gray-800"}`,children:c.jsxs("form",{onSubmit:kt,children:[c.jsxs("div",{className:"mb-5",children:[c.jsxs("label",{htmlFor:"title",className:`block text-sm font-medium mb-1 ${l?"text-gray-300":"text-gray-700"}`,children:["Tên danh mục ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",name:"title",id:"title",value:ie.title,onChange:er,className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 ${l?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"}`,placeholder:"Nhập tên danh mục"})]}),c.jsxs("div",{className:"mb-5",children:[c.jsxs("label",{className:`block text-sm font-medium mb-1 ${l?"text-gray-300":"text-gray-700"}`,children:["Biểu tượng ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("div",{className:`p-4 rounded-md mb-3 ${l?"bg-gray-700 border border-gray-600":"bg-gray-50 border border-gray-200"}`,children:c.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-6 gap-3 max-h-56 overflow-y-auto",children:_t.map(ke=>c.jsxs("button",{type:"button",onClick:()=>Et(ke.id),className:`flex flex-col items-center justify-center p-2 rounded-md transition-colors ${ie.logo===ke.id?l?"bg-green-700 text-white ring-2 ring-green-500":"bg-green-100 text-green-800 ring-2 ring-green-500":l?"bg-gray-800 hover:bg-gray-600 text-white":"bg-white hover:bg-gray-100 text-gray-800 border border-gray-200"}`,title:ke.name,children:[c.jsx("div",{className:"mb-1",children:ke.icon}),c.jsx("span",{className:"text-xs truncate w-full text-center",children:ke.name})]},ke.id))})}),c.jsx("div",{className:`text-sm ${l?"text-gray-400":"text-gray-600"}`,children:ie.logo?c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"mr-2",children:"Đã chọn:"}),c.jsx("span",{className:"mr-2 text-gray-700 dark:text-gray-300",children:(dt=_t.find(ke=>ke.id===ie.logo))==null?void 0:dt.icon}),c.jsx("span",{className:"font-medium",children:(Ct=_t.find(ke=>ke.id===ie.logo))==null?void 0:Ct.name})]}):"Vui lòng chọn một biểu tượng cho danh mục"})]}),fe&&c.jsx("div",{className:`p-3 mb-4 text-sm rounded-md ${l?"bg-green-900/30 text-green-300 border border-green-800":"bg-green-50 text-green-700 border border-green-200"}`,children:c.jsxs("div",{className:"flex",children:[c.jsx("svg",{className:"h-5 w-5 mr-2 text-green-400 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),c.jsx("span",{children:fe})]})}),ne&&c.jsx("div",{className:`p-3 mb-4 text-sm rounded-md ${l?"bg-red-900/30 text-red-300 border border-red-800":"bg-red-50 text-red-700 border border-red-200"}`,children:c.jsxs("div",{className:"flex",children:[c.jsx("svg",{className:"h-5 w-5 mr-2 text-red-400 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),c.jsx("span",{children:ne})]})})]})}),c.jsxs("div",{className:`px-6 py-4 sm:flex sm:flex-row-reverse ${l?"bg-gray-700 border-t border-gray-600":"bg-gray-50 border-t border-gray-200"}`,children:[c.jsx("button",{type:"button",onClick:kt,disabled:B,className:`w-full inline-flex justify-center items-center rounded-md border border-transparent shadow-sm px-4 py-2 text-base font-medium text-white sm:ml-3 sm:w-auto sm:text-sm ${B?"bg-green-500 cursor-not-allowed":l?"bg-green-700 hover:bg-green-600 focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-green-500":"bg-green-600 hover:bg-green-700 focus:ring-2 focus:ring-offset-2 focus:ring-green-500"}`,children:B?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Đang xử lý..."]}):c.jsxs(c.Fragment,{children:[c.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Thêm danh mục"]})}),c.jsx("button",{type:"button",onClick:()=>de(!1),className:`mt-3 w-full inline-flex justify-center rounded-md border shadow-sm px-4 py-2 text-base font-medium sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm ${l?"bg-gray-700 hover:bg-gray-600 text-gray-300 border-gray-600":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:"Hủy bỏ"})]})]})]})}),H&&c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:c.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-70"})}),c.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),c.jsxs("div",{className:`inline-block align-bottom rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full ${l?"bg-gray-700 border border-gray-600":"bg-gray-50 border border-gray-200"}`,children:[c.jsx("div",{className:`px-6 py-4 border-b ${l?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h3",{className:`text-lg font-medium ${l?"text-white":"text-gray-900"}`,children:"Chỉnh sửa danh mục"}),c.jsx("button",{type:"button",className:`rounded-md p-1 focus:outline-none ${l?"text-gray-400 hover:text-gray-200":"text-gray-500 hover:text-gray-700"}`,onClick:()=>G(!1),children:c.jsx("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),c.jsx("div",{className:`px-6 py-5 ${l?"bg-gray-700 text-gray-200":"bg-gray-50 text-gray-800"}`,children:c.jsxs("form",{onSubmit:xt,children:[c.jsxs("div",{className:"mb-5",children:[c.jsxs("label",{htmlFor:"edit-title",className:`block text-sm font-medium mb-1 ${l?"text-gray-300":"text-gray-700"}`,children:["Tên danh mục ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",name:"title",id:"edit-title",value:J.title,onChange:Gt,className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 ${l?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"}`,placeholder:"Nhập tên danh mục"})]}),c.jsxs("div",{className:"mb-5",children:[c.jsxs("label",{className:`block text-sm font-medium mb-1 ${l?"text-gray-300":"text-gray-700"}`,children:["Biểu tượng ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("div",{className:`p-4 rounded-md mb-3 ${l?"bg-gray-700 border border-gray-600":"bg-gray-50 border border-gray-200"}`,children:c.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-6 gap-3 max-h-56 overflow-y-auto",children:_t.map(ke=>c.jsxs("button",{type:"button",onClick:()=>ze(ke.id),className:`flex flex-col items-center justify-center p-2 rounded-md transition-colors ${J.logo===ke.id?l?"bg-green-700 text-white ring-2 ring-green-500":"bg-green-100 text-green-800 ring-2 ring-green-500":l?"bg-gray-800 hover:bg-gray-600 text-white":"bg-white hover:bg-gray-100 text-gray-800 border border-gray-200"}`,title:ke.name,children:[c.jsx("div",{className:"mb-1",children:ke.icon}),c.jsx("span",{className:"text-xs truncate w-full text-center",children:ke.name})]},ke.id))})}),c.jsx("div",{className:`text-sm ${l?"text-gray-400":"text-gray-600"}`,children:J.logo?c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"mr-2",children:"Đã chọn:"}),c.jsx("span",{className:"mr-2 text-gray-700 dark:text-gray-300",children:(Er=_t.find(ke=>ke.id===J.logo))==null?void 0:Er.icon}),c.jsx("span",{className:"font-medium",children:(kr=_t.find(ke=>ke.id===J.logo))==null?void 0:kr.name})]}):"Vui lòng chọn một biểu tượng cho danh mục"})]}),fe&&c.jsx("div",{className:`p-3 mb-4 text-sm rounded-md ${l?"bg-green-900/30 text-green-300 border border-green-800":"bg-green-50 text-green-700 border border-green-200"}`,children:c.jsxs("div",{className:"flex",children:[c.jsx("svg",{className:"h-5 w-5 mr-2 text-green-400 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),c.jsx("span",{children:fe})]})}),ne&&c.jsx("div",{className:`p-3 mb-4 text-sm rounded-md ${l?"bg-red-900/30 text-red-300 border border-red-800":"bg-red-50 text-red-700 border border-red-200"}`,children:c.jsxs("div",{className:"flex",children:[c.jsx("svg",{className:"h-5 w-5 mr-2 text-red-400 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),c.jsx("span",{children:ne})]})})]})}),c.jsxs("div",{className:`px-6 py-4 sm:flex sm:flex-row-reverse ${l?"bg-gray-700 border-t border-gray-600":"bg-gray-50 border-t border-gray-200"}`,children:[c.jsx("button",{type:"button",onClick:xt,disabled:re,className:`w-full inline-flex justify-center items-center rounded-md border border-transparent shadow-sm px-4 py-2 text-base font-medium text-white sm:ml-3 sm:w-auto sm:text-sm ${re?"bg-blue-500 cursor-not-allowed":l?"bg-blue-700 hover:bg-blue-600 focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-blue-500":"bg-blue-600 hover:bg-blue-700 focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}`,children:re?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Đang xử lý..."]}):c.jsxs(c.Fragment,{children:[c.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),"Cập nhật danh mục"]})}),c.jsx("button",{type:"button",onClick:()=>G(!1),className:`mt-3 w-full inline-flex justify-center rounded-md border shadow-sm px-4 py-2 text-base font-medium sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm ${l?"bg-gray-700 hover:bg-gray-600 text-gray-300 border-gray-600":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:"Hủy bỏ"})]})]})]})}),oe&&c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:c.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-70"})}),c.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),c.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),c.jsxs("div",{className:`inline-block align-bottom rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full ${l?"bg-gray-700 border border-gray-600":"bg-gray-50 border border-gray-200"}`,children:[c.jsx("div",{className:`px-6 py-4 border-b ${l?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h3",{className:`text-lg font-medium ${l?"text-white":"text-gray-900"}`,children:"Xác nhận xóa danh mục"}),c.jsx("button",{type:"button",className:`rounded-md p-1 focus:outline-none ${l?"text-gray-400 hover:text-gray-200":"text-gray-500 hover:text-gray-700"}`,onClick:()=>Pe(!1),children:c.jsx("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),c.jsx("div",{className:`px-6 py-5 ${l?"bg-gray-700 text-gray-200":"bg-gray-50 text-gray-800"}`,children:Ae?c.jsx("div",{className:`p-3 mb-4 text-sm rounded-md ${l?"bg-green-900/30 text-green-300 border border-green-800":"bg-green-50 text-green-700 border border-green-200"}`,children:c.jsxs("div",{className:"flex",children:[c.jsx("svg",{className:"h-5 w-5 mr-2 text-green-400 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),c.jsx("span",{children:Ae})]})}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"mb-5 flex items-center justify-center",children:c.jsx("div",{className:`flex h-12 w-12 items-center justify-center rounded-full ${l?"bg-red-900/30":"bg-red-100"} mx-auto`,children:c.jsx("svg",{className:`h-6 w-6 ${l?"text-red-400":"text-red-600"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})}),c.jsxs("p",{className:`text-center text-sm mb-5 ${l?"text-gray-300":"text-gray-700"}`,children:["Bạn có chắc chắn muốn xóa danh mục ",c.jsx("span",{className:"font-semibold",children:W==null?void 0:W.title}),"?",c.jsx("br",{}),c.jsx("span",{className:"text-red-500 font-medium",children:"Tất cả tài liệu và câu hỏi trong danh mục này sẽ bị xóa."}),c.jsx("br",{}),"Hành động này không thể hoàn tác."]}),Ue&&c.jsx("div",{className:`p-3 mb-4 text-sm rounded-md ${l?"bg-red-900/30 text-red-300 border border-red-800":"bg-red-50 text-red-700 border border-red-200"}`,children:c.jsxs("div",{className:"flex",children:[c.jsx("svg",{className:"h-5 w-5 mr-2 text-red-400 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),c.jsx("span",{children:Ue})]})})]})}),c.jsx("div",{className:`px-6 py-4 sm:flex ${Ae?"justify-center":"sm:flex-row-reverse"} ${l?"bg-gray-700 border-t border-gray-600":"bg-gray-50 border-t border-gray-200"}`,children:Ae?c.jsx("button",{type:"button",onClick:()=>Pe(!1),className:`mt-3 w-full inline-flex justify-center rounded-md border shadow-sm px-4 py-2 text-base font-medium sm:mt-0 sm:w-auto sm:text-sm ${l?"bg-gray-700 hover:bg-gray-600 text-gray-300 border-gray-600":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:"Đóng"}):c.jsxs(c.Fragment,{children:[c.jsx("button",{type:"button",onClick:Se,disabled:Oe,className:`w-full inline-flex justify-center items-center rounded-md border border-transparent shadow-sm px-4 py-2 text-base font-medium text-white sm:ml-3 sm:w-auto sm:text-sm ${Oe?"bg-red-500 cursor-not-allowed":l?"bg-red-700 hover:bg-red-600 focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-red-500":"bg-red-600 hover:bg-red-700 focus:ring-2 focus:ring-offset-2 focus:ring-red-500"}`,children:Oe?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Đang xử lý..."]}):c.jsxs(c.Fragment,{children:[c.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Xác nhận xóa"]})}),c.jsx("button",{type:"button",onClick:()=>Pe(!1),className:`mt-3 w-full inline-flex justify-center rounded-md border shadow-sm px-4 py-2 text-base font-medium sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm ${l?"bg-gray-700 hover:bg-gray-600 text-gray-300 border-gray-600":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:"Hủy bỏ"})]})})]})]})}),c.jsx(ja,{isOpen:h,onClose:()=>d(!1)}),bt&&c.jsx("div",{className:`fixed bottom-4 right-4 p-4 rounded-md shadow-lg ${l?"bg-red-900 text-red-200":"bg-red-100 text-red-800"} z-50 max-w-md`,children:c.jsxs("div",{className:"flex items-start",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("svg",{className:"h-5 w-5 text-red-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),c.jsx("div",{className:"ml-3",children:c.jsx("p",{className:"text-sm font-medium",children:bt})}),c.jsx("div",{className:"ml-auto pl-3",children:c.jsx("div",{className:"-mx-1.5 -my-1.5",children:c.jsxs("button",{onClick:()=>Mt(""),className:`inline-flex rounded-md p-1.5 ${l?"text-red-300 hover:bg-red-800":"text-red-500 hover:bg-red-200"} focus:outline-none`,children:[c.jsx("span",{className:"sr-only",children:"Đóng"}),c.jsx("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 011.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})})})]})})]})},nG=()=>{console.log("DocumentManagement component is rendering");const[t,e]=F.useState([]),[r,n]=F.useState([]),[s,i]=F.useState(!0),[a,o]=F.useState(null),[l]=vn(St),{isAdmin:u}=Yn(),{isDarkMode:h}=Mr(),d=Or(),[m,p]=F.useState(!1),[x,g]=F.useState([]),[y,w]=F.useState({}),[E,_]=F.useState(null),[N,j]=F.useState(null),[D,k]=F.useState(0),[S,b]=F.useState(!1),[C,A]=F.useState(""),[I,P]=F.useState(window.innerWidth),[ue,de]=F.useState(""),[ie,ge]=F.useState("all"),[ne,K]=F.useState(!1),[fe,_e]=F.useState(!1),[B,q]=F.useState(!1),[H,G]=F.useState({title:"",categoryId:""}),[J,ae]=F.useState({id:"",title:"",categoryId:""}),[re,he]=F.useState(null),[oe,Pe]=F.useState(""),[W,$e]=F.useState(""),[Oe,We]=F.useState(!1),[Ue,Te]=F.useState(!1),[Ae,ye]=F.useState(!1),[De,st]=F.useState(""),[bt,Mt]=F.useState("");F.useEffect(()=>{const Se=()=>{P(window.innerWidth)};return window.addEventListener("resize",Se),()=>{window.removeEventListener("resize",Se)}},[]),F.useEffect(()=>{(async()=>{if(console.log("Loading data, isAdmin:",u),!u){console.log("User is not admin, returning early");return}try{i(!0),console.log("Fetching categories and documents");const Ze=await Tx(),_r=await kx(),dt=[];Ze.forEach(Ct=>{if(Ct.documents&&Ct.documents.length>0){const Er=Ct.documents.map(kr=>({...kr,categoryTitle:Ct.title,categoryId:Ct.id,categoryLogo:Ct.logo||null}));dt.push(...Er)}}),e(_r),n(dt)}catch(Ze){console.error("Error loading data:",Ze),o("Không thể tải danh sách tài liệu và danh mục")}finally{i(!1)}})()},[u]),F.useEffect(()=>{!s&&!u&&d("/")},[u,s,d]);const _t=Se=>{ge(Se.target.value)},er=Se=>{G({...H,[Se.target.name]:Se.target.value})},Et=Se=>{ae({...J,[Se.target.name]:Se.target.value})},kt=async Se=>{if(Se.preventDefault(),Pe(""),$e(""),!H.title.trim()){Pe("Vui lòng nhập tên tài liệu");return}if(!H.categoryId){Pe("Vui lòng chọn danh mục");return}try{We(!0);const Ze={title:H.title.trim(),categoryId:H.categoryId},_r=await F9(Ze),dt=t.find(Ct=>Ct.id===Ze.categoryId);n(Ct=>[...Ct,{..._r,categoryTitle:(dt==null?void 0:dt.title)||"",categoryLogo:(dt==null?void 0:dt.logo)||null}]),$e("Đã thêm tài liệu thành công!"),setTimeout(()=>{G({title:"",categoryId:""}),K(!1),$e("")},1500)}catch(Ze){console.error("Error adding document:",Ze),Pe("Đã xảy ra lỗi khi thêm tài liệu. Vui lòng thử lại sau.")}finally{We(!1)}},Xe=async Se=>{if(Se.preventDefault(),Pe(""),$e(""),!J.title.trim()){Pe("Vui lòng nhập tên tài liệu");return}if(!J.categoryId){Pe("Vui lòng chọn danh mục");return}try{We(!0);const Ze={title:J.title.trim(),categoryId:J.categoryId},_r=await L9(J.id,Ze),dt=t.find(Ct=>Ct.id===Ze.categoryId);n(Ct=>Ct.map(Er=>Er.id===J.id?{..._r,categoryTitle:(dt==null?void 0:dt.title)||"",categoryLogo:(dt==null?void 0:dt.logo)||null}:Er)),$e("Đã cập nhật tài liệu thành công!"),setTimeout(()=>{_e(!1),$e("")},1500)}catch(Ze){console.error("Error updating document:",Ze),Pe("Đã xảy ra lỗi khi cập nhật tài liệu. Vui lòng thử lại sau.")}finally{We(!1)}},Gt=async()=>{if(!(!re||!Ue)){ye(!0),st(""),Mt("");try{await P9(re.id),n(Se=>Se.filter(Ze=>Ze.id!==re.id)),Mt(`Đã xóa tài liệu "${re.title}" thành công!`),setTimeout(()=>{q(!1),he(null),Mt("")},1500)}catch(Se){console.error("Error deleting document:",Se),st("Đã xảy ra lỗi khi xóa tài liệu. Vui lòng thử lại sau.")}finally{ye(!1)}}},ze=r.filter((Se,Ze)=>{var ut;const _r=(Ze+1).toString(),dt=Se.title.toLowerCase(),Ct=((ut=Se.categoryTitle)==null?void 0:ut.toLowerCase())||"",Er=ue.toLowerCase(),kr=dt.includes(Er)||Ct.includes(Er)||_r.includes(Er),ke=ie==="all"||Se.categoryId===ie;return kr&&ke}),xt=Se=>{ae({id:Se.id,title:Se.title,categoryId:Se.categoryId}),_e(!0),Pe(""),$e("")},Tt=Se=>{he(Se),q(!0),st(""),Mt(""),Te(!1)};return c.jsxs("div",{className:`flex flex-col min-h-screen ${h?"bg-gray-900":"bg-slate-100"}`,children:[I<770&&c.jsx(ac,{setIsSidebarOpen:b,isDarkMode:h}),c.jsxs("div",{className:"flex min-h-screen",children:[c.jsx("div",{className:`${I<770?`fixed inset-y-0 left-0 z-20 transition-all duration-300 transform ${S?"translate-x-0":"-translate-x-full"}`:"sticky top-0 h-screen z-10"}`,children:c.jsx(ic,{sidebarData:x,documents:y,openMain:D,setOpenMain:k,selectedCategory:E,selectedDocument:N,setSelectedDocument:j,setSearch:A,setDocuments:w,isOpen:S,setIsOpen:b,hideDocumentTree:!0})}),S&&I<770&&c.jsx("div",{className:"fixed inset-0 z-10 bg-black/50",onClick:()=>b(!1)}),c.jsxs("div",{className:"flex-1 overflow-hidden",children:[I>=770&&c.jsx("div",{className:"sticky top-0 z-20 w-full",children:c.jsx(Wo,{user:l,isDarkMode:h,setIsThemePickerOpen:p,setIsSidebarOpen:b})}),c.jsx("main",{className:`p-4 md:p-6 ${h?"bg-gray-900 text-white":"bg-slate-100 text-gray-900"}`,children:c.jsxs("div",{className:"max-w-7xl mx-auto",children:[c.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:c.jsx("h1",{className:"text-2xl font-bold mb-4 md:mb-0",children:"Quản lý Tài Liệu"})}),c.jsxs("div",{className:"flex-1 p-6",children:[c.jsx("div",{className:"mb-8",children:c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[c.jsx("div",{children:c.jsxs("button",{onClick:()=>K(!0),className:`inline-flex items-center px-4 py-2 rounded-md text-sm font-medium ${h?"bg-green-700 hover:bg-green-600 text-white":"bg-green-600 hover:bg-green-700 text-white"} transition-colors shadow-sm`,children:[c.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Thêm tài liệu mới"]})}),c.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:items-center",children:[c.jsx("div",{className:`relative rounded-lg overflow-hidden ${h?"bg-gray-800":"bg-white"} shadow-sm w-full md:w-64`,children:c.jsxs("select",{value:ie,onChange:_t,className:`w-full px-4 py-2.5 ${h?"bg-gray-800 text-white border-gray-700":"bg-white text-gray-900 border-gray-200"} border-0 focus:ring-2 focus:ring-green-500 focus:border-transparent`,children:[c.jsx("option",{value:"all",children:"Tất cả danh mục"}),t.map(Se=>c.jsx("option",{value:Se.id,children:Se.title},Se.id))]})}),c.jsxs("div",{className:`relative rounded-lg overflow-hidden ${h?"bg-gray-800":"bg-white"} shadow-sm w-full md:w-96 lg:w-[500px]`,children:[c.jsx("input",{type:"text",placeholder:"Tìm kiếm tài liệu theo tên, danh mục hoặc STT...",value:ue,onChange:Se=>de(Se.target.value),className:`w-full px-4 py-3 pl-10 ${h?"bg-gray-800 text-white placeholder-gray-400 border-gray-700":"bg-white text-gray-900 placeholder-gray-500 border-gray-200"} border-0 focus:ring-2 focus:ring-green-500 focus:border-transparent`}),c.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3",children:c.jsx("svg",{className:`w-5 h-5 ${h?"text-gray-400":"text-gray-500"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})]})]})}),a&&c.jsx("div",{className:`px-4 py-3 rounded-md border ${h?"bg-red-900/30 border-red-800 text-red-300":"bg-red-100 border-red-400 text-red-700"} mb-4`,children:c.jsx("span",{children:a})}),c.jsx("div",{className:"w-full overflow-hidden rounded-lg shadow-md",children:c.jsxs("div",{className:`${h?"bg-gray-800 border border-gray-700":"bg-white"}`,children:[c.jsxs("div",{className:`px-6 py-4 ${h?"bg-gray-700/50 border-b border-gray-700":"bg-gray-50 border-b border-gray-200"}`,children:[c.jsx("h3",{className:`text-lg font-medium ${h?"text-gray-100":"text-gray-900"}`,children:"Danh sách tài liệu"}),c.jsx("p",{className:`mt-1 text-sm ${h?"text-gray-400":"text-gray-500"}`,children:s?"Đang tải...":`Hiển thị ${ze.length} / ${r.length} tài liệu trong hệ thống`})]}),s?c.jsx("div",{className:"flex justify-center items-center py-12",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-green-500"})}):ze.length===0?c.jsxs("div",{className:"text-center py-12",children:[c.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),c.jsx("p",{className:`mt-2 text-sm font-medium ${h?"text-gray-400":"text-gray-500"}`,children:"Không tìm thấy tài liệu nào"}),c.jsx("p",{className:`text-sm ${h?"text-gray-500":"text-gray-400"}`,children:"Thử thay đổi bộ lọc hoặc thêm tài liệu mới"})]}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"md:hidden",children:ze.map((Se,Ze)=>c.jsx("div",{className:`px-4 py-3 border-b ${h?"border-gray-700":"border-gray-200"} ${h?"hover:bg-gray-700/30":"hover:bg-gray-50"}`,children:c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{className:"flex space-x-3 items-center",children:[c.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[c.jsx("span",{className:`text-xs font-medium ${h?"text-gray-400":"text-gray-500"}`,children:Ze+1}),c.jsx("div",{className:`w-8 h-8 flex items-center justify-center rounded-md ${h?"bg-gray-600":"bg-blue-100"}`,children:c.jsx("svg",{className:`h-5 w-5 ${h?"text-blue-300":"text-blue-600"}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})})]}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h4",{className:`text-sm font-medium ${h?"text-white":"text-gray-900"}`,children:Se.title}),c.jsx("div",{className:"mt-1 flex flex-col space-y-1",children:c.jsxs("span",{className:`flex items-center text-xs ${h?"text-gray-400":"text-gray-500"}`,children:[c.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),Se.categoryTitle||"Không có danh mục"]})})]})]}),c.jsxs("div",{className:"flex space-x-1",children:[c.jsx("button",{onClick:()=>xt(Se),className:`p-1.5 rounded-md ${h?"text-blue-400 hover:bg-gray-700 hover:text-blue-300":"text-blue-600 hover:bg-gray-100 hover:text-blue-700"}`,title:"Chỉnh sửa tài liệu",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),c.jsx("button",{onClick:()=>Tt(Se),className:`p-1.5 rounded-md ${h?"text-red-400 hover:bg-gray-700 hover:text-red-300":"text-red-600 hover:bg-gray-100 hover:text-red-700"}`,title:"Xóa tài liệu",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},Se.id))}),c.jsx("div",{className:"hidden md:block w-full overflow-x-auto",style:{WebkitOverflowScrolling:"touch"},children:c.jsxs("table",{className:`min-w-full divide-y ${h?"divide-gray-700":"divide-gray-200"}`,children:[c.jsx("thead",{children:c.jsxs("tr",{className:h?"bg-gray-700/30":"bg-gray-50",children:[c.jsx("th",{scope:"col",className:`sticky top-0 px-4 sm:px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${h?"text-gray-300 bg-gray-700/50":"text-gray-500 bg-gray-50"}`,children:"STT"}),c.jsx("th",{scope:"col",className:`sticky top-0 px-4 sm:px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${h?"text-gray-300 bg-gray-700/50":"text-gray-500 bg-gray-50"}`,children:"Biểu tượng"}),c.jsx("th",{scope:"col",className:`sticky top-0 px-4 sm:px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${h?"text-gray-300 bg-gray-700/50":"text-gray-500 bg-gray-50"}`,children:"Tên tài liệu"}),c.jsx("th",{scope:"col",className:`sticky top-0 px-4 sm:px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${h?"text-gray-300 bg-gray-700/50":"text-gray-500 bg-gray-50"}`,children:"Danh mục"}),c.jsx("th",{scope:"col",className:`sticky top-0 px-4 sm:px-6 py-3 text-right text-xs font-medium uppercase tracking-wider ${h?"text-gray-300 bg-gray-700/50":"text-gray-500 bg-gray-50"}`,children:c.jsx("span",{className:"sr-only",children:"Thao tác"})})]})}),c.jsx("tbody",{className:`divide-y ${h?"divide-gray-700":"divide-gray-200"}`,children:ze.map((Se,Ze)=>c.jsxs("tr",{className:h?"hover:bg-gray-700/30":"hover:bg-gray-50",children:[c.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:c.jsx("div",{className:`text-sm ${h?"text-gray-300":"text-gray-500"}`,children:Ze+1})}),c.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:c.jsx("div",{className:"flex items-center justify-center",children:c.jsx("div",{className:`w-8 h-8 flex items-center justify-center rounded-md ${h?"bg-gray-600":"bg-blue-100"}`,children:c.jsx("svg",{className:`h-5 w-5 ${h?"text-blue-300":"text-blue-600"}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})})})}),c.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:c.jsx("div",{className:`text-sm font-medium ${h?"text-white":"text-gray-900"}`,children:Se.title})}),c.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap hidden md:table-cell",children:c.jsx("div",{className:`text-sm ${h?"text-gray-300":"text-gray-500"}`,children:Se.categoryTitle||"Không có danh mục"})}),c.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-right text-sm",children:c.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[c.jsx("button",{onClick:()=>xt(Se),className:`inline-flex items-center p-1.5 rounded-md ${h?"text-blue-400 hover:bg-gray-700 hover:text-blue-300":"text-blue-600 hover:bg-gray-100 hover:text-blue-700"}`,title:"Chỉnh sửa tài liệu",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),c.jsx("button",{onClick:()=>Tt(Se),className:`inline-flex items-center p-1.5 rounded-md ${h?"text-red-400 hover:bg-gray-700 hover:text-red-300":"text-red-600 hover:bg-gray-100 hover:text-red-700"}`,title:"Xóa tài liệu",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},Se.id))})]})})]})]})})]})]})})]})]}),c.jsx(ja,{isOpen:m,onClose:()=>p(!1)}),ne&&c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:c.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-70"})}),c.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),c.jsxs("div",{className:`inline-block align-bottom rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full ${h?"bg-gray-700 border border-gray-600":"bg-gray-50 border border-gray-200"}`,children:[c.jsx("div",{className:`px-6 py-4 border-b ${h?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h3",{className:`text-lg font-medium ${h?"text-white":"text-gray-900"}`,children:"Thêm tài liệu mới"}),c.jsx("button",{type:"button",className:`rounded-md p-1 focus:outline-none ${h?"text-gray-400 hover:text-gray-200":"text-gray-500 hover:text-gray-700"}`,onClick:()=>K(!1),children:c.jsx("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),c.jsx("div",{className:`px-6 py-5 ${h?"bg-gray-700 text-gray-200":"bg-gray-50 text-gray-800"}`,children:c.jsxs("form",{onSubmit:kt,children:[c.jsxs("div",{className:"mb-5",children:[c.jsxs("label",{htmlFor:"title",className:`block text-sm font-medium mb-1 ${h?"text-gray-300":"text-gray-700"}`,children:["Tên tài liệu ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",name:"title",id:"title",value:H.title,onChange:er,className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 ${h?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"}`,placeholder:"Nhập tên tài liệu"})]}),c.jsxs("div",{className:"mb-5",children:[c.jsxs("label",{htmlFor:"categoryId",className:`block text-sm font-medium mb-1 ${h?"text-gray-300":"text-gray-700"}`,children:["Danh mục ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsxs("select",{id:"categoryId",name:"categoryId",value:H.categoryId,onChange:er,className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 ${h?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[c.jsx("option",{value:"",children:"Chọn danh mục"}),t.map(Se=>c.jsx("option",{value:Se.id,children:Se.title},Se.id))]})]}),W&&c.jsx("div",{className:`p-3 mb-4 text-sm rounded-md ${h?"bg-green-900/30 text-green-300 border border-green-800":"bg-green-50 text-green-700 border border-green-200"}`,children:c.jsxs("div",{className:"flex",children:[c.jsx("svg",{className:"h-5 w-5 mr-2 text-green-400 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),c.jsx("span",{children:W})]})}),oe&&c.jsx("div",{className:`p-3 mb-4 text-sm rounded-md ${h?"bg-red-900/30 text-red-300 border border-red-800":"bg-red-50 text-red-700 border border-red-200"}`,children:c.jsxs("div",{className:"flex",children:[c.jsx("svg",{className:"h-5 w-5 mr-2 text-red-400 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),c.jsx("span",{children:oe})]})})]})}),c.jsxs("div",{className:`px-6 py-4 sm:flex sm:flex-row-reverse ${h?"bg-gray-700 border-t border-gray-600":"bg-gray-50 border-t border-gray-200"}`,children:[c.jsx("button",{type:"button",onClick:kt,disabled:Oe,className:`w-full inline-flex justify-center items-center rounded-md border border-transparent shadow-sm px-4 py-2 text-base font-medium text-white sm:ml-3 sm:w-auto sm:text-sm ${Oe?"bg-green-500 cursor-not-allowed":h?"bg-green-700 hover:bg-green-600 focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-green-500":"bg-green-600 hover:bg-green-700 focus:ring-2 focus:ring-offset-2 focus:ring-green-500"}`,children:Oe?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Đang xử lý..."]}):c.jsxs(c.Fragment,{children:[c.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Thêm tài liệu"]})}),c.jsx("button",{type:"button",onClick:()=>K(!1),className:`mt-3 w-full inline-flex justify-center rounded-md border shadow-sm px-4 py-2 text-base font-medium sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm ${h?"bg-gray-700 hover:bg-gray-600 text-gray-300 border-gray-600":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:"Hủy bỏ"})]})]})]})}),fe&&c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:c.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-70"})}),c.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),c.jsxs("div",{className:`inline-block align-bottom rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full ${h?"bg-gray-700 border border-gray-600":"bg-gray-50 border border-gray-200"}`,children:[c.jsx("div",{className:`px-6 py-4 border-b ${h?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h3",{className:`text-lg font-medium ${h?"text-white":"text-gray-900"}`,children:"Chỉnh sửa tài liệu"}),c.jsx("button",{type:"button",className:`rounded-md p-1 focus:outline-none ${h?"text-gray-400 hover:text-gray-200":"text-gray-500 hover:text-gray-700"}`,onClick:()=>_e(!1),children:c.jsx("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),c.jsx("div",{className:`px-6 py-5 ${h?"bg-gray-700 text-gray-200":"bg-gray-50 text-gray-800"}`,children:c.jsxs("form",{onSubmit:Xe,children:[c.jsxs("div",{className:"mb-5",children:[c.jsxs("label",{htmlFor:"edit-title",className:`block text-sm font-medium mb-1 ${h?"text-gray-300":"text-gray-700"}`,children:["Tên tài liệu ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",name:"title",id:"edit-title",value:J.title,onChange:Et,className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 ${h?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"}`,placeholder:"Nhập tên tài liệu"})]}),c.jsxs("div",{className:"mb-5",children:[c.jsxs("label",{htmlFor:"edit-categoryId",className:`block text-sm font-medium mb-1 ${h?"text-gray-300":"text-gray-700"}`,children:["Danh mục ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsxs("select",{id:"edit-categoryId",name:"categoryId",value:J.categoryId,onChange:Et,className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 ${h?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[c.jsx("option",{value:"",children:"Chọn danh mục"}),t.map(Se=>c.jsx("option",{value:Se.id,children:Se.title},Se.id))]})]}),W&&c.jsx("div",{className:`p-3 mb-4 text-sm rounded-md ${h?"bg-green-900/30 text-green-300 border border-green-800":"bg-green-50 text-green-700 border border-green-200"}`,children:c.jsxs("div",{className:"flex",children:[c.jsx("svg",{className:"h-5 w-5 mr-2 text-green-400 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),c.jsx("span",{children:W})]})}),oe&&c.jsx("div",{className:`p-3 mb-4 text-sm rounded-md ${h?"bg-red-900/30 text-red-300 border border-red-800":"bg-red-50 text-red-700 border border-red-200"}`,children:c.jsxs("div",{className:"flex",children:[c.jsx("svg",{className:"h-5 w-5 mr-2 text-red-400 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),c.jsx("span",{children:oe})]})})]})}),c.jsxs("div",{className:`px-6 py-4 sm:flex sm:flex-row-reverse ${h?"bg-gray-700 border-t border-gray-600":"bg-gray-50 border-t border-gray-200"}`,children:[c.jsx("button",{type:"button",onClick:Xe,disabled:Oe,className:`w-full inline-flex justify-center items-center rounded-md border border-transparent shadow-sm px-4 py-2 text-base font-medium text-white sm:ml-3 sm:w-auto sm:text-sm ${Oe?"bg-blue-500 cursor-not-allowed":h?"bg-blue-700 hover:bg-blue-600 focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-blue-500":"bg-blue-600 hover:bg-blue-700 focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}`,children:Oe?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Đang xử lý..."]}):c.jsxs(c.Fragment,{children:[c.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Cập nhật tài liệu"]})}),c.jsx("button",{type:"button",onClick:()=>_e(!1),className:`mt-3 w-full inline-flex justify-center rounded-md border shadow-sm px-4 py-2 text-base font-medium sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm ${h?"bg-gray-700 hover:bg-gray-600 text-gray-300 border-gray-600":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:"Hủy bỏ"})]})]})]})}),B&&c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:c.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-70"})}),c.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),c.jsxs("div",{className:`inline-block align-bottom rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full ${h?"bg-gray-700 border border-gray-600":"bg-gray-50 border border-gray-200"}`,children:[c.jsx("div",{className:`px-6 py-4 border-b ${h?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h3",{className:`text-lg font-medium ${h?"text-white":"text-gray-900"}`,children:"Xác nhận xóa tài liệu"}),c.jsx("button",{type:"button",className:`rounded-md p-1 focus:outline-none ${h?"text-gray-400 hover:text-gray-200":"text-gray-500 hover:text-gray-700"}`,onClick:()=>q(!1),children:c.jsx("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),c.jsx("div",{className:`px-6 py-5 ${h?"bg-gray-700 text-gray-200":"bg-gray-50 text-gray-800"}`,children:bt?c.jsx("div",{className:`p-3 mb-4 text-sm rounded-md ${h?"bg-green-900/30 text-green-300 border border-green-800":"bg-green-50 text-green-700 border border-green-200"}`,children:c.jsxs("div",{className:"flex",children:[c.jsx("svg",{className:"h-5 w-5 mr-2 text-green-400 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),c.jsx("span",{children:bt})]})}):c.jsxs("form",{children:[c.jsxs("div",{className:"mb-5",children:[c.jsx("label",{htmlFor:"delete-title",className:`block text-sm font-medium mb-1 ${h?"text-gray-300":"text-gray-700"}`,children:"Tên tài liệu"}),c.jsx("input",{type:"text",id:"delete-title",value:(re==null?void 0:re.title)||"",readOnly:!0,className:`w-full px-3 py-2 border rounded-md shadow-sm ${h?"bg-gray-600 border-gray-500 text-white":"bg-gray-100 border-gray-300 text-gray-700"}`})]}),c.jsxs("div",{className:"mb-5",children:[c.jsx("label",{htmlFor:"delete-category",className:`block text-sm font-medium mb-1 ${h?"text-gray-300":"text-gray-700"}`,children:"Danh mục"}),c.jsx("input",{type:"text",id:"delete-category",value:(re==null?void 0:re.categoryTitle)||"",readOnly:!0,className:`w-full px-3 py-2 border rounded-md shadow-sm ${h?"bg-gray-600 border-gray-500 text-white":"bg-gray-100 border-gray-300 text-gray-700"}`})]}),c.jsx("div",{className:`p-3 mb-5 text-sm rounded-md border ${h?"bg-red-900/30 text-red-300 border-red-800":"bg-red-50 text-red-700 border-red-200"}`,children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("svg",{className:"h-5 w-5 mr-2 text-red-400 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),c.jsx("span",{className:"font-medium",children:"Cảnh báo: "}),c.jsx("span",{className:"ml-1",children:"Tất cả câu hỏi trong tài liệu này sẽ bị xóa vĩnh viễn!"})]})}),c.jsxs("div",{className:"flex items-center mb-5",children:[c.jsx("input",{id:"confirm-delete",name:"confirm-delete",type:"checkbox",checked:Ue,onChange:Se=>Te(Se.target.checked),className:`h-4 w-4 text-red-600 focus:ring-red-500 border-gray-300 rounded ${h?"bg-gray-700 border-gray-500":""}`}),c.jsx("label",{htmlFor:"confirm-delete",className:`ml-2 block text-sm ${h?"text-gray-300":"text-gray-700"}`,children:"Tôi xác nhận muốn xóa tài liệu này và tất cả câu hỏi liên quan"})]}),De&&c.jsx("div",{className:`p-3 mb-4 text-sm rounded-md ${h?"bg-red-900/30 text-red-300 border border-red-800":"bg-red-50 text-red-700 border border-red-200"}`,children:c.jsxs("div",{className:"flex",children:[c.jsx("svg",{className:"h-5 w-5 mr-2 text-red-400 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),c.jsx("span",{children:De})]})})]})}),c.jsx("div",{className:`px-6 py-4 sm:flex ${bt?"justify-center":"sm:flex-row-reverse"} ${h?"bg-gray-700 border-t border-gray-600":"bg-gray-50 border-t border-gray-200"}`,children:bt?c.jsx("button",{type:"button",onClick:()=>q(!1),className:`w-full inline-flex justify-center rounded-md border shadow-sm px-4 py-2 text-base font-medium sm:w-auto sm:text-sm ${h?"bg-gray-700 hover:bg-gray-600 text-gray-300 border-gray-600":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:"Đóng"}):c.jsxs(c.Fragment,{children:[c.jsx("button",{type:"button",onClick:Gt,disabled:Ae||!Ue,className:`w-full inline-flex justify-center items-center rounded-md border border-transparent shadow-sm px-4 py-2 text-base font-medium text-white sm:ml-3 sm:w-auto sm:text-sm ${Ae?"bg-red-500 cursor-not-allowed":Ue?h?"bg-red-700 hover:bg-red-600 focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-red-500":"bg-red-600 hover:bg-red-700 focus:ring-2 focus:ring-offset-2 focus:ring-red-500":"bg-red-400 cursor-not-allowed"}`,children:Ae?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Đang xử lý..."]}):c.jsxs(c.Fragment,{children:[c.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Xác nhận xóa"]})}),c.jsx("button",{type:"button",onClick:()=>q(!1),className:`mt-3 w-full inline-flex justify-center rounded-md border shadow-sm px-4 py-2 text-base font-medium sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm ${h?"bg-gray-700 hover:bg-gray-600 text-gray-300 border-gray-600":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:"Hủy bỏ"})]})})]})]})})]})},sG=()=>{var te;console.log("QuestionManagement component is rendering");const[t,e]=F.useState([]),[r,n]=F.useState([]),[s,i]=F.useState(!0),[a,o]=F.useState(null),[l]=vn(St),{isAdmin:u}=Yn(),{isDarkMode:h}=Mr(),d=Or(),[m,p]=F.useState(!1),[x,g]=F.useState([]),[y,w]=F.useState({}),[E,_]=F.useState(null),[N,j]=F.useState(null),[D,k]=F.useState(0),[S,b]=F.useState(!1),[C,A]=F.useState(""),[I,P]=F.useState(window.innerWidth),[ue,de]=F.useState(""),[ie,ge]=F.useState(null),[ne,K]=F.useState(!1),[fe,_e]=F.useState(!1),[B,q]=F.useState(!1),[H,G]=F.useState({question:"",answer:"",documentId:""}),[J,ae]=F.useState({id:"",question:"",answer:"",documentId:""}),[re,he]=F.useState(null),[oe,Pe]=F.useState(""),[W,$e]=F.useState(""),[Oe,We]=F.useState(!1),[Ue,Te]=F.useState(!1),[Ae,ye]=F.useState(!1),[De,st]=F.useState(""),[bt,Mt]=F.useState(""),[_t,er]=F.useState(!1),[Et,kt]=F.useState(null),[Xe,Gt]=F.useState(null),[ze,xt]=F.useState([]),[Tt,Se]=F.useState({}),[Ze,_r]=F.useState("text"),[dt,Ct]=F.useState(null),[Er,kr]=F.useState(""),ke=G_.useRef(null),[ut,Br]=F.useState(0),[Ir,Zr]=F.useState(!1),[xs,zo]=F.useState(0),[Ui,Va]=F.useState(0);F.useEffect(()=>{const X=()=>{P(window.innerWidth)};return window.addEventListener("resize",X),()=>{window.removeEventListener("resize",X)}},[]),F.useEffect(()=>{(async()=>{if(console.log("Loading data, isAdmin:",u),!u){console.log("User is not admin, returning early"),i(!1);return}try{i(!0);const Q=await Tx();console.log("Categories fetched:",Q);const Y=[...Q].sort((et,ot)=>(et.stt||Number.MAX_SAFE_INTEGER)-(ot.stt||Number.MAX_SAFE_INTEGER));xt(Y);const Z={},ce=[];if(Y.forEach(et=>{if(et.documents&&et.documents.length>0){const ot=[...et.documents].sort((Vr,vs)=>(Vr.stt||Number.MAX_SAFE_INTEGER)-(vs.stt||Number.MAX_SAFE_INTEGER));Z[et.id]=ot,ot.forEach(Vr=>{ce.push({...Vr,categoryId:et.id,categoryTitle:et.title,categoryLogo:et.logo||null})})}}),Se(Z),!Y||Y.length===0){console.log("No categories found"),o("Không tìm thấy danh mục"),i(!1);return}const xe=Y[0];if(console.log("First category:",xe),!xe.documents||xe.documents.length===0){console.log("No documents found in first category"),o("Không tìm thấy tài liệu trong danh mục đầu tiên"),i(!1);return}const Ne=xe.documents[0];console.log("First document:",Ne);const we=await Lm();console.log("All questions fetched:",we);const Re=we.filter(et=>et.documentId===Ne.id);console.log("Filtered questions for first document:",Re);const Be=[{id:xe.id,title:xe.title,logo:xe.logo||null}],Nt={[xe.id]:[Ne]};ge(Ne.id),_(xe.id),j(Ne.id),k(0),g(Be),w(Nt),e(Re||[]),n([Ne]),kt(xe.id),Gt(Ne.id),console.log("Data loading complete, filtered questions count:",Re.length),i(!1)}catch(Q){console.error("Error loading data:",Q),o("Không thể tải danh sách câu hỏi và tài liệu: "+Q.message),i(!1)}})()},[u]),F.useEffect(()=>{!s&&!u&&d("/")},[u,s,d]);const Ms=X=>{G({...H,[X.target.name]:X.target.value})},Ua=X=>{ae({...J,[X.target.name]:X.target.value})},Tr=X=>{const Q=X.target.files[0];if(kr(""),!Q){Ct(null);return}const Y=Q.name.split(".").pop().toLowerCase();if(Y!=="xlsx"&&Y!=="xls"){kr("Chỉ chấp nhận file Excel (.xlsx, .xls)"),Ct(null);return}if(Q.size>5*1024*1024){kr("Kích thước file không được vượt quá 5MB"),Ct(null);return}Ct(Q)},$i=async X=>new Promise((Q,Y)=>{const Z=new FileReader;Z.onload=async ce=>{try{const xe=ce.target.result,Ne=Ng(xe,{type:"binary"}),we=Ne.SheetNames[0],Re=Ne.Sheets[we],Be=Bh.sheet_to_json(Re,{header:"A"});if(Be.length===0){Y(new Error("File Excel không chứa dữ liệu"));return}if(!Be.some(ot=>ot.A&&ot.B&&ot.A.toString().trim()!==""&&ot.B.toString().trim()!=="")){Y(new Error("File Excel phải có ít nhất 2 cột dữ liệu"));return}const et=Be.filter(ot=>ot.A&&ot.B&&ot.A.toString().trim()!==""&&ot.B.toString().trim()!=="");if(et.length===0){Y(new Error("Không tìm thấy dữ liệu hợp lệ trong file Excel"));return}Q(et)}catch(xe){Y(new Error("Lỗi khi đọc file Excel: "+xe.message))}},Z.onerror=ce=>{Y(ce)},Z.readAsBinaryString(X)}),ui=async(X,Q)=>{zo(X.length),Va(0),Br(0);try{for(let Y=0;Y<X.length;Y++){const Z=X[Y],ce={question:Z.A.toString().trim(),answer:Z.B.toString().trim(),documentId:Q};await bw(ce),Va(Y+1),Br(Math.round((Y+1)/X.length*100))}return X.length}catch(Y){throw new Error("Lỗi khi tải câu hỏi lên Firestore: "+Y.message)}},hi=async X=>{if(X.preventDefault(),Pe(""),$e(""),kr(""),Ze==="text"){if(!H.question.trim()){Pe("Vui lòng nhập câu hỏi");return}if(!H.answer.trim()){Pe("Vui lòng nhập câu trả lời");return}try{We(!0);const Q={question:H.question.trim(),answer:H.answer.trim(),documentId:ie},Y=await bw(Q),Z=r.find(ce=>ce.id===Q.documentId);e(ce=>[...ce,{...Y,documentTitle:(Z==null?void 0:Z.title)||"",documentId:(Z==null?void 0:Z.id)||"",categoryId:(Z==null?void 0:Z.categoryId)||"",categoryTitle:(Z==null?void 0:Z.categoryTitle)||"",categoryLogo:(Z==null?void 0:Z.categoryLogo)||null}]),G({question:"",answer:"",documentId:""}),K(!1),$e("Đã thêm câu hỏi thành công!"),setTimeout(()=>{$e("")},3e3)}catch(Q){console.error("Error adding question:",Q),Pe("Lỗi khi thêm câu hỏi: "+Q.message)}finally{We(!1)}}else{if(!dt){kr("Vui lòng chọn file Excel");return}try{We(!0),Zr(!0);const Q=await $i(dt),Y=await ui(Q,ie);$e(`Đã nhập thành công ${Y} câu hỏi từ file Excel!`),setTimeout(()=>{Ct(null),ke.current&&(ke.current.value=""),Zr(!1),K(!1),(async()=>{try{const xe=(await Lm()).filter(Ne=>Ne.documentId===ie);e(xe||[])}catch(ce){console.error("Error refreshing questions:",ce)}})()},2e3)}catch(Q){console.error("Error processing Excel file:",Q),Pe(Q.message||"Lỗi khi xử lý file Excel"),Zr(!1)}finally{We(!1)}}},hc=async X=>{if(X.preventDefault(),Pe(""),!J.question.trim()){Pe("Vui lòng nhập câu hỏi");return}if(!J.answer.trim()){Pe("Vui lòng nhập câu trả lời");return}try{We(!0);const Q={question:J.question.trim(),answer:J.answer.trim(),documentId:ie};await A9(J.id,Q);const Y=r.find(Z=>Z.id===Q.documentId);e(Z=>Z.map(ce=>ce.id===J.id?{...ce,...Q,documentTitle:(Y==null?void 0:Y.title)||ce.documentTitle,categoryId:(Y==null?void 0:Y.categoryId)||ce.categoryId,categoryTitle:(Y==null?void 0:Y.categoryTitle)||ce.categoryTitle,categoryLogo:(Y==null?void 0:Y.categoryLogo)||ce.categoryLogo}:ce)),_e(!1),$e("Đã cập nhật câu hỏi thành công!"),setTimeout(()=>{$e("")},3e3)}catch(Q){console.error("Error updating question:",Q),Pe("Lỗi khi cập nhật câu hỏi: "+Q.message)}finally{We(!1)}},R=async()=>{if(re)try{ye(!0),st(""),await I9(re.id),e(X=>X.filter(Q=>Q.id!==re.id)),q(!1),Mt("Đã xóa câu hỏi thành công!"),setTimeout(()=>{Mt("")},3e3)}catch(X){console.error("Error deleting question:",X),st("Lỗi khi xóa câu hỏi: "+X.message)}finally{ye(!1),Te(!1)}},V=X=>{ae({id:X.id,question:X.question,answer:X.answer,documentId:ie}),_e(!0)},O=X=>{he(X),q(!0)},M=t.filter(X=>{var Q,Y,Z;if(ue){const ce=ue.toLowerCase();return((Q=X.question)==null?void 0:Q.toLowerCase().includes(ce))||((Y=X.answer)==null?void 0:Y.toLowerCase().includes(ce))||((Z=X.documentTitle)==null?void 0:Z.toLowerCase().includes(ce))}return!0});console.log("Filtered questions count:",M.length);const U=async()=>{if(!(!Et||!Xe))try{i(!0);const Q=(await Lm()).filter(Z=>Z.documentId===Xe);let Y=null;Tt[Et]&&(Y=Tt[Et].find(Z=>Z.id===Xe)),e(Q||[]),ge(Xe),_(Et),j(Xe),Y&&n([Y]),er(!1),i(!1)}catch(X){console.error("Error applying filter:",X),o("Không thể áp dụng bộ lọc: "+X.message),i(!1)}},z=X=>{kt(X),Tt[X]&&Tt[X].length>0?Gt(Tt[X][0].id):Gt(null)};return c.jsxs("div",{className:`flex flex-col min-h-screen ${h?"bg-gray-900":"bg-slate-100"}`,children:[I<770&&c.jsx(ac,{setIsSidebarOpen:b,isDarkMode:h}),c.jsxs("div",{className:"flex min-h-screen",children:[c.jsx("div",{className:`${I<770?`fixed inset-y-0 left-0 z-20 transition-all duration-300 transform ${S?"translate-x-0":"-translate-x-full"}`:"sticky top-0 h-screen z-10"}`,children:c.jsx(ic,{sidebarData:x,documents:y,openMain:D,setOpenMain:k,selectedCategory:E,selectedDocument:N,setSelectedDocument:j,setSearch:A,setDocuments:w,isOpen:S,setIsOpen:b,hideDocumentTree:!0})}),S&&I<770&&c.jsx("div",{className:"fixed inset-0 z-10 bg-black/50",onClick:()=>b(!1)}),c.jsxs("div",{className:"flex-1 overflow-hidden",children:[I>=770&&c.jsx("div",{className:"sticky top-0 z-20 w-full",children:c.jsx(Wo,{user:l,isDarkMode:h,setIsThemePickerOpen:p,setIsSidebarOpen:b})}),m&&c.jsx(ja,{onClose:()=>p(!1)}),c.jsx("main",{className:`p-4 md:p-6 ${h?"bg-gray-900 text-white":"bg-slate-100 text-gray-900"}`,children:c.jsxs("div",{className:"max-w-7xl mx-auto",children:[c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:[c.jsx("h1",{className:"text-2xl font-bold mb-4 md:mb-0",children:"Quản lý Bộ Câu Hỏi"}),c.jsx("div",{className:"flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-3",children:c.jsx("button",{className:`px-4 py-2 rounded-md ${h?"bg-blue-600 hover:bg-blue-700":"bg-blue-500 hover:bg-blue-600"} text-white transition-colors`,onClick:()=>K(!0),children:c.jsxs("span",{className:"flex items-center justify-center",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thêm Câu Hỏi Mới"]})})})]}),W&&c.jsx("div",{className:"mb-4 p-3 bg-green-100 text-green-700 rounded-md",children:W}),bt&&c.jsx("div",{className:"mb-4 p-3 bg-green-100 text-green-700 rounded-md",children:bt}),a&&c.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-md",children:a}),c.jsx("div",{className:"mb-6 bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-3 md:space-y-0 md:space-x-4",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("label",{htmlFor:"search",className:"block text-sm font-medium mb-1",children:"Tìm kiếm câu hỏi"}),c.jsx("input",{type:"text",id:"search",className:`w-full rounded-md ${h?"bg-gray-700 text-white border-gray-600":"bg-white text-gray-900 border-gray-300"} border px-3 py-2`,placeholder:"Tìm theo câu hỏi, câu trả lời hoặc tên tài liệu...",value:ue,onChange:X=>de(X.target.value)})]}),c.jsxs("div",{className:"w-full md:w-64",children:[c.jsx("label",{className:"block text-sm font-medium mb-1",children:"Bộ câu hỏi"}),c.jsxs("button",{type:"button",onClick:()=>er(!0),className:`w-full flex items-center justify-between px-4 py-2 rounded-md ${h?"bg-gray-700 text-white border-gray-600 hover:bg-gray-600":"bg-white text-gray-900 border-gray-300 hover:bg-gray-100"} border transition-colors`,children:[c.jsx("span",{children:r.length>0&&((te=r.find(X=>X.id===ie))==null?void 0:te.title)||"Chọn bộ câu hỏi"}),c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]})]})}),c.jsx("div",{className:"overflow-hidden bg-white dark:bg-gray-800 rounded-lg shadow-md",children:s?c.jsxs("div",{className:"p-6 text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),c.jsx("p",{className:"mt-4",children:"Đang tải dữ liệu..."})]}):M.length===0?c.jsx("div",{className:"p-6 text-center",children:c.jsx("p",{children:"Không tìm thấy câu hỏi nào."})}):c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[c.jsx("thead",{className:h?"bg-gray-700":"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"STT"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Câu hỏi"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Câu trả lời"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Tài liệu"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Danh mục"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Thao tác"})]})}),c.jsx("tbody",{className:`divide-y ${h?"divide-gray-700":"divide-gray-200"}`,children:M.map((X,Q)=>c.jsxs("tr",{className:`${h?"hover:bg-gray-700":"hover:bg-gray-50"} transition-colors`,children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:Q+1}),c.jsx("td",{className:"px-6 py-4 text-sm",children:c.jsx("div",{className:"max-w-xs overflow-hidden",children:X.question})}),c.jsx("td",{className:"px-6 py-4 text-sm",children:c.jsx("div",{className:"max-w-xs overflow-hidden",children:X.answer.length>100?`${X.answer.substring(0,100)}...`:X.answer})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:X.documentTitle}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:X.categoryTitle}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:c.jsxs("div",{className:"flex space-x-2",children:[c.jsx("button",{onClick:()=>V(X),className:"text-blue-500 hover:text-blue-700",title:"Chỉnh sửa",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),c.jsx("button",{onClick:()=>O(X),className:"text-red-500 hover:text-red-700",title:"Xóa",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},X.id))})]})})})]})})]})]}),ne&&c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:c.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-70"})}),c.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),c.jsx("div",{className:`inline-block align-bottom rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full ${h?"bg-gray-700 border border-gray-600":"bg-gray-50 border border-gray-200"}`,children:c.jsxs("div",{className:`px-6 pt-6 pb-6 ${h?"bg-gray-800":"bg-white"}`,children:[c.jsx("h3",{className:"text-xl font-medium leading-6 mb-5",children:"Thêm Câu Hỏi Mới"}),oe&&c.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-600 rounded-md text-sm",children:oe}),c.jsxs("form",{onSubmit:hi,children:[c.jsxs("div",{className:"mb-5",children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Loại nhập liệu"}),c.jsxs("div",{className:"flex space-x-4",children:[c.jsxs("label",{className:"flex items-center",children:[c.jsx("input",{type:"radio",name:"questionType",value:"text",checked:Ze==="text",onChange:()=>_r("text"),className:`h-4 w-4 ${h?"text-blue-600 bg-gray-700 border-gray-600":"text-blue-600 bg-gray-100 border-gray-300"}`}),c.jsx("span",{className:"ml-2",children:"Nhập câu hỏi"})]}),c.jsxs("label",{className:"flex items-center",children:[c.jsx("input",{type:"radio",name:"questionType",value:"excel",checked:Ze==="excel",onChange:()=>_r("excel"),className:`h-4 w-4 ${h?"text-blue-600 bg-gray-700 border-gray-600":"text-blue-600 bg-gray-100 border-gray-300"}`}),c.jsx("span",{className:"ml-2",children:"Nhập từ Excel"})]})]})]}),c.jsxs("div",{className:"mb-5",children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Tài liệu"}),c.jsx("div",{className:`px-4 py-3 rounded-xl border ${h?"bg-gray-700 text-white border-gray-600":"bg-gray-50 text-gray-900 border-gray-200"}`,children:r.length>0&&r[0].title?r[0].title:"Đang tải..."})]}),Ze==="text"?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"mb-5",children:[c.jsx("label",{htmlFor:"question",className:"block text-sm font-medium mb-2",children:"Câu hỏi"}),c.jsx("textarea",{id:"question",name:"question",rows:"3",className:`w-full rounded-xl py-3 px-4 ${h?"bg-gray-700 text-white border-gray-600":"bg-gray-50 text-gray-900 border-gray-200"} border focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"Nhập câu hỏi...",value:H.question,onChange:Ms})]}),c.jsxs("div",{className:"mb-5",children:[c.jsx("label",{htmlFor:"answer",className:"block text-sm font-medium mb-2",children:"Câu trả lời"}),c.jsx("textarea",{id:"answer",name:"answer",rows:"5",className:`w-full rounded-xl py-3 px-4 ${h?"bg-gray-700 text-white border-gray-600":"bg-gray-50 text-gray-900 border-gray-200"} border focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"Nhập câu trả lời...",value:H.answer,onChange:Ms})]})]}):c.jsxs("div",{className:"mb-5",children:[c.jsx("label",{htmlFor:"excelFile",className:"block text-sm font-medium mb-2",children:"File Excel"}),Ir?c.jsxs("div",{className:`p-4 rounded-xl border ${h?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:[c.jsxs("div",{className:"mb-2 flex justify-between text-sm",children:[c.jsx("span",{children:"Đang tải lên Firestore..."}),c.jsxs("span",{children:[ut,"%"]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700 mb-2",children:c.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:{width:`${ut}%`}})}),c.jsxs("p",{className:"text-xs text-center",children:["Đã xử lý ",Ui,"/",xs," câu hỏi"]})]}):c.jsxs("div",{className:`border-2 border-dashed rounded-xl p-4 text-center ${h?"bg-gray-700 border-gray-600 hover:border-gray-500":"bg-gray-50 border-gray-300 hover:border-gray-400"} transition-colors`,children:[c.jsx("input",{type:"file",id:"excelFile",accept:".xlsx,.xls",ref:ke,className:"hidden",onChange:Tr}),dt?c.jsxs("div",{className:"py-2",children:[c.jsx("div",{className:"flex items-center justify-center mb-2",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),c.jsx("p",{className:"text-sm font-medium mb-1",children:dt.name}),c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[(dt.size/1024).toFixed(2)," KB"]}),c.jsx("button",{type:"button",onClick:()=>{Ct(null),ke.current&&(ke.current.value="")},className:`mt-2 px-3 py-1 text-xs rounded-md ${h?"bg-gray-600 hover:bg-gray-500 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-700"}`,children:"Chọn file khác"})]}):c.jsxs("div",{className:"py-8 cursor-pointer",onClick:()=>{var X;return(X=ke.current)==null?void 0:X.click()},children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 mx-auto text-gray-400 mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),c.jsx("p",{className:"text-sm font-medium mb-1",children:"Chọn file Excel"}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Chấp nhận file .xlsx, .xls (tối đa 5MB)"})]})]}),Er&&c.jsx("p",{className:"mt-1 text-sm text-red-500",children:Er}),c.jsxs("div",{className:"mt-3 px-3 py-2 bg-blue-50 dark:bg-blue-900/30 rounded-md text-xs text-blue-700 dark:text-blue-300",children:[c.jsx("p",{className:"font-medium mb-1",children:"Định dạng file Excel:"}),c.jsxs("ul",{className:"list-disc list-inside ml-2 space-y-1",children:[c.jsx("li",{children:"Cột A: Câu hỏi"}),c.jsx("li",{children:"Cột B: Câu trả lời"})]})]})]}),c.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[c.jsx("button",{type:"button",className:`px-5 py-3 rounded-xl font-medium ${h?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-800"} transition-colors`,onClick:()=>K(!1),disabled:Ir,children:"Hủy"}),c.jsx("button",{type:"submit",className:`px-5 py-3 rounded-xl bg-blue-600 hover:bg-blue-700 text-white font-medium transition-colors ${Oe||Ir?"opacity-50 cursor-not-allowed":""}`,disabled:Oe||Ir,children:Ir?`Đang tải lên (${ut}%)`:Oe?"Đang thêm...":"Thêm câu hỏi"})]})]})]})})]})}),fe&&c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:c.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-70"})}),c.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),c.jsx("div",{className:`inline-block align-bottom rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full ${h?"bg-gray-700 border border-gray-600":"bg-gray-50 border border-gray-200"}`,children:c.jsxs("div",{className:`px-6 pt-6 pb-6 ${h?"bg-gray-800":"bg-white"}`,children:[c.jsx("h3",{className:"text-xl font-medium leading-6 mb-5",children:"Chỉnh Sửa Câu Hỏi"}),oe&&c.jsx("div",{className:"mb-4 p-3 bg-red-100 text-red-600 rounded-md text-sm",children:oe}),c.jsxs("form",{onSubmit:hc,children:[c.jsxs("div",{className:"mb-5",children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Tài liệu"}),c.jsx("div",{className:`px-4 py-3 rounded-xl border ${h?"bg-gray-700 text-white border-gray-600":"bg-gray-50 text-gray-900 border-gray-200"}`,children:r.length>0&&r[0].title?r[0].title:"Đang tải..."})]}),c.jsxs("div",{className:"mb-5",children:[c.jsx("label",{htmlFor:"edit-question",className:"block text-sm font-medium mb-2",children:"Câu hỏi"}),c.jsx("textarea",{id:"edit-question",name:"question",required:!0,rows:"3",className:`w-full rounded-xl py-3 px-4 ${h?"bg-gray-700 text-white border-gray-600":"bg-gray-50 text-gray-900 border-gray-200"} border focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"Nhập câu hỏi...",value:J.question,onChange:Ua})]}),c.jsxs("div",{className:"mb-5",children:[c.jsx("label",{htmlFor:"edit-answer",className:"block text-sm font-medium mb-2",children:"Câu trả lời"}),c.jsx("textarea",{id:"edit-answer",name:"answer",required:!0,rows:"5",className:`w-full rounded-xl py-3 px-4 ${h?"bg-gray-700 text-white border-gray-600":"bg-gray-50 text-gray-900 border-gray-200"} border focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"Nhập câu trả lời...",value:J.answer,onChange:Ua})]}),c.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[c.jsx("button",{type:"button",className:`px-5 py-3 rounded-xl font-medium ${h?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-800"} transition-colors`,onClick:()=>_e(!1),children:"Hủy"}),c.jsx("button",{type:"submit",className:`px-5 py-3 rounded-xl bg-blue-600 hover:bg-blue-700 text-white font-medium transition-colors ${Oe?"opacity-50 cursor-not-allowed":""}`,disabled:Oe,children:Oe?"Đang cập nhật...":"Lưu thay đổi"})]})]})]})})]})}),B&&c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:c.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-70"})}),c.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),c.jsx("div",{className:`inline-block align-bottom rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full ${h?"bg-gray-700 border border-gray-600":"bg-gray-50 border border-gray-200"}`,children:c.jsxs("div",{className:`px-6 pt-6 pb-6 ${h?"bg-gray-800":"bg-white"}`,children:[c.jsxs("div",{className:"sm:flex sm:items-start",children:[c.jsx("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:c.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),c.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[c.jsx("h3",{className:"text-xl font-medium",children:"Xác nhận xóa"}),c.jsxs("div",{className:"mt-3",children:[c.jsx("p",{className:"text-base",children:"Bạn có chắc chắn muốn xóa câu hỏi này? Hành động này không thể khôi phục."}),De&&c.jsx("div",{className:"mt-3 p-3 bg-red-100 text-red-600 rounded-md text-sm",children:De}),c.jsxs("div",{className:"mt-4 p-4 rounded-lg bg-gray-100 dark:bg-gray-700",children:[c.jsx("p",{className:"font-medium mb-2",children:"Câu hỏi:"}),c.jsx("p",{className:"text-sm",children:re==null?void 0:re.question})]})]})]})]}),c.jsxs("div",{className:"mt-5 sm:mt-6 sm:flex sm:flex-row-reverse",children:[c.jsx("button",{type:"button",className:`w-full inline-flex justify-center rounded-xl px-5 py-3 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none sm:ml-3 sm:w-auto ${Ae?"opacity-50 cursor-not-allowed":""}`,onClick:R,disabled:Ae,children:Ae?"Đang xóa...":"Xóa"}),c.jsx("button",{type:"button",className:`mt-3 w-full inline-flex justify-center rounded-xl px-5 py-3 ${h?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-800"} font-medium focus:outline-none sm:mt-0 sm:w-auto`,onClick:()=>q(!1),children:"Hủy"})]})]})})]})}),_t&&c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:c.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-70"})}),c.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),c.jsx("div",{className:`inline-block align-bottom rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full ${h?"bg-gray-700 border border-gray-600":"bg-gray-50 border border-gray-200"}`,children:c.jsxs("div",{className:`px-6 pt-6 pb-6 ${h?"bg-gray-800":"bg-white"}`,children:[c.jsx("h3",{className:"text-xl font-medium leading-6 mb-5",children:"Chọn Bộ Câu Hỏi"}),c.jsxs("div",{className:"mb-5",children:[c.jsx("label",{htmlFor:"filterCategory",className:"block text-sm font-medium mb-2",children:"Danh mục"}),c.jsxs("select",{id:"filterCategory",className:`w-full rounded-xl py-3 px-4 ${h?"bg-gray-700 text-white border-gray-600":"bg-gray-50 text-gray-900 border-gray-200"} border focus:outline-none focus:ring-2 focus:ring-blue-500`,value:Et||"",onChange:X=>z(X.target.value),children:[c.jsx("option",{value:"",children:"Chọn danh mục"}),ze.map(X=>c.jsx("option",{value:X.id,children:X.title},X.id))]})]}),c.jsxs("div",{className:"mb-5",children:[c.jsx("label",{htmlFor:"filterDocument",className:"block text-sm font-medium mb-2",children:"Tài liệu"}),c.jsxs("select",{id:"filterDocument",className:`w-full rounded-xl py-3 px-4 ${h?"bg-gray-700 text-white border-gray-600":"bg-gray-50 text-gray-900 border-gray-200"} border focus:outline-none focus:ring-2 focus:ring-blue-500`,value:Xe||"",onChange:X=>Gt(X.target.value),disabled:!Et||!Tt[Et]||Tt[Et].length===0,children:[c.jsx("option",{value:"",children:"Chọn tài liệu"}),Et&&Tt[Et]&&Tt[Et].map(X=>c.jsx("option",{value:X.id,children:X.title},X.id))]})]}),c.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[c.jsx("button",{type:"button",className:`px-5 py-3 rounded-xl font-medium ${h?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-800"} transition-colors`,onClick:()=>er(!1),children:"Hủy"}),c.jsx("button",{type:"button",className:`px-5 py-3 rounded-xl bg-blue-600 hover:bg-blue-700 text-white font-medium transition-colors ${!Et||!Xe?"opacity-50 cursor-not-allowed":""}`,onClick:U,disabled:!Et||!Xe,children:"Áp dụng bộ lọc"})]})]})})]})})]})},iG=t=>t.toLowerCase().replace(/\s+/g,"_").replace(/[^\w-]+/g,"").replace(/--+/g,"_"),aG=()=>{const[t,e]=F.useState([]),[r,n]=F.useState(!0),[s,i]=F.useState(null),{isDarkMode:a}=Mr(),o=Or();vn(St);const[l,u]=F.useState([]),[h,d]=F.useState({}),[m,p]=F.useState(!1),[x,g]=F.useState(window.innerWidth),[y,w]=F.useState(!1);F.useEffect(()=>{const _=()=>{g(window.innerWidth)};return window.addEventListener("resize",_),()=>{window.removeEventListener("resize",_)}},[]),F.useEffect(()=>{(async()=>{try{n(!0);const N=await Tx();if(e(N),u(N),N.length>0){const j=N[0];d({[j.id]:j.documents||[]})}}catch(N){console.error("Error loading homepage data:",N),i("Không thể tải dữ liệu. Vui lòng thử lại sau.")}finally{n(!1)}})()},[]);const E=(_,N)=>{const j=iG(_.title);o(`/${j}/${N.slug}`)};return r?c.jsx("div",{className:`min-h-screen flex items-center justify-center ${a?"bg-gray-900 text-white":"bg-slate-50 text-gray-800"}`,children:c.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-green-500"})}):s?c.jsx("div",{className:`min-h-screen flex items-center justify-center ${a?"bg-gray-900 text-white":"bg-slate-50 text-gray-800"}`,children:c.jsxs("div",{className:"text-center",children:[c.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Lỗi khi tải dữ liệu"}),c.jsx("p",{className:"mb-4",children:s}),c.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:"Thử lại"})]})}):c.jsxs("div",{className:`flex flex-col min-h-screen ${a?"bg-gray-900":"bg-slate-100"}`,children:[x<770&&c.jsx(z9,{setIsSidebarOpen:p,isDarkMode:a}),c.jsx("div",{className:"flex min-h-screen relative",children:c.jsxs("div",{className:`flex flex-col flex-1 ${a?"bg-gray-900 text-white":"bg-slate-50 text-gray-800"}`,children:[x>=770&&c.jsx(Wo,{title:"Trang chủ"}),c.jsxs("div",{className:"flex-1 p-6",children:[c.jsxs("div",{className:"mb-8",children:[c.jsx("h1",{className:`text-2xl font-bold ${a?"text-white":"text-gray-800"}`,children:"Thư viện tài liệu NEU"}),c.jsx("p",{className:`mt-2 ${a?"text-gray-300":"text-gray-600"}`,children:"Chọn một danh mục để xem tài liệu liên quan"})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(_=>c.jsxs("div",{className:`rounded-lg overflow-hidden shadow-md ${a?"bg-gray-800 border border-gray-700":"bg-white"}`,children:[c.jsx("div",{className:`px-6 py-4 ${a?"border-b border-gray-700":"border-b border-gray-200"}`,children:c.jsx("h2",{className:`text-lg font-semibold ${a?"text-white":"text-gray-800"}`,children:_.title})}),c.jsx("div",{className:"p-2",children:c.jsx("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:_.documents&&_.documents.length>0?_.documents.map(N=>c.jsx("li",{children:c.jsx("button",{onClick:()=>E(_,N),className:`w-full text-left px-4 py-3 rounded-md ${a?"hover:bg-gray-700 text-gray-200":"hover:bg-gray-100 text-gray-700"} transition-colors`,children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("svg",{className:"w-5 h-5 mr-2 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),c.jsx("span",{children:N.title})]})})},N.id)):c.jsx("li",{className:`px-4 py-3 ${a?"text-gray-400":"text-gray-500"}`,children:"Không có tài liệu"})})})]},_.id))})]})]})}),c.jsx(ja,{isOpen:y,onClose:()=>w(!1)})]})},oG=()=>{const[t]=vn(St),{isAdmin:e,loading:r}=Yn();return r?c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-green-500"})}):t&&e?c.jsx(Wc,{children:c.jsx(Z3,{})}):c.jsx(aG,{})};function lG(){return c.jsx(D9,{children:c.jsx(V9,{children:c.jsx(W9,{children:c.jsx(WI,{children:c.jsxs(jI,{children:[c.jsx(Es,{path:"/",element:c.jsx(oG,{})}),c.jsx(Es,{path:"/login",element:c.jsx(JH,{})}),c.jsx(Es,{path:"/register",element:c.jsx(eG,{})}),c.jsx(Es,{path:"/profile",element:c.jsx(tG,{})}),c.jsx(Es,{path:"/admin/users",element:c.jsx(Wc,{children:c.jsx(Z3,{})})}),c.jsx(Es,{path:"/admin/categories",element:c.jsx(Wc,{children:c.jsx(rG,{})})}),c.jsx(Es,{path:"/admin/documents",element:c.jsx(Wc,{children:c.jsx(nG,{})})}),c.jsx(Es,{path:"/admin/questions",element:c.jsx(Wc,{children:c.jsx(sG,{})})}),c.jsx(Es,{path:"/:categorySlug/:documentSlug",element:c.jsx(YH,{})}),c.jsx(Es,{path:"*",element:c.jsx(sk,{to:"/",replace:!0})})]})})})})})}const cG=()=>{const t=localStorage.getItem("darkMode");t===null?(localStorage.setItem("darkMode",JSON.stringify(!1)),document.documentElement.classList.remove("dark")):JSON.parse(t)?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")};typeof window<"u"&&cG();try{Qm.createRoot(document.getElementById("root")).render(c.jsx(lG,{}))}catch(t){console.error("Error rendering app:",t),document.body.innerHTML=`
    <div style="padding: 20px; font-family: sans-serif;">
      <h2 style="color: red;">App Error</h2>
      <p>There was an error loading the application:</p>
      <pre style="background: #f5f5f5; padding: 10px; border-radius: 5px; overflow: auto;">${t.message}</pre>
      <p>Check the console for more details.</p>
    </div>
  `}export{Ea as C,iu as E,si as F,C1 as L,go as _,cd as a,A1 as b,uG as c,mf as d,l5 as e,hG as f,ir as g,s5 as i,O5 as o,Qs as r,c5 as v};
